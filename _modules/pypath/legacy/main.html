
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pypath.legacy.main &#8212; pypath 0.15.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/pypathdocs.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_modules/pypath/legacy/main';</script>
    <link rel="icon" href="../../../_static/omnipath-logo.svg"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../../contents.html">
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/omnipath-logo.svg" class="logo__image only-light" alt="Pypath"/>
    <script>document.write(`<img src="../../../_static/omnipath-logo.svg" class="logo__image only-dark" alt="Pypath"/>`);</script>
  
  
    <p class="title logo__title">Pypath</p>
  
</a></div>
    
  </div>
  
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../index.html">
                        Welcome to pypath!
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../webservice.html">
                        Webservice
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../releasehistory.html">
                        Release history
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../reference.html">
                        Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../notebooks/manual.html">
                        The pypath book
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/saezlab/pypath" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/omnipathdb" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/pypath-omnipath" title="PyPI" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-solid fa-box"></i></span>
            <label class="sr-only">PyPI</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://omnipathdb.org/" title="OmniPath" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-solid fa-university"></i></span>
            <label class="sr-only">OmniPath</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://saezlab.org/" title="Saez Lab" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-solid fa-users"></i></span>
            <label class="sr-only">Saez Lab</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../index.html">
                        Welcome to pypath!
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../webservice.html">
                        Webservice
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../releasehistory.html">
                        Release history
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../reference.html">
                        Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../notebooks/manual.html">
                        The pypath book
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/saezlab/pypath" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/omnipathdb" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/pypath-omnipath" title="PyPI" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-solid fa-box"></i></span>
            <label class="sr-only">PyPI</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://omnipathdb.org/" title="OmniPath" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-solid fa-university"></i></span>
            <label class="sr-only">OmniPath</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://saezlab.org/" title="Saez Lab" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-solid fa-users"></i></span>
            <label class="sr-only">Saez Lab</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../contents.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link">Module code</a></li>
    
    
    <li class="breadcrumb-item"><a href="../../pypath.html" class="nav-link">pypath</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">pypath.legacy.main</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <h1>Source code for pypath.legacy.main</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="c1">#</span>
<span class="c1">#  This file is part of the `pypath` python module</span>
<span class="c1">#</span>
<span class="c1">#  Copyright</span>
<span class="c1">#  2014-2022</span>
<span class="c1">#  EMBL, EMBL-EBI, Uniklinik RWTH Aachen, Heidelberg University</span>
<span class="c1">#</span>
<span class="c1">#  Authors: Dénes Türei (turei.denes@gmail.com)</span>
<span class="c1">#           Nicolàs Palacio</span>
<span class="c1">#           Sebastian Lobentanzer</span>
<span class="c1">#           Erva Ulusoy</span>
<span class="c1">#           Olga Ivanova</span>
<span class="c1">#           Ahmet Rifaioglu</span>
<span class="c1">#</span>
<span class="c1">#  Distributed under the GPLv3 License.</span>
<span class="c1">#  See accompanying file LICENSE.txt or copy at</span>
<span class="c1">#      http://www.gnu.org/licenses/gpl-3.0.html</span>
<span class="c1">#</span>
<span class="c1">#  Website: http://pypath.omnipathdb.org/</span>
<span class="c1">#</span>

<span class="kn">from</span> <span class="nn">future.utils</span> <span class="kn">import</span> <span class="n">iteritems</span>
<span class="kn">from</span> <span class="nn">past.builtins</span> <span class="kn">import</span> <span class="n">xrange</span><span class="p">,</span> <span class="nb">range</span><span class="p">,</span> <span class="n">reduce</span>

<span class="kn">import</span> <span class="nn">pypath.share.session</span> <span class="k">as</span> <span class="nn">session_mod</span>

<span class="n">_logger</span> <span class="o">=</span> <span class="n">session_mod</span><span class="o">.</span><span class="n">Logger</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;main&#39;</span><span class="p">)</span>

<span class="c1"># external modules:</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">importlib</span> <span class="k">as</span> <span class="nn">imp</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">codecs</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">textwrap</span>
<span class="kn">import</span> <span class="nn">copy</span> <span class="k">as</span> <span class="nn">copy_mod</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">locale</span>
<span class="kn">import</span> <span class="nn">heapq</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">collections</span>

<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Py 2/3</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">basestring</span>

<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="n">basestring</span> <span class="o">=</span> <span class="nb">str</span>

<span class="c1"># Py 2/3</span>
<span class="k">try</span><span class="p">:</span>
    <span class="nb">input</span> <span class="o">=</span> <span class="n">raw_input</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">cPickle</span> <span class="k">as</span> <span class="nn">pickle</span>

<span class="k">except</span> <span class="ne">ModuleNotFoundError</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pickle</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pygraphviz</span> <span class="k">as</span> <span class="nn">graphviz</span>

<span class="k">except</span> <span class="ne">ModuleNotFoundError</span><span class="p">:</span>
    <span class="n">_logger</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
        <span class="s1">&#39;Module `pygraphviz` not available. &#39;</span>
        <span class="s1">&#39;You don</span><span class="se">\&#39;</span><span class="s1">t need it unless you want to export dot files.&#39;</span>
    <span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pandas</span>

<span class="k">except</span> <span class="ne">ModuleNotFoundError</span><span class="p">:</span>
    <span class="n">_logger</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Module `pandas` not available.&#39;</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">igraph</span>

<span class="k">except</span> <span class="ne">ModuleNotFoundError</span><span class="p">:</span>
    <span class="n">_logger</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
        <span class="s1">&#39;Module `igraph` not available. &#39;</span>
        <span class="s1">&#39;The legacy `pypath.main.PyPath` class requires `igraph`.&#39;</span>
    <span class="p">)</span>

<span class="c1"># importing cairo here only to test if the module is available</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">cairo</span>

<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span> <span class="c1"># XXX: Catching any exception like this is bad practice</span>
                    <span class="c1"># YYY: Why? We only want to send a log message so one can</span>
                    <span class="c1"># find out if this causes any trouble later.</span>
    <span class="n">_logger</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
        <span class="s1">&#39;Module `cairo` not available. &#39;</span>
        <span class="s1">&#39;Some plotting functionalities won</span><span class="se">\&#39;</span><span class="s1">t work.&#39;</span>
    <span class="p">)</span>

<span class="c1"># from this module:</span>
<span class="kn">import</span> <span class="nn">pypath</span>
<span class="kn">import</span> <span class="nn">pypath.share.cache</span> <span class="k">as</span> <span class="nn">cache_mod</span>
<span class="kn">import</span> <span class="nn">pypath.resources.data_formats</span> <span class="k">as</span> <span class="nn">data_formats</span>
<span class="kn">import</span> <span class="nn">pypath.utils.mapping</span> <span class="k">as</span> <span class="nn">mapping</span>
<span class="kn">import</span> <span class="nn">pypath.resources.descriptions</span> <span class="k">as</span> <span class="nn">descriptions</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.pubmed</span> <span class="k">as</span> <span class="nn">pubmed_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.kegg</span> <span class="k">as</span> <span class="nn">kegg_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.phosphosite</span> <span class="k">as</span> <span class="nn">phosphosite_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.phosphonetworks</span> <span class="k">as</span> <span class="nn">phosphonetworks_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.mimp</span> <span class="k">as</span> <span class="nn">mimp_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.laudanna</span> <span class="k">as</span> <span class="nn">laudanna_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.string</span> <span class="k">as</span> <span class="nn">string_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.go</span> <span class="k">as</span> <span class="nn">go_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.pdb</span> <span class="k">as</span> <span class="nn">pdb_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.corum</span> <span class="k">as</span> <span class="nn">corum</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.havugimana</span> <span class="k">as</span> <span class="nn">havugimana</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.compleat</span> <span class="k">as</span> <span class="nn">compleat</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.complexportal</span> <span class="k">as</span> <span class="nn">complexportal</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.proteinatlas</span> <span class="k">as</span> <span class="nn">proteinatlas</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.surfaceome</span> <span class="k">as</span> <span class="nn">surfaceome_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.matrisome</span> <span class="k">as</span> <span class="nn">matrisome_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.phosphopoint</span> <span class="k">as</span> <span class="nn">phosphopoint_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.graphviz</span> <span class="k">as</span> <span class="nn">graphviz_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.disgenet</span> <span class="k">as</span> <span class="nn">disgenet_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.membranome</span> <span class="k">as</span> <span class="nn">membranome_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.wang</span> <span class="k">as</span> <span class="nn">wang_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.acsn</span> <span class="k">as</span> <span class="nn">acsn_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.exocarta</span> <span class="k">as</span> <span class="nn">exocarta_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.guide2pharma</span> <span class="k">as</span> <span class="nn">g2p_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.comppi</span> <span class="k">as</span> <span class="nn">comppi_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.pepcyber</span> <span class="k">as</span> <span class="nn">pepcyber_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.domino</span> <span class="k">as</span> <span class="nn">domino_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.threedid</span> <span class="k">as</span> <span class="nn">threedid</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.threedcomplex</span> <span class="k">as</span> <span class="nn">threedcomplex</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.elm</span> <span class="k">as</span> <span class="nn">elm_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.ielm</span> <span class="k">as</span> <span class="nn">ielm_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.pisa</span> <span class="k">as</span> <span class="nn">pisa</span>
<span class="kn">import</span> <span class="nn">pypath.inputs</span> <span class="k">as</span> <span class="nn">inputs</span>
<span class="kn">import</span> <span class="nn">pypath.core.network</span> <span class="k">as</span> <span class="nn">network</span>
<span class="kn">import</span> <span class="nn">pypath.utils.homology</span> <span class="k">as</span> <span class="nn">homology</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.uniprot</span> <span class="k">as</span> <span class="nn">uniprot_input</span>
<span class="kn">import</span> <span class="nn">pypath.inputs.pfam</span> <span class="k">as</span> <span class="nn">pfam_input</span>
<span class="kn">import</span> <span class="nn">pypath.share.curl</span> <span class="k">as</span> <span class="nn">curl</span>
<span class="kn">import</span> <span class="nn">pypath.internals.intera</span> <span class="k">as</span> <span class="nn">intera</span>
<span class="kn">import</span> <span class="nn">pypath.utils.seq</span> <span class="k">as</span> <span class="nn">se</span>
<span class="kn">import</span> <span class="nn">pypath.utils.go</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">pypath.visual.drawing</span> <span class="k">as</span> <span class="nn">bdrawing</span>
<span class="kn">import</span> <span class="nn">pypath.utils.proteomicsdb</span> <span class="k">as</span> <span class="nn">proteomicsdb</span>
<span class="kn">import</span> <span class="nn">pypath.utils.reflists</span> <span class="k">as</span> <span class="nn">reflists</span>
<span class="kn">import</span> <span class="nn">pypath.internals.input_formats</span> <span class="k">as</span> <span class="nn">input_formats</span>
<span class="kn">import</span> <span class="nn">pypath.internals.refs</span> <span class="k">as</span> <span class="nn">_refs</span>
<span class="kn">import</span> <span class="nn">pypath.visual.plot</span> <span class="k">as</span> <span class="nn">plot</span>
<span class="kn">import</span> <span class="nn">pypath.core.enz_sub</span>
<span class="kn">import</span> <span class="nn">pypath.omnipath.export</span> <span class="k">as</span> <span class="nn">export</span>
<span class="kn">import</span> <span class="nn">pypath.share.common</span> <span class="k">as</span> <span class="nn">common</span>
<span class="kn">from</span> <span class="nn">pypath.share.progress</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">pypath.share.settings</span> <span class="k">as</span> <span class="nn">settings</span>
<span class="kn">import</span> <span class="nn">pypath.core.entity</span> <span class="k">as</span> <span class="nn">entity_mod</span>
<span class="kn">import</span> <span class="nn">pypath.utils.taxonomy</span> <span class="k">as</span> <span class="nn">taxonomy</span>
<span class="kn">import</span> <span class="nn">pypath.legacy.db_categories</span> <span class="k">as</span> <span class="nn">db_categories</span>
<span class="kn">import</span> <span class="nn">pypath.resources.network</span> <span class="k">as</span> <span class="nn">network_resources</span>
<span class="kn">import</span> <span class="nn">pypath.core.evidence</span> <span class="k">as</span> <span class="nn">evidence</span>
<span class="kn">import</span> <span class="nn">pypath.core.interaction</span> <span class="k">as</span> <span class="nn">interaction</span>

<span class="c1"># to make it accessible directly from the module</span>
<span class="n">omnipath</span> <span class="o">=</span> <span class="n">network_resources</span><span class="o">.</span><span class="n">omnipath</span>

<span class="c1"># XXX: The following aliases are already defined in common.py</span>
<span class="c1"># For compatibility with python 2, see https://docs.python.org/3/whatsnew/3.0.html</span>
<span class="k">if</span> <span class="s1">&#39;long&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">__builtins__</span><span class="p">):</span>
    <span class="n">long</span> <span class="o">=</span> <span class="nb">int</span>

<span class="k">if</span> <span class="s1">&#39;unicode&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">__builtins__</span><span class="p">):</span>
    <span class="n">unicode</span> <span class="o">=</span> <span class="nb">str</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PyPath&#39;</span><span class="p">,</span> <span class="s1">&#39;Direction&#39;</span><span class="p">,</span> <span class="s1">&#39;_AttrHelper&#39;</span><span class="p">,</span> <span class="s1">&#39;omnipath&#39;</span><span class="p">]</span>


<span class="n">NetworkEntityCollection</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span>
    <span class="s1">&#39;NetworkEntityCollection&#39;</span><span class="p">,</span>
    <span class="p">[</span>
        <span class="s1">&#39;total&#39;</span><span class="p">,</span>
        <span class="s1">&#39;by_resource&#39;</span><span class="p">,</span>
        <span class="s1">&#39;by_category&#39;</span><span class="p">,</span>
        <span class="s1">&#39;shared&#39;</span><span class="p">,</span>
        <span class="s1">&#39;unique&#39;</span><span class="p">,</span>
        <span class="s1">&#39;shared_res_cat&#39;</span><span class="p">,</span>
        <span class="s1">&#39;unique_res_cat&#39;</span><span class="p">,</span>
        <span class="s1">&#39;shared_cat&#39;</span><span class="p">,</span>
        <span class="s1">&#39;unique_cat&#39;</span><span class="p">,</span>
        <span class="s1">&#39;resource_cat&#39;</span><span class="p">,</span>
        <span class="s1">&#39;cat_resource&#39;</span><span class="p">,</span>
        <span class="s1">&#39;method&#39;</span><span class="p">,</span>
        <span class="s1">&#39;label&#39;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="n">NetworkEntityCollection</span><span class="o">.</span><span class="fm">__new__</span><span class="o">.</span><span class="vm">__defaults__</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,)</span> <span class="o">*</span> <span class="mi">8</span>


<span class="n">NetworkStatsRecord</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span>
    <span class="s1">&#39;NetworkStatsRecord&#39;</span><span class="p">,</span>
    <span class="p">[</span>
        <span class="s1">&#39;total&#39;</span><span class="p">,</span>
        <span class="s1">&#39;by_resource&#39;</span><span class="p">,</span>
        <span class="s1">&#39;by_category&#39;</span><span class="p">,</span>
        <span class="s1">&#39;shared&#39;</span><span class="p">,</span>
        <span class="s1">&#39;unique&#39;</span><span class="p">,</span>
        <span class="s1">&#39;percent&#39;</span><span class="p">,</span>
        <span class="s1">&#39;shared_res_cat&#39;</span><span class="p">,</span>
        <span class="s1">&#39;unique_res_cat&#39;</span><span class="p">,</span>
        <span class="s1">&#39;percent_res_cat&#39;</span><span class="p">,</span>
        <span class="s1">&#39;shared_cat&#39;</span><span class="p">,</span>
        <span class="s1">&#39;unique_cat&#39;</span><span class="p">,</span>
        <span class="s1">&#39;percent_cat&#39;</span><span class="p">,</span>
        <span class="s1">&#39;resource_cat&#39;</span><span class="p">,</span>
        <span class="s1">&#39;cat_resource&#39;</span><span class="p">,</span>
        <span class="s1">&#39;method&#39;</span><span class="p">,</span>
        <span class="s1">&#39;label&#39;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="n">NetworkStatsRecord</span><span class="o">.</span><span class="fm">__new__</span><span class="o">.</span><span class="vm">__defaults__</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,)</span> <span class="o">*</span> <span class="mi">11</span>


<div class="viewcode-block" id="Direction"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction">[docs]</a><span class="k">class</span> <span class="nc">Direction</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a *legacy* object for handling directionality information</span>
<span class="sd">    associated with unique pairs of interacting molecular entities.</span>
<span class="sd">    The py:class:`pypath.interaction.Interaction` available in the ``attrs``</span>
<span class="sd">    edge attribute of the legacy :py:class:`pypath.main.PyPath`` object</span>
<span class="sd">    provides a clearer and much more versatile interface. This object will</span>
<span class="sd">    be removed at some point, we don&#39;t recommend to build applications by</span>
<span class="sd">    using it.</span>
<span class="sd">    </span>
<span class="sd">    Object storing directionality information of an edge. Also includes</span>
<span class="sd">    information about the reverse direction, mode of regulation and</span>
<span class="sd">    sources of that information.</span>

<span class="sd">    :arg str id_a:</span>
<span class="sd">        Name of the source node.</span>
<span class="sd">    :arg str id_b:</span>
<span class="sd">        Name of the target node.</span>

<span class="sd">    :var dict dirs:</span>
<span class="sd">        Dictionary containing the presence of directionality of the</span>
<span class="sd">        given edge. Keys are *straight*, *reverse* and ``&#39;undirected&#39;``</span>
<span class="sd">        and their values denote the presence/absence [bool].</span>
<span class="sd">    :var dict negative:</span>
<span class="sd">        Dictionary contianing the presence/absence [bool] of negative</span>
<span class="sd">        interactions for both :py:attr:`straight` and :py:attr:`reverse`</span>
<span class="sd">        directions.</span>
<span class="sd">    :var dict negative_sources:</span>
<span class="sd">        Contains the resource names [str] supporting a negative</span>
<span class="sd">        interaction on :py:attr:`straight` and :py:attr:`reverse`</span>
<span class="sd">        directions.</span>
<span class="sd">    :var list nodes:</span>
<span class="sd">        Contains the node names [str] sorted alphabetically (*id_a*,</span>
<span class="sd">        *id_b*).</span>
<span class="sd">    :var dict positive:</span>
<span class="sd">        Dictionary contianing the presence/absence [bool] of positive</span>
<span class="sd">        interactions for both :py:attr:`straight` and :py:attr:`reverse`</span>
<span class="sd">        directions.</span>
<span class="sd">    :var dict positive_sources:</span>
<span class="sd">        Contains the resource names [str] supporting a positive</span>
<span class="sd">        interaction on :py:attr:`straight` and :py:attr:`reverse`</span>
<span class="sd">        directions.</span>
<span class="sd">    :var tuple reverse:</span>
<span class="sd">        Contains the node names [str] in reverse order e.g. (*id_b*,</span>
<span class="sd">        *id_a*).</span>
<span class="sd">    :var dict sources:</span>
<span class="sd">        Contains the resource names [str] of a given edge for each</span>
<span class="sd">        directionality (:py:attr:`straight`, :py:attr:`reverse` and</span>
<span class="sd">        ``&#39;undirected&#39;``). Values are sets containing the names of those</span>
<span class="sd">        resources supporting such directionality.</span>
<span class="sd">    :var tuple straight:</span>
<span class="sd">        Contains the node names [str] in the original order e.g.</span>
<span class="sd">        (*id_a*, *id_b*).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;nodes&#39;</span><span class="p">,</span>
        <span class="s1">&#39;straight&#39;</span><span class="p">,</span>
        <span class="s1">&#39;reverse&#39;</span><span class="p">,</span>
        <span class="s1">&#39;dirs&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sources&#39;</span><span class="p">,</span>
        <span class="s1">&#39;positive&#39;</span><span class="p">,</span>
        <span class="s1">&#39;negative&#39;</span><span class="p">,</span>
        <span class="s1">&#39;positive_sources&#39;</span><span class="p">,</span>
        <span class="s1">&#39;negative_sources&#39;</span><span class="p">,</span>
    <span class="p">]</span>

<div class="viewcode-block" id="Direction.__init__"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the edge object between the given nodes.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">straight</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reverse</span>  <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dirs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">:</span>  <span class="kc">False</span><span class="p">,</span>
            <span class="s1">&#39;undirected&#39;</span><span class="p">:</span>  <span class="kc">False</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sources</span> <span class="o">=</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">:</span> <span class="nb">set</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">:</span>  <span class="nb">set</span><span class="p">(),</span>
            <span class="s1">&#39;undirected&#39;</span><span class="p">:</span>  <span class="nb">set</span><span class="p">(),</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">positive</span> <span class="o">=</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">:</span>  <span class="kc">False</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">negative</span> <span class="o">=</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">:</span>  <span class="kc">False</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">positive_sources</span> <span class="o">=</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">:</span> <span class="nb">set</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">:</span>  <span class="nb">set</span><span class="p">(),</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">negative_sources</span> <span class="o">=</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">:</span> <span class="nb">set</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">:</span>  <span class="nb">set</span><span class="p">(),</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="Direction.reload"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.reload">[docs]</a>    <span class="k">def</span> <span class="nf">reload</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reloads the object from the module level.&quot;&quot;&quot;</span>

        <span class="n">modname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span>
        <span class="n">mod</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">modname</span><span class="p">,</span> <span class="n">fromlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">modname</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="n">imp</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>
        <span class="n">new</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;__class__&#39;</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Custom string/printing function for the object.&quot;&quot;&quot;</span>

    <span class="c1"># XXX: Pretty sure this could be refactored and implemented more</span>
    <span class="c1">#      efficiently like using str.format()</span>

        <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;Directions and signs of interaction between </span><span class="si">%s</span><span class="s1"> and </span><span class="si">%s</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">%</span> \
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dirs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">]:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="si">%s</span><span class="s1"> ===&gt; </span><span class="si">%s</span><span class="s1"> :: </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> \
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">]))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dirs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">]:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="si">%s</span><span class="s1"> &lt;=== </span><span class="si">%s</span><span class="s1"> :: </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> \
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                 <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">]))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dirs</span><span class="p">[</span><span class="s1">&#39;undirected&#39;</span><span class="p">]:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="si">%s</span><span class="s1"> ==== </span><span class="si">%s</span><span class="s1"> :: </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> \
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                 <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;undirected&#39;</span><span class="p">]))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">positive</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">]:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="si">%s</span><span class="s1"> =+=&gt; </span><span class="si">%s</span><span class="s1"> :: </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positive_sources</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">]))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">positive</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">]:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="si">%s</span><span class="s1"> &lt;=+= </span><span class="si">%s</span><span class="s1"> :: </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positive_sources</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">]))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">negative</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">]:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="si">%s</span><span class="s1"> =-=&gt; </span><span class="si">%s</span><span class="s1"> :: </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">negative_sources</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">]))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">negative</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">]:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="si">%s</span><span class="s1"> &lt;=-= </span><span class="si">%s</span><span class="s1"> :: </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">negative_sources</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">s</span>


<div class="viewcode-block" id="Direction.check_nodes"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.check_nodes">[docs]</a>    <span class="k">def</span> <span class="nf">check_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks if *nodes* is contained in the edge.</span>

<span class="sd">        :arg list nodes:</span>
<span class="sd">             Or [tuple], contains the names of the nodes to be checked.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*bool*) -- ``True`` if all elements in *nodes* are</span>
<span class="sd">            contained in the object :py:attr:`nodes` list.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">nodes</span><span class="p">)))</span></div>


<div class="viewcode-block" id="Direction.check_param"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.check_param">[docs]</a>    <span class="k">def</span> <span class="nf">check_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">di</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if *di* is ``&#39;undirected&#39;`` or contains the nodes of</span>
<span class="sd">        the current edge. Used internally to check that *di* is a valid</span>
<span class="sd">        key for the object attributes declared on dictionaries.</span>

<span class="sd">        :arg tuple di:</span>
<span class="sd">            Or [str], key to be tested for validity.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*bool*) -- ``True`` if *di* is ``&#39;undirected&#39;`` or a tuple</span>
<span class="sd">              of node names contained in the edge, ``False`` otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">di</span> <span class="o">==</span> <span class="s1">&#39;undirected&#39;</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">di</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">check_nodes</span><span class="p">(</span><span class="n">di</span><span class="p">)))</span></div>


<div class="viewcode-block" id="Direction.set_direction"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.set_direction">[docs]</a>    <span class="k">def</span> <span class="nf">set_direction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds directionality information with the corresponding data</span>
<span class="sd">        source named. Modifies self attributes :py:attr:`dirs` and</span>
<span class="sd">        :py:attr:`sources`.</span>

<span class="sd">        :arg tuple direction:</span>
<span class="sd">            Or [str], the directionality key for which the value on</span>
<span class="sd">            :py:attr:`dirs` has to be set ``True``.</span>
<span class="sd">        :arg set source:</span>
<span class="sd">            Contains the name(s) of the source(s) from which such</span>
<span class="sd">            information was obtained.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_param</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dirs</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">add_to_set</span><span class="p">(</span><span class="nb">set</span><span class="p">([]),</span> <span class="n">source</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">|</span> <span class="n">source</span></div>


    <span class="c1"># synonym: old name</span>
    <span class="n">set_dir</span> <span class="o">=</span> <span class="n">set_direction</span>


<div class="viewcode-block" id="Direction.get_direction"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.get_direction">[docs]</a>    <span class="k">def</span> <span class="nf">get_direction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">sources</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the state (or *sources* if specified) of the given</span>
<span class="sd">        *direction*.</span>

<span class="sd">        :arg tuple direction:</span>
<span class="sd">            Or [str] (if ``&#39;undirected&#39;``). Pair of nodes from which</span>
<span class="sd">            direction information is to be retrieved.</span>
<span class="sd">        :arg bool sources:</span>
<span class="sd">            Optional, ``&#39;False&#39;`` by default. Specifies if the</span>
<span class="sd">            :py:attr:`sources` information of the given direction is to</span>
<span class="sd">            be retrieved instead.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*bool* or *set*) -- (if ``sources=True``). Presence/absence</span>
<span class="sd">            of the requested direction (or the list of sources if</span>
<span class="sd">            specified). Returns ``None`` if *direction* is not valid.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_param</span><span class="p">(</span><span class="n">direction</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">sources</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dirs</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


    <span class="c1"># synonym: old name</span>
    <span class="n">get_dir</span> <span class="o">=</span> <span class="n">get_direction</span>


<div class="viewcode-block" id="Direction.get_directions"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.get_directions">[docs]</a>    <span class="k">def</span> <span class="nf">get_directions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">tgt</span><span class="p">,</span> <span class="n">sources</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns all directions with boolean values or list of sources.</span>

<span class="sd">        :arg str src:</span>
<span class="sd">            Source node.</span>
<span class="sd">        :arg str tgt:</span>
<span class="sd">            Target node.</span>
<span class="sd">        :arg bool sources:</span>
<span class="sd">            Optional, ``False`` by default. Specifies whether to return</span>
<span class="sd">            the :py:attr:`sources` attribute instead of :py:attr:`dirs`.</span>

<span class="sd">        :return:</span>
<span class="sd">            Contains the :py:attr:`dirs` (or :py:attr:`sources` if</span>
<span class="sd">            specified) of the given edge.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="c1"># XXX: What&#39;s the point of using src and tgt if in the end straigth,</span>
    <span class="c1">#      reverse and undirected are returned? Also, in such case:</span>
    <span class="c1">#      `return self.sources/dirs.values()` is more straightforward.</span>

        <span class="n">query</span> <span class="o">=</span> <span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">tgt</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_nodes</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">sources</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="n">query</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[(</span><span class="n">query</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">query</span><span class="p">[</span><span class="mi">0</span><span class="p">])],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;undirected&#39;</span><span class="p">],</span>
                <span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dirs</span><span class="p">[</span><span class="n">query</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dirs</span><span class="p">[(</span><span class="n">query</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">query</span><span class="p">[</span><span class="mi">0</span><span class="p">])],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dirs</span><span class="p">[</span><span class="s1">&#39;undirected&#39;</span><span class="p">],</span>
                <span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


    <span class="c1"># synonym: old name</span>
    <span class="n">get_dirs</span> <span class="o">=</span> <span class="n">get_directions</span>


<div class="viewcode-block" id="Direction.which_directions"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.which_directions">[docs]</a>    <span class="k">def</span> <span class="nf">which_directions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">effect</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the pair(s) of nodes for which there is information</span>
<span class="sd">        about their directionality.</span>

<span class="sd">        :param str effect:</span>
<span class="sd">            Either *positive* or *negative*.</span>
<span class="sd">        :param str,set resources:</span>
<span class="sd">            Limits the query to one or more resources. Optional.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*tuple*) -- Tuple of tuples with pairs of nodes where the</span>
<span class="sd">            first element is the source and the second is the target</span>
<span class="sd">            entity, according to the given resources and limited to the</span>
<span class="sd">            effect.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">resources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resources_set</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span>
        <span class="n">effect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_effect_synonyms</span><span class="p">(</span><span class="n">effect</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span>
            <span class="n">_dir</span>
            <span class="k">for</span> <span class="n">_dir</span><span class="p">,</span> <span class="n">_resources</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">_dir</span> <span class="o">!=</span> <span class="s1">&#39;undirected&#39;</span> <span class="ow">and</span>
            <span class="n">_resources</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="ow">not</span> <span class="n">resources</span> <span class="ow">or</span>
                <span class="n">resources</span> <span class="o">&amp;</span> <span class="n">_resources</span>
            <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="ow">not</span> <span class="n">effect</span>
                <span class="ow">or</span> <span class="p">(</span>
                    <span class="ow">not</span> <span class="n">resources</span> <span class="ow">and</span>
                    <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_sources&#39;</span> <span class="o">%</span> <span class="n">effect</span><span class="p">)</span>
                <span class="p">)</span> <span class="ow">or</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_sources&#39;</span> <span class="o">%</span> <span class="n">effect</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">resources</span>
            <span class="p">)</span>
        <span class="p">)</span></div>


    <span class="c1"># synonym: old name</span>
    <span class="n">which_dirs</span> <span class="o">=</span> <span class="n">which_directions</span>


<div class="viewcode-block" id="Direction.which_signs"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.which_signs">[docs]</a>    <span class="k">def</span> <span class="nf">which_signs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">effect</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the pair(s) of nodes for which there is information</span>
<span class="sd">        about their effect signs.</span>

<span class="sd">        :param str,set resources:</span>
<span class="sd">            Limits the query to one or more resources. Optional.</span>
<span class="sd">        :param str effect:</span>
<span class="sd">            Either *positive* or *negative*, limiting the query to positive</span>
<span class="sd">            or negative effects; for any other values effects of both</span>
<span class="sd">            signs will be returned.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*tuple*) -- Tuple of tuples with pairs of nodes where the</span>
<span class="sd">            first element is a tuple of the source and the target entity,</span>
<span class="sd">            while the second element is the effect sign, according to</span>
<span class="sd">            the given resources. E.g. (((&#39;A&#39;, &#39;B&#39;), &#39;positive&#39;),)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">resources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resources_set</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span>
        <span class="n">effect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_effect_synonyms</span><span class="p">(</span><span class="n">effect</span><span class="p">)</span>
        <span class="n">effects</span> <span class="o">=</span> <span class="p">(</span><span class="n">effect</span><span class="p">,)</span> <span class="k">if</span> <span class="n">effect</span> <span class="k">else</span> <span class="p">(</span><span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="s1">&#39;negative&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span>
            <span class="p">(</span><span class="n">_dir</span><span class="p">,</span> <span class="n">_effect</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">_effect</span> <span class="ow">in</span> <span class="n">effects</span>
            <span class="k">for</span> <span class="n">_dir</span><span class="p">,</span> <span class="n">_resources</span>
            <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_sources&#39;</span> <span class="o">%</span> <span class="n">_effect</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">_resources</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="ow">not</span> <span class="n">resources</span> <span class="ow">or</span>
                <span class="n">resources</span> <span class="o">&amp;</span> <span class="n">_resources</span>
            <span class="p">)</span>
        <span class="p">)</span></div>



    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_effect_synonyms</span><span class="p">(</span><span class="n">effect</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">effect</span><span class="p">:</span>

            <span class="k">return</span>

        <span class="k">if</span> <span class="n">effect</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="s1">&#39;stimulation&#39;</span><span class="p">,</span> <span class="s1">&#39;stimulatory&#39;</span><span class="p">}:</span>

            <span class="k">return</span> <span class="s1">&#39;positive&#39;</span>

        <span class="k">if</span> <span class="n">effect</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="s1">&#39;inhibition&#39;</span><span class="p">,</span> <span class="s1">&#39;inhibitory&#39;</span><span class="p">}:</span>

            <span class="k">return</span> <span class="s1">&#39;negative&#39;</span>


<div class="viewcode-block" id="Direction.unset_direction"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.unset_direction">[docs]</a>    <span class="k">def</span> <span class="nf">unset_direction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">source</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes directionality and/or source information of the</span>
<span class="sd">        specified *direction*. Modifies attribute :py:attr:`dirs` and</span>
<span class="sd">        :py:attr:`sources`.</span>

<span class="sd">        :arg tuple direction:</span>
<span class="sd">            Or [str] (if ``&#39;undirected&#39;``) the pair of nodes specifying</span>
<span class="sd">            the directionality from which the information is to be</span>
<span class="sd">            removed.</span>
<span class="sd">        :arg set source:</span>
<span class="sd">            Optional, ``None`` by default. If specified, determines</span>
<span class="sd">            which specific source(s) is(are) to be removed from</span>
<span class="sd">            :py:attr:`sources` attribute in the specified *direction*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_param</span><span class="p">(</span><span class="n">direction</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="n">direction</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dirs</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span></div>


    <span class="c1"># synonym: old name</span>
    <span class="n">unset_dir</span> <span class="o">=</span> <span class="n">unset_direction</span>


    <span class="k">def</span> <span class="nf">_resources_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

        <span class="k">return</span> <span class="n">common</span><span class="o">.</span><span class="n">to_set</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span>


<div class="viewcode-block" id="Direction.is_directed"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.is_directed">[docs]</a>    <span class="k">def</span> <span class="nf">is_directed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if edge has any directionality information.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*bool*) -- Returns ``True`` if any of the :py:attr:`dirs`</span>
<span class="sd">            attribute values is ``True`` (except ``&#39;undirected&#39;``),</span>
<span class="sd">            ``False`` otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dirs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">]</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">dirs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">]</span></div>


<div class="viewcode-block" id="Direction.is_directed_by_resources"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.is_directed_by_resources">[docs]</a>    <span class="k">def</span> <span class="nf">is_directed_by_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if edge has any directionality information from some</span>
<span class="sd">        resource(s).</span>

<span class="sd">        :return:</span>
<span class="sd">            (*bool*) -- Returns ``True`` if any of the :py:attr:`dirs`</span>
<span class="sd">            attribute values is ``True`` (except ``&#39;undirected&#39;``),</span>
<span class="sd">            ``False`` otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_resource</span><span class="p">(</span><span class="n">resources</span><span class="p">,</span> <span class="n">op</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">or_</span><span class="p">)</span></div>


<div class="viewcode-block" id="Direction.is_mutual"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.is_mutual">[docs]</a>    <span class="k">def</span> <span class="nf">is_mutual</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if the edge has mutual directions (both A--&gt;B and B--&gt;A).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dirs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dirs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">resources</span> <span class="k">else</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_mutual_by_resources</span><span class="p">(</span><span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Direction.is_mutual_by_resources"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.is_mutual_by_resources">[docs]</a>    <span class="k">def</span> <span class="nf">is_mutual_by_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if the edge has mutual directions (both A--&gt;B and B--&gt;A)</span>
<span class="sd">        according to some resource(s).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_resource</span><span class="p">(</span><span class="n">resources</span><span class="p">,</span> <span class="n">op</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">and_</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_by_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">op</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">or_</span><span class="p">):</span>

        <span class="n">resources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resources_set</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">op</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sources_straight</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">resources</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sources_reverse</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">resources</span>
        <span class="p">)</span>


<div class="viewcode-block" id="Direction.is_stimulation"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.is_stimulation">[docs]</a>    <span class="k">def</span> <span class="nf">is_stimulation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if any (or for a specific *direction*) interaction is</span>
<span class="sd">        activation (positive interaction).</span>

<span class="sd">        :arg tuple direction:</span>
<span class="sd">            Optional, ``None`` by default. If specified, checks the</span>
<span class="sd">            :py:attr:`positive` attribute of that specific</span>
<span class="sd">            directionality. If not specified, checks both.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*bool*) -- ``True`` if any interaction (or the specified</span>
<span class="sd">            *direction*) is activatory (positive).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_effect</span><span class="p">(</span>
            <span class="n">sign</span> <span class="o">=</span> <span class="s1">&#39;positive&#39;</span><span class="p">,</span>
            <span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span><span class="p">,</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Direction.is_inhibition"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.is_inhibition">[docs]</a>    <span class="k">def</span> <span class="nf">is_inhibition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if any (or for a specific *direction*) interaction is</span>
<span class="sd">        inhibition (negative interaction).</span>

<span class="sd">        :arg tuple direction:</span>
<span class="sd">            Optional, ``None`` by default. If specified, checks the</span>
<span class="sd">            :py:attr:`negative` attribute of that specific</span>
<span class="sd">            directionality. If not specified, checks both.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*bool*) -- ``True`` if any interaction (or the specified</span>
<span class="sd">            *direction*) is inhibitory (negative).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_effect</span><span class="p">(</span>
            <span class="n">sign</span> <span class="o">=</span> <span class="s1">&#39;negative&#39;</span><span class="p">,</span>
            <span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span><span class="p">,</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_is_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sign</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

        <span class="n">_sign</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">negative_sources</span>
                <span class="k">if</span> <span class="n">sign</span> <span class="o">==</span> <span class="s1">&#39;negative&#39;</span> <span class="k">else</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">positive_sources</span>
        <span class="p">)</span>
        <span class="n">_resources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resources_set</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="nb">any</span><span class="p">(</span>
                <span class="nb">bool</span><span class="p">(</span>
                    <span class="n">val</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">_resources</span> <span class="k">else</span>
                    <span class="n">val</span> <span class="o">&amp;</span> <span class="n">_resources</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">_dir</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">_sign</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">direction</span> <span class="ow">or</span> <span class="n">direction</span> <span class="o">==</span> <span class="n">_dir</span>
            <span class="p">)</span>
        <span class="p">)</span>


<div class="viewcode-block" id="Direction.has_sign"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.has_sign">[docs]</a>    <span class="k">def</span> <span class="nf">has_sign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether the edge (or for a specific *direction*) has</span>
<span class="sd">        any signed information (about positive/negative interactions).</span>

<span class="sd">        :arg tuple direction:</span>
<span class="sd">            Optional, ``None`` by default. If specified, only the</span>
<span class="sd">            information of that direction is checked for sign.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*bool*) -- ``True`` if there exist any information on the</span>
<span class="sd">              sign of the interaction, ``False`` otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_stimulation</span><span class="p">(</span><span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">)</span>
                <span class="ow">or</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_inhibition</span><span class="p">(</span><span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Direction.set_sign"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.set_sign">[docs]</a>    <span class="k">def</span> <span class="nf">set_sign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">sign</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets sign and source information on a given direction of the</span>
<span class="sd">        edge. Modifies the attributes :py:attr:`positive` and</span>
<span class="sd">        :py:attr:`positive_sources` or :py:attr:`negative` and</span>
<span class="sd">        :py:attr:`negative_sources` depending on the sign. Direction is</span>
<span class="sd">        also updated accordingly, which also modifies the attributes</span>
<span class="sd">        :py:attr:`dirs` and :py:attr:`sources`.</span>

<span class="sd">        :arg tuple direction:</span>
<span class="sd">            Pair of edge nodes specifying the direction from which the</span>
<span class="sd">            information is to be set/updated.</span>
<span class="sd">        :arg str sign:</span>
<span class="sd">            Specifies the type of interaction. If ``&#39;positive&#39;``, is</span>
<span class="sd">            considered activation, otherwise, is assumed to be negative</span>
<span class="sd">            (inhibition).</span>
<span class="sd">        :arg set source:</span>
<span class="sd">            Contains the name(s) of the source(s) from which the</span>
<span class="sd">            information was obtained.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_nodes</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_dir</span><span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">add_to_set</span><span class="p">(</span><span class="nb">set</span><span class="p">([]),</span> <span class="n">source</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">sign</span> <span class="o">==</span> <span class="s1">&#39;positive&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">positive</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">positive_sources</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">positive_sources</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">|</span> <span class="n">source</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">negative</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">negative_sources</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">negative_sources</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">|</span> <span class="n">source</span></div>


<div class="viewcode-block" id="Direction.get_sign"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.get_sign">[docs]</a>    <span class="k">def</span> <span class="nf">get_sign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">sign</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sources</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the sign information of the edge in the given</span>
<span class="sd">        diretion. If specified in *sign*, only that sign&#39;s information</span>
<span class="sd">        will be retrieved. If specified in *sources*, the sources of</span>
<span class="sd">        that information will be retrieved instead.</span>

<span class="sd">        :arg tuple direction:</span>
<span class="sd">            Contains the pair of nodes specifying the directionality of</span>
<span class="sd">            the edge from which th information is to be retrieved.</span>
<span class="sd">        :arg str sign:</span>
<span class="sd">            Optional, ``None`` by default. Denotes whether to retrieve</span>
<span class="sd">            the ``&#39;positive&#39;`` or ``&#39;negative&#39;`` specific information.</span>
<span class="sd">        :arg bool sources:</span>
<span class="sd">            Optional, ``False`` by default. Specifies whether to return</span>
<span class="sd">            the sources instead of sign.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*list*) -- If ``sign=None`` containing [bool] values</span>
<span class="sd">            denoting the presence of positive and negative sign on that</span>
<span class="sd">            direction, if ``sources=True`` the [set] of sources for each</span>
<span class="sd">            of them will be returned instead. If *sign* is specified,</span>
<span class="sd">            returns [bool] or [set] (if ``sources=True``) of that</span>
<span class="sd">            specific direction and sign.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_nodes</span><span class="p">(</span><span class="n">direction</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">sources</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">sign</span> <span class="o">==</span> <span class="s1">&#39;positive&#39;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">positive_sources</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span>

                <span class="k">elif</span> <span class="n">sign</span> <span class="o">==</span> <span class="s1">&#39;negative&#39;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">negative_sources</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">positive_sources</span><span class="p">[</span><span class="n">direction</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">negative_sources</span><span class="p">[</span><span class="n">direction</span><span class="p">]]</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">sign</span> <span class="o">==</span> <span class="s1">&#39;positive&#39;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">positive</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span>

                <span class="k">elif</span> <span class="n">sign</span> <span class="o">==</span> <span class="s1">&#39;negative&#39;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">negative</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">positive</span><span class="p">[</span><span class="n">direction</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">negative</span><span class="p">[</span><span class="n">direction</span><span class="p">]]</span></div>

<div class="viewcode-block" id="Direction.unset_sign"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.unset_sign">[docs]</a>    <span class="k">def</span> <span class="nf">unset_sign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">sign</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes sign and/or source information of the specified</span>
<span class="sd">        *direction* and *sign*. Modifies attribute :py:attr:`positive`</span>
<span class="sd">        and :py:attr:`positive_sources` or :py:attr:`negative` and</span>
<span class="sd">        :py:attr:`negative_sources` (or</span>
<span class="sd">        :py:attr:`positive_attributes`/:py:attr:`negative_sources`</span>
<span class="sd">        only if ``source=True``).</span>

<span class="sd">        :arg tuple direction:</span>
<span class="sd">            The pair of nodes specifying the directionality from which</span>
<span class="sd">            the information is to be removed.</span>
<span class="sd">        :arg str sign:</span>
<span class="sd">            Sign from which the information is to be removed. Must be</span>
<span class="sd">            either ``&#39;positive&#39;`` or ``&#39;negative&#39;``.</span>
<span class="sd">        :arg set source:</span>
<span class="sd">            Optional, ``None`` by default. If specified, determines</span>
<span class="sd">            which source(s) is(are) to be removed from the sources in</span>
<span class="sd">            the specified *direction* and *sign*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_nodes</span><span class="p">(</span><span class="n">direction</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                <span class="k">try</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">sign</span> <span class="o">==</span> <span class="s1">&#39;positive&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">positive_sources</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">sign</span> <span class="o">==</span> <span class="s1">&#39;negative&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">negative_sources</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">sign</span> <span class="o">==</span> <span class="s1">&#39;positive&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">positive_sources</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">if</span> <span class="n">sign</span> <span class="o">==</span> <span class="s1">&#39;negative&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">negative_sources</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positive_sources</span><span class="p">[</span><span class="n">direction</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">positive</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">negative_sources</span><span class="p">[</span><span class="n">direction</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">negative</span><span class="p">[</span><span class="n">direction</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="Direction.source"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.source">[docs]</a>    <span class="k">def</span> <span class="nf">source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">undirected</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the name(s) of the source node(s) for each existing</span>
<span class="sd">        direction on the interaction.</span>

<span class="sd">        :arg bool undirected:</span>
<span class="sd">            Optional, ``False`` by default.</span>

<span class="sd">        :returns:</span>
<span class="sd">            (*list*) -- Contains the name(s) for the source node(s).</span>
<span class="sd">            This means if the interaction is bidirectional, the list</span>
<span class="sd">            will contain both identifiers on the edge. If the</span>
<span class="sd">            interaction is undirected, an empty list will be returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_partner</span><span class="p">(</span>
            <span class="n">source_target</span> <span class="o">=</span> <span class="s1">&#39;source&#39;</span><span class="p">,</span>
            <span class="n">undirected</span> <span class="o">=</span> <span class="n">undirected</span><span class="p">,</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="c1"># synonym: old name</span>
    <span class="n">src</span> <span class="o">=</span> <span class="n">source</span>


<div class="viewcode-block" id="Direction.target"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.target">[docs]</a>    <span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">undirected</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the name(s) of the target node(s) for each existing</span>
<span class="sd">        direction on the interaction.</span>

<span class="sd">        :arg bool undirected:</span>
<span class="sd">            Optional, ``False`` by default.</span>

<span class="sd">        :returns:</span>
<span class="sd">            (*list*) -- Contains the name(s) for the target node(s).</span>
<span class="sd">            This means if the interaction is bidirectional, the list</span>
<span class="sd">            will contain both identifiers on the edge. If the</span>
<span class="sd">            interaction is undirected, an empty list will be returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_partner</span><span class="p">(</span>
            <span class="n">source_target</span> <span class="o">=</span> <span class="s1">&#39;target&#39;</span><span class="p">,</span>
            <span class="n">undirected</span> <span class="o">=</span> <span class="n">undirected</span><span class="p">,</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="c1"># synonym: old name</span>
    <span class="n">tgt</span> <span class="o">=</span> <span class="n">target</span>


    <span class="k">def</span> <span class="nf">_partner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_target</span><span class="p">,</span> <span class="n">undirected</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

        <span class="n">resources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resources_set</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span>
        <span class="n">_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">source_target</span> <span class="o">==</span> <span class="s1">&#39;source&#39;</span> <span class="k">else</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">_dir</span><span class="p">[</span><span class="n">_slice</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">_dir</span> <span class="o">!=</span> <span class="s1">&#39;undirected&#39;</span> <span class="k">else</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span>
                    <span class="k">if</span> <span class="n">undirected</span> <span class="k">else</span>
                <span class="p">()</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">_dir</span><span class="p">,</span> <span class="n">_resources</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="p">(</span><span class="ow">not</span> <span class="n">resources</span> <span class="ow">and</span> <span class="n">_resources</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="n">resources</span> <span class="o">&amp;</span> <span class="n">_resources</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">))</span>


<div class="viewcode-block" id="Direction.src_by_source"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.src_by_source">[docs]</a>    <span class="k">def</span> <span class="nf">src_by_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the name(s) of the source node(s) for each existing</span>
<span class="sd">        direction on the interaction for a specific *source*.</span>

<span class="sd">        :arg str source:</span>
<span class="sd">            Name of the source according to which the information is to</span>
<span class="sd">            be retrieved.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*list*) -- Contains the name(s) for the source node(s)</span>
<span class="sd">            according to the specified *source*. This means if the</span>
<span class="sd">            interaction is bidirectional, the list will contain both</span>
<span class="sd">            identifiers on the edge. If the specified *source* is not</span>
<span class="sd">            found or invalid, an empty list will be returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s1">&#39;undirected&#39;</span> <span class="ow">and</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span></div>


<div class="viewcode-block" id="Direction.tgt_by_source"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.tgt_by_source">[docs]</a>    <span class="k">def</span> <span class="nf">tgt_by_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the name(s) of the target node(s) for each existing</span>
<span class="sd">        direction on the interaction for a specific *source*.</span>

<span class="sd">        :arg str source:</span>
<span class="sd">            Name of the source according to which the information is to</span>
<span class="sd">            be retrieved.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*list*) -- Contains the name(s) for the target node(s)</span>
<span class="sd">            according to the specified *source*. This means if the</span>
<span class="sd">            interaction is bidirectional, the list will contain both</span>
<span class="sd">            identifiers on the edge. If the specified *source* is not</span>
<span class="sd">            found or invalid, an empty list will be returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s1">&#39;undirected&#39;</span> <span class="ow">and</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span></div>


<div class="viewcode-block" id="Direction.sources_straight"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.sources_straight">[docs]</a>    <span class="k">def</span> <span class="nf">sources_straight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the list of sources for the :py:attr:`straight`</span>
<span class="sd">        direction.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*set*) -- Contains the names of the sources supporting the</span>
<span class="sd">            :py:attr:`straight` directionality of the edge.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">]</span></div>


<div class="viewcode-block" id="Direction.sources_reverse"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.sources_reverse">[docs]</a>    <span class="k">def</span> <span class="nf">sources_reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the list of sources for the :py:attr:`reverse` direction.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*set*) -- Contains the names of the sources supporting the</span>
<span class="sd">            :py:attr:`reverse` directionality of the edge.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">]</span></div>


<div class="viewcode-block" id="Direction.sources_undirected"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.sources_undirected">[docs]</a>    <span class="k">def</span> <span class="nf">sources_undirected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the list of sources without directed information.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*set*) -- Contains the names of the sources supporting the</span>
<span class="sd">            edge presence but without specific directionality</span>
<span class="sd">            information.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;undirected&#39;</span><span class="p">]</span></div>


<div class="viewcode-block" id="Direction.positive_straight"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.positive_straight">[docs]</a>    <span class="k">def</span> <span class="nf">positive_straight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if the :py:attr:`straight` directionality is a positive</span>
<span class="sd">        interaction.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*bool*) -- ``True`` if there is supporting information on</span>
<span class="sd">            the :py:attr:`straight` direction of the edge as activation.</span>
<span class="sd">            ``False`` otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">positive</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">]</span></div>


<div class="viewcode-block" id="Direction.positive_reverse"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.positive_reverse">[docs]</a>    <span class="k">def</span> <span class="nf">positive_reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if the :py:attr:`reverse` directionality is a positive</span>
<span class="sd">        interaction.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*bool*) -- ``True`` if there is supporting information on</span>
<span class="sd">            the :py:attr:`reverse` direction of the edge as activation.</span>
<span class="sd">            ``False`` otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">positive</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">]</span></div>


<div class="viewcode-block" id="Direction.negative_straight"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.negative_straight">[docs]</a>    <span class="k">def</span> <span class="nf">negative_straight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if the :py:attr:`straight` directionality is a negative</span>
<span class="sd">        interaction.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*bool*) -- ``True`` if there is supporting information on</span>
<span class="sd">            the :py:attr:`straight` direction of the edge as inhibition.</span>
<span class="sd">            ``False`` otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">negative</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">]</span></div>


<div class="viewcode-block" id="Direction.negative_reverse"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.negative_reverse">[docs]</a>    <span class="k">def</span> <span class="nf">negative_reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if the :py:attr:`reverse` directionality is a negative</span>
<span class="sd">        interaction.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*bool*) -- ``True`` if there is supporting information on</span>
<span class="sd">            the :py:attr:`reverse` direction of the edge as inhibition.</span>
<span class="sd">            ``False`` otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">negative</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">]</span></div>


<div class="viewcode-block" id="Direction.negative_sources_straight"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.negative_sources_straight">[docs]</a>    <span class="k">def</span> <span class="nf">negative_sources_straight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the list of sources for the :py:attr:`straight`</span>
<span class="sd">        direction and negative sign.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*set*) -- Contains the names of the sources supporting the</span>
<span class="sd">            :py:attr:`straight` directionality of the edge with a</span>
<span class="sd">            negative sign.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">negative_sources</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">]</span></div>


<div class="viewcode-block" id="Direction.negative_sources_reverse"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.negative_sources_reverse">[docs]</a>    <span class="k">def</span> <span class="nf">negative_sources_reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the list of sources for the :py:attr:`reverse`</span>
<span class="sd">        direction and negative sign.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*set*) -- Contains the names of the sources supporting the</span>
<span class="sd">            :py:attr:`reverse` directionality of the edge with a</span>
<span class="sd">            negative sign.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">negative_sources</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">]</span></div>


<div class="viewcode-block" id="Direction.positive_sources_straight"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.positive_sources_straight">[docs]</a>    <span class="k">def</span> <span class="nf">positive_sources_straight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the list of sources for the :py:attr:`straight`</span>
<span class="sd">        direction and positive sign.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*set*) -- Contains the names of the sources supporting the</span>
<span class="sd">            :py:attr:`straight` directionality of the edge with a</span>
<span class="sd">            positive sign.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">positive_sources</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">]</span></div>


<div class="viewcode-block" id="Direction.positive_sources_reverse"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.positive_sources_reverse">[docs]</a>    <span class="k">def</span> <span class="nf">positive_sources_reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the list of sources for the :py:attr:`reverse`</span>
<span class="sd">        direction and positive sign.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*set*) -- Contains the names of the sources supporting the</span>
<span class="sd">            :py:attr:`reverse` directionality of the edge with a</span>
<span class="sd">            positive sign.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">positive_sources</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">]</span></div>


<div class="viewcode-block" id="Direction.majority_dir"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.majority_dir">[docs]</a>    <span class="k">def</span> <span class="nf">majority_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Infers which is the major directionality of the edge by number</span>
<span class="sd">        of supporting sources.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*tuple*) -- Contains the pair of nodes denoting the</span>
<span class="sd">            consensus directionality. If the number of sources on both</span>
<span class="sd">            directions is equal, ``None`` is returned. If there is no</span>
<span class="sd">            directionality information, ``&#39;undirected&#39;``` will be</span>
<span class="sd">            returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_directed</span><span class="p">():</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">]):</span>
                <span class="k">return</span> <span class="kc">None</span>

            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">]):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">straight</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reverse</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;undirected&#39;</span></div>

<div class="viewcode-block" id="Direction.majority_sign"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.majority_sign">[docs]</a>    <span class="k">def</span> <span class="nf">majority_sign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Infers which is the major sign (activation/inhibition) of the</span>
<span class="sd">        edge by number of supporting sources on both directions.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*dict*) -- Keys are the node tuples on both directions</span>
<span class="sd">            (:py:attr:`straight`/:py:attr:`reverse`) and values can be</span>
<span class="sd">            either ``None`` if that direction has no sign information or</span>
<span class="sd">            a list of two [bool] elements corresponding to majority of</span>
<span class="sd">            positive and majority of negative support. In case both</span>
<span class="sd">            elements of the list are ``True``, this means the number of</span>
<span class="sd">            supporting sources for both signs in that direction is</span>
<span class="sd">            equal.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dirs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">]</span>

        <span class="n">result</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">d</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_sign</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="n">d</span><span class="p">):</span>
                <span class="n">p</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">positive_sources</span><span class="p">[</span><span class="n">d</span><span class="p">],</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">negative_sources</span><span class="p">[</span><span class="n">d</span><span class="p">]])</span>

                <span class="n">result</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="Direction.consensus_edges"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.consensus_edges">[docs]</a>    <span class="k">def</span> <span class="nf">consensus_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Infers the consensus edge(s) according to the number of</span>
<span class="sd">        supporting sources. This includes direction and sign.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*list*) -- Contains the consensus edge(s) along with the</span>
<span class="sd">            consensus sign. If there is no major directionality, both</span>
<span class="sd">            are returned. The structure is as follows:</span>
<span class="sd">            ``[&#39;&lt;source&gt;&#39;, &#39;&lt;target&gt;&#39;, &#39;&lt;(un)directed&gt;&#39;, &#39;&lt;sign&gt;&#39;]``</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">majority_dir</span><span class="p">()</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">majority_sign</span><span class="p">()</span>

        <span class="c1"># XXX: This case could actually return directly, would save some time</span>
        <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="s1">&#39;undirected&#39;</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                           <span class="s1">&#39;undirected&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">])</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">dirs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">]</span> <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[</span><span class="n">d</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="n">d</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;directed&#39;</span><span class="p">,</span> <span class="s1">&#39;positive&#39;</span><span class="p">])</span>

    <span class="c1"># XXX: Technically, if s[d] is not None, this could be an elif right?</span>
                    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="n">d</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;directed&#39;</span><span class="p">,</span> <span class="s1">&#39;negative&#39;</span><span class="p">])</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;directed&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="Direction.merge"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.merge">[docs]</a>    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Merges current edge with another (if and only if they are the</span>
<span class="sd">        same class and contain the same nodes). Updates the attributes</span>
<span class="sd">        :py:attr:`dirs`, :py:attr:`sources`, :py:attr:`positive`,</span>
<span class="sd">        :py:attr:`negative`, :py:attr:`positive_sources` and</span>
<span class="sd">        :py:attr:`negative_sources`.</span>

<span class="sd">        :arg pypath.main.Direction other:</span>
<span class="sd">            The new edge object to be merged with the current one.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_nodes</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">nodes</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">,</span> <span class="s1">&#39;undirected&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dirs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dirs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">dirs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">|</span> <span class="n">other</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

    <span class="c1"># XXX: Is there a reason to only update positive with straight and negative</span>
    <span class="c1">#      only with reverse?</span>
                <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">positive</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">positive</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">positive</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">positive_sources</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positive_sources</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                                                <span class="o">|</span> <span class="n">other</span><span class="o">.</span><span class="n">positive_sources</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

                <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">negative</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">negative</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">negative</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">negative_sources</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">negative_sources</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                                                <span class="o">|</span> <span class="n">other</span><span class="o">.</span><span class="n">negative_sources</span><span class="p">[</span><span class="n">k</span><span class="p">])</span></div>

<div class="viewcode-block" id="Direction.translate"><a class="viewcode-back" href="../../../api/pypath.legacy.main.Direction.html#pypath.legacy.main.Direction.translate">[docs]</a>    <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Translates the node names/identifiers according to the</span>
<span class="sd">        dictionary *ids*.</span>

<span class="sd">        :arg dict ids:</span>
<span class="sd">            Dictionary containing (at least) the current names of the</span>
<span class="sd">            nodes as keys and their translation as values.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*pypath.main.Direction*) -- The copy of current edge object</span>
<span class="sd">            with translated node names.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># new Direction object</span>
        <span class="n">newd</span> <span class="o">=</span> <span class="n">Direction</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">ids</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

        <span class="c1"># copying directions</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">):</span>
            <span class="n">di</span> <span class="o">=</span> <span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">ids</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span> <span class="k">else</span> <span class="n">k</span>
            <span class="n">newd</span><span class="o">.</span><span class="n">set_dir</span><span class="p">(</span><span class="n">di</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

        <span class="c1"># copying signs</span>
        <span class="k">for</span> <span class="n">di</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">straight</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reverse</span><span class="p">]:</span>
            <span class="n">pos</span><span class="p">,</span> <span class="n">neg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sign</span><span class="p">(</span><span class="n">di</span><span class="p">,</span> <span class="n">sources</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

            <span class="n">newd</span><span class="o">.</span><span class="n">set_sign</span><span class="p">((</span><span class="n">ids</span><span class="p">[</span><span class="n">di</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">ids</span><span class="p">[</span><span class="n">di</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span> <span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
            <span class="n">newd</span><span class="o">.</span><span class="n">set_sign</span><span class="p">((</span><span class="n">ids</span><span class="p">[</span><span class="n">di</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">ids</span><span class="p">[</span><span class="n">di</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span> <span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="n">neg</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">newd</span></div></div>


<span class="k">class</span> <span class="nc">_AttrHelper</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Legacy* object for internal use. Will be removed.</span>
<span class="sd">    Assists in assigning visual attributes for plotting and export methods.</span>

<span class="sd">    * Initialization arguments:</span>
<span class="sd">        - *value* [dict/str]?:</span>
<span class="sd">        - *name* [str]?: Optional, ``None`` by default.</span>
<span class="sd">        - *defaults* [dict]:</span>

<span class="sd">    * Attributes:</span>
<span class="sd">        - *value* [dict]?:</span>
<span class="sd">        - *name* [str]?:</span>
<span class="sd">        - *defaults* [dict]:</span>
<span class="sd">        - *id_type* [type]:</span>

<span class="sd">    * Call arguments:</span>
<span class="sd">        - *instance* []:</span>
<span class="sd">        - *this_directed* [tuple?]: Optional, ``None`` by default.</span>
<span class="sd">        - *thisSign* []: Optional, ``None`` by default.</span>
<span class="sd">        - *this_directedSources* []: Optional, ``None`` by default.</span>
<span class="sd">        - *thisSources* []: Optional, ``None`` by default.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">defaults</span><span class="o">=</span><span class="p">{}):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">defaults</span> <span class="o">=</span> <span class="n">defaults</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">id_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">this_directed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">thisSign</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">this_directedSources</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">thisSources</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">_this_directed</span> <span class="o">=</span> <span class="s1">&#39;directed&#39;</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">this_directed</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="n">this_directed</span>

        <span class="c1"># user supplied callback function:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>

        <span class="c1"># special cases #1: by direction/effect</span>
        <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;DIRECTIONS&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaults</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
              <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaults</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">_this_directed</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaults</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]:</span>

                <span class="k">if</span> <span class="n">thisSign</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaults</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="n">_this_directed</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaults</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="n">_this_directed</span><span class="p">][</span><span class="n">thisSign</span><span class="p">]</span>

        <span class="c1"># special cases #2: by source category</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;RESOURCE_CATEGORIES&#39;</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">resource_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pathway&#39;</span><span class="p">,</span> <span class="s1">&#39;ptm&#39;</span><span class="p">,</span> <span class="s1">&#39;reaction&#39;</span><span class="p">,</span> <span class="s1">&#39;interaction&#39;</span><span class="p">]:</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">db_categories</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_resources&#39;</span> <span class="o">%</span> <span class="n">resource_type</span><span class="p">)</span>
                       <span class="o">&amp;</span><span class="n">thisSources</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaults</span>
                        <span class="ow">and</span> <span class="n">resource_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaults</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]):</span>
                        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaults</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="n">resource_type</span><span class="p">]</span>

            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">wrtie</span><span class="p">(</span><span class="s1">&#39;No category for </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">thisSources</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

        <span class="c1"># if value is constant:</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">common</span><span class="o">.</span><span class="n">simple_types</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>

        <span class="c1"># if a dictionary given to map some igraph attribute to values:</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">attr_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;_name&#39;</span><span class="p">]):</span>
                <span class="n">key_attr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;_name&#39;</span><span class="p">])</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;_name&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">instance</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
                <span class="n">key_attr</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;_name&#39;</span><span class="p">]]</span>

            <span class="k">if</span> <span class="n">key_attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">key_attr</span><span class="p">]</span>

        <span class="c1"># if default value has been given for this attribute:</span>
        <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaults</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
              <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaults</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaults</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>

        <span class="c1"># ultimately, return None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>


<span class="k">class</span> <span class="nc">_NamedVertexSeq</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Legacy* object, will be removed.</span>
<span class="sd">    A more versatile replacement in the new API is</span>
<span class="sd">    :py:class:`pypath.entity.EntityList`.</span>
<span class="sd">    Vertex sequence object. Combines the list of vertex objects, their</span>
<span class="sd">    UniProt IDs and corresponding GeneSymbols.</span>

<span class="sd">    :arg igraph.VertexSeq _vs:</span>
<span class="sd">        Collection of :py:class:`igraph.Vertex` objects.</span>
<span class="sd">    :arg list _nodNam:</span>
<span class="sd">        List of [str] containing the node names (UniProt IDs).</span>
<span class="sd">    :arg list _nodLab:</span>
<span class="sd">        List of [str] containing the node labels (GeneSymbols).</span>

<span class="sd">    :var igraph.VertexSeq _vs:</span>
<span class="sd">        Collection of :py:class:`igraph.Vertex` objects.</span>
<span class="sd">    :var lsit _nodNam:</span>
<span class="sd">        List of [str] containing the node names (UniProt IDs).</span>
<span class="sd">    :var list _nodLab:</span>
<span class="sd">        List of [str] containing the node labels (GeneSymbols).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;_vs&#39;</span><span class="p">,</span> <span class="s1">&#39;_nodNam&#39;</span><span class="p">,</span> <span class="s1">&#39;_nodLab&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_vs</span><span class="p">,</span> <span class="n">_nodNam</span><span class="p">,</span> <span class="n">_nodLab</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the object and sets the attributes according to the</span>
<span class="sd">        passed arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_vs</span> <span class="o">=</span> <span class="n">_vs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nodNam</span> <span class="o">=</span> <span class="n">_nodNam</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nodLab</span> <span class="o">=</span> <span class="n">_nodLab</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterator function yielding the :py:class:`igraph.Vertex`</span>
<span class="sd">        instances contained in *_vs*. It&#39;s accessed through the alias</span>
<span class="sd">        *vs*.</span>

<span class="sd">        :yield:</span>
<span class="sd">            (*igraph.Vertex*) -- The :py:class:`igraph.Vertex` object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vs</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">v</span>

    <span class="k">def</span> <span class="nf">genesymbol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterator function yielding the GeneSymbols contained in</span>
<span class="sd">        *_nodLab*. It can be accessed through the alias *gs*.</span>

<span class="sd">        :yield:</span>
<span class="sd">            (*str*) -- The GeneSymbols from the node list.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vs</span><span class="p">:</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodLab</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">uniprot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterator function yielding the UniProt IDs contained in</span>
<span class="sd">        *_nodNam*. It can be accessed through the alias *up*.</span>

<span class="sd">        :yield:</span>
<span class="sd">            (*str*) -- The UniProt IDs from the node list.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vs</span><span class="p">:</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodNam</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterator function yielding the vertex indexes.</span>

<span class="sd">        :yield:</span>
<span class="sd">            (*int*) -- The node&#39;s index.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vs</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span>

    <span class="c1"># Aliases</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">genesymbol</span>
    <span class="n">up</span> <span class="o">=</span> <span class="n">uniprot</span>
    <span class="n">vs</span> <span class="o">=</span> <span class="fm">__iter__</span>


<div class="viewcode-block" id="PyPath"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath">[docs]</a><span class="k">class</span> <span class="nc">PyPath</span><span class="p">(</span><span class="n">session_mod</span><span class="o">.</span><span class="n">Logger</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is the a *legacy* object representing a molecular interaction</span>
<span class="sd">    network. At some point it will be removed, we don&#39;t recommend to rely</span>
<span class="sd">    on it when you build your applications.</span>
<span class="sd">    The :py:class:`pypath.network.Network` object offers a much clearer and</span>
<span class="sd">    more versatile API. As of end of 2019 not all functionalities have been</span>
<span class="sd">    migrated to the new API. For this reason we offer an intermediate</span>
<span class="sd">    solution: in this `igraph` based object the `attrs` edge attribute</span>
<span class="sd">    holds instances of :py:class:`pypath.interaction.Interaction` objects,</span>
<span class="sd">    the same type of object we use to represent interactions in the new</span>
<span class="sd">    :py:class:`pypath.network.Network`.</span>
<span class="sd">    At the same time we will keep supporting `igraph` with a method for</span>
<span class="sd">    converting :py:class:`pypath.network.Network` to a</span>
<span class="sd">    :py:class:`igraph.Graph` object, however this won&#39;t provide all the</span>
<span class="sd">    methods available here but will serve only the purpose to make it</span>
<span class="sd">    possible to use the graph theory methods from the `igraph` library</span>
<span class="sd">    on networks built with `pypath`.</span>

<span class="sd">    An object representing a molecular interaction network.</span>

<span class="sd">    :arg int ncbi_tax_id:</span>
<span class="sd">        Optional, ``9606`` (Homo sapiens) by default. NCBI Taxonomic</span>
<span class="sd">        identifier of the organism from which the data will be</span>
<span class="sd">        downloaded.</span>
<span class="sd">    :arg dict default_name_type:</span>
<span class="sd">        Optional, ``{&#39;protein&#39;: &#39;uniprot&#39;, &#39;mirna&#39;: &#39;mirbase&#39;, &#39;drug&#39;:</span>
<span class="sd">        &#39;chembl&#39;, &#39;lncrna&#39;: &#39;lncrna-genesymbol&#39;}`` by default. Contains</span>
<span class="sd">        the default identifier types to which the downloaded data will</span>
<span class="sd">        be converted. If others are used, user may need to provide the</span>
<span class="sd">        format definitions for the conversion tables.</span>
<span class="sd">    :arg pypath.main.PyPath copy:</span>
<span class="sd">        Optional, ``None`` by default. Other</span>
<span class="sd">        :py:class:`pypath.main.PyPath` instance from which the data will</span>
<span class="sd">        be copied.</span>
<span class="sd">    :arg str name:</span>
<span class="sd">        Optional, ``&#39;unnamed&#39;`` by default. Session or project name</span>
<span class="sd">        (custom).</span>
<span class="sd">    :arg str outdir:</span>
<span class="sd">        Optional, ``&#39;results&#39;`` by default. Output directory where to</span>
<span class="sd">        store all output files.</span>
<span class="sd">    :arg int loglevel:</span>
<span class="sd">        Optional, 0 by default. Sets the level of the logger.</span>
<span class="sd">        The higher the level the more messages will be written to the log.</span>
<span class="sd">    :arg bool loops:</span>
<span class="sd">        Optional, ``False`` by default. Determines if self-loop edges</span>
<span class="sd">        are allowed in the graph.</span>

<span class="sd">    :var list adjlist:</span>
<span class="sd">        List of [set] containing the adjacency of each node. See</span>
<span class="sd">        :py:meth:`PyPath.update_adjlist` method for more information.</span>
<span class="sd">    :var pypath.chembl.Chembl chembl:</span>
<span class="sd">        Contains the ChEMBL data. See :py:mod:`pypath.chembl` module</span>
<span class="sd">        documentation for more information.</span>
<span class="sd">    :var tuple chembl_mysql:</span>
<span class="sd">        DEPRECATED Contains the MySQL parameters used by the</span>
<span class="sd">        :py:mod:`pypath.mapping` module to load the ChEMBL ID conversion</span>
<span class="sd">        tables.</span>
<span class="sd">    :var dict data:</span>
<span class="sd">        Stores the loaded interaction and attribute table. See</span>
<span class="sd">        :py:meth:`PyPath.read_data_file` method for more information.</span>
<span class="sd">    :var dict db_dict:</span>
<span class="sd">        Dictionary of dictionaries. Outer-level keys are ``&#39;nodes&#39;`` and</span>
<span class="sd">        ``&#39;edges&#39;``, corresponding values are [dict] whose keys are the</span>
<span class="sd">        database sources with values of type [set] containing the</span>
<span class="sd">        edge/node indexes for which that database provided some</span>
<span class="sd">        information.</span>
<span class="sd">    :var igraph.Graph dgraph:</span>
<span class="sd">        Directed network graph object.</span>
<span class="sd">    :var str disclaimer:</span>
<span class="sd">        Disclaimer text.</span>
<span class="sd">    :var dict dlabDct:</span>
<span class="sd">        Maps the directed graph node labels [str] (keys) to their</span>
<span class="sd">        indices [int] (values).</span>
<span class="sd">    :var dict dnodDct:</span>
<span class="sd">        Maps the directed graph node names [str] (keys) to their indices</span>
<span class="sd">        [int] (values).</span>
<span class="sd">    :var set dnodInd:</span>
<span class="sd">        Stores the directed graph node names [str].</span>
<span class="sd">    :var dict dnodLab:</span>
<span class="sd">        Maps the directed graph node indices [int] (keys) to their</span>
<span class="sd">        labels [str] (values).</span>
<span class="sd">    :var dict dnodNam:</span>
<span class="sd">        Maps the directed graph node indices [int] (keys) to their names</span>
<span class="sd">        [str] (values).</span>
<span class="sd">    :var dict edgeAttrs:</span>
<span class="sd">        Stores the edge attribute names [str] as keys and their</span>
<span class="sd">        corresponding types (e.g.: ``set``, ``list``, ``str``, ...) as</span>
<span class="sd">        values.</span>
<span class="sd">    :var pandas.DataFrame exp:</span>
<span class="sd">        Stores the expression data for the nodes (if loaded).</span>
<span class="sd">    :var pandas.DataFrame exp_prod:</span>
<span class="sd">        Stores the edge expression data (as the product of the</span>
<span class="sd">        normalized expression between the pair of nodes by default). For</span>
<span class="sd">        more details see :py:meth:`pypath.main.PyPath.edges_expression`.</span>
<span class="sd">    :var set exp_samples:</span>
<span class="sd">        Contains a list of tissues as downloaded by ProteomicsDB. See</span>
<span class="sd">        :py:meth:`PyPath.get_proteomicsdb` for more information.</span>
<span class="sd">    :var list failed_edges:</span>
<span class="sd">        List of lists containing information about the failed edges.</span>
<span class="sd">        Each failed edge sublist contains (in this order): [tuple] with</span>
<span class="sd">        the node IDs, [str] names of nodes A and B, [int] IDs of nodes</span>
<span class="sd">        A and B and [int] IDs of the edges in both directions.</span>
<span class="sd">    :var dict go:</span>
<span class="sd">        Contains the organism(s) NCBI taxonomy ID as key [int] and</span>
<span class="sd">        :py:class:`pypath.go.GOAnnotation` object as value, which</span>
<span class="sd">        contains the GO annotations for the nodes in the graph. See</span>
<span class="sd">        :py:class:`pypath.go.GOAnnotation` for more information.</span>
<span class="sd">    :var igraph.Graph graph:</span>
<span class="sd">        Undirected network graph object.</span>
<span class="sd">    :var pypath.gsea.GSEA gsea:</span>
<span class="sd">        Contains the loaded gene-sets from MSigDB. See</span>
<span class="sd">        :py:class:`pypath.gsea.GSEA` for more information.</span>
<span class="sd">    :var set has_cats:</span>
<span class="sd">        Contains the categories (e.g.: resource types) [str] loaded in</span>
<span class="sd">        the current network. Possible categories are: ``&#39;m&#39;`` for</span>
<span class="sd">        PTM/enzyme-substrate resources, ``&#39;p&#39;`` for pathway/activity</span>
<span class="sd">        flow resources, ``&#39;i&#39;`` for undirected/PPI resources, ``&#39;r&#39;``</span>
<span class="sd">        for process description/reaction resources and ``&#39;t&#39;`` for</span>
<span class="sd">        transcription resources.</span>
<span class="sd">    :var dict htp:</span>
<span class="sd">        Contains information about high-throughput data of the network</span>
<span class="sd">        for different thresholds [int] (keys). Values are [dict]</span>
<span class="sd">        containing the number of references (``&#39;rnum&#39;``) [int], number</span>
<span class="sd">        of edges (``&#39;enum&#39;``) [int], number of sources (``&#39;snum&#39;``)</span>
<span class="sd">        [int] and list of PMIDs of the most common references above the</span>
<span class="sd">        given threshold (``&#39;htrefs&#39;``) [set].</span>
<span class="sd">    :var dict labDct:</span>
<span class="sd">        Maps the undirected graph node labels [str] (keys) to their</span>
<span class="sd">        indices [int] (values).</span>
<span class="sd">    :var dict lists:</span>
<span class="sd">        Contains specific lists of nodes (values) for different</span>
<span class="sd">        categories [str] (keys). These can to be loaded from a file or</span>
<span class="sd">        a resource. Some methods include</span>
<span class="sd">        :py:meth:`pypath.main.PyPath.receptor_list` (``&#39;rec&#39;``),</span>
<span class="sd">        :py:meth:`pypath.main.PyPath.druggability_list` (``&#39;dgb&#39;``),</span>
<span class="sd">        :py:meth:`pypath.main.PyPath.kinases_list` (``&#39;kin&#39;``),</span>
<span class="sd">        :py:meth:`pypath.main.PyPath.tfs_list` (``&#39;tf&#39;``),</span>
<span class="sd">        :py:meth:`pypath.main.PyPath.disease_genes_list` (``&#39;dis&#39;``),</span>
<span class="sd">        :py:meth:`pypath.main.PyPath.signaling_proteins_list`</span>
<span class="sd">        (``&#39;sig&#39;``), :py:meth:`pypath.main.PyPath.proteome_list`</span>
<span class="sd">        (``&#39;proteome&#39;``) and</span>
<span class="sd">        :py:meth:`pypath.main.PyPath.cancer_drivers_list` (``&#39;cdv&#39;``).</span>
<span class="sd">    :var str loglevel:</span>
<span class="sd">        The level of the logger.</span>
<span class="sd">    :var bool loops:</span>
<span class="sd">        Whether if self-loop edges are allowed in the graph.</span>
<span class="sd">    :var pypath.mapping.Mapper mapper:</span>
<span class="sd">        :py:class:`pypath.mapper.Mapper` object for ID conversion and</span>
<span class="sd">        other ID-related operations across resources.</span>
<span class="sd">    :var list mutation_samples:</span>
<span class="sd">        DEPRECATED</span>
<span class="sd">    :var tuple mysql_conf:</span>
<span class="sd">        DEPRECATED Contains the MySQL parameters used by the</span>
<span class="sd">        :py:mod:`pypath.mapping` module to load the ID conversion</span>
<span class="sd">        tables.</span>
<span class="sd">    :var str name:</span>
<span class="sd">        Session or project name (custom).</span>
<span class="sd">    :var int ncbi_tax_id:</span>
<span class="sd">        NCBI Taxonomic identifier of the organism from which the data</span>
<span class="sd">        will be downloaded.</span>
<span class="sd">    :var dict negatives:</span>
<span class="sd">        Contains a list of negative interactions according to a given</span>
<span class="sd">        source (e.g.: Negatome database). See</span>
<span class="sd">        :py:meth:`pypath.main.PyPath.apply_negative` for more</span>
<span class="sd">        information.</span>
<span class="sd">    :var dict nodDct:</span>
<span class="sd">        Maps the undirected graph node names [str] (keys) to their</span>
<span class="sd">        indices [int] (values).</span>
<span class="sd">    :var set nodInd:</span>
<span class="sd">        Stores the undirected graph node names [str].</span>
<span class="sd">    :var dict nodLab:</span>
<span class="sd">        Maps the undirected graph node indices [int] (keys) to their</span>
<span class="sd">        labels [str] (values).</span>
<span class="sd">    :var dict nodNam:</span>
<span class="sd">        Maps the directed graph node indices [int] (keys) to their names</span>
<span class="sd">        [str] (values).</span>
<span class="sd">    :var str outdir:</span>
<span class="sd">        Output directory where to store all output files.</span>
<span class="sd">    :var list palette:</span>
<span class="sd">        Contains a list of hexadecimal [str] of colors. Used for</span>
<span class="sd">        plotting purposes.</span>
<span class="sd">    :var list pathway_types:</span>
<span class="sd">        Contains the names of all the loaded pathway resources [str].</span>
<span class="sd">    :var dict pathways:</span>
<span class="sd">        Contains the list of pathways (values) for each resource (keys)</span>
<span class="sd">        loaded in the network.</span>
<span class="sd">    :var dict plots:</span>
<span class="sd">        DEPRECATED (?)</span>
<span class="sd">    :var pypath.proteomicsdb.ProteomicsDB proteomicsdb:</span>
<span class="sd">        Contains a :py:class:`pypath.proteomicsdb.ProteomicsDB`</span>
<span class="sd">        instance, see the class documentation for more information.</span>
<span class="sd">    :var list raw_data:</span>
<span class="sd">        Contains a list of loaded edges [dict] from a data file. See</span>
<span class="sd">        :py:meth:`PyPath.read_data_file` for more information.</span>
<span class="sd">    :var dict seq:</span>
<span class="sd">        (?)</span>
<span class="sd">    :var str session:</span>
<span class="sd">        Session ID, a five random alphanumeric characters.</span>
<span class="sd">    :var str session_name:</span>
<span class="sd">        Session name and ID (e.g. ``&#39;unnamed-abc12&#39;``).</span>
<span class="sd">    :var igraph.Graph sourceNetEdges:</span>
<span class="sd">        (?)</span>
<span class="sd">    :var igraph.Graph sourceNetNodes:</span>
<span class="sd">        (?)</span>
<span class="sd">    :var list sources:</span>
<span class="sd">        List contianing the names of the loaded resources [str].</span>
<span class="sd">    :var dict u_pfam:</span>
<span class="sd">        Dictionary of dictionaries, contains the mapping of UniProt IDs</span>
<span class="sd">        to their respective protein families and other information.</span>
<span class="sd">    :var list uniprot_mapped:</span>
<span class="sd">        DEPRECATED (?)</span>
<span class="sd">    :var list unmapped:</span>
<span class="sd">        Contains the names of unmapped items [str]. See</span>
<span class="sd">        :py:meth:`pypath.main.PyPath.map_item` for more information.</span>
<span class="sd">    :var dict vertexAttrs:</span>
<span class="sd">        Stores the node attribute names [str] as keys and their</span>
<span class="sd">        corresponding types (e.g.: ``set``, ``list``, ``str``, ...) as</span>
<span class="sd">        values.</span>
<span class="sd">    &quot;&quot;&quot;</span>


<div class="viewcode-block" id="PyPath.__init__"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">ncbi_tax_id</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">copy</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;unnamed&#39;</span><span class="p">,</span>
            <span class="n">cache_dir</span>  <span class="o">=</span>  <span class="kc">None</span><span class="p">,</span>
            <span class="n">outdir</span> <span class="o">=</span> <span class="s1">&#39;results&#39;</span><span class="p">,</span>
            <span class="n">loglevel</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">loops</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the network object.</span>

<span class="sd">        **NOTE:** Only the instance is created, no data is donwloaded</span>
<span class="sd">        until the corresponding function is called (e.g.:</span>
<span class="sd">        :py:meth:`PyPath.init_network`).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">session_mod</span><span class="o">.</span><span class="n">Logger</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;network&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__version__</span> <span class="o">=</span> <span class="n">pypath</span><span class="o">.</span><span class="n">__version__</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="o">=</span> <span class="n">cache_mod</span><span class="o">.</span><span class="n">get_cachedir</span><span class="p">(</span><span class="n">cachedir</span> <span class="o">=</span> <span class="n">cache_dir</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">copy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="c1"># Setting up graph object</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">igraph</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

            <span class="n">g</span><span class="p">[</span><span class="s1">&#39;entity_types&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">g</span><span class="p">[</span><span class="s1">&#39;ncbi_tax_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ncbi_tax_id</span>
            <span class="n">g</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>
            <span class="n">g</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">g</span><span class="p">[</span><span class="s1">&#39;references&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">g</span><span class="p">[</span><span class="s1">&#39;directed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;id_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;original_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())]</span>
            <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;ncbi_tax_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{}]</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">([])</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">())]</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;attrs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">())]</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;references&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">())]</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;refs_by_source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">())]</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;refs_by_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">())]</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;refs_by_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">())]</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;sources_by_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">())]</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;negative_refs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">())]</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;negative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">())]</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
            <span class="n">g</span><span class="p">[</span><span class="s1">&#39;layout_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">g</span><span class="p">[</span><span class="s1">&#39;layout_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">g</span><span class="p">[</span><span class="s1">&#39;only_directed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">loops</span> <span class="o">=</span> <span class="n">loops</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dgraph</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_undirected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_directed</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">failed_edges</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unmapped</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outdir</span> <span class="o">=</span> <span class="n">outdir</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span> <span class="o">=</span> <span class="n">ncbi_tax_id</span> <span class="ow">or</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;default_organism&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default_name_type</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;default_name_types&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">negatives</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lists</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exp_samples</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sources</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">has_cats</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">db_dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pathway_types</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pathways</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertexAttrs</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edgeAttrs</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">u_pfam</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">seq</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">palette</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#6EA945&#39;</span><span class="p">,</span> <span class="s1">&#39;#007B7F&#39;</span><span class="p">,</span> <span class="s1">&#39;#FCCC06&#39;</span><span class="p">,</span> <span class="s1">&#39;#DA0025&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;#000000&#39;</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;PyPath has been initialized&#39;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">copy</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.set_chembl_mysql"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.set_chembl_mysql">[docs]</a>    <span class="k">def</span> <span class="nf">set_chembl_mysql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">config_file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the ChEMBL MySQL configuration according to the *title*</span>
<span class="sd">        section in *config_file* ini file configuration.</span>

<span class="sd">        :arg str title:</span>
<span class="sd">            Section title of the ini file.</span>
<span class="sd">        :arg str config_file:</span>
<span class="sd">            Optional, ``None`` by default. Specifies the configuration</span>
<span class="sd">            file name if none is passed, ``mysql_config/defaults.mysql``</span>
<span class="sd">            will be used.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">chembl_mysql</span> <span class="o">=</span> <span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.copy"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Copies another :py:class:`pypath.main.PyPath` instance into the</span>
<span class="sd">        current one.</span>

<span class="sd">        :arg pypath.main.PyPath other:</span>
<span class="sd">            The instance to be copied from.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span> <span class="o">=</span> <span class="n">copy_mod</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;PyPath object has been copied and reinitialized.&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">new</span> <span class="o">=</span> <span class="n">PyPath</span><span class="p">(</span><span class="n">copy</span> <span class="o">=</span> <span class="bp">self</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">new</span>

<div class="viewcode-block" id="PyPath.init_network"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.init_network">[docs]</a>    <span class="k">def</span> <span class="nf">init_network</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">lst</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">exclude</span> <span class="o">=</span> <span class="p">[],</span>
            <span class="n">cache_files</span> <span class="o">=</span> <span class="p">{},</span>
            <span class="n">pickle_file</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">pfile</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">save</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">reread</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">redownload</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">keep_raw</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">):</span> <span class="c1"># XXX: kwargs is not used anywhere</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads the network data.</span>

<span class="sd">        This is a lazy way to start the module, load data and build the</span>
<span class="sd">        high confidence, literature curated part of the signaling</span>
<span class="sd">        network.</span>

<span class="sd">        :arg dict lst:</span>
<span class="sd">            Optional, ``None`` by default. Specifies the data input</span>
<span class="sd">            formats for the different resources (keys) [str]. Values</span>
<span class="sd">            are :py:class:`pypath.input_formats.NetworkInput` instances</span>
<span class="sd">            containing the information. By default uses the set of</span>
<span class="sd">            resources of OmniPath.</span>
<span class="sd">        :arg list exclude:</span>
<span class="sd">            Optional, ``[]`` by default. List of resources [str] to</span>
<span class="sd">            exclude from the network.</span>
<span class="sd">        :arg dict cache_files:</span>
<span class="sd">            Optional, ``{}`` by default. Contains the resource name(s)</span>
<span class="sd">            [str] (keys) and the corresponding cached file name [str].</span>
<span class="sd">            If provided (and file exists) bypasses the download of the</span>
<span class="sd">            data for that resource and uses the cache file instead.</span>
<span class="sd">        :arg str pfile:</span>
<span class="sd">            Optional, ``False`` by default. If any, provides the file</span>
<span class="sd">            name or path to a previously saved network pickle file.</span>
<span class="sd">            If ``True`` is passed, takes the default path from</span>
<span class="sd">            :py:meth:`PyPath.save_network`</span>
<span class="sd">            (``&#39;cache/default_network.pickle&#39;``).</span>
<span class="sd">        :arg bool save:</span>
<span class="sd">            Optional, ``False`` by default. If set to ``True``, saves</span>
<span class="sd">            the loaded network to its default location</span>
<span class="sd">            (``&#39;cache/default_network.pickle&#39;``).</span>
<span class="sd">        :arg bool reread:</span>
<span class="sd">            Optional, ``False`` by default. Specifies whether to reread</span>
<span class="sd">            the data files from the cache or omit them (similar to</span>
<span class="sd">            *redownload*).</span>
<span class="sd">        :arg bool redownload:</span>
<span class="sd">            Optional, ``False`` by default. Specifies whether to</span>
<span class="sd">            re-download the data and ignore the cache.</span>
<span class="sd">        :arg \*\*kwargs:</span>
<span class="sd">            Not used.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">lst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lst</span> <span class="o">=</span> <span class="n">omnipath</span>

        <span class="n">pfile</span> <span class="o">=</span> <span class="n">pickle_file</span> <span class="ow">or</span> <span class="n">pfile</span>

        <span class="k">if</span> <span class="n">pfile</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">pfile</span><span class="p">):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                <span class="s1">&#39;Loading igraph object from pickle `</span><span class="si">%s</span><span class="s1">`...&#39;</span> <span class="o">%</span> <span class="n">pfile</span>
            <span class="p">)</span>
            <span class="n">graph</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">pfile</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">))</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">igraph</span><span class="o">.</span><span class="n">Graph</span><span class="p">)</span> <span class="ow">and</span> <span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                    <span class="s1">&#39;Network loaded from `</span><span class="si">%s</span><span class="s1">`. </span><span class="si">%u</span><span class="s1"> nodes, </span><span class="si">%u</span><span class="s1"> edges.&#39;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">pfile</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">(),</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">(),</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_vindex</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_sources</span><span class="p">()</span>

                <span class="k">return</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">load_resources</span><span class="p">(</span>
            <span class="n">lst</span> <span class="o">=</span> <span class="n">lst</span><span class="p">,</span>
            <span class="n">exclude</span> <span class="o">=</span> <span class="n">exclude</span><span class="p">,</span>
            <span class="n">reread</span> <span class="o">=</span> <span class="n">reread</span><span class="p">,</span>
            <span class="n">redownload</span> <span class="o">=</span> <span class="n">redownload</span><span class="p">,</span>
            <span class="n">cache_files</span> <span class="o">=</span> <span class="n">cache_files</span><span class="p">,</span>
            <span class="n">keep_raw</span> <span class="o">=</span> <span class="n">keep_raw</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Saving igraph object to file `</span><span class="si">%s</span><span class="s1">`...&#39;</span> <span class="o">%</span> <span class="n">pfile</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_network</span><span class="p">(</span><span class="n">pfile</span> <span class="o">=</span> <span class="n">pfile</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Network saved successfully to file `</span><span class="si">%s</span><span class="s1">`.&#39;</span> <span class="o">%</span> <span class="n">pfile</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.load_from_pickle"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_from_pickle">[docs]</a>    <span class="k">def</span> <span class="nf">load_from_pickle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pickle_file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shortcut for loading a network from a pickle dump.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_network</span><span class="p">(</span><span class="n">pfile</span> <span class="o">=</span> <span class="n">pickle_file</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.save_to_pickle"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.save_to_pickle">[docs]</a>    <span class="k">def</span> <span class="nf">save_to_pickle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pickle_file</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">pfile</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves the network object.</span>

<span class="sd">        Stores the instance into a pickle (binary) file which can be</span>
<span class="sd">        reloaded in the future.</span>

<span class="sd">        :arg str pickle_file:</span>
<span class="sd">            Optional, ``None`` by default. The path/file name where to</span>
<span class="sd">            store the pcikle file. If not specified, saves the network</span>
<span class="sd">            to its default location</span>
<span class="sd">            (``&#39;cache/default_network.pickle&#39;``).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Saving to pickle `</span><span class="si">%s</span><span class="s1">`.&#39;</span> <span class="o">%</span> <span class="n">pickle_file</span><span class="p">)</span>

        <span class="n">pfile</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">pickle_file</span> <span class="ow">or</span>
            <span class="n">pfile</span> <span class="ow">or</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">,</span> <span class="s1">&#39;default_network.pickle&#39;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">pfile</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Saved to pickle `</span><span class="si">%s</span><span class="s1">`.&#39;</span> <span class="o">%</span> <span class="n">pickle_file</span><span class="p">)</span></div>


    <span class="c1"># synonym for old name</span>
    <span class="n">save_network</span> <span class="o">=</span> <span class="n">save_to_pickle</span>

    <span class="c1">###</span>
    <span class="c1"># functions to read networks from text files or mysql</span>
    <span class="c1">###</span>

<div class="viewcode-block" id="PyPath.get_max"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.get_max">[docs]</a>    <span class="k">def</span> <span class="nf">get_max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrList</span><span class="p">):</span> <span class="c1"># TODO</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">maxC</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">attrList</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>

            <span class="k">if</span> <span class="n">val</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="n">maxC</span><span class="p">:</span>
                <span class="n">maxC</span> <span class="o">=</span> <span class="n">val</span>

        <span class="k">return</span> <span class="n">maxC</span></div>

<div class="viewcode-block" id="PyPath.get_attrs"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.get_attrs">[docs]</a>    <span class="k">def</span> <span class="nf">get_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="n">lnum</span><span class="p">):</span> <span class="c1"># TODO</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">attrs</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">spec</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="c1"># extra_edge_attrs and extraNodeAttrs are dicts</span>
            <span class="c1"># of additional parameters assigned to edges and nodes respectively;</span>
            <span class="c1"># key is the name of the parameter, value is the col number,</span>
            <span class="c1"># or a tuple of col number and the separator,</span>
            <span class="c1"># if the column contains additional subfields e.g. (5, &quot;;&quot;)</span>

            <span class="k">try</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">spec</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>

                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;__call__&#39;</span><span class="p">):</span>
                        <span class="n">fieldVal</span> <span class="o">=</span> <span class="n">spec</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">1</span><span class="p">](</span><span class="n">line</span><span class="p">[</span><span class="n">spec</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fieldVal</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">spec</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fieldVal</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">spec</span><span class="p">[</span><span class="n">col</span><span class="p">]]</span>

            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                    <span class="s1">&#39;Wrong column index (</span><span class="si">%s</span><span class="s1">) in extra attributes? &#39;</span>
                    <span class="s1">&#39;Line #</span><span class="si">%u</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="n">lnum</span><span class="p">),</span>
                    <span class="o">-</span><span class="mi">5</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">readError</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">break</span>

            <span class="n">fieldName</span> <span class="o">=</span> <span class="n">col</span>
            <span class="n">attrs</span><span class="p">[</span><span class="n">fieldName</span><span class="p">]</span> <span class="o">=</span> <span class="n">fieldVal</span>

        <span class="k">return</span> <span class="n">attrs</span></div>

<div class="viewcode-block" id="PyPath.get_taxon"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.get_taxon">[docs]</a>    <span class="k">def</span> <span class="nf">get_taxon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tax_dict</span><span class="p">,</span> <span class="n">fields</span><span class="p">):</span> <span class="c1"># TODO</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="s1">&#39;A&#39;</span> <span class="ow">in</span> <span class="n">tax_dict</span> <span class="ow">and</span> <span class="s1">&#39;B&#39;</span> <span class="ow">in</span> <span class="n">tax_dict</span><span class="p">:</span>

            <span class="k">return</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_taxon</span><span class="p">(</span><span class="n">tax_dict</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="n">fields</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_taxon</span><span class="p">(</span><span class="n">tax_dict</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">fields</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">if</span> <span class="s1">&#39;dict&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tax_dict</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="n">tax_dict</span><span class="p">[</span><span class="s1">&#39;col&#39;</span><span class="p">]])</span>

            <span class="k">elif</span> <span class="n">fields</span><span class="p">[</span><span class="n">tax_dict</span><span class="p">[</span><span class="s1">&#39;col&#39;</span><span class="p">]]</span> <span class="ow">in</span> <span class="n">tax_dict</span><span class="p">[</span><span class="s1">&#39;dict&#39;</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">tax_dict</span><span class="p">[</span><span class="s1">&#39;dict&#39;</span><span class="p">][</span><span class="n">fields</span><span class="p">[</span><span class="n">tax_dict</span><span class="p">[</span><span class="s1">&#39;col&#39;</span><span class="p">]]]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="PyPath.get_giant"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.get_giant">[docs]</a>    <span class="k">def</span> <span class="nf">get_giant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the giant component of the *graph*, or replaces the</span>
<span class="sd">        :py:class:`igraph.Graph` instance with only the giant component</span>
<span class="sd">        if specified.</span>

<span class="sd">        :arg bool replace:</span>
<span class="sd">            Optional, ``False`` by default. Specifies whether to replace</span>
<span class="sd">            the :py:class:`igraph.Graph` instance. This can be either</span>
<span class="sd">            the undirected network of the current</span>
<span class="sd">            :py:class:`pypath.main.PyPath` instance (default) or the one</span>
<span class="sd">            passed under the keyword argument *graph*.</span>
<span class="sd">        :arg igraph.Graph graph:</span>
<span class="sd">            Optional, ``None`` by default. The graph object from which</span>
<span class="sd">            the giant component is to be computed. If none is specified,</span>
<span class="sd">            takes the undirected network of the current</span>
<span class="sd">            :py:class:`pypath.main.PyPath` instance.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*igraph.Graph*) -- If ``replace=False``, returns a copy of</span>
<span class="sd">            the giant component graph.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">gg</span> <span class="o">=</span> <span class="n">g</span> <span class="k">if</span> <span class="n">replace</span> <span class="k">else</span> <span class="n">copy_mod</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="n">cl</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;WEAK&#39;</span><span class="p">)</span>
        <span class="n">cl_sizes</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">sizes</span><span class="p">()</span>
        <span class="n">giant_component_index</span> <span class="o">=</span> <span class="n">cl_sizes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">cl_sizes</span><span class="p">))</span>
        <span class="n">in_giant</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">==</span> <span class="n">giant_component_index</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cl</span><span class="o">.</span><span class="n">membership</span><span class="p">]</span>

        <span class="n">common</span><span class="o">.</span><span class="n">console</span><span class="p">(</span><span class="s1">&#39;:: Nodes in giant component: </span><span class="si">%u</span><span class="s1">&#39;</span> <span class="o">%</span>
                       <span class="n">in_giant</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>

        <span class="n">toDel</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">gg</span><span class="o">.</span><span class="n">vcount</span><span class="p">())</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">in_giant</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">gg</span><span class="o">.</span><span class="n">delete_vertices</span><span class="p">(</span><span class="n">toDel</span><span class="p">)</span>

        <span class="n">common</span><span class="o">.</span><span class="n">console</span><span class="p">(</span><span class="s1">&#39;:: Giant component size: </span><span class="si">%u</span><span class="s1"> edges, </span><span class="si">%u</span><span class="s1"> nodes&#39;</span> <span class="o">%</span>
                       <span class="p">(</span><span class="n">gg</span><span class="o">.</span><span class="n">ecount</span><span class="p">(),</span> <span class="n">gg</span><span class="o">.</span><span class="n">vcount</span><span class="p">()))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">replace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">gg</span></div>


<div class="viewcode-block" id="PyPath.update_vname"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.update_vname">[docs]</a>    <span class="k">def</span> <span class="nf">update_vname</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fast lookup of node names and indexes, these are hold in a</span>
<span class="sd">        [list] and a [dict] as well. However, every time new nodes are</span>
<span class="sd">        added, these should be updated. This function is automatically</span>
<span class="sd">        called after all operations affecting node indices.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Updating network component lookup dictionaries.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">genesymbol_labels</span><span class="p">()</span>
        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_undirected</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_already_has_directed</span><span class="p">()</span>
        <span class="n">dgraph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_directed</span>

        <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodInd</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">xrange</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">labDct</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">xrange</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodNam</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xrange</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()),</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodLab</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xrange</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()),</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]))</span>

        <span class="k">if</span> <span class="n">dgraph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dnodInd</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">dgraph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dnodDct</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="nb">zip</span><span class="p">(</span><span class="n">dgraph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">xrange</span><span class="p">(</span><span class="n">dgraph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlabDct</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="nb">zip</span><span class="p">(</span><span class="n">dgraph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">xrange</span><span class="p">(</span><span class="n">dgraph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="nb">zip</span><span class="p">(</span><span class="n">xrange</span><span class="p">(</span><span class="n">dgraph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()),</span> <span class="n">dgraph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dnodLab</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="nb">zip</span><span class="p">(</span><span class="n">xrange</span><span class="p">(</span><span class="n">dgraph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()),</span> <span class="n">dgraph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]))</span></div>


<div class="viewcode-block" id="PyPath.vsgs"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.vsgs">[docs]</a>    <span class="k">def</span> <span class="nf">vsgs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a generator sequence of the node names as GeneSymbols</span>
<span class="sd">        [str] (from the undirected graph).</span>

<span class="sd">        :return:</span>
<span class="sd">            (*generator*) -- Sequence containing the node names as</span>
<span class="sd">            GeneSymbols [str].</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodLab</span><span class="p">)</span><span class="o">.</span><span class="n">gs</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyPath.vsup"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.vsup">[docs]</a>    <span class="k">def</span> <span class="nf">vsup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a generator sequence of the node names as UniProt IDs</span>
<span class="sd">        [str] (from the undirected graph).</span>

<span class="sd">        :return:</span>
<span class="sd">            (*generator*) -- Sequence containing the node names as</span>
<span class="sd">            UniProt IDs [str].</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodLab</span><span class="p">)</span><span class="o">.</span><span class="n">up</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyPath.update_vindex"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.update_vindex">[docs]</a>    <span class="k">def</span> <span class="nf">update_vindex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># XXX: If so, shouldn&#39;t it be removed?</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is deprecated.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nodNam</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span></div>


<div class="viewcode-block" id="PyPath.vertex_pathways"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.vertex_pathways">[docs]</a>    <span class="k">def</span> <span class="nf">vertex_pathways</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Some resources assignes interactions some others proteins to</span>
<span class="sd">        pathways. This function copies pathway annotations from edge</span>
<span class="sd">        attributes to vertex attributes.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">eattr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>

            <span class="k">if</span> <span class="n">eattr</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;pathways&#39;</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">eattr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">eattr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">]</span>

                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="n">eattr</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">eattr</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="n">eattr</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">eattr</span><span class="p">]</span></div>


    <span class="k">def</span> <span class="nf">_filters</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">line</span><span class="p">,</span>
            <span class="n">positive_filters</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">negative_filters</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies negative and positive filters on a line (record from an</span>
<span class="sd">        interaction database). If returns ``True`` the interaction will be</span>
<span class="sd">        discarded, if ``False`` the interaction will be further processed</span>
<span class="sd">        and if all other criteria fit then will be added to the network</span>
<span class="sd">        after identifier translation.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">negative_filters</span> <span class="o">=</span> <span class="n">negative_filters</span> <span class="ow">or</span> <span class="p">()</span>

        <span class="k">for</span> <span class="n">filtr</span> <span class="ow">in</span> <span class="n">negative_filters</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">sep</span> <span class="o">=</span> <span class="n">filtr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">thisVal</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">filtr</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">))</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">thisVal</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="n">filtr</span><span class="p">[</span><span class="mi">0</span><span class="p">]]])</span>

            <span class="n">filtrVal</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">to_set</span><span class="p">(</span><span class="n">filtr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">thisVal</span> <span class="o">&amp;</span> <span class="n">filtrVal</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="n">positive_filters</span> <span class="o">=</span> <span class="n">positive_filters</span> <span class="ow">or</span> <span class="p">()</span>

        <span class="k">for</span> <span class="n">filtr</span> <span class="ow">in</span> <span class="n">positive_filters</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">sep</span> <span class="o">=</span> <span class="n">filtr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">thisVal</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">filtr</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">))</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">thisVal</span> <span class="o">=</span> <span class="p">{</span><span class="n">line</span><span class="p">[</span><span class="n">filtr</span><span class="p">[</span><span class="mi">0</span><span class="p">]]}</span>

            <span class="n">filtrVal</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">to_set</span><span class="p">(</span><span class="n">filtr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">thisVal</span> <span class="o">&amp;</span> <span class="n">filtrVal</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span>


<div class="viewcode-block" id="PyPath.lookup_cache"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.lookup_cache">[docs]</a>    <span class="k">def</span> <span class="nf">lookup_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">cache_files</span><span class="p">,</span> <span class="n">int_cache</span><span class="p">,</span> <span class="n">edges_cache</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks up the cache folder for the files of a given resource.</span>
<span class="sd">        First checks if *name* is on the *cache_files* dictionary.</span>
<span class="sd">        If so, loads either the interactions or edges otherwise. If</span>
<span class="sd">        not, checks *edges_cache* or *int_cache* otherwise.</span>

<span class="sd">        :arg str name:</span>
<span class="sd">            Name of the resource (lower-case).</span>
<span class="sd">        :arg dict cache_files:</span>
<span class="sd">            Contains the resource name(s) [str] (keys) and the</span>
<span class="sd">            corresponding cached file name [str] (values).</span>
<span class="sd">        :arg str int_cache:</span>
<span class="sd">            Path to the interactions cache file of the resource.</span>
<span class="sd">        :arg str edges_cache:</span>
<span class="sd">            Path to the edges cache file of the resource.</span>

<span class="sd">        :return:</span>
<span class="sd">            * (*file*) -- The loaded pickle file from the cache if the</span>
<span class="sd">              file is contains the interactions. ``None`` otherwise.</span>
<span class="sd">            * (*list*) -- List of mapped edges if the file contains the</span>
<span class="sd">              information from the edges. ``[]`` otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">infile</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">edge_list_mapped</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cache_file</span> <span class="o">=</span> <span class="n">cache_files</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">cache_files</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">cache_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">cache_file</span><span class="p">):</span>
            <span class="n">cache_type</span> <span class="o">=</span> <span class="n">cache_file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">cache_type</span> <span class="o">==</span> <span class="s1">&#39;interactions&#39;</span><span class="p">:</span>
                <span class="n">infile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_from_cache</span><span class="p">(</span><span class="n">int_cache</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">cache_type</span> <span class="o">==</span> <span class="s1">&#39;edges&#39;</span><span class="p">:</span>
                <span class="n">edge_list_mapped</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_from_cache</span><span class="p">(</span><span class="n">edges_cache</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">edges_cache</span><span class="p">):</span>
            <span class="n">edge_list_mapped</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_from_cache</span><span class="p">(</span><span class="n">edges_cache</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span> <span class="c1"># XXX: You could use another elif statement here</span>

            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">int_cache</span><span class="p">):</span>
                <span class="n">infile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_from_cache</span><span class="p">(</span><span class="n">int_cache</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">infile</span><span class="p">,</span> <span class="n">edge_list_mapped</span></div>

<div class="viewcode-block" id="PyPath.read_from_cache"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.read_from_cache">[docs]</a>    <span class="k">def</span> <span class="nf">read_from_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cache_file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads a pickle file from the cache and returns it. It is assumed</span>
<span class="sd">        that the subfolder ``cache/`` is on the supplied path.</span>

<span class="sd">        :arg str cache_file:</span>
<span class="sd">            Path to the cache file that is to be loaded.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*file*) -- The loaded pickle file from the cache. Type will</span>
<span class="sd">            depend on the file itself (e.g.: if the pickle was saved</span>
<span class="sd">            from a dictionary, the type will be [dict]).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;Reading edge list pickle dump from cache: </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">cache_file</span>
        <span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">cache_file</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Data have been read from cache: `</span><span class="si">%s</span><span class="s1">`&#39;</span> <span class="o">%</span> <span class="n">cache_file</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span></div>


    <span class="k">def</span> <span class="nf">_process_sign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signData</span><span class="p">,</span> <span class="n">signDef</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Processes the sign of an interaction, used when processing an</span>
<span class="sd">        input file.</span>

<span class="sd">        :arg str signData:</span>
<span class="sd">            Data regarding the sign to be processed.</span>
<span class="sd">        :arg tuple signDef:</span>
<span class="sd">            Contains information about how to process *signData*. This</span>
<span class="sd">            is defined in :py:mod:`pypath.data_formats`. First element</span>
<span class="sd">            determines the position on the direction information of each</span>
<span class="sd">            line on the data file [int], second element is either [str]</span>
<span class="sd">            or [list] and defines the terms for which an interaction is</span>
<span class="sd">            defined as stimulation, third element is similar but for the</span>
<span class="sd">            inhibition and third (optional) element determines the</span>
<span class="sd">            separator for *signData* if contains more than one element.</span>

<span class="sd">        :return:</span>
<span class="sd">            * (*bool*) -- Determines whether the processed interaction</span>
<span class="sd">              is considered stimulation or not.</span>
<span class="sd">            * (*bool*) -- Determines whether the processed interaction</span>
<span class="sd">              is considered inhibition or not.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">stim</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">inh</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">signSep</span> <span class="o">=</span> <span class="n">signDef</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">signDef</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">signData</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">signData</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">signSep</span><span class="p">))</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">to_set</span><span class="p">(</span><span class="n">signDef</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">neg</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">to_set</span><span class="p">(</span><span class="n">signDef</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="c1"># XXX: Isn&#39;t using elif here bias the choice to stimulatory interactions</span>
        <span class="c1">#      even though there can also be negative sources?</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">signData</span> <span class="o">&amp;</span> <span class="n">pos</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">stim</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">signData</span> <span class="o">&amp;</span> <span class="n">neg</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">inh</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="n">stim</span><span class="p">,</span> <span class="n">inh</span>


    <span class="k">def</span> <span class="nf">_process_direction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">dir_col</span><span class="p">,</span> <span class="n">dir_val</span><span class="p">,</span> <span class="n">dir_sep</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Processes the direction information of an interaction according</span>
<span class="sd">        to a data file from a source.</span>

<span class="sd">        :arg list line:</span>
<span class="sd">            The stripped and separated line from the resource data file</span>
<span class="sd">            containing the information of an interaction.</span>
<span class="sd">        :arg int dir_col:</span>
<span class="sd">            The column/position number where the information about the</span>
<span class="sd">            direction is to be found (on *line*).</span>
<span class="sd">        :arg list dir_val:</span>
<span class="sd">            Contains the terms [str] for which that interaction is to be</span>
<span class="sd">            considered directed.</span>
<span class="sd">        :arg str dir_sep:</span>
<span class="sd">            Separator for the field in *line* containing the direction</span>
<span class="sd">            information (if any).</span>

<span class="sd">        :return:</span>
<span class="sd">            (*bool*) -- Determines whether the given interaction is</span>
<span class="sd">            directed or not.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">dir_col</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">dir_val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">dir_col</span><span class="p">],</span> <span class="nb">bool</span><span class="p">):</span>

            <span class="k">return</span> <span class="n">line</span><span class="p">[</span><span class="n">dir_col</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">this_directed</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">dir_col</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">dir_sep</span><span class="p">))</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">this_directed</span> <span class="o">&amp;</span> <span class="n">dir_val</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>


    <span class="k">def</span> <span class="nf">_read_network_data</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">param</span><span class="p">,</span>
            <span class="n">keep_raw</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">cache_files</span> <span class="o">=</span> <span class="p">{},</span>
            <span class="n">reread</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">redownload</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads interaction data file containing node and edge attributes</span>
<span class="sd">        that can be read from simple text based files and adds it to the</span>
<span class="sd">        networkdata. This function works not only with files, but with</span>
<span class="sd">        lists as well. Any other function can be written to download and</span>
<span class="sd">        preprocess data, and then give it to this function to finally</span>
<span class="sd">        attach to the network.</span>

<span class="sd">        :arg pypath.input_formats.NetworkInput param:</span>
<span class="sd">            :py:class:`pypath.input_formats.NetworkInput` instance</span>
<span class="sd">            containing the detailed definition of the input format of</span>
<span class="sd">            the file. Instead of the file name (on the</span>
<span class="sd">            :py:attr:`pypath.input_formats.NetworkInput.input`</span>
<span class="sd">            attribute) you can give a custom function name, which will</span>
<span class="sd">            be executed, and the returned data will be used instead.</span>
<span class="sd">        :arg bool keep_raw:</span>
<span class="sd">            Optional, ``False`` by default. Whether to keep the raw data</span>
<span class="sd">            read by this function, in order for debugging purposes, or</span>
<span class="sd">            further use.</span>
<span class="sd">        :arg dict cache_files:</span>
<span class="sd">            Optional, ``{}`` by default. Contains the resource name(s)</span>
<span class="sd">            [str] (keys) and the corresponding cached file name [str].</span>
<span class="sd">            If provided (and file exists) bypasses the download of the</span>
<span class="sd">            data for that resource and uses the cache file instead.</span>
<span class="sd">        :arg bool reread:</span>
<span class="sd">            Optional, ``False`` by default. Specifies whether to reread</span>
<span class="sd">            the data files from the cache or omit them (similar to</span>
<span class="sd">            *redownload*).</span>
<span class="sd">        :arg bool redownload:</span>
<span class="sd">            Optional, ``False`` by default. Specifies whether to</span>
<span class="sd">            re-download the data and ignore the cache.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Reading network data from `</span><span class="si">%s</span><span class="s1">`.&#39;</span> <span class="o">%</span> <span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="c1"># workaround in order to make it work with both NetworkInput</span>
        <span class="c1"># and NetworkResource type param</span>
        <span class="n">_resource</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">param</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
                    <span class="n">param</span><span class="p">,</span>
                    <span class="n">network_resources</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">NetworkResource</span>
                <span class="p">)</span> <span class="k">else</span>
            <span class="n">network_resources</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">NetworkResource</span><span class="p">(</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">interaction_type</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">interaction_type</span><span class="p">,</span>
                <span class="n">networkinput</span> <span class="o">=</span> <span class="n">param</span><span class="p">,</span>
                <span class="n">data_model</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">data_model</span> <span class="ow">or</span> <span class="s1">&#39;unknown&#39;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">param</span> <span class="o">=</span> <span class="n">_resource</span><span class="o">.</span><span class="n">networkinput</span>

        <span class="n">_resources_secondary</span> <span class="o">=</span> <span class="p">()</span>

        <span class="n">expand_complexes</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">param</span><span class="o">.</span><span class="n">expand_complexes</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">expand_complexes</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="k">else</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;network_expand_complexes&#39;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">reread</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">reread</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reread</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="k">else</span>
            <span class="ow">not</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;network_pickle_cache&#39;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Expanding complexes for `</span><span class="si">%s</span><span class="s1">`: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">expand_complexes</span><span class="p">),</span>
        <span class="p">))</span>

        <span class="n">listLike</span> <span class="o">=</span> <span class="p">{</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">}</span>
        <span class="n">edge_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">nodeList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">edge_list_mapped</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">infile</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">_name</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="n">int_cache</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">,</span>
            <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.interactions.pickle&#39;</span> <span class="o">%</span> <span class="n">_name</span>
        <span class="p">)</span>
        <span class="n">edges_cache</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">,</span>
            <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.edges.pickle&#39;</span> <span class="o">%</span> <span class="n">_name</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">reread</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">redownload</span><span class="p">:</span>

            <span class="n">infile</span><span class="p">,</span> <span class="n">edge_list_mapped</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookup_cache</span><span class="p">(</span>
                <span class="n">_name</span><span class="p">,</span>
                <span class="n">cache_files</span><span class="p">,</span>
                <span class="n">int_cache</span><span class="p">,</span>
                <span class="n">edges_cache</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">edge_list_mapped</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">infile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span>
                    <span class="n">param</span><span class="p">,</span>
                    <span class="p">(</span>
                        <span class="n">data_formats</span><span class="o">.</span><span class="n">input_formats</span><span class="o">.</span><span class="n">NetworkInput</span><span class="p">,</span>
                        <span class="n">network_resources</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">NetworkResource</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">):</span>
                    
                    <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                        <span class="s1">&#39;_read_network_data: No proper input file &#39;</span>
                        <span class="s1">&#39;definition. `param` should be either &#39;</span>
                        <span class="s1">&#39;a `pypath.input_formats.NetworkInput` or a &#39;</span>
                        <span class="s1">&#39;`pypath.resource.NetworkResource` instance.&#39;</span><span class="p">,</span>
                        <span class="o">-</span><span class="mi">5</span><span class="p">,</span>
                    <span class="p">)</span>

                    <span class="k">return</span> <span class="kc">None</span>

                <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">huge</span><span class="p">:</span>

                    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                        <span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">Processing </span><span class="si">%s</span><span class="s1"> requires huge memory.</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Please hit `y` if you have at &#39;</span>
                        <span class="s1">&#39;least 2G free memory,</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">or `n` to omit </span><span class="si">%s</span><span class="s1">.</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">After processing once, it will be saved in </span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="s1">&#39;</span><span class="se">\t</span><span class="si">%s</span><span class="s1">, so next time can be loaded quickly.</span><span class="se">\n\n</span><span class="s1">&#39;</span>
                        <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Process </span><span class="si">%s</span><span class="s1"> now? [y/n]</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>
                        <span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">edges_cache</span><span class="p">,</span>
                         <span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

                    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="n">answer</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

                        <span class="k">if</span> <span class="n">answer</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span>
                            <span class="k">return</span> <span class="kc">None</span>

                        <span class="k">elif</span> <span class="n">answer</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
                            <span class="k">break</span>

                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                                <span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">Please answer `y` or `n`:</span><span class="se">\n\t</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

                <span class="n">input_func</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_method</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>

                <span class="c1"># reading from remote or local file, or executing import</span>
                <span class="c1"># function:</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">basestring</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                        <span class="n">param</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;http&#39;</span><span class="p">)</span> <span class="ow">or</span>
                        <span class="n">param</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;ftp&#39;</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="p">):</span>

                    <span class="n">curl_use_cache</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">redownload</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="n">curl</span><span class="o">.</span><span class="n">Curl</span><span class="p">(</span>
                        <span class="n">param</span><span class="o">.</span><span class="n">input</span><span class="p">,</span>
                        <span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">large</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">cache</span><span class="o">=</span><span class="n">curl_use_cache</span>
                    <span class="p">)</span>
                    <span class="n">infile</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">fileobj</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

                    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">bytes</span><span class="p">:</span>

                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">infile</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

                        <span class="k">except</span><span class="p">:</span>

                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">infile</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;iso-8859-1&#39;</span><span class="p">)</span>

                            <span class="k">except</span><span class="p">:</span>
                                <span class="k">pass</span>

                    <span class="n">infile</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">infile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
                    <span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                        <span class="s2">&quot;Retrieving data from</span><span class="si">%s</span><span class="s2"> ...&quot;</span> <span class="o">%</span> <span class="n">param</span><span class="o">.</span><span class="n">input</span>
                    <span class="p">)</span>

                <span class="k">elif</span> <span class="n">input_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s2">&quot;Retrieving data by `</span><span class="si">%s</span><span class="s2">` ...&quot;</span> <span class="o">%</span>
                                    <span class="n">input_func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

                    <span class="n">_store_cache</span> <span class="o">=</span> <span class="n">curl</span><span class="o">.</span><span class="n">CACHE</span>

                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">redownload</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>

                        <span class="n">curl</span><span class="o">.</span><span class="n">CACHE</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">redownload</span>

                    <span class="c1"># this try-except needs to be removed</span>
                    <span class="c1"># once correct exception handling will</span>
                    <span class="c1"># be implemented in every input function</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">infile</span> <span class="o">=</span> <span class="n">input_func</span><span class="p">(</span><span class="o">**</span><span class="n">param</span><span class="o">.</span><span class="n">input_args</span><span class="p">)</span>

                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                            <span class="s1">&#39;Error in `</span><span class="si">%s</span><span class="s1">`. &#39;</span>
                            <span class="s1">&#39;Skipping to next resource. &#39;</span>
                            <span class="s1">&#39;See below the traceback.&#39;</span> <span class="o">%</span> <span class="n">input_func</span><span class="o">.</span><span class="vm">__name__</span>
                        <span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_log_traceback</span><span class="p">()</span>

                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">traceback</span><span class="o">.</span><span class="n">print_tb</span><span class="p">(</span>
                                <span class="n">e</span><span class="o">.</span><span class="n">__traceback__</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>

                        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Failed handling exception.&#39;</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_log_traceback</span><span class="p">()</span>

                    <span class="n">curl</span><span class="o">.</span><span class="n">CACHE</span> <span class="o">=</span> <span class="n">_store_cache</span>

                <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">input</span><span class="p">):</span>

                    <span class="n">infile</span> <span class="o">=</span> <span class="n">curl</span><span class="o">.</span><span class="n">Curl</span><span class="p">(</span>
                        <span class="n">param</span><span class="o">.</span><span class="n">input</span><span class="p">,</span>
                        <span class="n">large</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                        <span class="n">silent</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">result</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> opened...&#39;</span> <span class="o">%</span> <span class="n">param</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">infile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                        <span class="s1">&#39;`</span><span class="si">%s</span><span class="s1">`: Could not find file or input function &#39;</span>
                        <span class="s1">&#39;or failed preprocessing.&#39;</span> <span class="o">%</span>
                        <span class="n">param</span><span class="o">.</span><span class="n">input</span><span class="p">,</span>
                        <span class="o">-</span><span class="mi">5</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">return</span> <span class="kc">None</span>

            <span class="c1"># at this point we can be sure we have something to iterate</span>
            <span class="c1"># rows (either lists or strings which can be split into lists)</span>

            <span class="c1"># finding the largest referred column number,</span>
            <span class="c1"># to avoid list indices out of range</span>
            <span class="c1"># TODO: this should not be necessary, if an input gives an</span>
            <span class="c1"># IndexError that should be fixed elsewhere</span>
            <span class="n">is_directed</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">is_directed</span>
            <span class="n">sign</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">sign</span>
            <span class="n">refCol</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">refs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">refs</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> \
                <span class="k">else</span> <span class="n">param</span><span class="o">.</span><span class="n">refs</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">refs</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">refSep</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">refs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">refs</span><span class="p">,</span>
                                                    <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;;&#39;</span>
            <span class="n">sigCol</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="n">sign</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">dir_col</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">dir_val</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">dir_sep</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">is_directed</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>

                <span class="n">dir_col</span> <span class="o">=</span> <span class="n">is_directed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">dir_val</span> <span class="o">=</span> <span class="n">is_directed</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">dir_sep</span> <span class="o">=</span> <span class="n">is_directed</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">is_directed</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="kc">None</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>

                <span class="n">dir_col</span> <span class="o">=</span> <span class="n">sign</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">dir_val</span> <span class="o">=</span> <span class="n">sign</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
                <span class="n">dir_val</span> <span class="o">=</span> <span class="n">dir_val</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">dir_val</span><span class="p">[</span>
                    <span class="mi">0</span><span class="p">])</span> <span class="ow">in</span> <span class="n">common</span><span class="o">.</span><span class="n">simple_types</span> <span class="k">else</span> <span class="n">common</span><span class="o">.</span><span class="n">flat_list</span><span class="p">(</span><span class="n">dir_val</span><span class="p">)</span>
                <span class="n">dir_sep</span> <span class="o">=</span> <span class="n">sign</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sign</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="k">else</span> <span class="kc">None</span>

            <span class="n">dir_val</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">to_set</span><span class="p">(</span><span class="n">dir_val</span><span class="p">)</span>
            <span class="n">max_col</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                <span class="nb">filter</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[</span>
                        <span class="n">param</span><span class="o">.</span><span class="n">id_col_a</span><span class="p">,</span>
                        <span class="n">param</span><span class="o">.</span><span class="n">id_col_b</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">get_max</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">extra_edge_attrs</span><span class="p">),</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">get_max</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">extra_node_attrs_a</span><span class="p">),</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">get_max</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">extra_node_attrs_b</span><span class="p">),</span>
                        <span class="n">refCol</span><span class="p">,</span>
                        <span class="n">dir_col</span><span class="p">,</span>
                        <span class="n">sigCol</span><span class="p">,</span>
                        <span class="nb">max</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span>
                            <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                <span class="n">param</span><span class="o">.</span><span class="n">positive_filters</span><span class="p">),</span>
                            <span class="p">[</span><span class="mi">0</span><span class="p">])),</span>
                        <span class="nb">max</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span>
                            <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                <span class="n">param</span><span class="o">.</span><span class="n">negative_filters</span><span class="p">),</span>
                            <span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                    <span class="p">]</span>
                <span class="p">)</span>
            <span class="p">)</span>

            <span class="n">must_have_references</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;keep_noref&#39;</span><span class="p">)</span> <span class="ow">or</span>
                <span class="n">param</span><span class="o">.</span><span class="n">must_have_references</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                <span class="s1">&#39;Resource `</span><span class="si">%s</span><span class="s1">` </span><span class="si">%s</span><span class="s1"> have literature references &#39;</span>
                <span class="s1">&#39;for all interactions. Interactions without references &#39;</span>
                <span class="s1">&#39;will be dropped. You can alter this condition globally by &#39;</span>
                <span class="s1">&#39;`pypath.settings.keep_noref` or for individual resources &#39;</span>
                <span class="s1">&#39;by the `must_have_references` attribute of their &#39;</span>
                <span class="s1">&#39;`NetworkInput` object.&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="s1">&#39;must&#39;</span> <span class="k">if</span> <span class="n">must_have_references</span> <span class="k">else</span> <span class="s1">&#39;does not need to&#39;</span>
                <span class="p">),</span>
                <span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                <span class="s1">&#39;`</span><span class="si">%s</span><span class="s1">` must have references: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">must_have_references</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>

            <span class="c1"># iterating lines from input file</span>
            <span class="n">lFiltered</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">rFiltered</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">tFiltered</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">readError</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">lnum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># we need to define it here to avoid errors if the</span>
                     <span class="c1"># loop below runs zero cycles</span>

            <span class="k">for</span> <span class="n">lnum</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">infile</span><span class="p">):</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="p">(</span><span class="n">lnum</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">param</span><span class="o">.</span><span class="n">header</span><span class="p">):</span>
                    <span class="c1"># empty lines</span>
                    <span class="c1"># or header row</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>

                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;decode&#39;</span><span class="p">):</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\r</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">separator</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;replace&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span>
                    <span class="p">]</span>

                <span class="c1"># in case line has less fields than needed</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">max_col</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                        <span class="s1">&#39;Line #</span><span class="si">%u</span><span class="s1"> has less than </span><span class="si">%u</span><span class="s1"> fields,&#39;</span>
                        <span class="s1">&#39; skipping! :(</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">lnum</span><span class="p">,</span> <span class="n">max_col</span><span class="p">),</span>
                        <span class="mi">5</span><span class="p">,</span>
                    <span class="p">)</span>

                    <span class="n">readError</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">continue</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># from here we are committed to process this row</span>

                    <span class="c1"># applying filters:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filters</span><span class="p">(</span>
                        <span class="n">line</span><span class="p">,</span>
                        <span class="n">param</span><span class="o">.</span><span class="n">positive_filters</span><span class="p">,</span>
                        <span class="n">param</span><span class="o">.</span><span class="n">negative_filters</span>
                    <span class="p">):</span>

                        <span class="n">lFiltered</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">continue</span>

                    <span class="c1"># reading names and attributes:</span>
                    <span class="k">if</span> <span class="n">is_directed</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">is_directed</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                        <span class="n">this_edge_dir</span> <span class="o">=</span> <span class="kc">True</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">this_edge_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_direction</span><span class="p">(</span>
                            <span class="n">line</span><span class="p">,</span>
                            <span class="n">dir_col</span><span class="p">,</span>
                            <span class="n">dir_val</span><span class="p">,</span>
                            <span class="n">dir_sep</span><span class="p">,</span>
                        <span class="p">)</span>

                    <span class="n">refs</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">if</span> <span class="n">refCol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">refCol</span><span class="p">],</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">set</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>

                            <span class="n">refs</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">refCol</span><span class="p">]</span>

                        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">refCol</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>

                            <span class="n">refs</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">refCol</span><span class="p">],)</span>

                        <span class="k">else</span><span class="p">:</span>

                            <span class="n">refs</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">refCol</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">refSep</span><span class="p">)</span>

                        <span class="n">refs</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">del_empty</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">refs</span><span class="p">)))</span>

                    <span class="n">refs</span> <span class="o">=</span> <span class="n">pubmed_input</span><span class="o">.</span><span class="n">only_pmids</span><span class="p">(</span>
                        <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">refs</span><span class="p">]</span>
                    <span class="p">)</span>

                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">refs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">must_have_references</span><span class="p">:</span>
                        <span class="n">rFiltered</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">continue</span>

                    <span class="c1"># to give an easy way for input definition:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">ncbi_tax_id</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                        <span class="n">taxon_a</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">ncbi_tax_id</span>
                        <span class="n">taxon_b</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">ncbi_tax_id</span>

                    <span class="c1"># to enable more sophisticated inputs:</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">ncbi_tax_id</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>

                        <span class="n">taxx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_taxon</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">ncbi_tax_id</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>

                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">taxx</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                            <span class="n">taxon_a</span> <span class="o">=</span> <span class="n">taxx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="n">taxon_b</span> <span class="o">=</span> <span class="n">taxx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">taxon_a</span> <span class="o">=</span> <span class="n">taxon_b</span> <span class="o">=</span> <span class="n">taxx</span>

                        <span class="n">taxdA</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="n">param</span><span class="o">.</span><span class="n">ncbi_tax_id</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
                            <span class="k">if</span> <span class="s1">&#39;A&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="o">.</span><span class="n">ncbi_tax_id</span> <span class="k">else</span>
                            <span class="n">param</span><span class="o">.</span><span class="n">ncbi_tax_id</span>
                        <span class="p">)</span>
                        <span class="n">taxdB</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="n">param</span><span class="o">.</span><span class="n">ncbi_tax_id</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
                            <span class="k">if</span> <span class="s1">&#39;B&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="o">.</span><span class="n">ncbi_tax_id</span> <span class="k">else</span>
                            <span class="n">param</span><span class="o">.</span><span class="n">ncbi_tax_id</span>
                        <span class="p">)</span>

                        <span class="k">if</span> <span class="p">((</span><span class="s1">&#39;include&#39;</span> <span class="ow">in</span> <span class="n">taxdA</span> <span class="ow">and</span>
                            <span class="n">taxon_a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">taxdA</span><span class="p">[</span><span class="s1">&#39;include&#39;</span><span class="p">])</span> <span class="ow">or</span>
                            <span class="p">(</span><span class="s1">&#39;include&#39;</span> <span class="ow">in</span> <span class="n">taxdB</span> <span class="ow">and</span>
                            <span class="n">taxon_b</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">taxdB</span><span class="p">[</span><span class="s1">&#39;include&#39;</span><span class="p">])</span> <span class="ow">or</span>
                            <span class="p">(</span><span class="s1">&#39;exclude&#39;</span> <span class="ow">in</span> <span class="n">taxdA</span> <span class="ow">and</span>
                            <span class="n">taxon_a</span> <span class="ow">in</span> <span class="n">taxdA</span><span class="p">[</span><span class="s1">&#39;exclude&#39;</span><span class="p">])</span> <span class="ow">or</span>
                            <span class="p">(</span><span class="s1">&#39;exclude&#39;</span> <span class="ow">in</span> <span class="n">taxdB</span> <span class="ow">and</span>
                            <span class="n">taxon_b</span> <span class="ow">in</span> <span class="n">taxdB</span><span class="p">[</span><span class="s1">&#39;exclude&#39;</span><span class="p">])):</span>

                            <span class="n">tFiltered</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="k">continue</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">taxon_a</span> <span class="o">=</span> <span class="n">taxon_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span>

                    <span class="k">if</span> <span class="n">taxon_a</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">taxon_b</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">tFiltered</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">continue</span>

                    <span class="n">stim</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">inh</span> <span class="o">=</span> <span class="kc">False</span>

                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sign</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                        <span class="n">stim</span><span class="p">,</span> <span class="n">inh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_sign</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">sign</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">sign</span><span class="p">)</span>

                    <span class="n">resource</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">line</span><span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">resource</span><span class="p">]</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">resource</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span>
                        <span class="n">line</span><span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">resource</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">resource</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">resource</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span>
                        <span class="n">param</span><span class="o">.</span><span class="n">resource</span>
                    <span class="p">)</span>

                    <span class="n">resource</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">to_set</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>

                    <span class="n">_resources_secondary</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                        <span class="n">network_resources</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">NetworkResource</span><span class="p">(</span>
                            <span class="n">name</span> <span class="o">=</span> <span class="n">sec_res</span><span class="p">,</span>
                            <span class="n">interaction_type</span> <span class="o">=</span> <span class="n">_resource</span><span class="o">.</span><span class="n">interaction_type</span><span class="p">,</span>
                            <span class="n">data_model</span> <span class="o">=</span> <span class="n">_resource</span><span class="o">.</span><span class="n">data_model</span><span class="p">,</span>
                            <span class="n">via</span> <span class="o">=</span> <span class="n">_resource</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="k">for</span> <span class="n">sec_res</span> <span class="ow">in</span> <span class="n">resource</span>
                        <span class="k">if</span> <span class="n">sec_res</span> <span class="o">!=</span> <span class="n">_resource</span><span class="o">.</span><span class="n">name</span>
                    <span class="p">)</span>

                    <span class="n">resource</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

                    <span class="n">id_a</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">id_col_a</span><span class="p">]</span>
                    <span class="n">id_b</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">id_col_b</span><span class="p">]</span>
                    <span class="n">id_a</span> <span class="o">=</span> <span class="n">id_a</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">id_a</span><span class="p">,</span> <span class="s1">&#39;strip&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">id_a</span>
                    <span class="n">id_b</span> <span class="o">=</span> <span class="n">id_b</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">id_b</span><span class="p">,</span> <span class="s1">&#39;strip&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">id_b</span>

                    <span class="n">evidences</span> <span class="o">=</span> <span class="n">evidence</span><span class="o">.</span><span class="n">Evidences</span><span class="p">(</span>
                        <span class="n">evidences</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="n">evidence</span><span class="o">.</span><span class="n">Evidence</span><span class="p">(</span>
                                <span class="n">resource</span> <span class="o">=</span> <span class="n">_res</span><span class="p">,</span>
                                <span class="n">references</span> <span class="o">=</span> <span class="n">refs</span><span class="p">,</span>
                            <span class="p">)</span>
                            <span class="k">for</span> <span class="n">_res</span> <span class="ow">in</span>
                            <span class="n">_resources_secondary</span> <span class="o">+</span> <span class="p">(</span><span class="n">_resource</span><span class="p">,)</span>
                        <span class="p">)</span>
                    <span class="p">)</span>


                    <span class="n">new_edge</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s1">&#39;id_a&#39;</span><span class="p">:</span> <span class="n">id_a</span><span class="p">,</span>
                        <span class="s1">&#39;id_b&#39;</span><span class="p">:</span> <span class="n">id_b</span><span class="p">,</span>
                        <span class="s1">&#39;id_type_a&#39;</span><span class="p">:</span> <span class="n">param</span><span class="o">.</span><span class="n">id_type_a</span><span class="p">,</span>
                        <span class="s1">&#39;id_type_b&#39;</span><span class="p">:</span> <span class="n">param</span><span class="o">.</span><span class="n">id_type_b</span><span class="p">,</span>
                        <span class="s1">&#39;entity_type_a&#39;</span><span class="p">:</span> <span class="n">param</span><span class="o">.</span><span class="n">entity_type_a</span><span class="p">,</span>
                        <span class="s1">&#39;entity_type_b&#39;</span><span class="p">:</span> <span class="n">param</span><span class="o">.</span><span class="n">entity_type_b</span><span class="p">,</span>
                        <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="n">resource</span><span class="p">,</span>
                        <span class="s1">&#39;is_directed&#39;</span><span class="p">:</span> <span class="n">this_edge_dir</span><span class="p">,</span>
                        <span class="s1">&#39;references&#39;</span><span class="p">:</span> <span class="n">refs</span><span class="p">,</span>
                        <span class="s1">&#39;stim&#39;</span><span class="p">:</span> <span class="n">stim</span><span class="p">,</span>
                        <span class="s1">&#39;inh&#39;</span><span class="p">:</span> <span class="n">inh</span><span class="p">,</span>
                        <span class="s1">&#39;taxon_a&#39;</span><span class="p">:</span> <span class="n">taxon_a</span><span class="p">,</span>
                        <span class="s1">&#39;taxon_b&#39;</span><span class="p">:</span> <span class="n">taxon_b</span><span class="p">,</span>
                        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">param</span><span class="o">.</span><span class="n">interaction_type</span><span class="p">,</span>
                        <span class="s1">&#39;evidences&#39;</span><span class="p">:</span> <span class="n">evidences</span><span class="p">,</span>
                    <span class="p">}</span>

                    <span class="c1"># getting additional edge and node attributes</span>
                    <span class="n">attrs_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attrs</span><span class="p">(</span>
                        <span class="n">line</span><span class="p">,</span>
                        <span class="n">param</span><span class="o">.</span><span class="n">extra_edge_attrs</span><span class="p">,</span>
                        <span class="n">lnum</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">attrs_node_a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attrs</span><span class="p">(</span>
                        <span class="n">line</span><span class="p">,</span>
                        <span class="n">param</span><span class="o">.</span><span class="n">extra_node_attrs_a</span><span class="p">,</span>
                        <span class="n">lnum</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">attrs_node_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attrs</span><span class="p">(</span>
                        <span class="n">line</span><span class="p">,</span>
                        <span class="n">param</span><span class="o">.</span><span class="n">extra_node_attrs_b</span><span class="p">,</span>
                        <span class="n">lnum</span><span class="p">,</span>
                    <span class="p">)</span>

                    <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">mark_source</span><span class="p">:</span>

                        <span class="n">attrs_node_a</span><span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">mark_source</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_edge_dir</span>

                    <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">mark_target</span><span class="p">:</span>

                        <span class="n">attrs_node_b</span><span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">mark_target</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_edge_dir</span>

                    <span class="c1"># merging dictionaries</span>
                    <span class="n">node_attrs</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s1">&#39;attrs_node_a&#39;</span><span class="p">:</span> <span class="n">attrs_node_a</span><span class="p">,</span>
                        <span class="s1">&#39;attrs_node_b&#39;</span><span class="p">:</span> <span class="n">attrs_node_b</span><span class="p">,</span>
                        <span class="s1">&#39;attrs_edge&#39;</span><span class="p">:</span> <span class="n">attrs_edge</span><span class="p">,</span>
                    <span class="p">}</span>
                    <span class="n">new_edge</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">node_attrs</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">readError</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                        <span class="s1">&#39;Errors occured, certain lines skipped.&#39;</span>
                        <span class="s1">&#39;Trying to read the remaining.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
                        <span class="mi">5</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">readError</span> <span class="o">=</span> <span class="mi">1</span>

                <span class="n">edge_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_edge</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">):</span>

                <span class="n">infile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="c1"># ID translation of edges</span>
            <span class="n">edge_list_mapped</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_map_list</span><span class="p">(</span>
                <span class="n">edge_list</span><span class="p">,</span>
                <span class="n">expand_complexes</span> <span class="o">=</span> <span class="n">expand_complexes</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                <span class="s1">&#39;</span><span class="si">%u</span><span class="s1"> lines have been read from </span><span class="si">%s</span><span class="s1">, &#39;</span>
                <span class="s1">&#39;</span><span class="si">%u</span><span class="s1"> links after mapping; &#39;</span>
                <span class="s1">&#39;</span><span class="si">%u</span><span class="s1"> lines filtered by filters; &#39;</span>
                <span class="s1">&#39;</span><span class="si">%u</span><span class="s1"> lines filtered because lack of references; &#39;</span>
                <span class="s1">&#39;</span><span class="si">%u</span><span class="s1"> lines filtered by taxon filters.&#39;</span> <span class="o">%</span>
                <span class="p">(</span>
                    <span class="n">lnum</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="n">param</span><span class="o">.</span><span class="n">input</span><span class="p">,</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">edge_list_mapped</span><span class="p">),</span>
                    <span class="n">lFiltered</span><span class="p">,</span>
                    <span class="n">rFiltered</span><span class="p">,</span>
                    <span class="n">tFiltered</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">reread</span> <span class="ow">or</span> <span class="n">redownload</span><span class="p">:</span>
                <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">edge_list_mapped</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">edges_cache</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;ID translated edge list saved to </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">edges_cache</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                <span class="s1">&#39;Previously ID translated edge list &#39;</span>
                <span class="s1">&#39;has been loaded from `</span><span class="si">%s</span><span class="s1">`.&#39;</span> <span class="o">%</span> <span class="n">edges_cache</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">keep_raw</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_list_mapped</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span> <span class="o">=</span> <span class="n">edge_list_mapped</span>


<div class="viewcode-block" id="PyPath.signaling_proteins_list"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.signaling_proteins_list">[docs]</a>    <span class="k">def</span> <span class="nf">signaling_proteins_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compiles a list of signaling proteins (as opposed to other</span>
<span class="sd">        proteins like metabolic enzymes, matrix proteins, etc), by</span>
<span class="sd">        looking up a few simple keywords in short description of GO</span>
<span class="sd">        terms.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">terms</span>   <span class="o">=</span> <span class="n">go_input</span><span class="o">.</span><span class="n">go_terms_quickgo</span><span class="p">()</span>
        <span class="n">goannot</span> <span class="o">=</span> <span class="n">go_input</span><span class="o">.</span><span class="n">go_annotations_goa</span><span class="p">()</span>

        <span class="n">gosig</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>

        <span class="k">for</span> <span class="n">term</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">terms</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">]):</span>

            <span class="k">if</span> <span class="s1">&#39;signal&#39;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;regulat&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                <span class="n">gosig</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">term</span><span class="p">)</span>

        <span class="n">upsig</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>

        <span class="k">if</span> <span class="s1">&#39;proteome&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">proteome_list</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">up</span><span class="p">,</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">goannot</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">]):</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">term</span> <span class="o">&amp;</span> <span class="n">gosig</span><span class="p">):</span>
                <span class="n">upsig</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">up</span><span class="p">)</span>

        <span class="n">spsig</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>

        <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">upsig</span><span class="p">:</span>
            <span class="n">spsig</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span>
                <span class="n">u</span><span class="p">,</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span> <span class="n">ncbi_tax_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span><span class="p">)))</span>

        <span class="n">upsig</span> <span class="o">=</span> <span class="n">spsig</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="s1">&#39;proteome&#39;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="s1">&#39;sig&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">upsig</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.cancer_gene_census_list"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.cancer_gene_census_list">[docs]</a>    <span class="k">def</span> <span class="nf">cancer_gene_census_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads the list of cancer driver proteins from the COSMIC Cancer</span>
<span class="sd">        Gene Census.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">read_list_file</span><span class="p">(</span><span class="n">data_formats</span><span class="o">.</span><span class="n">cgc</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.intogen_cancer_drivers_list"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.intogen_cancer_drivers_list">[docs]</a>    <span class="k">def</span> <span class="nf">intogen_cancer_drivers_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">intogen_file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads the list of cancer driver proteins from IntOGen data.</span>

<span class="sd">        :arg str intogen_file:</span>
<span class="sd">            Path to the data file. Can also be [function] that provides</span>
<span class="sd">            the data. In general, anything accepted by</span>
<span class="sd">            :py:attr:`pypath.input_formats.NetworkInput.input`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data_formats</span><span class="o">.</span><span class="n">intogen_cancer</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="n">intogen_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_list_file</span><span class="p">(</span><span class="n">data_formats</span><span class="o">.</span><span class="n">intogen_cancer</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.cancer_drivers_list"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.cancer_drivers_list">[docs]</a>    <span class="k">def</span> <span class="nf">cancer_drivers_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">intogen_file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads the list of cancer drivers. Contains information from</span>
<span class="sd">        COSMIC (needs user log in credentials) and IntOGen (if provided)</span>
<span class="sd">        and adds the attribute to the undirected network nodes.</span>

<span class="sd">        :arg str intogen_file:</span>
<span class="sd">            Optional, ``None`` by default. Path to the data file. Can</span>
<span class="sd">            also be [function] that provides the data. In general,</span>
<span class="sd">            anything accepted by</span>
<span class="sd">            :py:attr:`pypath.input_formats.NetworkInput.input`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cancer_gene_census_list</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">intogen_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">intogen_cancer_drivers_list</span><span class="p">(</span><span class="n">intogen_file</span><span class="o">=</span><span class="n">intogen_file</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="s1">&#39;cdv&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="s1">&#39;cgc&#39;</span><span class="p">])</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="s1">&#39;IntOGen&#39;</span><span class="p">]))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="s1">&#39;cdv&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="s1">&#39;cgc&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;cdv&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
            <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="s1">&#39;cdv&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">False</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">))</span></div>

<div class="viewcode-block" id="PyPath.coverage"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.coverage">[docs]</a>    <span class="k">def</span> <span class="nf">coverage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lst</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the coverage (range [0, 1]) of a list of nodes against</span>
<span class="sd">        the current (undirected) network.</span>

<span class="sd">        :arg set lst:</span>
<span class="sd">            Can also be [list] (will be converted to [set]) or [str]. In</span>
<span class="sd">            the latter case it will retrieve the list with that name (if</span>
<span class="sd">            such list exists in :py:attr:`pypath.main.PyPath.lists`).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">lst</span> <span class="o">=</span> <span class="n">lst</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="nb">set</span><span class="p">)</span> \
            <span class="k">else</span> <span class="nb">set</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> \
            <span class="k">else</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">lst</span><span class="p">])</span> \
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">lst</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span> \
            <span class="k">else</span> <span class="nb">set</span><span class="p">([])</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="n">lst</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">))</span></div>


<div class="viewcode-block" id="PyPath.entities_by_resources"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.entities_by_resources">[docs]</a>    <span class="k">def</span> <span class="nf">entities_by_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dict of sets with resources as keys and sets of entity IDs</span>
<span class="sd">        as values.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">resource</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]:</span>

                <span class="n">result</span><span class="p">[</span><span class="n">resource</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="PyPath.fisher_enrichment"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.fisher_enrichment">[docs]</a>    <span class="k">def</span> <span class="nf">fisher_enrichment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lst</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="s1">&#39;proteome&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes an enrichment analysis using Fisher&#39;s exact test. The</span>
<span class="sd">        contingency table is built as follows:</span>
<span class="sd">        First row contains the number of nodes in the *ref* list (such</span>
<span class="sd">        list is considered to be loaded in</span>
<span class="sd">        :py:attr:`pypath.main.PyPath.lists`) and the number of nodes in</span>
<span class="sd">        the current (undirected) network. Second row contains the number</span>
<span class="sd">        of nodes in *lst* list (also considered to be already loaded)</span>
<span class="sd">        and the number of nodes in the network with a non-empty</span>
<span class="sd">        attribute *attr*. Uses :py:func:`scipy.stats.fisher_exact`, see</span>
<span class="sd">        the documentation of the corresponding package for more</span>
<span class="sd">        information.</span>

<span class="sd">        :arg str lst:</span>
<span class="sd">            Name of the list in :py:attr:`pypath.main.PyPath.lists`</span>
<span class="sd">            whose number of elements will be the first element in the</span>
<span class="sd">            second row of the contingency table.</span>
<span class="sd">        :arg str attr:</span>
<span class="sd">            The node attribute name for which the number of nodes in the</span>
<span class="sd">            network with such attribute will be the second element of</span>
<span class="sd">            the second row of the contingency table.</span>
<span class="sd">        :arg str ref:</span>
<span class="sd">            Optional, ``&#39;proteome&#39;`` by default. The name of the list in</span>
<span class="sd">            :py:attr:`pypath.main.PyPath.lists` whose number of elements</span>
<span class="sd">            will be the first element of the first row of the</span>
<span class="sd">            contingency table.</span>

<span class="sd">        :return:</span>
<span class="sd">            * (*float*) -- Prior odds ratio.</span>
<span class="sd">            * (*float*) -- P-value or probability of obtaining a</span>
<span class="sd">              distribution as extreme as the observed, assuming that the</span>
<span class="sd">              null hypothesis is true.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cont</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">ref</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()],</span>
                         <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">lst</span><span class="p">]),</span>
                          <span class="nb">len</span><span class="p">([</span><span class="mi">1</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">attr</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])]])</span>

        <span class="k">return</span> <span class="n">stats</span><span class="o">.</span><span class="n">fisher_exact</span><span class="p">(</span><span class="n">cont</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.read_list_file"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.read_list_file">[docs]</a>    <span class="k">def</span> <span class="nf">read_list_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">settings</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads a list from a file and adds it to</span>
<span class="sd">        :py:attr:`pypath.main.PyPath.lists`.</span>

<span class="sd">        :arg pypath.input_formats.ReadList settings:</span>
<span class="sd">            :py:class:`python.data_formats.ReadList` instance specifying</span>
<span class="sd">            the settings of the file to be read. See the class</span>
<span class="sd">            documentation for more details.</span>
<span class="sd">        :arg \*\*kwargs:</span>
<span class="sd">            Extra arguments passed to the file reading function. Such</span>
<span class="sd">            function name is outlined in the</span>
<span class="sd">            :py:attr:`python.data_formats.ReadList.input` attribute and</span>
<span class="sd">            defined in :py:mod:`pypath.inputs`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">_input</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">!=</span> <span class="s2">&quot;ReadList&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                <span class="s1">&#39;No proper input file definition! `settings`&#39;</span>
                <span class="s1">&#39;should be a `readList` instance&#39;</span><span class="p">,</span>
                <span class="o">-</span><span class="mi">5</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">common</span><span class="o">.</span><span class="n">basestring</span><span class="p">)</span> <span class="ow">and</span>
            <span class="n">inputs</span><span class="o">.</span><span class="n">get_method</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
        <span class="p">):</span>

            <span class="n">toCall</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_method</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
            <span class="n">_input</span> <span class="o">=</span> <span class="n">toCall</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">input</span><span class="p">):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: No such file! :(</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">settings</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">_input</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">input</span>

        <span class="n">original_name_type</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">id_type</span>
        <span class="n">default_name_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_name_type</span><span class="p">[</span><span class="n">settings</span><span class="o">.</span><span class="n">entity_type</span><span class="p">]</span>
        <span class="n">mapTbl</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">original_name_type</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="n">default_name_type</span><span class="p">])</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">_input</span><span class="p">)</span> <span class="ow">in</span> <span class="n">common</span><span class="o">.</span><span class="n">char_types</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">_input</span><span class="p">):</span>

            <span class="n">_input</span> <span class="o">=</span> <span class="n">curl</span><span class="o">.</span><span class="n">Curl</span><span class="p">(</span><span class="n">_input</span><span class="p">,</span> <span class="n">large</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">result</span>

            <span class="c1">#codecs.open(_input, encoding=&#39;utf-8&#39;, mode=&#39;r&#39;)</span>

        <span class="k">if</span> <span class="n">_input</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Could not find file or input function.&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> opened...&quot;</span> <span class="o">%</span> <span class="n">settings</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
        <span class="c1"># finding the largest referred column number,</span>
        <span class="c1"># to avoid references out of index</span>
        <span class="n">max_col</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">settings</span><span class="o">.</span><span class="n">id_col</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_max</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">extra_attrs</span><span class="p">)])</span>
        <span class="c1"># iterating lines from input file</span>
        <span class="n">lnum</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">readError</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">item_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">_input</span><span class="p">:</span> <span class="c1"># XXX: Could use enumerate(_input) instead of lnum</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="p">(</span><span class="n">lnum</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">settings</span><span class="o">.</span><span class="n">header</span><span class="p">):</span>
                <span class="c1"># empty lines</span>
                <span class="c1"># or header row</span>
                <span class="n">lnum</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="ow">in</span> <span class="n">common</span><span class="o">.</span><span class="n">char_types</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">separator</span><span class="p">)</span>

            <span class="c1"># in case line has less fields than needed</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">max_col</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                    <span class="s1">&#39;Line #</span><span class="si">%u</span><span class="s1"> has less than </span><span class="si">%u</span><span class="s1"> fields! :(</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">lnum</span><span class="p">,</span> <span class="n">max_col</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">readError</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">break</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="c1"># reading names and attributes</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">newItem</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">line</span><span class="p">[</span><span class="n">settings</span><span class="o">.</span><span class="n">id_col</span><span class="p">],</span>
                       <span class="s2">&quot;id_type&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">id_type</span><span class="p">,</span>
                       <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">entity_type</span><span class="p">,</span>
                       <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">name</span>
                    <span class="p">}</span>

                <span class="k">except</span><span class="p">:</span>

                    <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                        <span class="s1">&#39;Wrong name column indexes (</span><span class="si">%u</span><span class="s1"> and </span><span class="si">%u</span><span class="s1">), &#39;</span>
                        <span class="s1">&#39;or wrong separator (</span><span class="si">%s</span><span class="s1">)? Line #</span><span class="si">%u</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">settings</span><span class="o">.</span><span class="n">id_col</span><span class="p">,</span>
                            <span class="n">settings</span><span class="o">.</span><span class="n">separator</span><span class="p">,</span>
                            <span class="n">lnum</span><span class="p">,</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">readError</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">break</span>

                <span class="c1"># getting additional attributes</span>
                <span class="n">attrsItem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attrs</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">settings</span><span class="o">.</span><span class="n">extra_attrs</span><span class="p">,</span> <span class="n">lnum</span><span class="p">)</span>
                <span class="c1"># merging dictionaries</span>
                <span class="n">newItem</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">attrsItem</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">readError</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">break</span>

            <span class="n">item_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newItem</span><span class="p">)</span>
            <span class="n">lnum</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">_input</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">):</span>
            <span class="n">_input</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">item_list_mapped</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_list</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">single_list</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">item_list_mapped</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">item_list_mapped</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">%u</span><span class="s1"> lines have been read from </span><span class="si">%s</span><span class="s1">, </span><span class="si">%u</span><span class="s1">  items after mapping&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">lnum</span><span class="p">,</span>
                <span class="n">settings</span><span class="o">.</span><span class="n">input</span><span class="p">,</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">item_list_mapped</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">settings</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">item_list_mapped</span></div>


    <span class="k">def</span> <span class="nf">_map_list</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">lst</span><span class="p">,</span>
            <span class="n">single_list</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">expand_complexes</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Maps the names from a list of edges or items (molecules).</span>

<span class="sd">        :arg list lst:</span>
<span class="sd">            List of items or edge dictionaries whose names have to be</span>
<span class="sd">            mapped.</span>
<span class="sd">        :arg bool single_list:</span>
<span class="sd">            Optional, ``False`` by default. Determines whether the</span>
<span class="sd">            provided elements are items or edges. This is, either calls</span>
<span class="sd">            :py:meth:`pypath.main.PyPath.map_edge` or</span>
<span class="sd">            :py:meth:`pypath.main.PyPath.map_item` to map the item</span>
<span class="sd">            names.</span>
<span class="sd">        :arg bool expand_complexes:</span>
<span class="sd">            Expand complexes, i.e. create links between each member of</span>
<span class="sd">            the complex and the interacting partner.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*list*) -- Copy of *lst* with their elements&#39; names mapped.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">list_mapped</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">single_list</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>
                <span class="n">list_mapped</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_map_item</span><span class="p">(</span>
                    <span class="n">item</span><span class="p">,</span>
                    <span class="n">expand_complexes</span> <span class="o">=</span> <span class="n">expand_complexes</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>
                <span class="n">list_mapped</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_map_edge</span><span class="p">(</span>
                    <span class="n">edge</span><span class="p">,</span>
                    <span class="n">expand_complexes</span> <span class="o">=</span> <span class="n">expand_complexes</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">list_mapped</span>


    <span class="k">def</span> <span class="nf">_map_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">expand_complexes</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Translates the name in *item* representing a molecule. Default</span>
<span class="sd">        name types are defined in</span>
<span class="sd">        :py:attr:`pypath.main.PyPath.default_name_type` If the mapping</span>
<span class="sd">        is unsuccessful, the item will be added to</span>
<span class="sd">        :py:attr:`pypath.main.PyPath.unmapped` list.</span>

<span class="sd">        :arg dict item:</span>
<span class="sd">            Item whose name is to be mapped to a default name type.</span>
<span class="sd">        :arg bool expand_complexes:</span>
<span class="sd">            Expand complexes, i.e. create links between each member of</span>
<span class="sd">            the complex and the interacting partner.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*list*) -- The default mapped name(s) [str] of *item*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># TODO: include</span>
        <span class="n">default_id</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span>
            <span class="n">item</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;id_type&#39;</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default_name_type</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]],</span>
            <span class="n">expand_complexes</span> <span class="o">=</span> <span class="n">expand_complexes</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">default_id</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">unmapped</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">default_id</span>


    <span class="k">def</span> <span class="nf">_map_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edge</span><span class="p">,</span> <span class="n">expand_complexes</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Translates the identifiers in *edge* representing an edge. Default</span>
<span class="sd">        name types are defined in</span>
<span class="sd">        :py:attr:`pypath.main.PyPath.default_name_type` If the mapping</span>
<span class="sd">        is unsuccessful, the item will be added to</span>
<span class="sd">        :py:attr:`pypath.main.PyPath.unmapped` list.</span>

<span class="sd">        :arg dict edge:</span>
<span class="sd">            Item whose name is to be mapped to a default name type.</span>
<span class="sd">        :arg bool expand_complexes:</span>
<span class="sd">            Expand complexes, i.e. create links between each member of</span>
<span class="sd">            the complex and the interacting partner.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*list*) -- Contains the edge(s) [dict] with default mapped</span>
<span class="sd">            names.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">edge_stack</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">default_id_a</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span>
            <span class="n">edge</span><span class="p">[</span><span class="s1">&#39;id_a&#39;</span><span class="p">],</span>
            <span class="n">edge</span><span class="p">[</span><span class="s1">&#39;id_type_a&#39;</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default_name_type</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="s1">&#39;entity_type_a&#39;</span><span class="p">]],</span>
            <span class="n">ncbi_tax_id</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="s1">&#39;taxon_a&#39;</span><span class="p">],</span>
            <span class="n">expand_complexes</span> <span class="o">=</span> <span class="n">expand_complexes</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">default_id_b</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span>
            <span class="n">edge</span><span class="p">[</span><span class="s1">&#39;id_b&#39;</span><span class="p">],</span>
            <span class="n">edge</span><span class="p">[</span><span class="s1">&#39;id_type_b&#39;</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default_name_type</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="s1">&#39;entity_type_b&#39;</span><span class="p">]],</span>
            <span class="n">ncbi_tax_id</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="s1">&#39;taxon_b&#39;</span><span class="p">],</span>
            <span class="n">expand_complexes</span> <span class="o">=</span> <span class="n">expand_complexes</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># this is needed because the possibility ambigous mapping</span>
        <span class="c1"># and expansion of complexes</span>
        <span class="c1"># one name can be mapped to multiple ones</span>
        <span class="c1"># this multiplies the nodes and edges</span>
        <span class="c1"># in case of proteins this does not happen too often</span>
        <span class="k">for</span> <span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">default_id_a</span><span class="p">,</span> <span class="n">default_id_b</span><span class="p">):</span>

            <span class="n">this_edge</span> <span class="o">=</span> <span class="n">copy_mod</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span>
            <span class="n">this_edge</span><span class="p">[</span><span class="s1">&#39;default_name_a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">id_a</span>
            <span class="n">this_edge</span><span class="p">[</span><span class="s1">&#39;default_name_type_a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">default_name_type</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="s1">&#39;entity_type_a&#39;</span><span class="p">]]</span>
            <span class="p">)</span>

            <span class="n">this_edge</span><span class="p">[</span><span class="s1">&#39;default_name_b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">id_b</span>
            <span class="n">this_edge</span><span class="p">[</span><span class="s1">&#39;default_name_type_b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">default_name_type</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="s1">&#39;entity_type_b&#39;</span><span class="p">]]</span>
            <span class="p">)</span>
            <span class="n">edge_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this_edge</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">edge_stack</span>


<div class="viewcode-block" id="PyPath.combine_attr"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.combine_attr">[docs]</a>    <span class="k">def</span> <span class="nf">combine_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lst</span><span class="p">,</span> <span class="n">num_method</span> <span class="o">=</span> <span class="nb">max</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Combines multiple attributes into one. This method attempts</span>
<span class="sd">        to find out which is the best way to combine attributes.</span>

<span class="sd">            * If there is only one value or one of them is None, then</span>
<span class="sd">              returns the one available.</span>
<span class="sd">            * Lists: concatenates unique values of lists.</span>
<span class="sd">            * Numbers: returns the greater by default or calls</span>
<span class="sd">              *num_method* if given.</span>
<span class="sd">            * Sets: returns the union.</span>
<span class="sd">            * Dictionaries: calls :py:func:`pypath.common.merge_dicts`.</span>
<span class="sd">            * Direction: calls their special</span>
<span class="sd">              :py:meth:`pypath.main.Direction.merge` method.</span>

<span class="sd">        Works on more than 2 attributes recursively.</span>

<span class="sd">        :arg list lst:</span>
<span class="sd">            List of one or two attribute values.</span>
<span class="sd">        :arg function num_method:</span>
<span class="sd">            Optional, ``max`` by default. Method to merge numeric</span>
<span class="sd">            attributes.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">list_or_set</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">two</span><span class="p">):</span>

            <span class="k">if</span> <span class="p">((</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">two</span><span class="p">,</span> <span class="nb">set</span><span class="p">))</span>
                <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">two</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="nb">set</span><span class="p">))):</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">one</span><span class="p">),</span> <span class="nb">set</span><span class="p">(</span><span class="n">two</span><span class="p">)</span>

                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">one</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">two</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">one</span><span class="p">,</span> <span class="n">two</span>

        <span class="c1"># recursion:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_attr</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">num_method</span><span class="o">=</span><span class="n">num_method</span><span class="p">)]</span>

        <span class="c1"># quick and simple cases:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># merge numeric values</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">in</span> <span class="n">common</span><span class="o">.</span><span class="n">numeric_types</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">in</span> <span class="n">common</span><span class="o">.</span><span class="n">numeric_types</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">num_method</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>

        <span class="c1"># in case one is list other is set</span>
        <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">list_or_set</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># merge lists:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># lists of hashable elements only:</span>
                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>

            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="c1"># if contain non-hashable elements:</span>
                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

        <span class="c1"># merge sets:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">set</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">common</span><span class="o">.</span><span class="n">add_to_set</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">set</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">common</span><span class="o">.</span><span class="n">add_to_set</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># merge dicts:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">common</span><span class="o">.</span><span class="n">merge_dicts</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># 2 different strings: return a set with both of them</span>
        <span class="k">if</span> <span class="p">((</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">unicode</span><span class="p">))</span>
            <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">unicode</span><span class="p">))):</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">return</span> <span class="nb">set</span><span class="p">([</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

        <span class="c1"># one attr is list, the other is simple value:</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">in</span> <span class="n">common</span><span class="o">.</span><span class="n">simple_types</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">common</span><span class="o">.</span><span class="n">numeric_types</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">common</span><span class="o">.</span><span class="n">add_to_list</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">in</span> <span class="n">common</span><span class="o">.</span><span class="n">simple_types</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">common</span><span class="o">.</span><span class="n">numeric_types</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">common</span><span class="o">.</span><span class="n">add_to_list</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># special: merging directions</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;Direction&#39;</span>
            <span class="ow">and</span> <span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;Direction&#39;</span><span class="p">):</span>

            <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># in case the objects have `__add__()` method:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;__add__&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="PyPath.uniq_node_list"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.uniq_node_list">[docs]</a>    <span class="k">def</span> <span class="nf">uniq_node_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lst</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a given list of nodes containing only the unique</span>
<span class="sd">        elements.</span>

<span class="sd">        :arg list lst:</span>
<span class="sd">            List of nodes.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*list*) -- Copy of *lst* containing only unique nodes.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">uniqLst</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">uniqLst</span><span class="p">:</span>
                <span class="n">uniqLst</span><span class="p">[</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">uniqLst</span><span class="p">[</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">merge_attrs</span><span class="p">(</span><span class="n">uniqLst</span><span class="p">[</span><span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">uniqLst</span></div>

<div class="viewcode-block" id="PyPath.collapse_by_name"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.collapse_by_name">[docs]</a>    <span class="k">def</span> <span class="nf">collapse_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Collapses nodes with the same name by copying and merging</span>
<span class="sd">        all edges and attributes. Operates directly on the provided</span>
<span class="sd">        network object.</span>

<span class="sd">        :arg igraph.Graph graph:</span>
<span class="sd">            Optional, ``None`` by default. The network for which the</span>
<span class="sd">            nodes are to be collapsed. If none is provided, takes</span>
<span class="sd">            :py:attr:`pypath.main.PyPath.graph` (undirected network) by</span>
<span class="sd">            default.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">graph</span>

        <span class="n">multiple</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">multiple</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>

                <span class="n">nodes</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">)</span>

                <span class="c1"># the number of nodes might have changed</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">merge_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.merge_nodes"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.merge_nodes">[docs]</a>    <span class="k">def</span> <span class="nf">merge_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">primary</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Merges all attributes and edges of selected nodes and assigns</span>
<span class="sd">        them to the primary node (by default the one with lowest index).</span>

<span class="sd">        :arg list nodes:</span>
<span class="sd">            List of node indexes [int] that are to be collapsed.</span>
<span class="sd">        :arg int primary:</span>
<span class="sd">            Optional, ``None`` by default. ID of the primary edge, if</span>
<span class="sd">            none is passed, the node with lowest index on *nodes* is</span>
<span class="sd">            selected.</span>
<span class="sd">        :arg igraph.Graph graph:</span>
<span class="sd">            Optional, ``None`` by default. The network graph object from</span>
<span class="sd">            which the nodes are to be merged. If none is passed, takes</span>
<span class="sd">            the undirected network graph.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">graph</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">n</span><span class="p">:</span>
                            <span class="n">n</span><span class="o">.</span><span class="n">index</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">int</span> <span class="k">else</span> <span class="n">n</span><span class="p">,</span> <span class="n">nodes</span><span class="p">)))</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span> <span class="c1"># XXX: Isn&#39;t it already sorted just above?</span>
        <span class="n">primary</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">primary</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">primary</span>
        <span class="n">primary</span> <span class="o">=</span> <span class="n">primary</span><span class="o">.</span><span class="n">index</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">primary</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">int</span> <span class="k">else</span> <span class="n">primary</span>
        <span class="n">nonprimary</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">n</span> <span class="o">!=</span> <span class="n">primary</span><span class="p">,</span> <span class="n">nodes</span><span class="p">))</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;id_merge&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">xrange</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()))</span>

        <span class="c1"># combining vertex attributes:</span>
        <span class="n">vprim</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">primary</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">vprim</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>

            <span class="k">if</span> <span class="n">attr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;id_merge&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">}:</span>

                <span class="n">vprim</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_attr</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span>
                                <span class="k">lambda</span> <span class="n">vid</span><span class="p">:</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">vid</span><span class="p">][</span><span class="n">attr</span><span class="p">],</span>
                                <span class="c1"># combining from all nodes</span>
                                <span class="n">nodes</span><span class="p">)))</span>

        <span class="c1"># moving edges of non primary vertices to the primary one</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copy_edges</span><span class="p">(</span><span class="n">nonprimary</span><span class="p">,</span> <span class="n">primary</span><span class="p">,</span> <span class="n">move</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span><span class="p">)</span>

        <span class="c1"># deleting non primary vertices:</span>
        <span class="n">toDel</span> <span class="o">=</span> <span class="p">[</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">id_merge</span> <span class="o">=</span> <span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">nonprimary</span><span class="p">]</span>

        <span class="n">graph</span><span class="o">.</span><span class="n">delete_vertices</span><span class="p">(</span><span class="n">toDel</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;id_merge&#39;</span><span class="p">]</span></div>


<div class="viewcode-block" id="PyPath.copy_edges"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.copy_edges">[docs]</a>    <span class="k">def</span> <span class="nf">copy_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sources</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">move</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Copies edges from *sources* node(s) to another one (*target*),</span>
<span class="sd">        keeping attributes and directions.</span>

<span class="sd">        :arg list sources:</span>
<span class="sd">            Contains the vertex index(es) [int] of the node(s) to be</span>
<span class="sd">            copied or moved.</span>
<span class="sd">        :arg int target:</span>
<span class="sd">            Vertex index where edges and attributes are to be copied to.</span>
<span class="sd">        :arg bool move:</span>
<span class="sd">            Optional, ``False`` by default. Whether to perform copy or</span>
<span class="sd">            move (remove or keep the source edges).</span>
<span class="sd">        :arg igraph.Graph graph:</span>
<span class="sd">            Optional, ``None`` by default. The network graph object from</span>
<span class="sd">            which the nodes are to be merged. If none is passed, takes</span>
<span class="sd">            the undirected network graph.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">toDel</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>
        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">graph</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;id_old&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()))</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;id_old&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">()))</span>

        <span class="c1"># preserve a permanent marker of the target vertex</span>
        <span class="n">ovidt</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;id_old&#39;</span><span class="p">]</span>

        <span class="c1"># collecting the edges of all source vertices into dict</span>
        <span class="n">ses</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="c1"># id_old of source vertices:</span>
                <span class="n">s</span><span class="p">,</span>
                <span class="c1"># edges of current source node:</span>
                <span class="nb">set</span><span class="p">(</span>
                    <span class="n">e</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span>
                    <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span>
                        <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">_source</span> <span class="o">=</span> <span class="n">s</span><span class="p">),</span>
                        <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">_target</span> <span class="o">=</span> <span class="n">s</span><span class="p">),</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sources</span>
        <span class="p">)</span>

        <span class="c1"># collecting edges to be newly created</span>
        <span class="n">toAdd</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>

        <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">es</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">ses</span><span class="p">):</span>

            <span class="k">for</span> <span class="n">eid</span> <span class="ow">in</span> <span class="n">es</span><span class="p">:</span>
                <span class="c1"># the source edge:</span>
                <span class="n">e</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">]</span>

                <span class="n">new_source</span> <span class="o">=</span> <span class="n">target</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="n">s</span> <span class="k">else</span> <span class="n">e</span><span class="o">.</span><span class="n">source</span>
                <span class="n">new_target</span> <span class="o">=</span> <span class="n">target</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span> <span class="o">==</span> <span class="n">s</span> <span class="k">else</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span>

                <span class="n">es0</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
                    <span class="n">_source</span> <span class="o">=</span> <span class="n">new_source</span><span class="p">,</span>
                    <span class="n">_target</span> <span class="o">=</span> <span class="n">new_target</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">es1</span> <span class="o">=</span> <span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">graph</span><span class="o">.</span><span class="n">is_directed</span><span class="p">():</span>
                    <span class="n">es1</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
                        <span class="n">_source</span> <span class="o">=</span> <span class="n">new_target</span><span class="p">,</span>
                        <span class="n">_target</span> <span class="o">=</span> <span class="n">new_source</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="c1"># looking up if target edge already exists:</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="n">es0</span><span class="p">,</span> <span class="n">es1</span><span class="p">))):</span>

                    <span class="n">toAdd</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">new_source</span><span class="p">,</span> <span class="n">new_target</span><span class="p">))</span>

        <span class="c1"># creating new edges</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span><span class="n">toAdd</span><span class="p">)</span>
        <span class="n">nvidt</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">id_old</span> <span class="o">=</span> <span class="n">target</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>

        <span class="c1"># copying attributes:</span>

        <span class="k">for</span> <span class="n">ovids</span><span class="p">,</span> <span class="n">es</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">ses</span><span class="p">):</span>

            <span class="k">for</span> <span class="n">oeid</span> <span class="ow">in</span> <span class="n">es</span><span class="p">:</span>

                <span class="c1"># this is the current source edge:</span>
                <span class="n">e</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">id_old</span> <span class="o">=</span> <span class="n">oeid</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="c1"># this is the index of the other (peer) node:</span>
                <span class="n">new_source</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">nvidt</span>
                        <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;id_old&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ovids</span> <span class="k">else</span>
                    <span class="n">e</span><span class="o">.</span><span class="n">source</span>
                <span class="p">)</span>
                <span class="n">new_target</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">nvidt</span>
                        <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;id_old&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ovids</span> <span class="k">else</span>
                    <span class="n">e</span><span class="o">.</span><span class="n">target</span>
                <span class="p">)</span>
                <span class="n">nvids</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">id_old</span> <span class="o">=</span> <span class="n">ovids</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
                <span class="n">nvid_other</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="n">nvids</span> <span class="k">else</span> <span class="n">e</span><span class="o">.</span><span class="n">source</span>

                <span class="c1"># looking up new edge:</span>
                <span class="n">es0</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
                    <span class="n">_source</span> <span class="o">=</span> <span class="n">new_source</span><span class="p">,</span>
                    <span class="n">_target</span> <span class="o">=</span> <span class="n">new_target</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">es1</span> <span class="o">=</span> <span class="p">()</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">graph</span><span class="o">.</span><span class="n">is_directed</span><span class="p">():</span>

                    <span class="n">es1</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
                        <span class="n">_source</span> <span class="o">=</span> <span class="n">new_target</span><span class="p">,</span>
                        <span class="n">_target</span> <span class="o">=</span> <span class="n">new_source</span><span class="p">,</span>
                    <span class="p">)</span>

                <span class="n">es_all</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="n">es0</span><span class="p">,</span> <span class="n">es1</span><span class="p">))</span>

                <span class="k">for</span> <span class="n">new_edge</span> <span class="ow">in</span> <span class="n">es_all</span><span class="p">:</span>

                    <span class="c1"># old direction:</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span>
                    <span class="c1"># dict from old names to new ones</span>
                    <span class="c1"># the peer does no change, only s-&gt;t</span>
                    <span class="n">ids</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">nvids</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]:</span>
                            <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">nvidt</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                        <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">nvid_other</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]:</span>
                            <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">nvid_other</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                    <span class="p">}</span>

                    <span class="c1"># copying directions and signs:</span>
                    <span class="n">new_dirs</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">new_edge</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]:</span>
                        <span class="n">new_dirs</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">new_edge</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">])</span>

                    <span class="n">new_edge</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_dirs</span>

                    <span class="c1"># copying `refs_by_dir`</span>
                    <span class="n">new_edge</span><span class="p">[</span><span class="s1">&#39;refs_by_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_translate_refsdir</span><span class="p">(</span>
                        <span class="n">e</span><span class="p">[</span><span class="s1">&#39;refs_by_dir&#39;</span><span class="p">],</span> <span class="n">ids</span><span class="p">,</span>
                    <span class="p">)</span>

                    <span class="c1"># copying further attributes:</span>
                    <span class="k">for</span> <span class="n">eattr</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>

                        <span class="k">if</span> <span class="n">eattr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;dirs&#39;</span><span class="p">,</span> <span class="s1">&#39;refs_by_dir&#39;</span><span class="p">,</span> <span class="s1">&#39;id_old&#39;</span><span class="p">}:</span>

                            <span class="n">new_edge</span><span class="p">[</span><span class="n">eattr</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_attr</span><span class="p">([</span>
                                <span class="n">new_edge</span><span class="p">[</span><span class="n">eattr</span><span class="p">],</span>
                                <span class="n">e</span><span class="p">[</span><span class="n">eattr</span><span class="p">]</span>
                            <span class="p">])</span>

                <span class="c1"># in case we want to delete old edges:</span>
                <span class="n">toDel</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">move</span><span class="p">:</span>

            <span class="n">graph</span><span class="o">.</span><span class="n">delete_edges</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">toDel</span><span class="p">))</span>

        <span class="c1"># removing temporary attributes</span>
        <span class="k">del</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;id_old&#39;</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;id_old&#39;</span><span class="p">]</span></div>


<div class="viewcode-block" id="PyPath.delete_by_organism"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.delete_by_organism">[docs]</a>    <span class="k">def</span> <span class="nf">delete_by_organism</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">organisms_allowed</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes the proteins of all organisms which are not given in</span>
<span class="sd">        *tax*.</span>

<span class="sd">        :arg list,set organisms_allowed:</span>
<span class="sd">            List of NCBI Taxonomy IDs [int] of the organism(s) that are</span>
<span class="sd">            to be kept.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="n">organisms_allowed</span> <span class="o">=</span> <span class="n">organisms_allowed</span> <span class="ow">or</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span><span class="p">}</span>

        <span class="n">to_delete</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">v</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span>
            <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;ncbi_tax_id&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">organisms_allowed</span>
        <span class="p">]</span>

        <span class="n">g</span><span class="o">.</span><span class="n">delete_vertices</span><span class="p">(</span><span class="n">to_delete</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_db_dict</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyPath.delete_unknown"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.delete_unknown">[docs]</a>    <span class="k">def</span> <span class="nf">delete_unknown</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">organisms_allowed</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;protein&#39;</span><span class="p">,</span>
            <span class="n">default_name_type</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes those items which are not in the list of all default</span>
<span class="sd">        IDs of the organisms. By default, it means to remove all protein</span>
<span class="sd">        nodes not having a human UniProt ID.</span>

<span class="sd">        :arg str typ:</span>
<span class="sd">            Optional, ``&#39;protein&#39;`` by default. Determines the molecule</span>
<span class="sd">            type. These can be ``&#39;protein&#39;``, ``&#39;drug&#39;``, ``&#39;lncrna&#39;``,</span>
<span class="sd">            ``&#39;mirna&#39;`` or any other type defined in</span>
<span class="sd">            :py:attr:`pypath.main.PyPath.default_name_type`.</span>
<span class="sd">        :arg str default_name_type:</span>
<span class="sd">            Optional, ``None`` by default. The default name type for the</span>
<span class="sd">            given molecular species. If none is specified takes it from</span>
<span class="sd">            :py:attr:`pypath.main.PyPath.default_name_type` (e.g.: for</span>
<span class="sd">            ``&#39;protein&#39;``, default is ``&#39;uniprot&#39;``).</span>
<span class="sd">        :arg set organisms_allowed:</span>
<span class="sd">            NCBI Taxonomy identifiers [int] of the organisms allowed in</span>
<span class="sd">            the network.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">default_name_type</span><span class="p">:</span>

            <span class="n">default_name_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_name_type</span><span class="p">[</span><span class="n">entity_type</span><span class="p">]</span>

        <span class="n">organisms_allowed</span> <span class="o">=</span> <span class="n">organisms_allowed</span> <span class="ow">or</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span><span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Checking network components against reference lists.&#39;</span><span class="p">)</span>

        <span class="n">names</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;id_type&#39;</span><span class="p">]</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">default_name_type</span><span class="p">]</span>
        <span class="n">entity_types</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
        <span class="n">entity_types</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">entity_types</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">entity_type</span>
        <span class="p">]</span>
        <span class="n">organisms</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;ncbi_tax_id&#39;</span><span class="p">]</span>
        <span class="n">organisms</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">organisms</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">organisms_allowed</span>
        <span class="p">]</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">entity_types</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">organisms</span><span class="p">))</span>
        <span class="n">names_selected</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">]</span>

        <span class="n">names_to_delete</span> <span class="o">=</span> <span class="nb">set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span>
            <span class="o">*</span><span class="p">(</span>
                <span class="n">reflists</span><span class="o">.</span><span class="n">is_not</span><span class="p">(</span>
                    <span class="n">names</span> <span class="o">=</span> <span class="n">names_selected</span><span class="p">,</span>
                    <span class="n">id_type</span> <span class="o">=</span> <span class="n">default_name_type</span><span class="p">,</span>
                    <span class="n">ncbi_tax_id</span> <span class="o">=</span> <span class="n">ncbi_tax_id</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">ncbi_tax_id</span> <span class="ow">in</span> <span class="n">organisms_allowed</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">vertices_to_delete</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">names_to_delete</span><span class="p">]</span>

        <span class="n">g</span><span class="o">.</span><span class="n">delete_vertices</span><span class="p">(</span><span class="n">vertices_to_delete</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyPath.clean_graph"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.clean_graph">[docs]</a>    <span class="k">def</span> <span class="nf">clean_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">organisms_allowed</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes multiple edges, unknown molecules and those from wrong</span>
<span class="sd">        taxon. Multiple edges will be combined by</span>
<span class="sd">        :py:meth:`pypath.main.PyPath.combine_attr` method.</span>
<span class="sd">        Loops will be deleted unless the attribute</span>
<span class="sd">        :py:attr:`pypath.main.PyPath.loops` is set to ``True``.</span>

<span class="sd">        :arg set organisms_allowed:</span>
<span class="sd">            NCBI Taxonomy identifiers [int] of the organisms allowed</span>
<span class="sd">            in the network.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Removing duplicate edges...&#39;</span><span class="p">)</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">is_simple</span><span class="p">():</span>
            <span class="n">g</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">loops</span><span class="o">=</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">loops</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">combine_edges</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">combine_attr</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;After duplicate edge removal: &#39;</span>
            <span class="s1">&#39;number of nodes: </span><span class="si">%u</span><span class="s1">, edges: </span><span class="si">%u</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">(),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">delete_unmapped</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;After removing unmapped nodes: &#39;</span>
            <span class="s1">&#39;number of nodes: </span><span class="si">%u</span><span class="s1">, edges: </span><span class="si">%u</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">(),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">delete_by_organism</span><span class="p">(</span><span class="n">organisms_allowed</span> <span class="o">=</span> <span class="n">organisms_allowed</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;After removing unknown organism nodes: &#39;</span>
            <span class="s1">&#39;number of nodes: </span><span class="si">%u</span><span class="s1">, edges: </span><span class="si">%u</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">(),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">delete_unknown</span><span class="p">(</span><span class="n">organisms_allowed</span> <span class="o">=</span> <span class="n">organisms_allowed</span><span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
        <span class="n">zeroDeg</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">g</span><span class="o">.</span><span class="n">delete_vertices</span><span class="p">(</span><span class="n">zeroDeg</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;After removing zero degree nodes: &#39;</span>
            <span class="s1">&#39;number of node: </span><span class="si">%u</span><span class="s1">, edges: </span><span class="si">%u</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">(),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span></div>

    <span class="c1">###</span>
    <span class="c1"># functions to integrate new data into the main igraph network object</span>
    <span class="c1">###</span>

<div class="viewcode-block" id="PyPath.count_sol"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.count_sol">[docs]</a>    <span class="k">def</span> <span class="nf">count_sol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># XXX: Not used anywhere</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Counts the number of nodes with zero degree.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*int*) -- The number of nodes with zero degree.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># XXX: Refactor option 1:</span>
        <span class="c1">#          return len([1 for i in self.graph.vs.degree() if i == 0])</span>
        <span class="c1">#      Refactor option 2:</span>
        <span class="c1">#          return Counter(self.graph.vs.degree()[0])</span>

        <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">degree</span><span class="p">():</span>

            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">s</span></div>


    <span class="k">def</span> <span class="nf">_add_update_vertex</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">default_attrs</span><span class="p">,</span>
            <span class="n">original_name</span><span class="p">,</span>
            <span class="n">original_name_type</span><span class="p">,</span>
            <span class="n">extra_attrs</span> <span class="o">=</span> <span class="p">{},</span>
            <span class="n">add</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the attributes of one node in the (undirected) network.</span>
<span class="sd">        Optionally it creates a new node and sets the attributes, but it</span>
<span class="sd">        is not efficient as :py:mod:`igraph` needs to reindex vertices</span>
<span class="sd">        after this operation, so better to create new nodes in batches.</span>

<span class="sd">        :arg dict default_attrs:</span>
<span class="sd">            The attribute dictionary of the node to be updated/created.</span>
<span class="sd">        :arg str original_name:</span>
<span class="sd">            Original node name (e.g.: UniProt ID).</span>
<span class="sd">        :arg str original_name_type:</span>
<span class="sd">            The original node name type (e.g.: for the previous example,</span>
<span class="sd">            this would be ``&#39;uniprot&#39;``).</span>
<span class="sd">        :arg dict extra_attrs:</span>
<span class="sd">            Optional, ``{}`` by default. Contains any extra attributes</span>
<span class="sd">            for the node to be updated.</span>
<span class="sd">        :arg bool add:</span>
<span class="sd">            Optional, ``False`` by default. If set to ``True`` and the</span>
<span class="sd">            node is not in the network, it will be created. Otherwise,</span>
<span class="sd">            in such case it will raise an error message.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">keep_original_names</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;network_keep_original_names&#39;</span><span class="p">)</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">_reindex_names</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">default_attrs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]:</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">add</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Failed to add some vertices&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="n">n</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vcount</span><span class="p">()</span>
            <span class="n">g</span><span class="o">.</span><span class="n">add_vertices</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

            <span class="c1"># only keep track of original names if they are strings</span>
            <span class="c1"># not, for example, complexes</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">keep_original_names</span> <span class="ow">and</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">original_name</span><span class="p">,</span> <span class="n">common</span><span class="o">.</span><span class="n">basestring</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;original_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">original_name</span><span class="p">:</span> <span class="n">original_name_type</span><span class="p">,</span>
                <span class="p">}</span>

            <span class="n">this_node</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">_name_index</span><span class="p">[</span><span class="n">default_attrs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]]</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">this_node</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">_name_index</span><span class="p">[</span><span class="n">default_attrs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]]</span>

            <span class="k">if</span> <span class="n">this_node</span><span class="p">[</span><span class="s1">&#39;original_names&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

                <span class="n">this_node</span><span class="p">[</span><span class="s1">&#39;original_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="c1"># only keep track of original names if they are strings</span>
            <span class="c1"># not, for example, complexes</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">keep_original_names</span> <span class="ow">and</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">original_name</span><span class="p">,</span> <span class="n">common</span><span class="o">.</span><span class="n">basestring</span><span class="p">)</span>
            <span class="p">):</span>

                <span class="n">this_node</span><span class="p">[</span><span class="s1">&#39;original_names&#39;</span><span class="p">][</span><span class="n">original_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">original_name_type</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">default_attrs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">intera</span><span class="o">.</span><span class="n">Complex</span><span class="p">):</span>

            <span class="n">default_attrs</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;complex&#39;</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">default_attrs</span><span class="p">):</span>

            <span class="n">this_node</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">extra_attrs</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>

                <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())]</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span>
                    <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
                <span class="p">)</span>

            <span class="n">this_node</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_attr</span><span class="p">([</span><span class="n">this_node</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">value</span><span class="p">])</span>


    <span class="k">def</span> <span class="nf">_add_update_edge</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">id_a</span><span class="p">,</span>
            <span class="n">id_b</span><span class="p">,</span>
            <span class="n">id_type_a</span><span class="p">,</span>
            <span class="n">id_type_b</span><span class="p">,</span>
            <span class="n">entity_type_a</span><span class="p">,</span>
            <span class="n">entity_type_b</span><span class="p">,</span>
            <span class="n">source</span><span class="p">,</span>
            <span class="n">evidences</span><span class="p">,</span>
            <span class="n">is_directed</span><span class="p">,</span>
            <span class="n">refs</span><span class="p">,</span>
            <span class="n">stim</span><span class="p">,</span>
            <span class="n">inh</span><span class="p">,</span>
            <span class="n">taxon_a</span><span class="p">,</span>
            <span class="n">taxon_b</span><span class="p">,</span>
            <span class="n">typ</span><span class="p">,</span>
            <span class="n">extra_attrs</span> <span class="o">=</span> <span class="p">{},</span>
            <span class="n">add</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the attributes of one edge in the (undirected) network.</span>
<span class="sd">        Optionally it creates a new edge and sets the attributes, but it</span>
<span class="sd">        is not efficient as :py:mod:`igraph` needs to reindex edges</span>
<span class="sd">        after this operation, so better to create new edges in batches.</span>

<span class="sd">        :arg str id_a:</span>
<span class="sd">            Name of the source node of the edge to be added/updated.</span>
<span class="sd">        :arg str id_b:</span>
<span class="sd">            Name of the source node of the edge to be added/updated.</span>
<span class="sd">        :arg set source:</span>
<span class="sd">            Or [list], contains the names [str] of the resources</span>
<span class="sd">            supporting that edge.</span>
<span class="sd">        :arg pypath.evidence.Evidence evidence:</span>
<span class="sd">            A ``pypath.evidence.Evidence`` object.</span>
<span class="sd">        :arg bool is_directed:</span>
<span class="sd">            Whether if the edge is directed or not.</span>
<span class="sd">        :arg set refs:</span>
<span class="sd">            Or [list], contains the instances of the references</span>
<span class="sd">            :py:class:`pypath.refs.Reference` for that edge.</span>
<span class="sd">        :arg bool stim:</span>
<span class="sd">            Whether the edge is stimulatory or not.</span>
<span class="sd">        :arg bool inh:</span>
<span class="sd">            Whether the edge is inhibitory or note</span>
<span class="sd">        :arg int taxon_a:</span>
<span class="sd">            NCBI Taxonomic identifier of the source molecule.</span>
<span class="sd">        :arg int taxon_b:</span>
<span class="sd">            NCBI Taxonomic identifier of the target molecule.</span>
<span class="sd">        :arg str typ:</span>
<span class="sd">            The type of interaction (e.g.: ``&#39;PPI&#39;``)</span>
<span class="sd">        :arg dict extra_attrs:</span>
<span class="sd">            Optional, ``{}`` by default. Contains any extra attributes</span>
<span class="sd">            for the edge to be updated.</span>
<span class="sd">        :arg bool add:</span>
<span class="sd">            Optional, ``False`` by default. If set to ``True`` and the</span>
<span class="sd">            edge is not in the network, it will be created. Otherwise,</span>
<span class="sd">            in such case it will raise an error message.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;nodDct&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodInd</span><span class="p">)</span> <span class="o">!=</span> <span class="n">g</span><span class="o">.</span><span class="n">vcount</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>

        <span class="n">edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_exists</span><span class="p">(</span><span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">edge</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">add</span><span class="p">:</span>
                <span class="c1"># normally we create all new edges before calling this method</span>
                <span class="c1"># for efficiency reasons; hence if ``add`` is False and the</span>
                <span class="c1"># edge does not exist something must have gone wrong earlier</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Failed to add some edges&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>
                <span class="n">aid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">id_a</span><span class="p">]</span>
                <span class="n">bid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">id_b</span><span class="p">]</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span><span class="n">aid</span><span class="p">,</span> <span class="n">bid</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span><span class="n">aid</span><span class="p">,</span> <span class="n">bid</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">failed_edges</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">edge</span><span class="p">,</span> <span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span><span class="p">,</span> <span class="n">aid</span><span class="p">,</span> <span class="n">bid</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>

                <span class="k">return</span> <span class="kc">False</span>

            <span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_exists</span><span class="p">(</span><span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span><span class="p">)</span>

        <span class="c1"># assigning source:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_set_eattr</span><span class="p">(</span><span class="n">edge</span><span class="p">,</span> <span class="s1">&#39;sources&#39;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
        
        <span class="c1"># adding references:</span>
        <span class="c1"># if len(refs) &gt; 0:</span>
        <span class="n">refs</span> <span class="o">=</span> <span class="p">[</span><span class="n">_refs</span><span class="o">.</span><span class="n">Reference</span><span class="p">(</span><span class="n">pmid</span><span class="p">)</span> <span class="k">for</span> <span class="n">pmid</span> <span class="ow">in</span> <span class="n">refs</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_list_eattr</span><span class="p">(</span><span class="n">edge</span><span class="p">,</span> <span class="s1">&#39;references&#39;</span><span class="p">,</span> <span class="n">refs</span><span class="p">)</span>
        
        <span class="n">entity_a</span> <span class="o">=</span> <span class="n">entity_mod</span><span class="o">.</span><span class="n">Entity</span><span class="p">(</span>
            <span class="n">identifier</span> <span class="o">=</span> <span class="n">id_a</span><span class="p">,</span>
            <span class="n">id_type</span> <span class="o">=</span> <span class="n">id_type_a</span><span class="p">,</span>
            <span class="n">entity_type</span> <span class="o">=</span> <span class="n">entity_type_a</span><span class="p">,</span>
            <span class="n">taxon</span> <span class="o">=</span> <span class="n">taxon_a</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">entity_b</span> <span class="o">=</span> <span class="n">entity_mod</span><span class="o">.</span><span class="n">Entity</span><span class="p">(</span>
            <span class="n">identifier</span> <span class="o">=</span> <span class="n">id_b</span><span class="p">,</span>
            <span class="n">id_type</span> <span class="o">=</span> <span class="n">id_type_b</span><span class="p">,</span>
            <span class="n">entity_type</span> <span class="o">=</span> <span class="n">entity_type_b</span><span class="p">,</span>
            <span class="n">taxon</span> <span class="o">=</span> <span class="n">taxon_b</span><span class="p">,</span>
        <span class="p">)</span>
        
        <span class="n">attrs</span> <span class="o">=</span> <span class="n">interaction</span><span class="o">.</span><span class="n">Interaction</span><span class="p">(</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">entity_a</span><span class="p">,</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">entity_b</span><span class="p">,</span>
        <span class="p">)</span>
        
        <span class="c1"># updating references-by-source dict:</span>
        <span class="n">sources</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">source</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">set</span><span class="p">,</span> <span class="nb">list</span><span class="p">))</span> <span class="k">else</span>
            <span class="p">(</span><span class="n">source</span><span class="p">,)</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_grouped_set_eattr</span><span class="p">(</span><span class="n">edge</span><span class="p">,</span> <span class="s1">&#39;refs_by_source&#39;</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">refs</span><span class="p">)</span>

        <span class="c1"># updating refrences-by-type dict:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_grouped_set_eattr</span><span class="p">(</span><span class="n">edge</span><span class="p">,</span> <span class="s1">&#39;refs_by_type&#39;</span><span class="p">,</span> <span class="n">typ</span><span class="p">,</span> <span class="n">refs</span><span class="p">)</span>

        <span class="c1"># setting directions:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="s1">&#39;dirs&#39;</span><span class="p">]:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Direction</span><span class="p">(</span><span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_directed</span><span class="p">:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_dir</span><span class="p">((</span><span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span><span class="p">),</span> <span class="n">source</span><span class="p">)</span>
            <span class="c1"># updating references-by-direction dict:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_grouped_set_eattr</span><span class="p">(</span>
                <span class="n">edge</span><span class="p">,</span>
                <span class="s1">&#39;refs_by_dir&#39;</span><span class="p">,</span>
                <span class="p">(</span><span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span><span class="p">),</span>
                <span class="n">refs</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">attrs</span><span class="o">.</span><span class="n">add_evidence</span><span class="p">(</span>
                <span class="n">evidence</span> <span class="o">=</span> <span class="n">evidences</span><span class="p">,</span>
                <span class="n">direction</span> <span class="o">=</span> <span class="p">(</span><span class="n">entity_a</span><span class="p">,</span> <span class="n">entity_b</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_dir</span><span class="p">(</span><span class="s1">&#39;undirected&#39;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_grouped_set_eattr</span><span class="p">(</span>
                <span class="n">edge</span><span class="p">,</span>
                <span class="s1">&#39;refs_by_dir&#39;</span><span class="p">,</span>
                <span class="s1">&#39;undirected&#39;</span><span class="p">,</span>
                <span class="n">refs</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">attrs</span><span class="o">.</span><span class="n">add_evidence</span><span class="p">(</span>
                <span class="n">evidence</span> <span class="o">=</span> <span class="n">evidences</span><span class="p">,</span>
                <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;undirected&#39;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># setting signs:</span>
        <span class="k">if</span> <span class="n">stim</span><span class="p">:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_sign</span><span class="p">((</span><span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span><span class="p">),</span> <span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
            <span class="n">attrs</span><span class="o">.</span><span class="n">add_evidence</span><span class="p">(</span>
                <span class="n">evidence</span> <span class="o">=</span> <span class="n">evidences</span><span class="p">,</span>
                <span class="n">direction</span> <span class="o">=</span> <span class="p">(</span><span class="n">entity_a</span><span class="p">,</span> <span class="n">entity_b</span><span class="p">),</span>
                <span class="n">effect</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">inh</span><span class="p">:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_sign</span><span class="p">((</span><span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span><span class="p">),</span> <span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
            <span class="n">attrs</span><span class="o">.</span><span class="n">add_evidence</span><span class="p">(</span>
                <span class="n">evidence</span> <span class="o">=</span> <span class="n">evidences</span><span class="p">,</span>
                <span class="n">direction</span> <span class="o">=</span> <span class="p">(</span><span class="n">entity_a</span><span class="p">,</span> <span class="n">entity_b</span><span class="p">),</span>
                <span class="n">effect</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>
        
        <span class="c1"># adding interaction attributes (this new kind of object either will</span>
        <span class="c1"># replace the igraph based network representation or is a temporary</span>
        <span class="c1"># solution and something else will replace them):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="s1">&#39;attrs&#39;</span><span class="p">],</span> <span class="n">interaction</span><span class="o">.</span><span class="n">Interaction</span><span class="p">):</span>
            
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="s1">&#39;attrs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">attrs</span>
            
        <span class="k">else</span><span class="p">:</span>
            
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="s1">&#39;attrs&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">attrs</span>
        
        <span class="c1"># updating sources-by-type dict:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_grouped_set_eattr</span><span class="p">(</span><span class="n">edge</span><span class="p">,</span> <span class="s1">&#39;sources_by_type&#39;</span><span class="p">,</span> <span class="n">typ</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
        <span class="c1"># adding type:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_list_eattr</span><span class="p">(</span><span class="n">edge</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">typ</span><span class="p">)</span>

        <span class="c1"># adding extra attributes:</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">extra_attrs</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
                <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">([[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">())]</span>
                             <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="kc">None</span><span class="p">])</span>

            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_attr</span><span class="p">([</span><span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="n">key</span><span class="p">],</span> <span class="n">value</span><span class="p">])</span>


<div class="viewcode-block" id="PyPath.add_list_eattr"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.add_list_eattr">[docs]</a>    <span class="k">def</span> <span class="nf">add_list_eattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edge</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Merges (or creates) a given edge attribute as [list].</span>

<span class="sd">        :arg int edge:</span>
<span class="sd">            Edge index where the given attribute value is to be merged</span>
<span class="sd">            or created.</span>
<span class="sd">        :arg str attr:</span>
<span class="sd">            The name of the attribute. If such attribute does not exist</span>
<span class="sd">            in the network edges, it will be created on all edges (as an</span>
<span class="sd">            empty [list], *value* will only be assigned to the given</span>
<span class="sd">            *edge*).</span>
<span class="sd">        :arg list value:</span>
<span class="sd">            The value of the attribute to be assigned/merged.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="n">value</span><span class="p">]</span>
        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">attr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">())]</span>

        <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">]]</span>

        <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">uniq_list</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">+</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.add_set_eattr"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.add_set_eattr">[docs]</a>    <span class="k">def</span> <span class="nf">add_set_eattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edge</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Merges (or creates) a given edge attribute as [set].</span>

<span class="sd">        :arg int edge:</span>
<span class="sd">            Edge index where the given attribute value is to be merged</span>
<span class="sd">            or created.</span>
<span class="sd">        :arg str attr:</span>
<span class="sd">            The name of the attribute. If such attribute does not exist</span>
<span class="sd">            in the network edges, it will be created on all edges (as an</span>
<span class="sd">            empty [set], *value* will only be assigned to the given</span>
<span class="sd">            *edge*).</span>
<span class="sd">        :arg set value:</span>
<span class="sd">            The value of the attribute to be assigned/merged.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">value</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">to_set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">attr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="nb">set</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">())</span>
            <span class="p">]</span>
        <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">],</span> <span class="nb">set</span><span class="p">):</span>

            <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">to_set</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">])</span>

        <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.add_grouped_eattr"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.add_grouped_eattr">[docs]</a>    <span class="k">def</span> <span class="nf">add_grouped_eattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edge</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Merges (or creates) a given edge attribute as [dict] of [list]</span>
<span class="sd">        values.</span>

<span class="sd">        :arg int edge:</span>
<span class="sd">            Edge index where the given attribute value is to be merged</span>
<span class="sd">            or created.</span>
<span class="sd">        :arg str attr:</span>
<span class="sd">            The name of the attribute. If such attribute does not exist</span>
<span class="sd">            in the network edges, it will be created on all edges (as an</span>
<span class="sd">            empty [dict], *value* will only be assigned to the given</span>
<span class="sd">            *edge* and *group*).</span>
<span class="sd">        :arg str group:</span>
<span class="sd">            The key of the attribute dictionary where *value* is to be</span>
<span class="sd">            assigned.</span>
<span class="sd">        :arg list value:</span>
<span class="sd">            The value of the attribute to be assigned/merged.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="n">value</span><span class="p">]</span>
        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">attr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">())]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">group</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="n">group</span><span class="p">],</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="n">group</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="n">group</span><span class="p">]]</span>

        <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">uniq_list</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="n">group</span><span class="p">]</span> <span class="o">+</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.add_grouped_set_eattr"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.add_grouped_set_eattr">[docs]</a>    <span class="k">def</span> <span class="nf">add_grouped_set_eattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edge</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Merges (or creates) a given edge attribute as [dict] of [set]</span>
<span class="sd">        values.</span>

<span class="sd">        :arg int edge:</span>
<span class="sd">            Edge index where the given attribute value is to be merged</span>
<span class="sd">            or created.</span>
<span class="sd">        :arg str attr:</span>
<span class="sd">            The name of the attribute. If such attribute does not exist</span>
<span class="sd">            in the network edges, it will be created on all edges (as an</span>
<span class="sd">            empty [dict], *value* will only be assigned to the given</span>
<span class="sd">            *edge* and *group*).</span>
<span class="sd">        :arg str group:</span>
<span class="sd">            The key of the attribute dictionary where *value* is to be</span>
<span class="sd">            assigned.</span>
<span class="sd">        :arg set value:</span>
<span class="sd">            The value of the attribute to be assigned/merged.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">set</span><span class="p">)</span> <span class="k">else</span> <span class="nb">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                 <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="nb">set</span><span class="p">([</span><span class="n">value</span><span class="p">]))</span>
        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">attr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">())]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">group</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="n">group</span><span class="p">],</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="n">group</span><span class="p">],</span> <span class="nb">set</span><span class="p">):</span>
            <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="n">group</span><span class="p">])</span>
                              <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="n">group</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span>
                              <span class="k">else</span> <span class="nb">set</span><span class="p">([</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="n">group</span><span class="p">]]))</span>

        <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">][</span><span class="n">group</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.get_directed"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.get_directed">[docs]</a>    <span class="k">def</span> <span class="nf">get_directed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">conv_edges</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mutual</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">ret</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts a copy of *graph* undirected *igraph.Graph* object to a</span>
<span class="sd">        directed one. By default it converts the current network</span>
<span class="sd">        instance in :py:attr:`pypath.main.PyPath.graph` and places the</span>
<span class="sd">        copy of the directed instance in</span>
<span class="sd">        :py:attr:`pypath.main.PyPath.dgraph`.</span>

<span class="sd">        :arg igraph.Graph graph:</span>
<span class="sd">            Optional, ``None`` by default. Undirected graph object. If</span>
<span class="sd">            none is passed, takes the current undirected network</span>
<span class="sd">            instance and saves the directed network under the attribute</span>
<span class="sd">            :py:attr:`pypath.main.PyPath.dgraph`. Otherwise, the</span>
<span class="sd">            directed graph will be returned instead.</span>
<span class="sd">        :arg bool conv_edges:</span>
<span class="sd">            Optional, ``False`` by default. Whether to convert</span>
<span class="sd">            undirected edges (those without explicit direction</span>
<span class="sd">            information) to an arbitrary direction edge or</span>
<span class="sd">            a pair of opposite edges. Otherwise those will be deleted.</span>
<span class="sd">        :arg bool mutual:</span>
<span class="sd">            Optional, ``False`` by default. If *conv_edges* is ``True``,</span>
<span class="sd">            whether to convert the undirected edges to a single,</span>
<span class="sd">            arbitrary directed edge, or a pair of opposite directed</span>
<span class="sd">            edges.</span>
<span class="sd">        :arg bool ret:</span>
<span class="sd">            Optional, ``False`` by default. Whether to return the</span>
<span class="sd">            directed graph instance, or not. If a *graph* is provided,</span>
<span class="sd">            its directed version will be returned anyway.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*igraph.Graph*) -- If *graph* is passed or *ret* is</span>
<span class="sd">            ``True``, returns the copy of the directed graph. otherwise</span>
<span class="sd">            returns ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Creating directed network object.&#39;</span><span class="p">)</span>

        <span class="n">toDel</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">graph</span> <span class="k">else</span> <span class="n">graph</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">as_directed</span><span class="p">(</span><span class="n">mutual</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="n">d</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;directed_sources&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">ecount</span><span class="p">())]</span>
        <span class="n">d</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;undirected_sources&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">ecount</span><span class="p">())]</span>
        <span class="n">d</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;directed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">ecount</span><span class="p">())]</span>
        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span>
            <span class="n">total</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">ecount</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Setting directions&quot;</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            This works because in directed graphs get_eid() defaults to</span>
<span class="sd">            directed = True, so the source -&gt; target edge is returned.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">dir_one</span> <span class="o">=</span> <span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">],</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">])</span>
            <span class="n">dir_two</span> <span class="o">=</span> <span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">],</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">])</span>
            <span class="n">dir_edge_one</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span>
                <span class="n">d</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">]),</span>
                <span class="n">d</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">]))</span>
            <span class="n">dir_edge_two</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span>
                <span class="n">d</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">]),</span>
                <span class="n">d</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">]))</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span><span class="n">dir_one</span><span class="p">):</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">conv_edges</span> <span class="ow">or</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span><span class="n">dir_two</span><span class="p">):</span>
                    <span class="n">toDel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dir_edge_one</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">d</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">dir_edge_one</span><span class="p">][</span><span class="s1">&#39;directed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">d</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">dir_edge_one</span><span class="p">][</span><span class="s1">&#39;directed_sources&#39;</span><span class="p">]</span> <span class="o">+=</span> \
                    <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span><span class="n">dir_one</span><span class="p">,</span> <span class="n">sources</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">d</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">dir_edge_one</span><span class="p">][</span><span class="s1">&#39;undirected_sources&#39;</span><span class="p">]</span> <span class="o">+=</span> \
                    <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span><span class="s1">&#39;undirected&#39;</span><span class="p">,</span> <span class="n">sources</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span><span class="n">dir_two</span><span class="p">):</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">conv_edges</span> <span class="ow">or</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span><span class="n">dir_one</span><span class="p">):</span>
                    <span class="n">toDel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dir_edge_two</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">d</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">dir_edge_two</span><span class="p">][</span><span class="s1">&#39;directed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">d</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">dir_edge_two</span><span class="p">][</span><span class="s1">&#39;directed_sources&#39;</span><span class="p">]</span> <span class="o">+=</span> \
                    <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span><span class="n">dir_two</span><span class="p">,</span> <span class="n">sources</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">d</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">dir_edge_two</span><span class="p">][</span><span class="s1">&#39;undirected_sources&#39;</span><span class="p">]</span> <span class="o">+=</span> \
                    <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span><span class="s1">&#39;undirected&#39;</span><span class="p">,</span> <span class="n">sources</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span><span class="s1">&#39;undirected&#39;</span><span class="p">)</span> <span class="ow">and</span> \
                <span class="ow">not</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span><span class="n">dir_one</span><span class="p">)</span> <span class="ow">and</span> \
                    <span class="ow">not</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span><span class="n">dir_two</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">conv_edges</span><span class="p">:</span>
                    <span class="n">d</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">dir_edge_one</span><span class="p">][</span><span class="s1">&#39;undirected_sources&#39;</span><span class="p">]</span> <span class="o">+=</span> \
                        <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span><span class="s1">&#39;undirected&#39;</span><span class="p">,</span> <span class="n">sources</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">mutual</span><span class="p">:</span>
                        <span class="n">d</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">dir_edge_two</span><span class="p">][</span><span class="s1">&#39;undirected_sources&#39;</span><span class="p">]</span> <span class="o">+=</span> \
                            <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span><span class="s1">&#39;undirected&#39;</span><span class="p">,</span> <span class="n">sources</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">toDel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dir_edge_two</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">toDel</span> <span class="o">+=</span> <span class="p">[</span><span class="n">dir_edge_one</span><span class="p">,</span> <span class="n">dir_edge_two</span><span class="p">]</span>

            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="n">d</span><span class="o">.</span><span class="n">delete_edges</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">toDel</span><span class="p">)))</span>
        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
        <span class="n">deg</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
        <span class="n">toDel</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">deg</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">toDel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodInd</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">toDel</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">d</span><span class="o">.</span><span class="n">delete_vertices</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">toDel</span><span class="p">)))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">graph</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">dgraph</span> <span class="o">=</span> <span class="n">d</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_directed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgraph</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_directed</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_undirected</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Directed igraph object created.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">graph</span> <span class="ow">or</span> <span class="n">ret</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">d</span></div>


<div class="viewcode-block" id="PyPath.new_edges"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.new_edges">[docs]</a>    <span class="k">def</span> <span class="nf">new_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds new edges from any iterable of edges to the undirected</span>
<span class="sd">        graph. Basically, calls :py:meth:`igraph.Graph.add_edges`.</span>

<span class="sd">        :arg list edges:</span>
<span class="sd">            Contains the edges that are to be added to the network.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">edges</span><span class="p">))</span></div>


<div class="viewcode-block" id="PyPath.new_nodes"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.new_nodes">[docs]</a>    <span class="k">def</span> <span class="nf">new_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds new nodes from any iterable of nodes to the undirected</span>
<span class="sd">        graph. Basically, calls :py:meth:`igraph.Graph.add_vertices`.</span>

<span class="sd">        :arg list nodes:</span>
<span class="sd">            Contains the nodes that are to be added to the network.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">add_vertices</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">nodes</span><span class="p">))</span></div>

<div class="viewcode-block" id="PyPath.edge_exists"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.edge_exists">[docs]</a>    <span class="k">def</span> <span class="nf">edge_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a tuple of vertex indices if edge doesn&#39;t exist,</span>
<span class="sd">        otherwise, the edge ID. Not sensitive to direction.</span>

<span class="sd">        :arg str id_a:</span>
<span class="sd">            Name of the source node.</span>
<span class="sd">        :arg str id_b:</span>
<span class="sd">            Name of the target node.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*int*) -- The edge index, if exists such edge. Otherwise,</span>
<span class="sd">            [tuple] of [int] corresponding to the node IDs.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;nodDct&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>

        <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">id_a</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">id_b</span><span class="p">]]</span>
        <span class="n">edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">error</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">edge</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">edge</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">nodes</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">nodes</span></div>


<div class="viewcode-block" id="PyPath.edge_names"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.edge_names">[docs]</a>    <span class="k">def</span> <span class="nf">edge_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the node names of a given edge.</span>

<span class="sd">        :arg int e:</span>
<span class="sd">            The edge index.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*tuple*) -- Contains the source and target node names of</span>
<span class="sd">            the edge [str].</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span></div>


<div class="viewcode-block" id="PyPath.node_exists"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.node_exists">[docs]</a>    <span class="k">def</span> <span class="nf">node_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if a node exists in the (undirected) network.</span>

<span class="sd">        :arg str name:</span>
<span class="sd">            The name of the node to be searched.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*bool*) -- Whether the node exists in the network or not.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;nodInd&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodInd</span></div>

<div class="viewcode-block" id="PyPath.names2vids"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.names2vids">[docs]</a>    <span class="k">def</span> <span class="nf">names2vids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        From a list of node names, returns their corresponding indices.</span>

<span class="sd">        :arg list names:</span>
<span class="sd">            Contains the node names [str] for which the IDs are to be</span>
<span class="sd">            searched.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*list*) -- The queried node IDs [int].</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">vids</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;nodInd&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodInd</span><span class="p">:</span>
                <span class="n">vids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">vids</span></div>

    <span class="c1"># XXX: this function name may lead to some confusion with get_edge() method</span>
    <span class="c1">#      also, leading underscore makes the method private (is this intended?)</span>
    <span class="k">def</span> <span class="nf">_get_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the edge index only if there is such an edge from</span>
<span class="sd">        *nodes*[0] to *nodes*[1], returns ``False```otherwise (e.g.: if</span>
<span class="sd">        edge exists in the opposite direction, no such edge exists or</span>
<span class="sd">        any of the vertex ids doesn&#39;t exist). To find edges regardless</span>
<span class="sd">        of their direction, see</span>
<span class="sd">        :py:meth:`pypath.main.PyPath.edge_exists`.</span>

<span class="sd">        :arg tuple nodes:</span>
<span class="sd">            Or [list], contains the node IDs [int] where the first</span>
<span class="sd">            element is the source and the second one the target.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*int*) -- The edge ID if it exists, ``False`` otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">e</span>

        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

<div class="viewcode-block" id="PyPath.straight_between"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.straight_between">[docs]</a>    <span class="k">def</span> <span class="nf">straight_between</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Finds an edge between the provided node names.</span>

<span class="sd">        :arg str id_a:</span>
<span class="sd">            The name of the source node.</span>
<span class="sd">        :arg str id_b:</span>
<span class="sd">            The name of the target node.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*int*) -- The edge ID. If the edge doesn&#39;t exist, returns</span>
<span class="sd">            [list] with the node indices [int].</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">nodNm</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span><span class="p">])</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">nodNm</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">nodNm</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
        <span class="n">edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_edge</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">edge</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">edge</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">nodes</span></div>

    <span class="c1"># XXX: Not sure if the intended behavior, according to old description:</span>
    <span class="c1"># &quot;&quot;&quot;</span>
    <span class="c1"># Returns all edges between two given vertex names. Similar to</span>
    <span class="c1"># straight_between(), but checks both directions, and returns</span>
    <span class="c1"># list of edge ids in [undirected, straight, reversed] format,</span>
    <span class="c1"># for both id_a -&gt; id_b and id_b -&gt; id_a edges.</span>
    <span class="c1"># &quot;&quot;&quot;</span>
    <span class="c1"># Just returns A SINGLE edge ID assigned according to the &#39;dirs&#39; attribute</span>
    <span class="c1"># on a position of the dict and list</span>

<div class="viewcode-block" id="PyPath.all_between"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.all_between">[docs]</a>    <span class="k">def</span> <span class="nf">all_between</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks for any edges (in any direction) between the provided</span>
<span class="sd">        nodes.</span>

<span class="sd">        :arg str id_a:</span>
<span class="sd">            The name of the source node.</span>
<span class="sd">        :arg str id_b:</span>
<span class="sd">            The name of the target node.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*dict*) -- Contains information on the directionality of</span>
<span class="sd">            the requested edge. Keys are ``&#39;ab&#39;`` and ``&#39;ba&#39;``, denoting</span>
<span class="sd">            the straight/reverse directionalities respectively. Values</span>
<span class="sd">            are [list] whose elements are the edge ID or ``None``</span>
<span class="sd">            according to the existance of that edge in the following</span>
<span class="sd">            categories: undirected, straight and reverse (in that</span>
<span class="sd">            order).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ab&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="s1">&#39;ba&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]}</span>
        <span class="n">eid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_exists</span><span class="p">(</span><span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">][</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span><span class="s1">&#39;undirected&#39;</span><span class="p">):</span>
                <span class="n">edges</span><span class="p">[</span><span class="s1">&#39;ab&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">eid</span>
                <span class="n">edges</span><span class="p">[</span><span class="s1">&#39;ba&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">eid</span>

            <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">][</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_dir</span><span class="p">((</span><span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span><span class="p">)):</span>
                <span class="n">edges</span><span class="p">[</span><span class="s1">&#39;ab&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">eid</span>
                <span class="n">edges</span><span class="p">[</span><span class="s1">&#39;ba&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">eid</span>

            <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">][</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_dir</span><span class="p">((</span><span class="n">id_b</span><span class="p">,</span> <span class="n">id_a</span><span class="p">)):</span>
                <span class="n">edges</span><span class="p">[</span><span class="s1">&#39;ab&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">eid</span>
                <span class="n">edges</span><span class="p">[</span><span class="s1">&#39;ba&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">eid</span>

        <span class="k">return</span> <span class="n">edges</span></div>

<div class="viewcode-block" id="PyPath.get_node_pair"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.get_node_pair">[docs]</a>    <span class="k">def</span> <span class="nf">get_node_pair</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the node IDs from a pair of node names.</span>

<span class="sd">        :arg str id_a:</span>
<span class="sd">            Name of the source node.</span>
<span class="sd">        :arg str id_b:</span>
<span class="sd">            Name of the target node.</span>
<span class="sd">        :arg bool directed:</span>
<span class="sd">            Optional, ``False`` by default. Whether to return the node</span>
<span class="sd">            indices from the directed or undirected graph.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*tuple*) -- The pair of node IDs of the selected graph.</span>
<span class="sd">            If not found, returns ``False``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;nodDct&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_directed</span> <span class="k">if</span> <span class="n">directed</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_undirected</span>
        <span class="n">nodDct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodDct</span> <span class="k">if</span> <span class="n">directed</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">directed</span> <span class="k">else</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span><span class="p">])</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">nodeA</span> <span class="o">=</span> <span class="n">nodDct</span><span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">nodeB</span> <span class="o">=</span> <span class="n">nodDct</span><span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">nodeA</span><span class="p">,</span> <span class="n">nodeB</span><span class="p">)</span>

        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="PyPath.update_attrs"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.update_attrs">[docs]</a>    <span class="k">def</span> <span class="nf">update_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the node and edge attributes. Note that no data is</span>
<span class="sd">        donwloaded, mainly updates the dictionaries of attributes</span>
<span class="sd">        :py:attr:`pypath.main.PyPath.edgeAttrs` and</span>
<span class="sd">        :py:attr:`pypath.main.PyPath.vertexAttrs` containing the</span>
<span class="sd">        attributes names and their correspoding types and initializes</span>
<span class="sd">        such attributes in the network nodes/edges if they weren&#39;t.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="n">types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="nb">set</span><span class="p">([</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]))</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">types</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                    <span class="s1">&#39;Vertex attribute `</span><span class="si">%s</span><span class="s1">` has multiple types of&#39;</span>
                    <span class="s1">&#39; values: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">attr</span><span class="p">,</span>
                        <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">types</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">types</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Vertex attribute `</span><span class="si">%s</span><span class="s1">` has only None values&#39;</span> <span class="o">%</span> <span class="n">attr</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">types</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

                <span class="k">if</span> <span class="nb">list</span> <span class="ow">in</span> <span class="n">types</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vertexAttrs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vertexAttrs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">types</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">init_vertex_attr</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">())</span> <span class="o">-</span> <span class="nb">set</span><span class="p">([</span><span class="s1">&#39;dirs&#39;</span><span class="p">])):</span>

            <span class="n">types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="nb">set</span><span class="p">([</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]))</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">types</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                    <span class="s1">&#39;Edge attribute `</span><span class="si">%s</span><span class="s1">` has multiple types of&#39;</span>
                    <span class="s1">&#39; values: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">attr</span><span class="p">,</span>
                        <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">types</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">types</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Edge attribute `</span><span class="si">%s</span><span class="s1">` has only None values&#39;</span> <span class="o">%</span> <span class="n">attr</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">types</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

                <span class="k">if</span> <span class="nb">set</span> <span class="ow">in</span> <span class="n">types</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">edgeAttrs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span>

                <span class="k">elif</span> <span class="nb">list</span> <span class="ow">in</span> <span class="n">types</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">edgeAttrs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">edgeAttrs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">types</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">init_edge_attr</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.init_vertex_attr"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.init_vertex_attr">[docs]</a>    <span class="k">def</span> <span class="nf">init_vertex_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fills all vertices attribute *attr* with its default type (if</span>
<span class="sd">        such attribute value is ``None``), creates [list] if in</span>
<span class="sd">        :py:attr:`pypath.main.PyPath.vertexAttrs` such attribute is</span>
<span class="sd">        registered as [list].</span>

<span class="sd">        :arg str attr:</span>
<span class="sd">            The attribute name to be initialized on the network</span>
<span class="sd">            vertices.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># XXX: Doesn&#39;t handle potential KeyError</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">v</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertexAttrs</span><span class="p">[</span><span class="n">attr</span><span class="p">]()</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertexAttrs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="ow">is</span> <span class="nb">list</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">[</span>
                    <span class="n">attr</span><span class="p">])</span> <span class="ow">in</span> <span class="n">common</span><span class="o">.</span><span class="n">simple_types</span><span class="p">:</span>
                <span class="n">v</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">attr</span><span class="p">]]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">attr</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="PyPath.init_edge_attr"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.init_edge_attr">[docs]</a>    <span class="k">def</span> <span class="nf">init_edge_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fills all edges attribute *attr* with its default type (if</span>
<span class="sd">        such attribute value is ``None``), creates [list] if in</span>
<span class="sd">        :py:attr:`pypath.main.PyPath.edgeAttrs` such attribute is</span>
<span class="sd">        registered as [list].</span>

<span class="sd">        :arg str attr:</span>
<span class="sd">            The attribute name to be initialized on the network edges.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># XXX: Doesn&#39;t handle potential KeyError</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edgeAttrs</span><span class="p">[</span><span class="n">attr</span><span class="p">]()</span>

            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edgeAttrs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="ow">is</span> <span class="nb">list</span> <span class="ow">or</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">edgeAttrs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="ow">is</span> <span class="nb">set</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">[</span>
                    <span class="n">attr</span><span class="p">])</span> <span class="ow">in</span> <span class="n">common</span><span class="o">.</span><span class="n">simple_types</span><span class="p">:</span>

                <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">]]</span> <span class="k">if</span> <span class="p">(</span>
                    <span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">])</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">common</span><span class="o">.</span><span class="n">char_types</span> <span class="ow">or</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="p">[]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">edgeAttrs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="ow">is</span> <span class="nb">set</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>

                <span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">])</span></div>

    <span class="k">def</span> <span class="nf">_add_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edge_list</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">regulator</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds edges to the network from *edge_list* obtained from file or</span>
<span class="sd">        other input method. If none is passed, checks for such data in</span>
<span class="sd">        :py:attr:`pypath.main.PyPath.raw_data`.</span>

<span class="sd">        :arg str edge_list:</span>
<span class="sd">            Optional, ``False`` by default. The source name of the list</span>
<span class="sd">            of edges to be added. This must have been loaded previously</span>
<span class="sd">            (e.g.: with :py:meth:`pypath.main.PyPath.read_data_file`).</span>
<span class="sd">            If none is passed, loads the data directly from</span>
<span class="sd">            :py:attr:`pypath.main.PyPath.raw_data`.</span>
<span class="sd">        :arg bool regulator:</span>
<span class="sd">            Optional, ``False`` by default. If set to ``True``, non</span>
<span class="sd">            previously existing nodes, will not be added (and hence, the</span>
<span class="sd">            edges involved).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Adding preprocessed edge list to existing network.&#39;</span><span class="p">)</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">edge_list</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">edge_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;_add_network(): No data, nothing to do.&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">edge_list</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">edge_list</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                <span class="n">edge_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">edge_list</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                    <span class="s1">&#39;`</span><span class="si">%s</span><span class="s1">` looks like a source name, but no data &#39;</span>
                    <span class="s1">&#39;available under this name.&#39;</span> <span class="o">%</span> <span class="n">edge_list</span>
                <span class="p">)</span>

                <span class="k">return</span> <span class="kc">False</span>

        <span class="n">nodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># adding nodes and edges first in bunch,</span>
        <span class="c1"># to avoid multiple reindexing by igraph</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span>
            <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">edge_list</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Processing nodes&quot;</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edge_list</span><span class="p">:</span>
            <span class="n">aexists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s2">&quot;default_name_a&quot;</span><span class="p">])</span>
            <span class="n">bexists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s2">&quot;default_name_b&quot;</span><span class="p">])</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">aexists</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">regulator</span> <span class="ow">or</span> <span class="n">bexists</span><span class="p">):</span>
                <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s2">&quot;default_name_a&quot;</span><span class="p">])</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">bexists</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">regulator</span><span class="p">:</span>
                <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s2">&quot;default_name_b&quot;</span><span class="p">])</span>

            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_nodes</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">nodes</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;New nodes have been created (</span><span class="si">%u</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span>
            <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">edge_list</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Processing edges&#39;</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edge_list</span><span class="p">:</span>
            <span class="n">aexists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s2">&quot;default_name_a&quot;</span><span class="p">])</span>
            <span class="n">bexists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s2">&quot;default_name_b&quot;</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">aexists</span> <span class="ow">and</span> <span class="n">bexists</span><span class="p">:</span>

                <span class="n">edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_exists</span><span class="p">(</span>
                    <span class="n">e</span><span class="p">[</span><span class="s2">&quot;default_name_a&quot;</span><span class="p">],</span>
                    <span class="n">e</span><span class="p">[</span><span class="s2">&quot;default_name_b&quot;</span><span class="p">],</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">edge</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">edge</span><span class="p">))</span>

                <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_edges</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">edges</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;New edges have been created&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Introducing new node and edge attributes...&#39;</span><span class="p">)</span>
        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span>
            <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">edge_list</span><span class="p">),</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Processing attributes&#39;</span><span class="p">,</span>
            <span class="n">interval</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">nodes_updated</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edge_list</span><span class="p">:</span>
            <span class="c1"># adding new node attributes</span>

            <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;default_name_a&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nodes_updated</span><span class="p">:</span>
                <span class="n">default_attrs</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;default_name_a&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;default_name_a&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;id_type&#39;</span><span class="p">:</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;default_name_type_a&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;entity_type_a&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;ncbi_tax_id&#39;</span><span class="p">:</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;taxon_a&#39;</span><span class="p">],</span>
                <span class="p">}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_add_update_vertex</span><span class="p">(</span>
                    <span class="n">default_attrs</span><span class="p">,</span>
                    <span class="n">e</span><span class="p">[</span><span class="s1">&#39;id_a&#39;</span><span class="p">],</span>
                    <span class="n">e</span><span class="p">[</span><span class="s1">&#39;id_type_a&#39;</span><span class="p">],</span>
                    <span class="n">e</span><span class="p">[</span><span class="s1">&#39;attrs_node_a&#39;</span><span class="p">],</span>
                <span class="p">)</span>
                <span class="n">nodes_updated</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;default_name_a&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;default_name_b&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nodes_updated</span><span class="p">:</span>
                <span class="n">default_attrs</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;default_name_b&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;default_name_b&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;id_type&#39;</span><span class="p">:</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;default_name_type_b&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;entity_type_b&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;ncbi_tax_id&#39;</span><span class="p">:</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;taxon_b&#39;</span><span class="p">]</span>
                <span class="p">}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_add_update_vertex</span><span class="p">(</span>
                    <span class="n">default_attrs</span><span class="p">,</span>
                    <span class="n">e</span><span class="p">[</span><span class="s1">&#39;id_b&#39;</span><span class="p">],</span>
                    <span class="n">e</span><span class="p">[</span><span class="s1">&#39;id_type_b&#39;</span><span class="p">],</span>
                    <span class="n">e</span><span class="p">[</span><span class="s1">&#39;attrs_node_b&#39;</span><span class="p">],</span>
                <span class="p">)</span>
                <span class="n">nodes_updated</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;default_name_b&#39;</span><span class="p">])</span>

            <span class="c1"># adding new edge attributes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_update_edge</span><span class="p">(</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;default_name_a&#39;</span><span class="p">],</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;default_name_b&#39;</span><span class="p">],</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;default_name_type_a&#39;</span><span class="p">],</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;default_name_type_b&#39;</span><span class="p">],</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;entity_type_a&#39;</span><span class="p">],</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;entity_type_b&#39;</span><span class="p">],</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">],</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;evidences&#39;</span><span class="p">],</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;is_directed&#39;</span><span class="p">],</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;references&#39;</span><span class="p">],</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;stim&#39;</span><span class="p">],</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;inh&#39;</span><span class="p">],</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;taxon_a&#39;</span><span class="p">],</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;taxon_b&#39;</span><span class="p">],</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;attrs_edge&#39;</span><span class="p">],</span>
            <span class="p">)</span>

            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;New network resource added, current number &#39;</span>
            <span class="s1">&#39;of nodes: </span><span class="si">%u</span><span class="s1">, edges: </span><span class="si">%u</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_attrs</span><span class="p">()</span>


<div class="viewcode-block" id="PyPath.apply_list"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.apply_list">[docs]</a>    <span class="k">def</span> <span class="nf">apply_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">node_or_edge</span> <span class="o">=</span> <span class="s1">&#39;node&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates vertex or edge attribute based on a list.</span>

<span class="sd">        :arg str name:</span>
<span class="sd">            The name of the list to be added as attribute. Must have</span>
<span class="sd">            been previously loaded with</span>
<span class="sd">            :py:meth:`pypath.main.PyPath.load_list` or other methods.</span>
<span class="sd">            See description of :py:attr:`pypath.main.PyPath.lists`</span>
<span class="sd">            attribute for more information.</span>
<span class="sd">        :arg str node_or_edge:</span>
<span class="sd">            Optional, ``&#39;node&#39;`` by default. Whether the attribute list</span>
<span class="sd">            is to be added to the nodes or to the edges.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;No such list: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">if</span> <span class="n">node_or_edge</span> <span class="o">==</span> <span class="s2">&quot;edge&quot;</span><span class="p">:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">node_or_edge</span> <span class="o">==</span> <span class="s2">&quot;edge&quot;</span><span class="p">:</span>

                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

                    <span class="k">if</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                        <span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
                        <span class="n">e</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">name</span><span class="p">][(</span><span class="n">v</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
                                                    <span class="n">v</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">])]</span>

                    <span class="k">if</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                        <span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
                        <span class="n">e</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">name</span><span class="p">][(</span><span class="n">v</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
                                                    <span class="n">v</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">])]</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
                        <span class="n">v</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">v</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">node_or_edge</span> <span class="o">==</span> <span class="s2">&quot;edge&quot;</span><span class="p">:</span>

                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

                    <span class="k">if</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                        <span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
                        <span class="n">e</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">e</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
                        <span class="n">v</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">v</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="PyPath.merge_lists"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.merge_lists">[docs]</a>    <span class="k">def</span> <span class="nf">merge_lists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">and_or</span><span class="o">=</span><span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">func</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">):</span> <span class="c1"># XXX: kwarg func not used</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Merges two lists from :py:attr:`pypat.main.PyPath.lists`.</span>

<span class="sd">        :arg str id_a:</span>
<span class="sd">            Name of the first list to be merged.</span>
<span class="sd">        :arg str id_b:</span>
<span class="sd">            Name of the second list to be merged.</span>
<span class="sd">        :arg str name:</span>
<span class="sd">            Optional, ``None`` by default. Specifies a new name for the</span>
<span class="sd">            merged list. If none is passed, name will be set to</span>
<span class="sd">            *id_a*_*id_b*.</span>
<span class="sd">        :arg str and_or:</span>
<span class="sd">            Optional, ``&#39;and&#39;`` by default. The logic operation perfomed</span>
<span class="sd">            in the merging: ``&#39;and&#39;`` performs an union, ``&#39;or&#39;`` for</span>
<span class="sd">            the intersection.</span>
<span class="sd">        :arg bool delete:</span>
<span class="sd">            Optional, ``False`` by default. Whether to delete the</span>
<span class="sd">            former lists or not.</span>
<span class="sd">        :arg str func:</span>
<span class="sd">            Optional, ``&#39;max&#39;`` by default. Not used.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">id_a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;No such list: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">id_a</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">id_b</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;No such list: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">id_b</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">id_a</span><span class="p">,</span> <span class="n">id_b</span><span class="p">])</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">name</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_a</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_b</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">and_or</span> <span class="o">==</span> <span class="s2">&quot;and&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                    <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_a</span><span class="p">])</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_b</span><span class="p">]))</span>

            <span class="k">if</span> <span class="n">and_or</span> <span class="o">==</span> <span class="s2">&quot;or&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                    <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_a</span><span class="p">])</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_b</span><span class="p">]))</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_a</span><span class="p">],</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_b</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">if</span> <span class="n">and_or</span> <span class="o">==</span> <span class="s2">&quot;and&quot;</span><span class="p">:</span>
                <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                    <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_a</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">)</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_b</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span>
                    <span class="p">)))</span>

                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_a</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_a</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>

                    <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_b</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_b</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>

                    <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_a</span><span class="p">]</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_b</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_attr</span><span class="p">(</span>
                            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_a</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_b</span><span class="p">][</span><span class="n">k</span><span class="p">]])</span>

            <span class="k">if</span> <span class="n">and_or</span> <span class="o">==</span> <span class="s2">&quot;or&quot;</span><span class="p">:</span>
                <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                    <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_a</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_b</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span>
                    <span class="p">)))</span>

                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine_attr</span><span class="p">(</span>
                        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_a</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_b</span><span class="p">][</span><span class="n">k</span><span class="p">]])</span>

        <span class="k">if</span> <span class="n">delete</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_a</span><span class="p">]</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">id_b</span><span class="p">]</span></div>

<div class="viewcode-block" id="PyPath.save_session"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.save_session">[docs]</a>    <span class="k">def</span> <span class="nf">save_session</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the current session state into pickle dump. The file will</span>
<span class="sd">        be saved in the current working directory as</span>
<span class="sd">        ``&#39;pypath-&lt;session_id&gt;.pickle&#39;``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pickle_file</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s1">&#39;pypath-</span><span class="si">%s</span><span class="s1">.pickle&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">session_mod</span><span class="o">.</span><span class="n">get_session</span><span class="p">()</span><span class="o">.</span><span class="n">label</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s2">&quot;Saving session to </span><span class="si">%s</span><span class="s2">... &quot;</span> <span class="o">%</span> <span class="n">pickle_file</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pickle_file</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span></div>

    <span class="c1">###</span>
    <span class="c1"># functions for plotting // with custom typeface ;)</span>
    <span class="c1">###</span>

    <span class="c1">#</span>
    <span class="c1"># functions to compare networks and pathways</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="PyPath.databases_similarity"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.databases_similarity">[docs]</a>    <span class="k">def</span> <span class="nf">databases_similarity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;simpson&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the similarity across databases according to a given</span>
<span class="sd">        index metric. Computes the similarity across the loaded</span>
<span class="sd">        resources (listed in :py:attr:`pypath.main.PyPath.sources` in</span>
<span class="sd">        terms of nodes and edges separately.</span>

<span class="sd">        :arg str index:</span>
<span class="sd">            Optional, ``&#39;simpson&#39;`` by default. The type of index metric</span>
<span class="sd">            to use to compute the similarity. Options are ``&#39;simpson&#39;``,</span>
<span class="sd">            ``&#39;sorensen&#39;`` and ``&#39;jaccard&#39;``.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*dict*) -- Nested dictionaries (three levels). First-level</span>
<span class="sd">            keys are ``&#39;nodes&#39;`` and ``&#39;edges&#39;``, then second and third</span>
<span class="sd">            levels correspond to sources names which map to the</span>
<span class="sd">            similarity index between those sources [float].</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_sources</span><span class="p">()</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">s</span><span class="p">,</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]])</span>
                      <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">])</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">s</span><span class="p">,</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]])</span>
                      <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">])</span>
        <span class="n">sNodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">similarity_groups</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
        <span class="n">sEdges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">similarity_groups</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;nodes&#39;</span><span class="p">:</span> <span class="n">sNodes</span><span class="p">,</span> <span class="s1">&#39;edges&#39;</span><span class="p">:</span> <span class="n">sEdges</span><span class="p">}</span></div>

<div class="viewcode-block" id="PyPath.similarity_groups"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.similarity_groups">[docs]</a>    <span class="k">def</span> <span class="nf">similarity_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;simpson&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the similarity index across the given *groups*.</span>

<span class="sd">        :arg dict groups:</span>
<span class="sd">            Contains the different group names [str] as keys and their</span>
<span class="sd">            corresponding elements [set].</span>
<span class="sd">        :arg str index:</span>
<span class="sd">            Optional, ``&#39;simpson&#39;`` by default. The type of index metric</span>
<span class="sd">            to use to compute the similarity. Options are ``&#39;simpson&#39;``,</span>
<span class="sd">            ``&#39;sorensen&#39;`` and ``&#39;jaccard&#39;``.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*dict*) -- Dictionary of dictionaries containing the groups</span>
<span class="sd">            names [str] as keys (for both inner and outer dictionaries)</span>
<span class="sd">            and the index metric as inner value [float] between those</span>
<span class="sd">            groups.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">index_func</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_index&#39;</span> <span class="o">%</span> <span class="n">index</span>
        <span class="c1"># these are imported into globals() from common:</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.common&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__module__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]],</span>
                   <span class="n">index_func</span><span class="p">):</span>
            <span class="n">to_call</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.common&#39;</span> <span class="o">%</span>
                                          <span class="bp">self</span><span class="o">.</span><span class="vm">__module__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]],</span>
                              <span class="n">index_func</span><span class="p">)</span>
            <span class="n">grs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">groups</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">sor</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">g</span><span class="p">,</span> <span class="p">{})</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">grs</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">g1</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">grs</span><span class="p">)):</span>

                <span class="k">for</span> <span class="n">g2</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">grs</span><span class="p">)):</span>
                    <span class="n">sor</span><span class="p">[</span><span class="n">grs</span><span class="p">[</span><span class="n">g1</span><span class="p">]][</span><span class="n">grs</span><span class="p">[</span><span class="n">g2</span><span class="p">]]</span> <span class="o">=</span> <span class="n">to_call</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="n">grs</span><span class="p">[</span><span class="n">g1</span><span class="p">]],</span>
                                                    <span class="n">groups</span><span class="p">[</span><span class="n">grs</span><span class="p">[</span><span class="n">g2</span><span class="p">]])</span>
                    <span class="n">sor</span><span class="p">[</span><span class="n">grs</span><span class="p">[</span><span class="n">g2</span><span class="p">]][</span><span class="n">grs</span><span class="p">[</span><span class="n">g1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">sor</span><span class="p">[</span><span class="n">grs</span><span class="p">[</span><span class="n">g1</span><span class="p">]][</span><span class="n">grs</span><span class="p">[</span><span class="n">g2</span><span class="p">]]</span>

            <span class="k">return</span> <span class="n">sor</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;No such function: </span><span class="si">%s</span><span class="s1">()&#39;</span> <span class="o">%</span> <span class="n">index_func</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.sorensen_pathways"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.sorensen_pathways">[docs]</a>    <span class="k">def</span> <span class="nf">sorensen_pathways</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pwlist</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the Sorensen&#39;s similarity index across nodes and edges</span>
<span class="sd">        for the given list of pathway sources (all loaded pathway</span>
<span class="sd">        sources by default).</span>

<span class="sd">        :arg list pwlist:</span>
<span class="sd">            Optional, ``None`` by default. The list of pathway sources</span>
<span class="sd">            to be compared.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*dict*) -- Nested dictionaries (three levels). First-level</span>
<span class="sd">            keys are ``&#39;nodes&#39;`` and ``&#39;edges&#39;``, then second and third</span>
<span class="sd">            levels correspond to ``&lt;source&gt;__&lt;patwhay&gt;`` names which map</span>
<span class="sd">            to the similarity index between those pathways [float].</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">if</span> <span class="n">pwlist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_pathway_types</span><span class="p">()</span>
            <span class="n">pwlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathway_types</span>

        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pwlist</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">p</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;No such vertex attribute: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">p</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>

        <span class="n">edges</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># Keys = &lt;source&gt;__&lt;pathway&gt;, values = lsit of edge IDs</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># Keys = &lt;source&gt;__&lt;pathway&gt;, values = lsit of node IDs</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>
            <span class="n">indA</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">source</span>
            <span class="n">indB</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span>
            <span class="n">pwsA</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">pwsB</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pwlist</span><span class="p">:</span> <span class="c1"># p is &#39;&lt;source&gt;_pathways&#39;</span>

                <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">indA</span><span class="p">][</span><span class="n">p</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># pw is &#39;&lt;patwhay&gt;&#39; from in node[p]</span>
                    <span class="k">for</span> <span class="n">pw</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">indA</span><span class="p">][</span><span class="n">p</span><span class="p">]:</span>
                        <span class="n">thisPw</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_pathways&quot;</span><span class="p">,</span> <span class="s2">&quot;__&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">pw</span>

                        <span class="k">if</span> <span class="n">thisPw</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
                            <span class="n">nodes</span><span class="p">[</span><span class="n">thisPw</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                        <span class="n">nodes</span><span class="p">[</span><span class="n">thisPw</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indA</span><span class="p">)</span>
                        <span class="n">pwsA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisPw</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">indB</span><span class="p">][</span><span class="n">p</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                    <span class="k">for</span> <span class="n">pw</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">indB</span><span class="p">][</span><span class="n">p</span><span class="p">]:</span>
                        <span class="n">thisPw</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_pathways&quot;</span><span class="p">,</span> <span class="s2">&quot;__&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">pw</span>

                        <span class="k">if</span> <span class="n">thisPw</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
                            <span class="n">nodes</span><span class="p">[</span><span class="n">thisPw</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                        <span class="n">nodes</span><span class="p">[</span><span class="n">thisPw</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indB</span><span class="p">)</span>
                        <span class="n">pwsB</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thisPw</span><span class="p">)</span>

            <span class="n">pwsE</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">pwsA</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">pwsB</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">pw</span> <span class="ow">in</span> <span class="n">pwsE</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">pw</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
                    <span class="n">edges</span><span class="p">[</span><span class="n">pw</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="n">edges</span><span class="p">[</span><span class="n">pw</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="n">sNodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">similarity_groups</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;sorensen&#39;</span><span class="p">)</span>
        <span class="n">sEdges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">similarity_groups</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;sorensen&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="n">sNodes</span><span class="p">,</span> <span class="s2">&quot;edges&quot;</span><span class="p">:</span> <span class="n">sEdges</span><span class="p">}</span></div>

<div class="viewcode-block" id="PyPath.write_table"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.write_table">[docs]</a>    <span class="k">def</span> <span class="nf">write_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tbl</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cut</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">rownames</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes a given table to a file.</span>

<span class="sd">        :arg dict tbl:</span>
<span class="sd">            Contains the data of the table. It is assumed that keys are</span>
<span class="sd">            the row names [str] and the values, well, values. Column</span>
<span class="sd">            names (if any) are defined with the key ``&#39;header&#39;``.</span>
<span class="sd">        :arg str outfile:</span>
<span class="sd">            File name where to save the table. The file will be saved</span>
<span class="sd">            under the object&#39;s :py:attr:`pypath.main.PyPath.outdir`</span>
<span class="sd">            (``&#39;results&#39;`` by default).</span>
<span class="sd">        :arg str sep:</span>
<span class="sd">            Optional, ``&#39;\t&#39;`` (tab) by default. Specifies the separator</span>
<span class="sd">            for the file.</span>
<span class="sd">        :arg int cut:</span>
<span class="sd">            Optional, ``None`` by default. Specifies the maximum number</span>
<span class="sd">            of characters for the row names.</span>
<span class="sd">        :arg bool colnames:</span>
<span class="sd">            Optional, ``True`` by default. Specifies whether to write</span>
<span class="sd">            the column names in the file or not.</span>
<span class="sd">        :arg bool rownames:</span>
<span class="sd">            Optional, ``True`` by default. Specifies whether to write</span>
<span class="sd">            the row names in the file or not.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">out</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">rn</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tbl</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="k">if</span> <span class="s2">&quot;header&quot;</span> <span class="ow">in</span> <span class="n">rn</span><span class="p">:</span>
            <span class="n">cn</span> <span class="o">=</span> <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;header&quot;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">tbl</span><span class="p">[</span><span class="s2">&quot;header&quot;</span><span class="p">]</span>
            <span class="n">rn</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;header&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">cn</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tbl</span><span class="p">[</span><span class="n">rn</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))]</span>

        <span class="k">if</span> <span class="n">colnames</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">rownames</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">+=</span> <span class="n">sep</span>

            <span class="n">out</span> <span class="o">+=</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cn</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rn</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">rownames</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="n">cut</span><span class="p">]</span> <span class="o">+</span> <span class="n">sep</span>

            <span class="n">thisRow</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tbl</span><span class="p">[</span><span class="n">r</span><span class="p">]]</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">thisRow</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outdir</span><span class="p">,</span> <span class="n">outfile</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.search_attr_or"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.search_attr_or">[docs]</a>    <span class="k">def</span> <span class="nf">search_attr_or</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">lst</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Searches a given collection of attributes in a given object. As</span>
<span class="sd">        soon as one item is found, returns ``True``, if none could be</span>
<span class="sd">        found then returns ``False``.</span>

<span class="sd">        :arg object obj:</span>
<span class="sd">            Object (dictionary-like) where to search for elements of</span>
<span class="sd">            *lst*.</span>
<span class="sd">        :arg dict lst:</span>
<span class="sd">            Keys are the attribute names [str] and values the collection</span>
<span class="sd">            of elements to be searched in such attribute [set].</span>

<span class="sd">        :return:</span>
<span class="sd">            (*bool*) -- ``True`` if *lst* is empty or any of its</span>
<span class="sd">            elements is found in *obj*. Returns only ``False`` if cannot</span>
<span class="sd">            find anything.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span> <span class="c1"># XXX: Why call it lst if it&#39;s dict?</span>

            <span class="k">if</span> <span class="p">((</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="n">a</span><span class="p">])</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">==</span> <span class="n">v</span><span class="p">)):</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="PyPath.search_attr_and"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.search_attr_and">[docs]</a>    <span class="k">def</span> <span class="nf">search_attr_and</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">lst</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Searches a given collection of attributes in a given object.</span>
<span class="sd">        Only returns ``True``, if all elements of *lst* can be found in</span>
<span class="sd">        *obj*.</span>

<span class="sd">        :arg object obj:</span>
<span class="sd">            Object (dictionary-like) where to search for elements of</span>
<span class="sd">            *lst*.</span>
<span class="sd">        :arg dict lst:</span>
<span class="sd">            Keys are the attribute names [str] and values the collection</span>
<span class="sd">            of elements to be searched in such attribute [set].</span>

<span class="sd">        :return:</span>
<span class="sd">            (*bool*) -- ``True`` only if *lst* is empty or all of its</span>
<span class="sd">            elements are found in *obj*. Returns ``False`` otherwise (as</span>
<span class="sd">            soon as one element of *lst* is not found).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span> <span class="c1"># XXX: Why call it lst if it&#39;s dict?</span>

            <span class="k">if</span> <span class="p">((</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="n">a</span><span class="p">])</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">!=</span> <span class="n">v</span><span class="p">)):</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="PyPath.get_sub"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.get_sub">[docs]</a>    <span class="k">def</span> <span class="nf">get_sub</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crit</span><span class="p">,</span> <span class="n">andor</span><span class="o">=</span><span class="s2">&quot;or&quot;</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects the nodes from *graph* (and edges to be removed)</span>
<span class="sd">        according to a set of user-defined attributes.</span>

<span class="sd">        :arg dict crit:</span>
<span class="sd">            Defines the critical attributes to generate the subnetwork.</span>
<span class="sd">            Keys are ``&#39;edge&#39;`` and ``&#39;node&#39;`` and values are [dict]</span>
<span class="sd">            containing the critical attribute names [str] and values</span>
<span class="sd">            are [set] containing those attributes of the nodes/edges</span>
<span class="sd">            that are to be kept.</span>
<span class="sd">        :arg str andor:</span>
<span class="sd">            Optional, ``&#39;or&#39;`` by default. Determines the search mode.</span>
<span class="sd">            See :py:meth:`pypath.main.PyPath.search_attr_or` and</span>
<span class="sd">            :py:meth:`pypath.main.PyPath.search_attr_and` for more</span>
<span class="sd">            details.</span>
<span class="sd">        :arg igraph.Graph graph:</span>
<span class="sd">            Optional, ``None`` by default. The graph object where to</span>
<span class="sd">            extract the subnetwork. If none is passed, takes the current</span>
<span class="sd">            network (undirected) graph</span>
<span class="sd">            (:py:attr:`pypath.main.PyPath.graph`).</span>

<span class="sd">        :return:</span>
<span class="sd">            (*dict*) -- Keys are ``&#39;nodes&#39;`` and ``&#39;edges&#39;`` whose</span>
<span class="sd">            values are [lst] of elements (as indexes [int]). Nodes are</span>
<span class="sd">            those to be kept and edges to be removed on the extracted</span>
<span class="sd">            subnetwork.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">graph</span>
        <span class="n">keepV</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">delE</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">andor</span> <span class="o">==</span> <span class="s2">&quot;and&quot;</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>
                <span class="n">keepThis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_attr_and</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">crit</span><span class="p">[</span><span class="s2">&quot;edge&quot;</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">keepThis</span><span class="p">:</span>
                    <span class="n">keepA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_attr_and</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">],</span> <span class="n">crit</span><span class="p">[</span><span class="s2">&quot;node&quot;</span><span class="p">])</span>

                    <span class="k">if</span> <span class="n">keepA</span><span class="p">:</span>
                        <span class="n">keepV</span> <span class="o">+=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">]</span>

                    <span class="n">keepB</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_attr_and</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">],</span> <span class="n">crit</span><span class="p">[</span><span class="s2">&quot;node&quot;</span><span class="p">])</span>

                    <span class="k">if</span> <span class="n">keepB</span><span class="p">:</span>
                        <span class="n">keepV</span> <span class="o">+=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">]</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="n">keepA</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">keepB</span><span class="p">:</span>
                        <span class="n">delE</span> <span class="o">+=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">delE</span> <span class="o">+=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>
                <span class="n">keepThis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_attr_or</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">crit</span><span class="p">[</span><span class="s2">&quot;edge&quot;</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">keepThis</span><span class="p">:</span>
                    <span class="n">keepV</span> <span class="o">+=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">]</span>
                    <span class="k">continue</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">delE</span> <span class="o">+=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">crit</span><span class="p">[</span><span class="s2">&quot;node&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">keepA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_attr_or</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">],</span> <span class="n">crit</span><span class="p">[</span><span class="s2">&quot;node&quot;</span><span class="p">])</span>

                    <span class="k">if</span> <span class="n">keepA</span><span class="p">:</span>
                        <span class="n">keepV</span> <span class="o">+=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">]</span>

                    <span class="n">keepB</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_attr_or</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">],</span> <span class="n">crit</span><span class="p">[</span><span class="s2">&quot;node&quot;</span><span class="p">])</span>

                    <span class="k">if</span> <span class="n">keepB</span><span class="p">:</span>
                        <span class="n">keepV</span> <span class="o">+=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">keepV</span><span class="p">)),</span> <span class="s2">&quot;edges&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">delE</span><span class="p">))}</span></div>

<div class="viewcode-block" id="PyPath.edgeseq_inverse"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.edgeseq_inverse">[docs]</a>    <span class="k">def</span> <span class="nf">edgeseq_inverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the sequence of all edge indexes that are not in</span>
<span class="sd">        the argument *edges*.</span>

<span class="sd">        :arg set edges:</span>
<span class="sd">            Sequence of edge indices [int] that will not be returned.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*list*) -- Contains all edge indices [int] of the</span>
<span class="sd">            undirected network except the ones on *edges* argument.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">inv</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># XXX: This could be refactored with a list comprehension:</span>
        <span class="c1"># return [e.index for e in g.es if e.index not in set(edges)]</span>
        <span class="c1"># also, assuming edges index is always == range(g.ecount()):</span>
        <span class="c1"># return set(range(g.ecount())) - set(edges)</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">index</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">edges</span><span class="p">):</span>
                <span class="n">inv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">inv</span></div>

<div class="viewcode-block" id="PyPath.get_network"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.get_network">[docs]</a>    <span class="k">def</span> <span class="nf">get_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crit</span><span class="p">,</span> <span class="n">andor</span><span class="o">=</span><span class="s2">&quot;or&quot;</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves a subnetwork according to a set of user-defined</span>
<span class="sd">        attributes. Basically applies</span>
<span class="sd">        :py:meth:`pypath.main.PyPath.get_sub` on a given *graph*.</span>

<span class="sd">        :arg dict crit:</span>
<span class="sd">            Defines the critical attributes to generate the subnetwork.</span>
<span class="sd">            Keys are ``&#39;edge&#39;`` and ``&#39;node&#39;`` and values are [dict]</span>
<span class="sd">            containing the critical attribute names [str] and values</span>
<span class="sd">            are [set] containing those attributes of the nodes/edges</span>
<span class="sd">            that are to be kept.</span>
<span class="sd">        :arg str andor:</span>
<span class="sd">            Optional, ``&#39;or&#39;`` by default. Determines the search mode.</span>
<span class="sd">            See :py:meth:`pypath.main.PyPath.search_attr_or` and</span>
<span class="sd">            :py:meth:`pypath.main.PyPath.search_attr_and` for more</span>
<span class="sd">            details.</span>
<span class="sd">        :arg igraph.Graph graph:</span>
<span class="sd">            Optional, ``None`` by default. The graph object where to</span>
<span class="sd">            extract the subnetwork. If none is passed, takes the current</span>
<span class="sd">            network (undirected) graph</span>
<span class="sd">            (:py:attr:`pypath.main.PyPath.graph`).</span>

<span class="sd">        :return:</span>
<span class="sd">            (*igraph.Graph*) -- The subgraph obtained from filtering</span>
<span class="sd">            according to the attributes defined in *crit*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">graph</span>
        <span class="n">sub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sub</span><span class="p">(</span><span class="n">crit</span><span class="p">,</span> <span class="n">andor</span><span class="o">=</span><span class="n">andor</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">new</span><span class="o">.</span><span class="n">delete_edges</span><span class="p">(</span><span class="n">sub</span><span class="p">[</span><span class="s2">&quot;edges&quot;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">new</span><span class="o">.</span><span class="n">induced_subgraph</span><span class="p">(</span><span class="n">sub</span><span class="p">[</span><span class="s2">&quot;nodes&quot;</span><span class="p">])</span></div>

<div class="viewcode-block" id="PyPath.separate"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.separate">[docs]</a>    <span class="k">def</span> <span class="nf">separate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Separates the undirected network according to the different</span>
<span class="sd">        sources. Basically applies</span>
<span class="sd">        :py:meth:`pypath.main.PyPath.get_network` for each resource.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*dict*) -- Keys are resource names [str] whose values are</span>
<span class="sd">            the subnetwork [igraph.Graph] containing the elements of</span>
<span class="sd">            that source.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_network</span><span class="p">({</span><span class="s1">&#39;edge&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;sources&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">s</span><span class="p">]},</span>
                                           <span class="s1">&#39;node&#39;</span><span class="p">:</span> <span class="p">{}}))</span>
                     <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">])</span></div>

<div class="viewcode-block" id="PyPath.separate_by_category"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.separate_by_category">[docs]</a>    <span class="k">def</span> <span class="nf">separate_by_category</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Separates the undirected network according to resource</span>
<span class="sd">        categories. Possible categories are:</span>

<span class="sd">            * ``&#39;m&#39;``: PTM/enzyme-substrate resources.</span>
<span class="sd">            * ``&#39;p&#39;``: Pathway/activity flow resources.</span>
<span class="sd">            * ``&#39;i&#39;``: Undirected/PPI resources.</span>
<span class="sd">            * ``&#39;r&#39;``: Process description/reaction resources.</span>
<span class="sd">            * ``&#39;t&#39;``: Transcription resources.</span>

<span class="sd">        Works in the same way as :py:meth:`pypath.main.PyPath.separate`.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*dict*) -- Keys are category names [str] whose values are</span>
<span class="sd">            the subnetwork [igraph.Graph] containing the elements of</span>
<span class="sd">            those resources corresponding to that category.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cats</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span>
            <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span>
                <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">cs</span><span class="p">:</span>
                    <span class="n">cs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">cs</span><span class="p">:</span>
                        <span class="n">cs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">c</span><span class="p">,</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">db_categories</span><span class="o">.</span><span class="n">categories</span><span class="p">)))))),</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">has_cats</span><span class="p">)))</span>

        <span class="k">return</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_network</span><span class="p">({</span><span class="s1">&#39;edge&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;sources&#39;</span><span class="p">:</span> <span class="n">s</span><span class="p">},</span>
                                           <span class="s1">&#39;node&#39;</span><span class="p">:</span> <span class="p">{}}))</span>
                     <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">cats</span><span class="p">)])</span></div>

<div class="viewcode-block" id="PyPath.update_pathway_types"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.update_pathway_types">[docs]</a>    <span class="k">def</span> <span class="nf">update_pathway_types</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the pathway types attribute</span>
<span class="sd">        (:py:attr:`pypath.main.PyPath.pathway_types`) according to the</span>
<span class="sd">        loaded resources of the undirected network.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">pwTyp</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>

            <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;_pathways&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">pwTyp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pathway_types</span> <span class="o">=</span> <span class="n">pwTyp</span></div>

<div class="viewcode-block" id="PyPath.source_similarity"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.source_similarity">[docs]</a>    <span class="k">def</span> <span class="nf">source_similarity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the Sorensen&#39;s similarity index across nodes and edges</span>
<span class="sd">        for all the sources available (already loaded in the network)</span>
<span class="sd">        and saves them into table files. Files are stored in</span>
<span class="sd">        :py:attr:`pypath.main.PyPath.outdir` (``&#39;results&#39;`` by default).</span>
<span class="sd">        See :py:meth:`pypath.main.PyPath.databases_similarity` for more</span>
<span class="sd">        information.</span>

<span class="sd">        :arg str outfile:</span>
<span class="sd">            Optional, ``None`` by default. Specifies the file name</span>
<span class="sd">            prefix (suffixes will be ``&#39;-nodes&#39;`` and ``&#39;-edges&#39;``). If</span>
<span class="sd">            none is specified, this will be</span>
<span class="sd">            ``&#39;pwnet-&lt;session_id&gt;-sim-src&#39;``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">outfile</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;pwnet-&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">,</span> <span class="s2">&quot;-sim-src&quot;</span><span class="p">])</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">database_similarity</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;sorensen&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_table</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;nodes&quot;</span><span class="p">],</span> <span class="n">outfile</span> <span class="o">+</span> <span class="s2">&quot;-nodes&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_table</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;edges&quot;</span><span class="p">],</span> <span class="n">outfile</span> <span class="o">+</span> <span class="s2">&quot;-edges&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.pathway_similarity"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.pathway_similarity">[docs]</a>    <span class="k">def</span> <span class="nf">pathway_similarity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the Sorensen&#39;s similarity index across nodes and edges</span>
<span class="sd">        for all the available pathway sources (already loaded in the</span>
<span class="sd">        network) and saves them into table files. Files are stored in</span>
<span class="sd">        :py:attr:`pypath.main.PyPath.outdir` (``&#39;results&#39;`` by default).</span>
<span class="sd">        See :py:meth:`pypath.main.PyPath.sorensen_pathways` for more</span>
<span class="sd">        information..</span>

<span class="sd">        :arg str outfile:</span>
<span class="sd">            Optional, ``None`` by default. Specifies the file name</span>
<span class="sd">            prefix (suffixes will be ``&#39;-nodes&#39;`` and ``&#39;-edges&#39;``). If</span>
<span class="sd">            none is specified, this will be</span>
<span class="sd">            ``&#39;pwnet-&lt;session_id&gt;-sim-pw&#39;``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">outfile</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;pwnet-&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">,</span> <span class="s2">&quot;-sim-pw&quot;</span><span class="p">])</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sorensen_pathways</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_table</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;nodes&quot;</span><span class="p">],</span> <span class="n">outfile</span> <span class="o">+</span> <span class="s2">&quot;-nodes&quot;</span><span class="p">,</span> <span class="n">cut</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_table</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;edges&quot;</span><span class="p">],</span> <span class="n">outfile</span> <span class="o">+</span> <span class="s2">&quot;-edges&quot;</span><span class="p">,</span> <span class="n">cut</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.update_sources"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.update_sources">[docs]</a>    <span class="k">def</span> <span class="nf">update_sources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Makes sure that the :py:attr:`pypath.main.PyPath.sources`</span>
<span class="sd">        attribute is an up to date [list] of all sources in the current</span>
<span class="sd">        network.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">src</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>
            <span class="n">src</span> <span class="o">+=</span> <span class="n">e</span><span class="p">[</span><span class="s2">&quot;sources&quot;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sources</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">src</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sources2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
            <span class="n">ev</span><span class="o">.</span><span class="n">resource</span>
            <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;attrs&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">ev</span> <span class="ow">in</span> <span class="n">attr</span><span class="o">.</span><span class="n">evidences</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_cats</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyPath.update_cats"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.update_cats">[docs]</a>    <span class="k">def</span> <span class="nf">update_cats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Makes sure that the :py:attr:`pypath.main.PyPath.has_cats`</span>
<span class="sd">        attribute is an up to date [set] of all categories in the</span>
<span class="sd">        current network.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">has_cats</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">db_categories</span><span class="o">.</span><span class="n">catnames</span><span class="p">[</span><span class="n">catletter</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span>
            <span class="k">for</span> <span class="n">catletter</span> <span class="ow">in</span> <span class="n">db_categories</span><span class="o">.</span><span class="n">get_categories</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">has_cats2</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">ev</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">data_model_label</span>
            <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;attrs&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">ev</span> <span class="ow">in</span> <span class="n">attr</span><span class="o">.</span><span class="n">evidences</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="PyPath.update_pathways"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.update_pathways">[docs]</a>    <span class="k">def</span> <span class="nf">update_pathways</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Makes sure that the :py:attr:`pypath.main.PyPath.pathways`</span>
<span class="sd">        attribute is an up to date [dict] of all pathways and their</span>
<span class="sd">        sources in the current network.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">pws</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>

                <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;_pathways&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pws</span><span class="p">:</span>
                        <span class="n">pws</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                    <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>

                            <span class="k">if</span> <span class="n">p</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">pws</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                                <span class="n">pws</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pathways</span> <span class="o">=</span> <span class="n">pws</span></div>

<div class="viewcode-block" id="PyPath.delete_unmapped"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.delete_unmapped">[docs]</a>    <span class="k">def</span> <span class="nf">delete_unmapped</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks the network for any existing unmapped node and removes</span>
<span class="sd">        it.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">if</span> <span class="s2">&quot;unmapped&quot;</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">delete_vertices</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;unmapped&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_db_dict</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.genesymbol_labels"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.genesymbol_labels">[docs]</a>    <span class="k">def</span> <span class="nf">genesymbol_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remap_all</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creats vertex attribute ``&#39;label&#39;`` and fills up with the</span>
<span class="sd">        corresponding GeneSymbols of all proteins where the GeneSymbol</span>
<span class="sd">        can be looked up based on the default name of the protein</span>
<span class="sd">        vertex (UniProt ID by default). If the attribute ``&#39;label&#39;`` has</span>
<span class="sd">        been already initialized, updates this attribute or recreates if</span>
<span class="sd">        *remap_all* is set to ``True``.</span>

<span class="sd">        :arg igraph.Graph graph:</span>
<span class="sd">            Optional, ``None`` by default. The network graph object</span>
<span class="sd">            where the GeneSymbol labels are to be set/updated. If none</span>
<span class="sd">            is passed, takes the current network undirected graph by</span>
<span class="sd">            default (:py:attr:`pypath.main.PyPath.graph`).</span>
<span class="sd">        :arg bool remap_all:</span>
<span class="sd">            Optional, ``False`` by default. Whether to map anew the</span>
<span class="sd">            GeneSymbol labels if those were already initialized.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Updating vertex labels.&#39;</span><span class="p">)</span>

        <span class="c1"># XXX: What&#39;s the purpose of this? I mean attribute _directed is not</span>
        <span class="c1">#      accessed in this function (?)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_already_has_directed</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgraph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">genesymbol_labels</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dgraph</span><span class="p">,</span> <span class="n">remap_all</span><span class="o">=</span><span class="n">remap_all</span><span class="p">)</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">graph</span>
        <span class="n">default_name_types</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;default_name_types&#39;</span><span class="p">)</span>
        <span class="n">label_name_types</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="s1">&#39;genesymbol&#39;</span><span class="p">,</span>
            <span class="s1">&#39;mirna&#39;</span><span class="p">:</span> <span class="s1">&#39;mir-mat-name&#39;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="s1">&#39;label&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="n">remap_all</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span>
                <span class="kc">None</span>
                    <span class="k">if</span> <span class="n">remap_all</span> <span class="ow">or</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">else</span>
                <span class="n">v</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">xrange</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vcount</span><span class="p">())):</span>

            <span class="k">if</span> <span class="n">l</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

                <span class="n">label</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">intera</span><span class="o">.</span><span class="n">Complex</span><span class="p">):</span>

                    <span class="n">label</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">genesymbol_str</span>

                <span class="k">elif</span> <span class="p">(</span>
                    <span class="n">v</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">label_name_types</span> <span class="ow">and</span>
                    <span class="n">v</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">default_name_types</span>
                <span class="p">):</span>

                    <span class="n">label</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name0</span><span class="p">(</span>
                        <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                        <span class="n">default_name_types</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]],</span>
                        <span class="n">label_name_types</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]],</span>
                        <span class="n">ncbi_tax_id</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;ncbi_tax_id&#39;</span><span class="p">],</span>
                    <span class="p">)</span>

                <span class="k">if</span> <span class="n">label</span><span class="p">:</span>

                    <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

        <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels</span></div>

<div class="viewcode-block" id="PyPath.network_stats"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.network_stats">[docs]</a>    <span class="k">def</span> <span class="nf">network_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates basic statistics for the whole network and each of</span>
<span class="sd">        sources (node and edge counts, average node degree, graph</span>
<span class="sd">        diameter, transitivity, adhesion and cohesion). Writes the</span>
<span class="sd">        results in a tab file. File is stored in</span>
<span class="sd">        :py:attr:`pypath.main.PyPath.outdir` (``&#39;results&#39;`` by default).</span>

<span class="sd">        :arg str outfile:</span>
<span class="sd">            Optional, ``None`` by default. Specifies the file name. If</span>
<span class="sd">            none is specified, this will be</span>
<span class="sd">            ``&#39;pwnet-&lt;session_id&gt;-stats&#39;``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">outfile</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;pwnet&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">,</span> <span class="s2">&quot;stats&quot;</span><span class="p">])</span>

        <span class="n">stats</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;vnum&quot;</span><span class="p">,</span> <span class="s2">&quot;enum&quot;</span><span class="p">,</span> <span class="s2">&quot;deg_avg&quot;</span><span class="p">,</span> <span class="s2">&quot;diam&quot;</span><span class="p">,</span> <span class="s2">&quot;trans&quot;</span><span class="p">,</span> <span class="s2">&quot;adh&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;coh&quot;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;All&quot;</span> <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)</span>
                 <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_network</span><span class="p">({</span><span class="s2">&quot;edge&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;sources&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">s</span><span class="p">]},</span> <span class="s2">&quot;node&quot;</span><span class="p">:</span> <span class="p">{}}))</span>

            <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">vcount</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">stats</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">vcount</span><span class="p">(),</span> <span class="n">g</span><span class="o">.</span><span class="n">ecount</span><span class="p">(),</span>
                            <span class="nb">sum</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">degree</span><span class="p">())</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">)),</span> <span class="c1"># XXX: g.vcount()?</span>
                            <span class="n">g</span><span class="o">.</span><span class="n">diameter</span><span class="p">(),</span> <span class="n">g</span><span class="o">.</span><span class="n">transitivity_undirected</span><span class="p">(),</span>
                            <span class="n">g</span><span class="o">.</span><span class="n">adhesion</span><span class="p">(),</span> <span class="n">g</span><span class="o">.</span><span class="n">cohesion</span><span class="p">()]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write_table</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="n">outfile</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.degree_dists"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.degree_dists">[docs]</a>    <span class="k">def</span> <span class="nf">degree_dists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the degree distribution for all the different network</span>
<span class="sd">        sources. This is, for each source, the subnetwork comprising all</span>
<span class="sd">        interactions coming from it is extracted and the degree</span>
<span class="sd">        distribution information is computed and saved into a file.</span>
<span class="sd">        A file is created for each resource under the name</span>
<span class="sd">        ``&#39;pwnet-&lt;session_id&gt;-degdist-&lt;resource&gt;&#39;&#39;``. Files are stored</span>
<span class="sd">        in :py:attr:`pypath.main.PyPath.outdir` (``&#39;results&#39;`` by</span>
<span class="sd">        default).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dds</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">:</span>
            <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_network</span><span class="p">({</span><span class="s2">&quot;edge&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;sources&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">s</span><span class="p">]},</span> <span class="s2">&quot;node&quot;</span><span class="p">:</span> <span class="p">{}})</span>

            <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">vcount</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">dds</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">degree_distribution</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">dds</span><span class="p">):</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outdir</span><span class="p">,</span>
                                    <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;pwnet-&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">,</span>
                                             <span class="s2">&quot;-degdist-&quot;</span><span class="p">,</span> <span class="n">k</span><span class="p">]))</span>
            <span class="n">bins</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">bins</span><span class="p">():</span>
                <span class="n">bins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>

            <span class="n">out</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bins</span><span class="p">),</span>
                           <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">])</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.intergroup_shortest_paths"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.intergroup_shortest_paths">[docs]</a>    <span class="k">def</span> <span class="nf">intergroup_shortest_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">groupA</span><span class="p">,</span> <span class="n">groupB</span><span class="p">,</span> <span class="n">random</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span> <span class="c1"># TODO</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_sources</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">groupA</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;No such attribute: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">groupA</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">groupB</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;No such attribute: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">groupB</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">deg_pathlen</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">rat_pathlen</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">rand_pathlen</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">diam_pathlen</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;All&quot;</span> <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">outfile</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">s</span><span class="p">,</span> <span class="n">groupA</span><span class="p">,</span> <span class="n">groupB</span><span class="p">,</span> <span class="s2">&quot;paths&quot;</span><span class="p">])</span>
            <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)</span>
                 <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_network</span><span class="p">({</span><span class="s2">&quot;edge&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;sources&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">s</span><span class="p">]},</span> <span class="s2">&quot;node&quot;</span><span class="p">:</span> <span class="p">{}}))</span>
            <span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">grA</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">grB</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">groupA</span><span class="p">]:</span>
                    <span class="n">grA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">groupB</span><span class="p">]:</span>
                    <span class="n">grB</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">groupB</span><span class="p">]:</span>
                    <span class="n">pt</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_shortest_paths</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">grA</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;epath&quot;</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pt</span><span class="p">:</span>
                        <span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>

                    <span class="k">if</span> <span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">grA</span><span class="p">):</span>
                        <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">write_table</span><span class="p">({</span><span class="s2">&quot;paths&quot;</span><span class="p">:</span> <span class="n">paths</span><span class="p">},</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">,</span>
                             <span class="n">colnames</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rownames</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">deg</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
            <span class="n">mean_pathlen</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">))</span>
            <span class="n">deg_pathlen</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">mean_pathlen</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">deg</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">deg</span><span class="p">))]</span>
            <span class="n">rat_pathlen</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">mean_pathlen</span><span class="p">,</span>
                              <span class="n">f</span><span class="o">.</span><span class="n">vcount</span><span class="p">()</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">grA</span> <span class="o">+</span> <span class="n">grB</span><span class="p">))))]</span>
            <span class="n">diam_pathlen</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">mean_pathlen</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">diameter</span><span class="p">()]</span>

            <span class="k">if</span> <span class="n">random</span><span class="p">:</span>
                <span class="n">groupA_random</span> <span class="o">=</span> <span class="n">groupA</span> <span class="o">+</span> <span class="s2">&quot;_random&quot;</span>
                <span class="n">groupB_random</span> <span class="o">=</span> <span class="n">groupB</span> <span class="o">+</span> <span class="s2">&quot;_random&quot;</span>
                <span class="n">random_pathlen</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">groupA_random</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy_mod</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">groupA</span><span class="p">])</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">groupB_random</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy_mod</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">groupB</span><span class="p">])</span>
                    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">groupA_random</span><span class="p">])</span>
                    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">groupB_random</span><span class="p">])</span>
                    <span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">grA</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">grB</span> <span class="o">=</span> <span class="p">[]</span>

                    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

                        <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">groupA_random</span><span class="p">]:</span>
                            <span class="n">grA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">groupB_random</span><span class="p">]:</span>
                            <span class="n">grB</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

                        <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">groupB_random</span><span class="p">]:</span>
                            <span class="n">pt</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_shortest_paths</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">grA</span><span class="p">,</span>
                                                      <span class="n">output</span><span class="o">=</span><span class="s2">&quot;epath&quot;</span><span class="p">)</span>

                            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pt</span><span class="p">:</span>
                                <span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

                                <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                                    <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>

                            <span class="k">if</span> <span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">grA</span><span class="p">):</span>
                                <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">random_pathlen</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)))</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">random_pathlen</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rand_pathlen</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">mean_pathlen</span><span class="p">,</span>
                                       <span class="nb">sum</span><span class="p">(</span><span class="n">random_pathlen</span><span class="p">)</span>
                                       <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">random_pathlen</span><span class="p">))]</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">rand_pathlen</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">mean_pathlen</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>

        <span class="n">deg_pathlen</span><span class="p">[</span><span class="s2">&quot;header&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;path_len&quot;</span><span class="p">,</span> <span class="s2">&quot;degree&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_table</span><span class="p">(</span><span class="n">deg_pathlen</span><span class="p">,</span> <span class="s2">&quot;deg_pathlen&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
        <span class="n">diam_pathlen</span><span class="p">[</span><span class="s2">&quot;header&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;path_len&quot;</span><span class="p">,</span> <span class="s2">&quot;diam&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_table</span><span class="p">(</span><span class="n">diam_pathlen</span><span class="p">,</span> <span class="s2">&quot;diam_pathlen&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
        <span class="n">rat_pathlen</span><span class="p">[</span><span class="s2">&quot;header&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;path_len&quot;</span><span class="p">,</span> <span class="s2">&quot;ratio&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_table</span><span class="p">(</span><span class="n">rat_pathlen</span><span class="p">,</span> <span class="s2">&quot;rat_pathlen&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">random</span><span class="p">:</span>
            <span class="n">rand_pathlen</span><span class="p">[</span><span class="s2">&quot;header&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;path_len&quot;</span><span class="p">,</span> <span class="s2">&quot;random&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_table</span><span class="p">(</span><span class="n">rand_pathlen</span><span class="p">,</span> <span class="s2">&quot;rand_pathlen&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.update_vertex_sources"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.update_vertex_sources">[docs]</a>    <span class="k">def</span> <span class="nf">update_vertex_sources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the all the vertex attributes ``&#39;sources&#39;`` and</span>
<span class="sd">        ``&#39;references&#39;`` according to their related edges (on the</span>
<span class="sd">        undirected graph).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">,</span> <span class="s1">&#39;references&#39;</span><span class="p">]:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">([])</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>
                <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="n">attr</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">])</span>
                <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="n">attr</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">attr</span><span class="p">])</span></div>


<div class="viewcode-block" id="PyPath.set_categories"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.set_categories">[docs]</a>    <span class="k">def</span> <span class="nf">set_categories</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the category attribute on the network nodes and edges</span>
<span class="sd">        (``&#39;cat&#39;``) as well the edge attribute coercing the references</span>
<span class="sd">        by category (``&#39;refs_by_cat&#39;``). The possible categories are</span>
<span class="sd">        as follows:</span>

<span class="sd">            * ``&#39;m&#39;``: PTM/enzyme-substrate resources.</span>
<span class="sd">            * ``&#39;p&#39;``: Pathway/activity flow resources.</span>
<span class="sd">            * ``&#39;i&#39;``: Undirected/PPI resources.</span>
<span class="sd">            * ``&#39;r&#39;``: Process description/reaction resources.</span>
<span class="sd">            * ``&#39;t&#39;``: Transcription resources.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">([])</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">([])</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;refs_by_cat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]:</span>

                <span class="n">vcats</span> <span class="o">=</span> <span class="n">db_categories</span><span class="o">.</span><span class="n">get_categories</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">vcats</span><span class="p">:</span>

                    <span class="n">v</span><span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]:</span>

                <span class="n">ecats</span> <span class="o">=</span> <span class="n">db_categories</span><span class="o">.</span><span class="n">get_categories</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">ecats</span><span class="p">:</span>

                    <span class="n">e</span><span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">cat</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;refs_by_cat&#39;</span><span class="p">]:</span>
                        <span class="n">e</span><span class="p">[</span><span class="s1">&#39;refs_by_cat&#39;</span><span class="p">][</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

                    <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;refs_by_source&#39;</span><span class="p">]:</span>

                        <span class="n">e</span><span class="p">[</span><span class="s1">&#39;refs_by_cat&#39;</span><span class="p">][</span><span class="n">cat</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;refs_by_source&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">])</span></div>


<div class="viewcode-block" id="PyPath.basic_stats_intergroup"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.basic_stats_intergroup">[docs]</a>    <span class="k">def</span> <span class="nf">basic_stats_intergroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">groupA</span><span class="p">,</span> <span class="n">groupB</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> <span class="c1"># TODO</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;All&quot;</span> <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)</span>
                 <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_network</span><span class="p">({</span><span class="s2">&quot;edge&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;sources&quot;</span><span class="p">:</span> <span class="nb">set</span><span class="p">([</span><span class="n">s</span><span class="p">])},</span>
                                        <span class="s2">&quot;node&quot;</span><span class="p">:</span> <span class="p">{}}))</span>
            <span class="n">deg</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
            <span class="n">bw</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">betweenness</span><span class="p">()</span>
            <span class="n">vnum</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">vcount</span><span class="p">()</span>
            <span class="n">enum</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">ecount</span><span class="p">()</span>
            <span class="n">cancerg</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">drugt</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">cdeg</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">tdeg</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">ddeg</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">cbw</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">tbw</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">dbw</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">cg</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>
                <span class="n">tdeg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deg</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>
                <span class="n">tbw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bw</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">groupA</span><span class="p">]:</span>
                    <span class="n">cg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
                    <span class="n">cancerg</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">cdeg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deg</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>
                    <span class="n">cbw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bw</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">groupB</span><span class="p">]:</span>
                    <span class="n">dt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
                    <span class="n">drugt</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">ddeg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deg</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>
                    <span class="n">dbw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bw</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>

            <span class="n">cpct</span> <span class="o">=</span> <span class="n">cancerg</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">groupA</span><span class="p">]))</span>
            <span class="n">dpct</span> <span class="o">=</span> <span class="n">drugt</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="n">groupB</span><span class="p">]))</span>
            <span class="n">tdgr</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">tdeg</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tdeg</span><span class="p">))</span>
            <span class="n">cdgr</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">cdeg</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cdeg</span><span class="p">))</span>
            <span class="n">ddgr</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ddeg</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ddeg</span><span class="p">))</span>
            <span class="n">tbwn</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">tbw</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tbw</span><span class="p">))</span>
            <span class="n">cbwn</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">cbw</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cbw</span><span class="p">))</span>
            <span class="n">dbwn</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">dbw</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dbw</span><span class="p">))</span>
            <span class="n">src</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">csrc</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">dsrc</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># FIXME: Here raises AttributeError. From above, I understood that</span>
        <span class="c1">#        arguments groupA and groupB were names for self.lists but</span>
        <span class="c1">#        here seems they are vertex attributes??</span>

            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>
                <span class="n">src</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s2">&quot;sources&quot;</span><span class="p">]))</span>

                <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="n">groupA</span><span class="p">]</span> <span class="ow">or</span> <span class="n">f</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="n">groupA</span><span class="p">]:</span>
                    <span class="n">csrc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s2">&quot;sources&quot;</span><span class="p">]))</span>

                <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="n">groupB</span><span class="p">]</span> <span class="ow">or</span> <span class="n">f</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="n">groupB</span><span class="p">]:</span>
                    <span class="n">dsrc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s2">&quot;sources&quot;</span><span class="p">]))</span>

            <span class="n">snum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">src</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">src</span><span class="p">))</span>
            <span class="n">csnum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">csrc</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">csrc</span><span class="p">))</span>
            <span class="n">dsnum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">dsrc</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dsrc</span><span class="p">))</span>
            <span class="n">result</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">vnum</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">enum</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">cancerg</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">drugt</span><span class="p">),</span>
                         <span class="nb">str</span><span class="p">(</span><span class="n">cpct</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">dpct</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">tdgr</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">cdgr</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">ddgr</span><span class="p">),</span>
                         <span class="nb">str</span><span class="p">(</span><span class="n">tbwn</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">cbwn</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">dbwn</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">snum</span><span class="p">),</span>
                         <span class="nb">str</span><span class="p">(</span><span class="n">csnum</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">dsnum</span><span class="p">)]</span>

        <span class="n">outfile</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">groupA</span><span class="p">,</span> <span class="n">groupB</span><span class="p">,</span> <span class="s2">&quot;stats&quot;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">header</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_table</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;header&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">header</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_table</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.sources_venn_data"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.sources_venn_data">[docs]</a>    <span class="k">def</span> <span class="nf">sources_venn_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_data</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the overlap in number of interactions for all pairs of</span>
<span class="sd">        sources.</span>

<span class="sd">        :arg str fname:</span>
<span class="sd">            Optional, ``None`` by default. If provided, saves the</span>
<span class="sd">            results into a table file. File is stored in</span>
<span class="sd">            :py:attr:`pypath.main.PyPath.outdir` (``&#39;results&#39;`` by</span>
<span class="sd">            default).</span>
<span class="sd">        :arg bool return_data:</span>
<span class="sd">            Optional, ``False`` by default. Whether to return the</span>
<span class="sd">            results as a [list].</span>

<span class="sd">        :return:</span>
<span class="sd">            (*list*) -- Only if *return_data* is set to ``True``. List</span>
<span class="sd">            of lists containing the counts for each pair of resources.</span>
<span class="sd">            This is, for instance, number of interactions only in</span>
<span class="sd">            resource A, number of interactions only in resource B and</span>
<span class="sd">            number of common interactions between A and B.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_sources</span><span class="p">()</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">):</span>

            <span class="n">ini</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]]</span>
            <span class="n">inj</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span> <span class="k">if</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]]</span>

            <span class="n">onlyi</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ini</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">inj</span><span class="p">))))</span>
            <span class="n">onlyj</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">inj</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">ini</span><span class="p">))))</span>
            <span class="n">inter</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ini</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">inj</span><span class="p">))))</span>
            <span class="n">result</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">onlyi</span><span class="p">,</span> <span class="n">onlyj</span><span class="p">,</span> <span class="n">inter</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">fname</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_table</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">return_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="PyPath.sources_hist"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.sources_hist">[docs]</a>    <span class="k">def</span> <span class="nf">sources_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Counts the number of sources per interaction in the graph and</span>
<span class="sd">        saves them into a file named ``source_num``. File is stored in</span>
<span class="sd">        :py:attr:`pypath.main.PyPath.outdir` (``&#39;results&#39;`` by</span>
<span class="sd">        default).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">srcnum</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write_table</span><span class="p">({</span><span class="s2">&quot;srcnum&quot;</span><span class="p">:</span> <span class="n">srcnum</span><span class="p">},</span> <span class="s2">&quot;source_num&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">,</span>
                         <span class="n">rownames</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.degree_dist"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.degree_dist">[docs]</a>    <span class="k">def</span> <span class="nf">degree_dist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the degree distribution over all nodes of the network.</span>
<span class="sd">        If *group* is provided, also across nodes of that group(s).</span>

<span class="sd">        :arg str prefix:</span>
<span class="sd">            Prefix for the file name(s).</span>
<span class="sd">        :arg igraph.Graph g:</span>
<span class="sd">            Optional, ``None`` by default. The network over which to</span>
<span class="sd">            compute the degree distribution. If none is passed, takes</span>
<span class="sd">            the undirected network of the current instance.</span>
<span class="sd">        :arg list group:</span>
<span class="sd">            Optional, ``None`` by default. Additional group(s) name(s)</span>
<span class="sd">            [str] of node attributes to subset the network and compute</span>
<span class="sd">            its degree distribution.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">g</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="n">deg</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_table</span><span class="p">({</span><span class="s2">&quot;deg&quot;</span><span class="p">:</span> <span class="n">deg</span><span class="p">},</span> <span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;-whole-degdist&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">,</span>
                         <span class="n">rownames</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">group</span> <span class="o">=</span> <span class="p">[</span><span class="n">group</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">group</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">()))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Missing vertex attribute!&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="k">for</span> <span class="n">gr</span> <span class="ow">in</span> <span class="n">group</span><span class="p">:</span>
                <span class="n">dgr</span> <span class="o">=</span> <span class="p">[</span><span class="n">deg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">)</span> <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">gr</span><span class="p">]]</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">write_table</span><span class="p">({</span><span class="s2">&quot;deg&quot;</span><span class="p">:</span> <span class="n">dgr</span><span class="p">},</span> <span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">gr</span> <span class="o">+</span> <span class="s2">&quot;-degdist&quot;</span><span class="p">,</span>
                                 <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="n">rownames</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.delete_by_source"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.delete_by_source">[docs]</a>    <span class="k">def</span> <span class="nf">delete_by_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">vertexAttrsToDel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">edgeAttrsToDel</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes nodes and edges from the network according to a provided</span>
<span class="sd">        source name. Optionally can also remove the given list of</span>
<span class="sd">        attributes from nodes and/or edges.</span>

<span class="sd">        :arg str source:</span>
<span class="sd">            Name of the source from which the nodes and edges have to be</span>
<span class="sd">            removed.</span>
<span class="sd">        :arg list vertexAttrsToDel:</span>
<span class="sd">            Optional, ``None`` by default. Contains the names [str] of</span>
<span class="sd">            the attributes to be removed from the nodes.</span>
<span class="sd">        :arg list edgeAttrsToDel:</span>
<span class="sd">            Optional, ``None`` by default. Contains the names [str] of</span>
<span class="sd">            the attributes to be removed from the edges.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vertex_sources</span><span class="p">()</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">verticesToDel</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># XXX: Refactor to?:</span>
        <span class="c1">#      verticesToDel = [v.index for v in g.vs</span>
        <span class="c1">#                if len(v[&#39;sources&#39;]-set([source])) == 0]</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="nb">set</span><span class="p">([</span><span class="n">source</span><span class="p">]))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">verticesToDel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="n">g</span><span class="o">.</span><span class="n">delete_vertices</span><span class="p">(</span><span class="n">verticesToDel</span><span class="p">)</span>

        <span class="n">edgesToDel</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="nb">set</span><span class="p">([</span><span class="n">source</span><span class="p">]))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">edgesToDel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="nb">set</span><span class="p">([</span><span class="n">source</span><span class="p">])</span>

        <span class="n">g</span><span class="o">.</span><span class="n">delete_edges</span><span class="p">(</span><span class="n">edgesToDel</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">vertexAttrsToDel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">vAttr</span> <span class="ow">in</span> <span class="n">vertexAttrsToDel</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">vAttr</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
                    <span class="k">del</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">vAttr</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">edgeAttrsToDel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">eAttr</span> <span class="ow">in</span> <span class="n">edgeAttrsToDel</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">eAttr</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
                    <span class="k">del</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">eAttr</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vertex_sources</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.reference_hist"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.reference_hist">[docs]</a>    <span class="k">def</span> <span class="nf">reference_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a file containing a table with information about the</span>
<span class="sd">        network&#39;s edges. First column contains the source node ID,</span>
<span class="sd">        followed by the target&#39;s ID, third column contains the number of</span>
<span class="sd">        references for that interaction and finally the number of</span>
<span class="sd">        sources. Writes the results in a tab file.</span>

<span class="sd">        :arg str filename:</span>
<span class="sd">            Optional, ``None`` by default. Specifies the file name and</span>
<span class="sd">            path to save the table. If none is passed, file will be</span>
<span class="sd">            saved in :py:attr:`pypath.main.PyPath.outdir` (``&#39;results&#39;``</span>
<span class="sd">            by default) with the name ``&#39;&lt;session_id&gt;-refs-hist&#39;``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">tbl</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>
            <span class="n">tbl</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                        <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;references&#39;</span><span class="p">])),</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]))))</span>

        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outdir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">+</span> <span class="s2">&quot;-refs-hist&quot;</span><span class="p">)</span>

        <span class="n">out</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tbl</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">outf</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">outf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">outf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.load_resources"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_resources">[docs]</a>    <span class="k">def</span> <span class="nf">load_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="p">[],</span> <span class="n">cache_files</span><span class="o">=</span><span class="p">{},</span>
                       <span class="n">reread</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">redownload</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keep_raw</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads multiple resources, and cleans up after. Looks up ID</span>
<span class="sd">        types, and loads all ID conversion tables from UniProt if</span>
<span class="sd">        necessary. This is much faster than loading the ID conversion</span>
<span class="sd">        and the resources one by one.</span>

<span class="sd">        :arg dict lst:</span>
<span class="sd">            Optional, ``None`` by default. Specifies the data input</span>
<span class="sd">            formats for the different resources (keys) [str]. Values</span>
<span class="sd">            are :py:class:`pypath.input_formats.NetworkInput` instances</span>
<span class="sd">            containing the information. By default uses the set of</span>
<span class="sd">            resources of OmniPath.</span>
<span class="sd">        :arg list exclude:</span>
<span class="sd">            Optional, ``[]`` by default. List of resources [str] to</span>
<span class="sd">            exclude from the network.</span>
<span class="sd">        :arg dict cache_files:</span>
<span class="sd">            Optional, ``{}`` by default. Contains the resource name(s)</span>
<span class="sd">            [str] (keys) and the corresponding cached file name [str].</span>
<span class="sd">            If provided (and file exists) bypasses the download of the</span>
<span class="sd">            data for that resource and uses the cache file instead.</span>
<span class="sd">        :arg bool reread:</span>
<span class="sd">            Optional, ``False`` by default. Specifies whether to reread</span>
<span class="sd">            the data files from the cache or omit them (similar to</span>
<span class="sd">            *redownload*).</span>
<span class="sd">        :arg bool redownload:</span>
<span class="sd">            Optional, ``False`` by default. Specifies whether to</span>
<span class="sd">            re-download the data and ignore the cache.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">lst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lst</span> <span class="o">=</span> <span class="n">omnipath</span>

        <span class="n">huge</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="p">(</span>
                    <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s1">&#39;huge&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">v</span><span class="o">.</span><span class="n">huge</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                        <span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s1">&#39;networkinput&#39;</span><span class="p">)</span> <span class="ow">and</span>
                        <span class="n">v</span><span class="o">.</span><span class="n">networkinput</span><span class="o">.</span><span class="n">huge</span>
                    <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                        <span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s1">&#39;huge&#39;</span><span class="p">)</span> <span class="ow">and</span>
                        <span class="n">v</span><span class="o">.</span><span class="n">huge</span>
                    <span class="p">)</span>
                <span class="p">)</span> <span class="ow">and</span>
                <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span> <span class="ow">and</span>
                <span class="n">v</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span> <span class="ow">and</span>
                <span class="n">v</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cache_files</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">nothuge</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="p">(</span>
                    <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s1">&#39;huge&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">v</span><span class="o">.</span><span class="n">huge</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                        <span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s1">&#39;networkinput&#39;</span><span class="p">)</span> <span class="ow">and</span>
                        <span class="ow">not</span> <span class="n">v</span><span class="o">.</span><span class="n">networkinput</span><span class="o">.</span><span class="n">huge</span>
                    <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                        <span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s1">&#39;huge&#39;</span><span class="p">)</span> <span class="ow">and</span>
                        <span class="ow">not</span> <span class="n">v</span><span class="o">.</span><span class="n">huge</span>
                    <span class="p">)</span> <span class="ow">and</span>
                    <span class="n">v</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">cache_files</span>
                <span class="p">)</span> <span class="ow">and</span>
                <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span> <span class="ow">and</span>
                <span class="n">v</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">_inputs</span> <span class="ow">in</span> <span class="p">[</span><span class="n">huge</span><span class="p">,</span> <span class="n">nothuge</span><span class="p">]:</span>

            <span class="k">for</span> <span class="n">this_input</span> <span class="ow">in</span> <span class="n">_inputs</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">load_resource</span><span class="p">(</span>
                    <span class="n">this_input</span><span class="p">,</span>
                    <span class="n">clean</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="n">cache_files</span> <span class="o">=</span> <span class="n">cache_files</span><span class="p">,</span>
                    <span class="n">reread</span> <span class="o">=</span> <span class="n">reread</span><span class="p">,</span>
                    <span class="n">redownload</span> <span class="o">=</span> <span class="n">redownload</span><span class="p">,</span>
                    <span class="n">keep_raw</span> <span class="o">=</span> <span class="n">keep_raw</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;load_resources(): all resources have been loaded, &#39;</span>
            <span class="s1">&#39;current number of nodes: </span><span class="si">%u</span><span class="s1">, edges: </span><span class="si">%u</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">(),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">clean_graph</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_sources</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_vertex_sources</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_pathways</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_pathway_types</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;Network has been built with </span><span class="si">%u</span><span class="s1"> interactions &#39;</span>
            <span class="s1">&#39;between </span><span class="si">%u</span><span class="s1"> nodes from </span><span class="si">%u</span><span class="s1"> resources&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">(),</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.load_resource"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_resource">[docs]</a>    <span class="k">def</span> <span class="nf">load_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">settings</span><span class="p">,</span>
            <span class="n">clean</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">cache_files</span> <span class="o">=</span> <span class="p">{},</span>
            <span class="n">reread</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">redownload</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">keep_raw</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads the data from a single resource and attaches it to the</span>
<span class="sd">        network</span>

<span class="sd">        :arg pypath.input_formats.NetworkInput settings:</span>
<span class="sd">            :py:class:`pypath.input_formats.NetworkInput` instance</span>
<span class="sd">            containing the detailed definition of the input format to</span>
<span class="sd">            the downloaded file.</span>
<span class="sd">        :arg bool clean:</span>
<span class="sd">            Optional, ``True`` by default. Whether to clean the graph</span>
<span class="sd">            after importing the data or not. See</span>
<span class="sd">            :py:meth:`pypath.main.PyPath.clean_graph` for more</span>
<span class="sd">            information.</span>
<span class="sd">        :arg dict cache_files:</span>
<span class="sd">            Optional, ``{}`` by default. Contains the resource name(s)</span>
<span class="sd">            [str] (keys) and the corresponding cached file name [str].</span>
<span class="sd">            If provided (and file exists) bypasses the download of the</span>
<span class="sd">            data for that resource and uses the cache file instead.</span>
<span class="sd">        :arg bool reread:</span>
<span class="sd">            Optional, ``False`` by default. Specifies whether to reread</span>
<span class="sd">            the data files from the cache or omit them (similar to</span>
<span class="sd">            *redownload*).</span>
<span class="sd">        :arg bool redownload:</span>
<span class="sd">            Optional, ``False`` by default. Specifies whether to</span>
<span class="sd">            re-download the data and ignore the cache.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Loading network data from resource `</span><span class="si">%s</span><span class="s1">`.&#39;</span> <span class="o">%</span> <span class="n">settings</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_read_network_data</span><span class="p">(</span>
            <span class="n">settings</span><span class="p">,</span>
            <span class="n">cache_files</span> <span class="o">=</span> <span class="n">cache_files</span><span class="p">,</span>
            <span class="n">reread</span> <span class="o">=</span> <span class="n">reread</span><span class="p">,</span>
            <span class="n">redownload</span> <span class="o">=</span> <span class="n">redownload</span><span class="p">,</span>
            <span class="n">keep_raw</span> <span class="o">=</span> <span class="n">keep_raw</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_network</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">clean</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clean_graph</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_sources</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_vertex_sources</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyPath.load_negatives"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_negatives">[docs]</a>    <span class="k">def</span> <span class="nf">load_negatives</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">data_formats</span><span class="o">.</span><span class="n">negative</span><span class="p">):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                <span class="s1">&#39;Loading resource of negative interactions: `</span><span class="si">%s</span><span class="s1">`.&#39;</span> <span class="o">%</span> <span class="n">v</span><span class="o">.</span><span class="n">name</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">apply_negative</span><span class="p">(</span><span class="n">v</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.load_dorothea"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_dorothea">[docs]</a>    <span class="k">def</span> <span class="nf">load_dorothea</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">},</span> <span class="n">only_curated</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds TF-target interactions from TF regulons to the network.</span>
<span class="sd">        DoRothEA is a comprehensive resource of TF-target</span>
<span class="sd">        interactions combining multiple lines of evidences: literature</span>
<span class="sd">        curated databases, ChIP-Seq data, PWM based prediction using</span>
<span class="sd">        HOCOMOCO and JASPAR matrices and prediction from GTEx expression</span>
<span class="sd">        data by ARACNe.</span>

<span class="sd">        For details see https://github.com/saezlab/DoRothEA.</span>

<span class="sd">        :arg set levels:</span>
<span class="sd">            Optional, ``{&#39;A&#39;, &#39;B&#39;}`` by default. Confidence levels to be</span>
<span class="sd">            loaded (from A to E) [str].</span>
<span class="sd">        :arg bool only_curated:</span>
<span class="sd">            Optional, ``False`` by default. Whether to retrieve only the</span>
<span class="sd">            literature curated interactions or not.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">settings</span> <span class="o">=</span> <span class="n">copy_mod</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span>
            <span class="n">network_resources</span><span class="o">.</span><span class="n">transcription</span><span class="p">[</span><span class="s1">&#39;dorothea&#39;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">settings</span><span class="o">.</span><span class="n">networkinput</span><span class="o">.</span><span class="n">input_args</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;levels&#39;</span><span class="p">:</span> <span class="n">levels</span><span class="p">,</span>
            <span class="s1">&#39;only_curated&#39;</span><span class="p">:</span> <span class="n">only_curated</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">load_resources</span><span class="p">({</span><span class="s1">&#39;dorothea&#39;</span><span class="p">:</span> <span class="n">settings</span><span class="p">})</span></div>

    
    <span class="n">load_tfregulons</span> <span class="o">=</span> <span class="n">load_dorothea</span>

    <span class="c1"># XXX: Wouldn&#39;t it be better if only printed the resources loaded in</span>
    <span class="c1">#      **the current network** rather than omnipath? (e.g. if the user</span>
    <span class="c1">#      just removed one or several of them because he doesn&#39;t like/want them</span>
    <span class="c1">#      and then this function still prints them, as if they were still</span>
    <span class="c1">#      part of the network can be confusing).</span>
<div class="viewcode-block" id="PyPath.list_resources"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.list_resources">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">list_resources</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints the list of resources through the standard output.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; &gt; omnipath</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">omnipath</span><span class="p">):</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">:: </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>

        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; &gt; good</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">good</span><span class="p">):</span> <span class="c1"># FIXME: global name &#39;good&#39; is not defined</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">:: </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span></div>

<div class="viewcode-block" id="PyPath.info"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.info">[docs]</a>    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given the name of a resource, prints out the information about</span>
<span class="sd">        that source/database. You can check the list of available</span>
<span class="sd">        resource descriptions in</span>
<span class="sd">        :py:func:`ypath.descriptions.descriptions.keys`.</span>

<span class="sd">        :arg str name:</span>
<span class="sd">            The name of the resource from which to print the</span>
<span class="sd">            information.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">descriptions</span><span class="o">.</span><span class="n">descriptions</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; :: Sorry, no description available about </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>
                             <span class="n">name</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">dd</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="n">out</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">::: </span><span class="si">%s</span><span class="s1"> :::</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">name</span>

        <span class="k">if</span> <span class="s1">&#39;urls&#39;</span> <span class="ow">in</span> <span class="n">dd</span><span class="p">:</span>

            <span class="k">if</span> <span class="s1">&#39;webpages&#39;</span> <span class="ow">in</span> <span class="n">dd</span><span class="p">[</span><span class="s1">&#39;urls&#39;</span><span class="p">]:</span>
                <span class="n">out</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">:: Webpages:</span><span class="se">\n</span><span class="s1">&#39;</span>

                <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">dd</span><span class="p">[</span><span class="s1">&#39;urls&#39;</span><span class="p">][</span><span class="s1">&#39;webpages&#39;</span><span class="p">]:</span>
                    <span class="n">out</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">    &gt; </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">w</span>

            <span class="k">if</span> <span class="s1">&#39;articles&#39;</span> <span class="ow">in</span> <span class="n">dd</span><span class="p">[</span><span class="s1">&#39;urls&#39;</span><span class="p">]:</span>
                <span class="n">out</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">:: Articles:</span><span class="se">\n</span><span class="s1">&#39;</span>

                <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">dd</span><span class="p">[</span><span class="s1">&#39;urls&#39;</span><span class="p">][</span><span class="s1">&#39;articles&#39;</span><span class="p">]:</span>
                    <span class="n">out</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">    &gt; </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">w</span>

        <span class="k">if</span> <span class="s1">&#39;taxons&#39;</span> <span class="ow">in</span> <span class="n">dd</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">:: Taxons: </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dd</span><span class="p">[</span><span class="s1">&#39;taxons&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="s1">&#39;descriptions&#39;</span> <span class="ow">in</span> <span class="n">dd</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">dd</span><span class="p">[</span><span class="s1">&#39;descriptions&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">:: From the authors:</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">txt</span> <span class="o">=</span> <span class="n">dd</span><span class="p">[</span><span class="s1">&#39;descriptions&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">txt</span><span class="p">])</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">txt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">    &#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;notes&#39;</span> <span class="ow">in</span> <span class="n">dd</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">dd</span><span class="p">[</span><span class="s1">&#39;notes&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">:: Notes:</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">txt</span> <span class="o">=</span> <span class="n">dd</span><span class="p">[</span><span class="s1">&#39;notes&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">txt</span><span class="p">])</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\t\t</span><span class="s1"> </span><span class="si">%s</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">txt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">    &#39;</span><span class="p">)</span>

        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></div>

    <span class="c1"># XXX: all these having_* functions are actually not used anywhere</span>

<div class="viewcode-block" id="PyPath.having_attr"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.having_attr">[docs]</a>    <span class="k">def</span> <span class="nf">having_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if edges or nodes of the network have a specific</span>
<span class="sd">        attribute and returns an iterator of the indices (or the</span>
<span class="sd">        edge/node instances) of edges/nodes having such attribute.</span>

<span class="sd">        :arg str attr:</span>
<span class="sd">            The name of the attribute to look for.</span>
<span class="sd">        :arg igraph.Graph graph:</span>
<span class="sd">            Optional, ``None`` by default. The graph object where the</span>
<span class="sd">            edge/node attribute is to be searched. If none is passed,</span>
<span class="sd">            takes the undirected network of the current instance.</span>
<span class="sd">        :arg bool index:</span>
<span class="sd">            Optional, ``True`` by default. Whether to return the</span>
<span class="sd">            iterator of the indices or the node/edge instances.</span>
<span class="sd">        :arg bool edges:</span>
<span class="sd">            Optional, ``True`` by default. Whether to look for the</span>
<span class="sd">            attribute in the networks edges or nodes instead.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*generator*) -- Generator object containing the edge/node</span>
<span class="sd">            indices (or instances) having the specified attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">es_or_vs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;es&#39;</span> <span class="k">if</span> <span class="n">edges</span> <span class="k">else</span> <span class="s1">&#39;vs&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">es_or_vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">es_or_vs</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">common</span><span class="o">.</span><span class="n">something</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="n">attr</span><span class="p">]):</span>
                    <span class="k">yield</span> <span class="n">i</span><span class="o">.</span><span class="n">index</span> <span class="k">if</span> <span class="n">index</span> <span class="k">else</span> <span class="n">i</span></div>

<div class="viewcode-block" id="PyPath.having_eattr"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.having_eattr">[docs]</a>    <span class="k">def</span> <span class="nf">having_eattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if edges of the network have a specific attribute and</span>
<span class="sd">        returns an iterator of the indices (or the edge instances) of</span>
<span class="sd">        edges having such attribute.</span>

<span class="sd">        :arg str attr:</span>
<span class="sd">            The name of the attribute to look for.</span>
<span class="sd">        :arg igraph.Graph graph:</span>
<span class="sd">            Optional, ``None`` by default. The graph object where the</span>
<span class="sd">            edge/node attribute is to be searched. If none is passed,</span>
<span class="sd">            takes the undirected network of the current instance.</span>
<span class="sd">        :arg bool index:</span>
<span class="sd">            Optional, ``True`` by default. Whether to return the</span>
<span class="sd">            iterator of the indices or the node/edge instances.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*generator*) -- Generator object containing the edge</span>
<span class="sd">            indices (or instances) having the specified attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">having_attr</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.having_vattr"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.having_vattr">[docs]</a>    <span class="k">def</span> <span class="nf">having_vattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if nodes of the network have a specific attribute and</span>
<span class="sd">        returns an iterator of the indices (or the node instances) of</span>
<span class="sd">        nodes having such attribute.</span>

<span class="sd">        :arg str attr:</span>
<span class="sd">            The name of the attribute to look for.</span>
<span class="sd">        :arg igraph.Graph graph:</span>
<span class="sd">            Optional, ``None`` by default. The graph object where the</span>
<span class="sd">            edge/node attribute is to be searched. If none is passed,</span>
<span class="sd">            takes the undirected network of the current instance.</span>
<span class="sd">        :arg bool index:</span>
<span class="sd">            Optional, ``True`` by default. Whether to return the</span>
<span class="sd">            iterator of the indices or the node/edge instances.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*generator*) -- Generator object containing the node</span>
<span class="sd">            indices (or instances) having the specified attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">having_attr</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.having_ptm"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.having_ptm">[docs]</a>    <span class="k">def</span> <span class="nf">having_ptm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if edges of the network have the ``&#39;ptm&#39;`` attribute and</span>
<span class="sd">        returns an iterator of the indices (or the edge instances) of</span>
<span class="sd">        edges having such attribute.</span>

<span class="sd">        :arg bool index:</span>
<span class="sd">            Optional, ``True`` by default. Whether to return the</span>
<span class="sd">            iterator of the indices or the node/edge instances.</span>
<span class="sd">        :arg igraph.Graph graph:</span>
<span class="sd">            Optional, ``None`` by default. The graph object where the</span>
<span class="sd">            edge/node attribute is to be searched. If none is passed,</span>
<span class="sd">            takes the undirected network of the current instance.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*generator*) -- Generator object containing the edge</span>
<span class="sd">            indices (or instances) having the ``ptm&#39;&#39;`` attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">having_eattr</span><span class="p">(</span><span class="s1">&#39;ptm&#39;</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.loop_edges"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.loop_edges">[docs]</a>    <span class="k">def</span> <span class="nf">loop_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an iterator of the indices (or the edge instances) of</span>
<span class="sd">        the edges which represent a loop (whose source and target node</span>
<span class="sd">        are the same).</span>

<span class="sd">        :arg bool index:</span>
<span class="sd">            Optional, ``True`` by default. Whether to return the</span>
<span class="sd">            iterator of the indices or the edge instances.</span>
<span class="sd">        :arg igraph.Graph graph:</span>
<span class="sd">            Optional, ``None`` by default. The graph object where the</span>
<span class="sd">            edge loops are to be searched. If none is passed, takes the</span>
<span class="sd">            undirected network of the current instance.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*generator*) -- Generator object containing the edge</span>
<span class="sd">            indices (or instances) containing loops.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">source</span> <span class="o">==</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">e</span><span class="o">.</span><span class="n">index</span> <span class="k">if</span> <span class="n">index</span> <span class="k">else</span> <span class="n">e</span></div>

    <span class="c1">#</span>
    <span class="c1"># functions to make topological analysis on the graph</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="PyPath.first_neighbours"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.first_neighbours">[docs]</a>    <span class="k">def</span> <span class="nf">first_neighbours</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Looks for the first neighbours of a given node and returns a</span>
<span class="sd">        list of their UniProt IDs.</span>

<span class="sd">        :arg str node:</span>
<span class="sd">            The UniProt ID of the node of interest. Can also be the</span>
<span class="sd">            index of such node [int].</span>
<span class="sd">        :arg bool indices:</span>
<span class="sd">            Optional, ``False`` by default. Whether to return the</span>
<span class="sd">            neighbour nodes indices or their UniProt IDs.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*list*) -- The list containing the first neighbours of the</span>
<span class="sd">            queried node.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">node</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">lst</span>

        <span class="n">lst</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">neighborhood</span><span class="p">(</span><span class="n">node</span><span class="p">))</span> <span class="o">-</span> <span class="nb">set</span><span class="p">([</span><span class="n">node</span><span class="p">]))</span>

        <span class="k">if</span> <span class="n">indices</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">lst</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">nlst</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>
                <span class="n">nlst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

            <span class="k">return</span> <span class="n">nlst</span></div>

<div class="viewcode-block" id="PyPath.second_neighbours"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.second_neighbours">[docs]</a>    <span class="k">def</span> <span class="nf">second_neighbours</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_first</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Looks for the (first and) second neighbours of a given node and</span>
<span class="sd">        returns a list of their UniProt IDs.</span>

<span class="sd">        :arg str node:</span>
<span class="sd">            The UniProt ID of the node of interest. Can also be the</span>
<span class="sd">            index of such node [int].</span>
<span class="sd">        :arg bool indices:</span>
<span class="sd">            Optional, ``False`` by default. Whether to return the</span>
<span class="sd">            neighbour nodes indices or their UniProt IDs.</span>
<span class="sd">        :arg bool wit_first:</span>
<span class="sd">            Optional, ``False`` by default. Whether to return also the</span>
<span class="sd">            first neighbours or not.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*list*) -- The list containing the second neighbours of the</span>
<span class="sd">            queried node (including the first ones if specified).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">node_i</span> <span class="o">=</span> <span class="n">node</span>
            <span class="n">node_n</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">node_i</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">node_i</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">node</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">node_i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">node_i</span> <span class="o">=</span> <span class="n">node_i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
                <span class="n">node_n</span> <span class="o">=</span> <span class="n">node</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">lst</span>

        <span class="n">first</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_neighbours</span><span class="p">(</span><span class="n">node_i</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">first</span><span class="p">:</span>
            <span class="n">lst</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_neighbours</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">with_first</span><span class="p">:</span>
            <span class="n">lst</span> <span class="o">+=</span> <span class="n">first</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">lst</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">first</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">indices</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">([</span><span class="n">node_i</span><span class="p">]))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">([</span><span class="n">node_n</span><span class="p">]))</span></div>

<div class="viewcode-block" id="PyPath.all_neighbours"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.all_neighbours">[docs]</a>    <span class="k">def</span> <span class="nf">all_neighbours</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Looks for the first neighbours of all the nodes and creates an</span>
<span class="sd">        attribute (``&#39;neighbours&#39;``) on each one of them containing a</span>
<span class="sd">        list of their UniProt IDs.</span>

<span class="sd">        :arg bool indices:</span>
<span class="sd">            Optional, ``False`` by default. Whether to list the</span>
<span class="sd">            neighbour nodes indices or their UniProt IDs.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;neighbours&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vcount</span><span class="p">())]</span>
        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">vcount</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Searching neighbours&quot;</span><span class="p">,</span>
                       <span class="n">interval</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>
            <span class="n">v</span><span class="p">[</span><span class="s1">&#39;neighbours&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_neighbours</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">)</span>
            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.jaccard_edges"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.jaccard_edges">[docs]</a>    <span class="k">def</span> <span class="nf">jaccard_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the Jaccard similarity index between the sets of first</span>
<span class="sd">        neighbours of all node pairs. **NOTE:** this method can take a</span>
<span class="sd">        while to compute, e.g.: if the network has 10K nodes, the total</span>
<span class="sd">        number of possible pairs to compute is:</span>

<span class="sd">        .. math::</span>
<span class="sd">          \\binom{10^4}{2} = 49995000</span>

<span class="sd">        :return:</span>
<span class="sd">            (*list*) -- Large list of [tuple] elements containing the</span>
<span class="sd">            node pair names [str] and their corresponding first</span>
<span class="sd">            neighbours Jaccard index [float].</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_neighbours</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">metaEdges</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">vcount</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Calculating Jaccard-indices&quot;</span><span class="p">,</span>
                       <span class="n">interval</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

        <span class="c1"># XXX: could reduce to a single for loop using itertools.combinations()</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">vcount</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>

            <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">vcount</span><span class="p">()):</span>
                <span class="n">vv</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
                <span class="n">vw</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>

        <span class="c1"># XXX: Why not using the function from common.jaccard_index()?</span>

                <span class="n">ja</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">vv</span><span class="p">[</span><span class="s1">&#39;neighbours&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">vw</span><span class="p">[</span><span class="s1">&#39;neighbours&#39;</span><span class="p">]))</span> <span class="o">/</span>
                      <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vv</span><span class="p">[</span><span class="s1">&#39;neighbours&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">vw</span><span class="p">[</span><span class="s1">&#39;neighbours&#39;</span><span class="p">])))</span>
                <span class="n">metaEdges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">vv</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">vw</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">ja</span><span class="p">))</span>

            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">metaEdges</span></div>

    <span class="c1"># XXX: Should consider returning a generator instead of list in the</span>
    <span class="c1">#      function above... that list and pa.graph are overflowing 16GB</span>
    <span class="c1">#      of RAM + 8GB of swap (maybe Chrome and Atom also helping, but</span>
    <span class="c1">#      you get the point)</span>

<div class="viewcode-block" id="PyPath.jaccard_meta"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.jaccard_meta">[docs]</a>    <span class="k">def</span> <span class="nf">jaccard_meta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">jedges</span><span class="p">,</span> <span class="n">critical</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a (undirected) graph from a list of edges filtering by</span>
<span class="sd">        their Jaccard index.</span>

<span class="sd">        :arg list jedges:</span>
<span class="sd">            List of [tuple] containing the edges node names [str] and</span>
<span class="sd">            their Jaccard index. Basically, the output of</span>
<span class="sd">            :py:meth:`pypath.main.PyPath.jaccard_edges`.</span>
<span class="sd">        :arg float critical:</span>
<span class="sd">            Specifies the threshold of the Jaccard index from above</span>
<span class="sd">            which an edge will be included in the graph.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*igraph.Graph*) -- The Undirected graph instance containing</span>
<span class="sd">            only the edges whose Jaccard similarity index is above the</span>
<span class="sd">            threshold specified by *critical*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">edges</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">jedges</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">critical</span><span class="p">:</span>
                <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">igraph</span><span class="o">.</span><span class="n">Graph</span><span class="o">.</span><span class="n">TupleList</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.apply_negative"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.apply_negative">[docs]</a>    <span class="k">def</span> <span class="nf">apply_negative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">settings</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads a negative interaction source (e.g.: Negatome) into the</span>
<span class="sd">        current network.</span>

<span class="sd">        :arg pypath.input_formats.NetworkInput settings:</span>
<span class="sd">            :py:class:`pypath.input_formats.NetworkInput` instance</span>
<span class="sd">            containing the detailed definition of the input format to</span>
<span class="sd">            the downloaded file. For instance</span>
<span class="sd">            :py:data:`pypath.data_formats.negative[&#39;negatome&#39;]`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">negatives</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_network_data</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">negatives</span><span class="p">[</span><span class="n">settings</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span>

        <span class="n">neg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">negatives</span><span class="p">[</span><span class="n">settings</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">neg</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Matching interactions&quot;</span><span class="p">,</span>
                       <span class="n">interval</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;negative&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">([])</span> <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;negative&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;negative&#39;</span><span class="p">]</span>
                            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>
        <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;negative_refs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">([])</span> <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;negative_refs&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span>
                                 <span class="k">else</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;negative_refs&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">neg</span><span class="p">:</span>
            <span class="n">aexists</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="s2">&quot;default_name_a&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
            <span class="n">bexists</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="s2">&quot;default_name_b&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">aexists</span> <span class="ow">and</span> <span class="n">bexists</span><span class="p">:</span>
                <span class="n">edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_exists</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="s2">&quot;default_name_a&quot;</span><span class="p">],</span> <span class="n">n</span><span class="p">[</span><span class="s2">&quot;default_name_b&quot;</span><span class="p">])</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">edge</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                    <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="s1">&#39;negative&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="n">refs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
                        <span class="nb">list</span><span class="p">(</span>
                            <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">_refs</span><span class="o">.</span><span class="n">Reference</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="p">)),</span> <span class="n">n</span><span class="p">[</span>
                                <span class="s1">&#39;attrs_edge&#39;</span><span class="p">][</span><span class="s1">&#39;references&#39;</span><span class="p">])))</span>
                    <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="s1">&#39;negative_refs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">refs</span><span class="p">)</span>
                    <span class="n">matches</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">%u</span><span class="s1"> matches found with negative set</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">matches</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.negative_report"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.negative_report">[docs]</a>    <span class="k">def</span> <span class="nf">negative_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lst</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">outFile</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a report file with the negative interactions (assumed</span>
<span class="sd">        to be already loaded).</span>

<span class="sd">        :arg bool lst:</span>
<span class="sd">            Optional, ``True`` by default. Whether to retun a list of</span>
<span class="sd">            edges containing the edge instances which have negative</span>
<span class="sd">            references.</span>
<span class="sd">        :arg str outFile:</span>
<span class="sd">            Optional, ``None`` by default. The output file name/path. If</span>
<span class="sd">            none is passed, the default is</span>
<span class="sd">            ``&#39;results/&lt;session_id&gt;-negatives&#39;``</span>

<span class="sd">        :return:</span>
<span class="sd">            (*list*) -- If *lst* is set to ``True``, returns a [list]</span>
<span class="sd">            is returned with the :py:class:`igraph.Edge` instances that</span>
<span class="sd">            contain at least a negative reference.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">outFile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">outFile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outdir</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">+</span> <span class="s1">&#39;-negatives&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">genesymbol_labels</span><span class="p">()</span>
        <span class="n">out</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">neg</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;negative&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">outFile</span><span class="p">:</span>
                    <span class="n">out</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                                      <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                                      <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">],</span>
                                      <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">],</span>
                                      <span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">])),</span>
                                      <span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">pmid</span><span class="p">,</span>
                                                   <span class="n">e</span><span class="p">[</span><span class="s1">&#39;references&#39;</span><span class="p">])),</span>
                                      <span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;negative&#39;</span><span class="p">]),</span>
                                      <span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;negative_refs&#39;</span><span class="p">])])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

                <span class="k">if</span> <span class="n">lst</span><span class="p">:</span>
                    <span class="n">neg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">outFile</span><span class="p">:</span>
            <span class="n">outf</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">outFile</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
            <span class="n">outf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
            <span class="n">outf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">lst</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">neg</span></div>

<div class="viewcode-block" id="PyPath.export_ptms_tab"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.export_ptms_tab">[docs]</a>    <span class="k">def</span> <span class="nf">export_ptms_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports a tab file containing the PTM interaction information</span>
<span class="sd">        loaded in the network.</span>

<span class="sd">        :arg str outfile:</span>
<span class="sd">            Optional, ``None`` by default. The output file nama/path to</span>
<span class="sd">            store the PTM information. If none is provided, the default</span>
<span class="sd">            is ``&#39;results/network-&lt;session_id&gt;.tab&#39;``.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*list*) -- Contains the edge indices [int] of all PTM</span>
<span class="sd">            interactions.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># XXX: Shouldn&#39;t we use another default name for the file? too generic</span>
        <span class="c1">#      plus the same one is used in the functions below</span>
        <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">outfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outdir</span><span class="p">,</span>
                                   <span class="s1">&#39;network-&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">+</span> <span class="s1">&#39;.tab&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">genesymbol_labels</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">if</span> <span class="s1">&#39;ddi&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;ddi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="k">if</span> <span class="s1">&#39;ptm&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;UniProt_A&#39;</span><span class="p">,</span> <span class="s1">&#39;UniProt_B&#39;</span><span class="p">,</span> <span class="s1">&#39;GeneSymbol_A&#39;</span><span class="p">,</span> <span class="s1">&#39;GeneSymbol_B&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Databases&#39;</span><span class="p">,</span> <span class="s1">&#39;PubMed_IDs&#39;</span><span class="p">,</span> <span class="s1">&#39;Stimulation&#39;</span><span class="p">,</span> <span class="s1">&#39;Inhibition&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Substrate-isoform&#39;</span><span class="p">,</span> <span class="s1">&#39;Residue_number&#39;</span><span class="p">,</span> <span class="s1">&#39;Residue_letter&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;PTM_type&#39;</span><span class="p">]</span>

        <span class="n">stripJson</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[\[\]</span><span class="si">{}</span><span class="s1">\&quot;]&#39;</span><span class="p">)</span>
        <span class="c1"># first row is header</span>
        <span class="n">outl</span> <span class="o">=</span> <span class="p">[</span><span class="n">header</span><span class="p">]</span>

        <span class="k">with</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">header</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Writing table&#39;</span><span class="p">,</span>
                           <span class="n">interval</span><span class="o">=</span><span class="mi">31</span><span class="p">)</span>
            <span class="n">uniqedges</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>
                <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
                <span class="c1"># only directed</span>

                <span class="k">for</span> <span class="n">di</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">which_dirs</span><span class="p">():</span>
                    <span class="n">src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">di</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                    <span class="n">tgt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">di</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
                    <span class="c1"># uniprot names</span>
                    <span class="n">row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">di</span><span class="p">)</span>
                    <span class="c1"># genesymbols</span>
                    <span class="n">row</span> <span class="o">+=</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">src</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">tgt</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span>
                    <span class="c1"># sources</span>
                    <span class="n">dbs</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span><span class="n">di</span><span class="p">,</span> <span class="n">sources</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dbs</span><span class="p">))</span>
                    <span class="c1"># references</span>
                    <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">r</span> <span class="k">for</span> <span class="n">rs</span> <span class="ow">in</span>
                                         <span class="p">[</span><span class="n">refs</span> <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">refs</span>
                                          <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;refs_by_source&#39;</span><span class="p">])</span>
                                          <span class="k">if</span> <span class="n">db</span> <span class="ow">in</span> <span class="n">dbs</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rs</span><span class="p">]))</span>
                    <span class="c1"># signs</span>
                    <span class="n">row</span> <span class="o">+=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_sign</span><span class="p">(</span><span class="n">di</span><span class="p">)]</span>
                    <span class="c1"># domain-motif</span>
                    <span class="c1"># row.append(&#39;#&#39;.join([x.print_residues() for x in e[&#39;ptm&#39;] \</span>
                    <span class="c1">#    if x.__class__.__name__ == &#39;DomainMotif&#39;]))</span>

                    <span class="k">for</span> <span class="n">dmi</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]:</span>

                        <span class="k">if</span> <span class="n">dmi</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;DomainMotif&#39;</span><span class="p">:</span>

                            <span class="k">if</span> <span class="n">dmi</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">residue</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                                <span class="k">if</span> <span class="n">dmi</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">protein</span> <span class="o">==</span> <span class="n">di</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                                    <span class="n">uniqedges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                                    <span class="n">r</span> <span class="o">=</span> <span class="n">row</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%u</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dmi</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">protein</span><span class="p">,</span>
                                                          <span class="n">dmi</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">isoform</span><span class="p">),</span>
                                               <span class="nb">str</span><span class="p">(</span><span class="n">dmi</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">number</span><span class="p">),</span>
                                               <span class="n">dmi</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                               <span class="n">dmi</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">typ</span><span class="p">]</span>
                                    <span class="c1"># here each ptm in separate row:</span>
                                    <span class="n">outl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
                    <span class="c1"># row complete, appending to main list</span>
                    <span class="c1"># outl.append(row)</span>
                    <span class="c1"># tabular text from list of lists; writing to file</span>

            <span class="n">out</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">outl</span><span class="p">])</span>

            <span class="k">with</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

            <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
            <span class="n">console</span><span class="p">(</span><span class="s1">&#39;:: Data has been written to </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">outfile</span><span class="p">)</span>

            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">uniqedges</span><span class="p">))</span></div>

<div class="viewcode-block" id="PyPath.export_struct_tab"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.export_struct_tab">[docs]</a>    <span class="k">def</span> <span class="nf">export_struct_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports a tab file containing the domain interaction information</span>
<span class="sd">        and PTM regulation loaded in the network.</span>

<span class="sd">        :arg str outfile:</span>
<span class="sd">            Optional, ``None`` by default. The output file nama/path to</span>
<span class="sd">            store the PTM information. If none is provided, the default</span>
<span class="sd">            is ``&#39;results/network-&lt;session_id&gt;.tab&#39;``.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*list*) -- Contains the edge indices [int] of all PTM</span>
<span class="sd">            interactions.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">outfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outdir</span><span class="p">,</span>
                                   <span class="s1">&#39;network-&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">+</span> <span class="s1">&#39;.tab&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">genesymbol_labels</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">if</span> <span class="s1">&#39;ddi&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;ddi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="k">if</span> <span class="s1">&#39;ptm&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;UniProt_A&#39;</span><span class="p">,</span> <span class="s1">&#39;UniProt_B&#39;</span><span class="p">,</span> <span class="s1">&#39;GeneSymbol_B&#39;</span><span class="p">,</span> <span class="s1">&#39;GeneSymbol_A&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Databases&#39;</span><span class="p">,</span> <span class="s1">&#39;PubMed_IDs&#39;</span><span class="p">,</span> <span class="s1">&#39;Stimulation&#39;</span><span class="p">,</span> <span class="s1">&#39;Inhibition&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Domain-domain&#39;</span><span class="p">,</span> <span class="s1">&#39;Domain-motif-PTM&#39;</span><span class="p">,</span> <span class="s1">&#39;PTM-regulation&#39;</span><span class="p">]</span>

        <span class="n">stripJson</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[\[\]</span><span class="si">{}</span><span class="s1">\&quot;]&#39;</span><span class="p">)</span>
        <span class="c1"># first row is header</span>
        <span class="n">outl</span> <span class="o">=</span> <span class="p">[</span><span class="n">header</span><span class="p">]</span>

        <span class="k">with</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">header</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Writing table&#39;</span><span class="p">,</span>
                           <span class="n">interval</span><span class="o">=</span><span class="mi">31</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>
                <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
                <span class="c1"># only directed</span>

                <span class="k">for</span> <span class="n">di</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">which_dirs</span><span class="p">():</span>
                    <span class="n">src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">di</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                    <span class="n">tgt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">di</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
                    <span class="c1"># uniprot names</span>
                    <span class="n">row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">di</span><span class="p">)</span>
                    <span class="c1"># genesymbols</span>
                    <span class="n">row</span> <span class="o">+=</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">src</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">tgt</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span>
                    <span class="c1"># sources</span>
                    <span class="n">dbs</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span><span class="n">di</span><span class="p">,</span> <span class="n">sources</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dbs</span><span class="p">))</span>
                    <span class="c1"># references</span>
                    <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">r</span> <span class="k">for</span> <span class="n">rs</span> <span class="ow">in</span>
                                         <span class="p">[</span><span class="n">refs</span> <span class="k">for</span> <span class="n">db</span><span class="p">,</span> <span class="n">refs</span> <span class="ow">in</span>
                                          <span class="n">iteritems</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;refs_by_source&#39;</span><span class="p">])</span>
                                          <span class="k">if</span> <span class="n">db</span> <span class="ow">in</span> <span class="n">dbs</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rs</span><span class="p">]))</span>
                    <span class="c1"># signs</span>
                    <span class="n">row</span> <span class="o">+=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_sign</span><span class="p">(</span><span class="n">di</span><span class="p">)]</span>
                    <span class="c1"># domain-domain</span>
                    <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;ddi&#39;</span><span class="p">]]))</span>
                    <span class="c1"># domain-motif</span>
                    <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span>
                                         <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;Ptm&#39;</span><span class="p">]))</span>
                    <span class="c1"># domain-motif</span>
                    <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="k">if</span>
                                         <span class="n">x</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;Regulation&#39;</span><span class="p">]))</span>
                    <span class="c1"># row complete, appending to main list</span>
                    <span class="n">outl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

            <span class="c1"># tabular text from list of lists; writing to file</span>
            <span class="n">out</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">outl</span><span class="p">])</span>

            <span class="k">with</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

            <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
            <span class="n">console</span><span class="p">(</span><span class="s1">&#39;:: Data has been written to </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">outfile</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.export_tab"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.export_tab">[docs]</a>    <span class="k">def</span> <span class="nf">export_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extra_node_attrs</span><span class="o">=</span><span class="p">{},</span>
                   <span class="n">extra_edge_attrs</span><span class="o">=</span><span class="p">{},</span> <span class="n">unique_pairs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports the network in a tabular format. By default UniProt IDs,</span>
<span class="sd">        Gene Symbols, source databases, literature references,</span>
<span class="sd">        directionality and sign information and interaction type are</span>
<span class="sd">        included.</span>

<span class="sd">        :arg str outfile:</span>
<span class="sd">            Optional, ``None`` by default. Name/path of the output file.</span>
<span class="sd">            If none is passed, ``&#39;results/netrowk-&lt;session_id&gt;.tab&#39;``</span>
<span class="sd">            is used.</span>
<span class="sd">        :arg dict extra_node_attrs:</span>
<span class="sd">            Optional, ``{}`` by default. Additional node attributes to</span>
<span class="sd">            be included in the exported table. Keys are column names</span>
<span class="sd">            used in the header while values are names of vertex</span>
<span class="sd">            attributes. In the header ``&#39;_A&#39;`` and ``&#39;_B&#39;`` suffixes</span>
<span class="sd">            will be appended to the column names so the values can be</span>
<span class="sd">            assigned to A and B side interaction partners.</span>
<span class="sd">        :arg dict extra_edge_attrs:</span>
<span class="sd">            Optional, ``{}`` by default. Additional edge attributes to</span>
<span class="sd">            be included in the exported table. Keys are column names</span>
<span class="sd">            used in the header while values are names of edge</span>
<span class="sd">            attributes.</span>
<span class="sd">        :arg bool unique_pairs:</span>
<span class="sd">            Optional, ``True`` by default. If set to ``True`` each line</span>
<span class="sd">            corresponds to a unique pair of molecules, all</span>
<span class="sd">            directionality and sign information are covered in other</span>
<span class="sd">            columns. If ``False``, order of ``&#39;A&#39;`` and ``&#39;B&#39;`` IDs</span>
<span class="sd">            corresponds to the direction while sign covered in further</span>
<span class="sd">            columns.</span>
<span class="sd">        :arg \*\* kwargs:</span>
<span class="sd">            Additional keyword arguments passed to</span>
<span class="sd">            :py:class:`pypath.export.Export`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">e</span> <span class="o">=</span> <span class="n">export</span><span class="o">.</span><span class="n">Export</span><span class="p">(</span><span class="n">pa</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">extra_node_attrs</span><span class="o">=</span><span class="n">extra_node_attrs</span><span class="p">,</span>
                          <span class="n">extra_edge_attrs</span><span class="o">=</span><span class="n">extra_edge_attrs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">e</span><span class="o">.</span><span class="n">write_tab</span><span class="p">(</span><span class="n">unique_pairs</span><span class="o">=</span><span class="n">unique_pairs</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="n">outfile</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.export_sif"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.export_sif">[docs]</a>    <span class="k">def</span> <span class="nf">export_sif</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports the network interactions in ``.sif`` format (Simple</span>
<span class="sd">        Interaction Format).</span>

<span class="sd">        :arg str outfile:</span>
<span class="sd">            Optional, ``None`` by default. Name/path of the output file.</span>
<span class="sd">            If none is passed, ``&#39;results/netrowk-&lt;session_id&gt;.sif&#39;``</span>
<span class="sd">            is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">outfile</span> <span class="o">=</span> <span class="p">(</span><span class="n">outfile</span> <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                   <span class="k">else</span> <span class="s1">&#39;network-</span><span class="si">%s</span><span class="s1">.sif&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

                <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dirs</span><span class="p">)</span> <span class="k">if</span> <span class="n">b</span><span class="p">]:</span>

                    <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">is_directed</span><span class="p">()</span> <span class="ow">and</span> <span class="n">d</span> <span class="o">==</span> <span class="s1">&#39;undirected&#39;</span><span class="p">:</span>
                        <span class="k">continue</span>

                    <span class="n">sign</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="s1">&#39;undirected&#39;</span> <span class="k">else</span>
                            <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span>
                                     <span class="nb">enumerate</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_sign</span><span class="p">(</span><span class="n">d</span><span class="p">))</span> <span class="k">if</span> <span class="n">v</span><span class="p">]))</span>
                    <span class="n">dirn</span> <span class="o">=</span> <span class="s1">&#39;=&#39;</span> <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="s1">&#39;undirected&#39;</span> <span class="k">else</span> <span class="s1">&#39;&gt;&#39;</span>
                    <span class="n">source</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                              <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="s1">&#39;undirected&#39;</span> <span class="k">else</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">target</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                              <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="s1">&#39;undirected&#39;</span> <span class="k">else</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">source</span><span class="p">,</span> <span class="n">sign</span> <span class="o">+</span> <span class="n">dirn</span><span class="p">,</span> <span class="n">target</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span></div>

    <span class="c1"># TODO: Further description when function works/know what to do.</span>
<div class="viewcode-block" id="PyPath.export_graphml"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.export_graphml">[docs]</a>    <span class="k">def</span> <span class="nf">export_graphml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;main&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves the network in a ``.graphml`` file.</span>

<span class="sd">        :arg str outfile:</span>
<span class="sd">            Optional, ``None`` by default. Name/path of the output file.</span>
<span class="sd">            If none is passed,</span>
<span class="sd">            ``&#39;results/netrowk-&lt;session_id&gt;.graphml&#39;`` is used.</span>
<span class="sd">        :arg igraph.Graph graph:</span>
<span class="sd">            Optional, ``None`` by default. The network object to be</span>
<span class="sd">            saved. If none is passed, takes the undirected network of</span>
<span class="sd">            the current instance.</span>
<span class="sd">        :arg str name:</span>
<span class="sd">            Optional, ``&#39;main&#39;`` by default. The graph name for the</span>
<span class="sd">            output file.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">genesymbol_labels</span><span class="p">()</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">graph</span>

        <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">outfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outdir</span><span class="p">,</span>
                                   <span class="s1">&#39;network-&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">+</span> <span class="s1">&#39;.graphml&#39;</span><span class="p">)</span>

        <span class="n">is_directed</span> <span class="o">=</span> <span class="s1">&#39;directed&#39;</span> <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">is_directed</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;undirected&#39;</span>
        <span class="n">is_directedB</span> <span class="o">=</span> <span class="s1">&#39;true&#39;</span> <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">is_directed</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;false&#39;</span>
        <span class="n">node_attrs</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;UniProt&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;GeneSymbol&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">),</span>
                     <span class="p">(</span><span class="s1">&#39;Type&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">)]</span>
        <span class="n">edgeAttrs</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Databases&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;PubMedIDs&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">),</span>
                     <span class="p">(</span><span class="s1">&#39;Undirected&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;DirectionAB&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">),</span>
                     <span class="p">(</span><span class="s1">&#39;DirectionBA&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;StimulatoryAB&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">),</span>
                     <span class="p">(</span><span class="s1">&#39;InhibitoryAB&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;StimulatoryBA&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">),</span>
                     <span class="p">(</span><span class="s1">&#39;InhibitoryBA&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Category&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">)]</span>
        <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="s2">                    &lt;graphml xmlns=&quot;http://graphml.graphdrawing.org/xmlns&quot;</span>
<span class="s2">                    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
<span class="s2">                    xsi:schemaLocation=&quot;http://graphml.graphdrawing.org/xmlns</span>
<span class="s2">                    http://graphml.graphdrawing.org/xmlns/1.0/graphml.xsd&quot;&gt;</span><span class="se">\n\n</span>
<span class="s2">                &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">node_attrs</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                    <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&lt;key id=&quot;</span><span class="si">%s</span><span class="s1">&quot; for=&quot;node&quot; attr.name=&quot;</span><span class="si">%s</span><span class="s1">&quot; attr.type=&quot;</span><span class="si">%s</span><span class="s1">&quot; /&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="n">attr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">attr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">attr</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

            <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">edgeAttrs</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                    <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&lt;key id=&quot;</span><span class="si">%s</span><span class="s1">&quot; for=&quot;edge&quot; attr.name=&quot;</span><span class="si">%s</span><span class="s1">&quot; attr.type=&quot;</span><span class="si">%s</span><span class="s1">&quot; /&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="n">attr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">attr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">attr</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&lt;graph id=&quot;</span><span class="si">%s</span><span class="s2">&quot; edgedefault=&quot;</span><span class="si">%s</span><span class="s2">&quot;</span>
<span class="s2">                        parse.nodeids=&quot;free&quot; parse.edgeids=&quot;canonical&quot;</span>
<span class="s2">                        parse.order=&quot;nodesfirst&quot;&gt;</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">is_directed</span><span class="p">))</span>
            <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">vcount</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Writing nodes&#39;</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">31</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">&lt;!-- graph properties --&gt;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">&lt;!-- vertices --&gt;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;node id=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&lt;data key=&quot;UniProt&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/data&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&lt;data key=&quot;GeneSymbol&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/data&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>
                        <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)))</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&lt;data key=&quot;Type&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/data&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]))</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/node&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
            <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">ecount</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Writing edges&#39;</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">31</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">&lt;!-- edges --&gt;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                    <span class="s1">&#39;&lt;edge id=&quot;</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">&quot; source=&quot;</span><span class="si">%s</span><span class="s1">&quot; target=&quot;</span><span class="si">%s</span><span class="s1">&quot; directed=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                       <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">is_directedB</span><span class="p">))</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&lt;data key=&quot;Databases&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/data&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>
                        <span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]))))</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                    <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&lt;data key=&quot;PubMedIDs&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/data&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>
                    <span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">pmid</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;references&#39;</span><span class="p">])))))</span>
    <span class="c1"># XXX: attribute &#39;dirs_by_source&#39; does not exist (nor created anywhere)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                    <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&lt;data key=&quot;Undirected&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/data&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span>
                            <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;undirected&#39;</span><span class="p">]</span>
                        <span class="p">))</span>
                    <span class="p">)</span>
                <span class="p">)</span>

                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                    <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&lt;data key=&quot;DirectionAB&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/data&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span>
                            <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">straight</span><span class="p">]</span>
                        <span class="p">))</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&lt;data key=&quot;DirectionAB&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/data&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>
                        <span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">uniq_list</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs_by_source&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]))))</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&lt;data key=&quot;DirectionBA&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/data&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>
                        <span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">uniq_list</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs_by_source&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]))))</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&lt;data key=&quot;StimulatoryAB&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/data&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>
                        <span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">uniq_list</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;signs&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]))))</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&lt;data key=&quot;InhibitoryAB&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/data&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>
                        <span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">uniq_list</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;signs&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]))))</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&lt;data key=&quot;StimulatoryBA&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/data&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>
                        <span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">uniq_list</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;signs&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]))))</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&lt;data key=&quot;InhibitoryBA&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/data&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>
                        <span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">uniq_list</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;signs&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]))))</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&lt;data key=&quot;InhibitoryBA&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/data&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]))</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&lt;/edge&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">&lt;/graph&gt;</span><span class="se">\n</span><span class="s1">&lt;/graphml&gt;&#39;</span><span class="p">)</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span></div>

    <span class="c1"># XXX: Consider to remove kwarg `multi_query` since it&#39;s not used.</span>
<div class="viewcode-block" id="PyPath.compounds_from_chembl"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.compounds_from_chembl">[docs]</a>    <span class="k">def</span> <span class="nf">compounds_from_chembl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chembl_mysql</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">andor</span><span class="o">=</span><span class="s2">&quot;or&quot;</span><span class="p">,</span> <span class="n">assay_types</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">],</span>
                              <span class="n">relationship_types</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">],</span> <span class="n">multi_query</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads compound data from ChEMBL to the network.</span>

<span class="sd">        :arg tuple chebl_mysql:</span>
<span class="sd">            Optional, ``None`` by default. Contains the MySQL parameters</span>
<span class="sd">            used by the :py:mod:`pypath.mapping` module to loadthe</span>
<span class="sd">            ChEMBL ID conversion tables. If none is passed, takes the</span>
<span class="sd">            current instance :py:attr:`pypath.main.PyPath.chembl_mysql`</span>
<span class="sd">            attribute.</span>
<span class="sd">        :arg list nodes:</span>
<span class="sd">            Optional, ``None`` by default. List of node indices for</span>
<span class="sd">            which the information is to be loaded. If none is provided</span>
<span class="sd">            calls the method :py:meth:`pypath.main.PyPath.get_sub` with</span>
<span class="sd">            the provided *crit* parameter.</span>
<span class="sd">        :arg dict crit:</span>
<span class="sd">            Optional, ``None`` by default. Defines the critical</span>
<span class="sd">            attributes to generate a subnetwork to extract the nodes in</span>
<span class="sd">            case *nodes* is not provided. Keys are ``&#39;edge&#39;`` and</span>
<span class="sd">            ``&#39;node&#39;`` and values are [dict] containing the critical</span>
<span class="sd">            attribute names [str] and values are [set] containing those</span>
<span class="sd">            attributes of the nodes/edges that are to be kept in the</span>
<span class="sd">            subnetwork. If none is provided, takes the whole network.</span>
<span class="sd">        :arg str andor:</span>
<span class="sd">            Optional, ``&#39;or&#39;`` by default. Determines the search mode</span>
<span class="sd">            for the subnetwork generation (if ``nodes=None``). See</span>
<span class="sd">            :py:meth:`pypath.main.PyPath.search_attr_or` and</span>
<span class="sd">            :py:meth:`pypath.main.PyPath.search_attr_and` for more</span>
<span class="sd">            details.</span>
<span class="sd">        :arg list assay_types:</span>
<span class="sd">            Optional, ``[&#39;B&#39;, &#39;F&#39;]`` by default. Types of assay to query</span>
<span class="sd">            Options are: ``&#39;A&#39;`` (ADME), ``&#39;B&#39;`` (Binding),``&#39;F&#39;``</span>
<span class="sd">            (Functional), ``&#39;P&#39;`` (Physicochemical), ``&#39;T&#39;`` (Toxicity)</span>
<span class="sd">            and/or ``&#39;U&#39;`` (Unassigned).</span>
<span class="sd">        :arg list relationship_types:</span>
<span class="sd">            Optional, ``[&#39;D&#39;, &#39;H&#39;]`` by default. Assay relationship</span>
<span class="sd">            types to query. Possible values are: ``&#39;D&#39;`` (Direct protein</span>
<span class="sd">            target assigned), ``&#39;H&#39;`` (Homologous protein target</span>
<span class="sd">            assigned), ``&#39;M&#39;`` (Molecular target other than protein</span>
<span class="sd">            assigned), ``&#39;N&#39;`` (Non-molecular target assigned), ``&#39;S&#39;``</span>
<span class="sd">            (Subcellular target assigned) and/or ``&#39;U&#39;`` (Default value,</span>
<span class="sd">            target has yet to be curated).</span>
<span class="sd">        :arg bool multi_query:</span>
<span class="sd">            Optional, ``False`` by default. Not used.</span>
<span class="sd">        :arg \*\*kwargs:</span>
<span class="sd">            Additional keyword arguments for</span>
<span class="sd">            :py:meth:`pypath.chembl.Chembl.compounds_targets`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">chembl_mysql</span> <span class="o">=</span> <span class="n">chembl_mysql</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">chembl_mysql</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chembl</span> <span class="o">=</span> <span class="n">chembl</span><span class="o">.</span><span class="n">Chembl</span><span class="p">(</span>
            <span class="n">chembl_mysql</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">nodes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">crit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">nodes</span> <span class="o">=</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">sub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sub</span><span class="p">(</span><span class="n">crit</span><span class="o">=</span><span class="n">crit</span><span class="p">,</span> <span class="n">andor</span><span class="o">=</span><span class="n">andor</span><span class="p">)</span>
                <span class="n">nodes</span> <span class="o">=</span> <span class="n">sub</span><span class="p">[</span><span class="s1">&#39;nodes&#39;</span><span class="p">]</span>

        <span class="n">uniprots</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="ow">and</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;id_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">:</span>
                <span class="n">uniprots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">chembl</span><span class="o">.</span><span class="n">compounds_targets</span><span class="p">(</span><span class="n">uniprots</span><span class="p">,</span> <span class="n">assay_types</span><span class="o">=</span><span class="n">assay_types</span><span class="p">,</span>
                                      <span class="n">relationship_types</span><span class="o">=</span><span class="n">relationship_types</span><span class="p">,</span>
                                      <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chembl</span><span class="o">.</span><span class="n">compounds_by_target</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;compounds_chembl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span>
                                             <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;compounds_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span>
                                            <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;compounds_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span>
                                           <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())]</span>
        <span class="n">num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chembl</span><span class="o">.</span><span class="n">compounds</span><span class="p">)</span>
        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">num</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Adding compounds&#39;</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
        <span class="n">hascomp</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">target</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chembl</span><span class="o">.</span><span class="n">compounds</span><span class="p">):</span>
            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>
                <span class="n">hascomp</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">target</span><span class="p">)]</span>
                <span class="n">node</span><span class="p">[</span><span class="s1">&#39;compounds_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>

                <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                    <span class="n">node</span><span class="p">[</span><span class="s1">&#39;compounds_chembl&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp</span><span class="p">[</span><span class="s1">&#39;chembl&#39;</span><span class="p">])</span>
                    <span class="n">node</span><span class="p">[</span><span class="s1">&#39;compounds_names&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">comp</span><span class="p">[</span><span class="s1">&#39;compound_names&#39;</span><span class="p">]</span>

                <span class="n">node</span><span class="p">[</span><span class="s1">&#39;compounds_chembl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">uniq_list</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="s1">&#39;compounds_chembl&#39;</span><span class="p">])</span>
                <span class="n">node</span><span class="p">[</span><span class="s1">&#39;compounds_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">uniq_list</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="s1">&#39;compounds_names&#39;</span><span class="p">])</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
        <span class="n">percent</span> <span class="o">=</span> <span class="n">hascomp</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">Compounds found for </span><span class="si">%u</span><span class="s1"> targets, (</span><span class="si">%.2f%%</span><span class="s1"> of all proteins).</span><span class="se">\n\n</span><span class="s1">&#39;</span>
            <span class="o">%</span> <span class="p">(</span><span class="n">hascomp</span><span class="p">,</span> <span class="n">percent</span> <span class="o">*</span> <span class="mf">100.0</span><span class="p">))</span></div>

    <span class="c1"># XXX: Is it me or this function does not actually filter but only</span>
    <span class="c1">#      computes the score for the edges and that&#39;s all?</span>
<div class="viewcode-block" id="PyPath.network_filter"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.network_filter">[docs]</a>    <span class="k">def</span> <span class="nf">network_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">2.0</span><span class="p">):</span> <span class="c1"># TODO</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function aims to cut the number of edges in the network,</span>
<span class="sd">        without losing nodes, to make the network less connected,</span>
<span class="sd">        less hairball-like, more usable for analysis.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ref_freq</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">:</span>
            <span class="n">ref_freq</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]:</span>

                    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;refs_by_source&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">]:</span>

                        <span class="k">if</span> <span class="n">r</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ref_freq</span><span class="p">[</span><span class="n">s</span><span class="p">]:</span>
                            <span class="n">ref_freq</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">ref_freq</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">r</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span>
        <span class="n">deg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
        <span class="n">avdeg</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">deg</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">deg</span><span class="p">)</span>
        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">(),</span> <span class="s1">&#39;Calculating scores&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>
            <span class="n">score</span> <span class="o">=</span> <span class="mf">0.0</span>

            <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">rs</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;refs_by_source&#39;</span><span class="p">]):</span>

                <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rs</span><span class="p">:</span>
                    <span class="n">score</span> <span class="o">+=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">ref_freq</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">r</span><span class="p">]</span>

            <span class="n">mindeg</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">]</span><span class="o">.</span><span class="n">degree</span><span class="p">(),</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">degree</span><span class="p">())</span>

            <span class="k">if</span> <span class="n">mindeg</span> <span class="o">&lt;</span> <span class="n">avdeg</span><span class="p">:</span>
                <span class="n">score</span> <span class="o">*=</span> <span class="nb">pow</span><span class="p">((</span><span class="n">mindeg</span> <span class="o">-</span> <span class="n">avdeg</span><span class="p">),</span> <span class="n">p</span><span class="p">)</span>

            <span class="n">e</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">score</span>
            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.shortest_path_dist"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.shortest_path_dist">[docs]</a>    <span class="k">def</span> <span class="nf">shortest_path_dist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the distribution of shortest paths for each pair of</span>
<span class="sd">        nodes in the network (or between group(s) of nodes if *subset*</span>
<span class="sd">        is provided). **NOTE:** this method can take a while to compute,</span>
<span class="sd">        e.g.: if the network has 10K nodes, the total number of possible</span>
<span class="sd">        pairs to compute is:</span>

<span class="sd">        .. math::</span>
<span class="sd">          \\binom{10^4}{2} = 49995000</span>

<span class="sd">        :arg igraph.Graph graph:</span>
<span class="sd">            Optional, ``None`` by default. The network object for which</span>
<span class="sd">            the shortest path distribution is to be computed. If none is</span>
<span class="sd">            passed, takes the undirected network of the current</span>
<span class="sd">            instance.</span>
<span class="sd">        :arg tuple susbet:</span>
<span class="sd">            Optional, ``None`` by default. Contains two lists of node</span>
<span class="sd">            indices defining two groups between which the distribution</span>
<span class="sd">            is to be computed. Can also be [list] if the shortest paths</span>
<span class="sd">            are to be searched whithin the group. If none is passed, the</span>
<span class="sd">            whole network is taken by default.</span>
<span class="sd">        :arg str outfile:</span>
<span class="sd">            Optional, ``None`` by default. File name/path to save the</span>
<span class="sd">            shortest path distribution. If none is passed, no file is</span>
<span class="sd">            generated.</span>
<span class="sd">        :arg \*\*kwargs:</span>
<span class="sd">            Additional keyword arguments passed to</span>
<span class="sd">            :py:meth:`igraph.Graph.get_shortest_paths`.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*list*) -- The length of the shortest paths for each pair</span>
<span class="sd">            of nodes of the network (or whithin/between group/s if</span>
<span class="sd">            *subset* is provided).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">shortest_paths</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">subset</span> <span class="o">=</span> <span class="p">(</span><span class="n">subset</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subset</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">or</span> <span class="n">subset</span> <span class="ow">is</span> <span class="kc">None</span>
                  <span class="k">else</span> <span class="p">(</span><span class="n">subset</span><span class="p">,</span> <span class="n">subset</span><span class="p">))</span>
        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">(),</span> <span class="s1">&#39;Calculating paths&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span> <span class="c1"># i = node index</span>

            <span class="k">if</span> <span class="n">subset</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">subset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">subset</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">paths</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">get_shortest_paths</span><span class="p">(</span><span class="n">i</span><span class="p">,</span>
                                                 <span class="n">xrange</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()),</span>
                                                 <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)):</span> <span class="c1"># j = `paths` list index</span>
    <span class="c1"># XXX: Or I&#39;m missing something or something&#39;s wrong here... you&#39;re</span>
    <span class="c1">#      adding a node index to a index of the `paths` list and checking</span>
    <span class="c1">#      if such number is in a subset?</span>
                    <span class="k">if</span> <span class="n">subset</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span>
                            <span class="n">i</span> <span class="ow">in</span> <span class="n">subset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span> <span class="ow">in</span> <span class="n">subset</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">or</span> <span class="p">(</span>
                                <span class="n">i</span> <span class="ow">in</span> <span class="n">subset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span> <span class="ow">in</span> <span class="n">subset</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="n">shortest_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>

            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">shortest_paths</span><span class="p">])</span>

            <span class="k">with</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">shortest_paths</span></div>

<div class="viewcode-block" id="PyPath.load_pdb"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_pdb">[docs]</a>    <span class="k">def</span> <span class="nf">load_pdb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads the 3D structure information from PDB into the network.</span>
<span class="sd">        Creates the node attribute ``&#39;pdb&#39;`` containing a [dict] whose</span>
<span class="sd">        keys are the PDB identifier [str] and values are [tuple] of two</span>
<span class="sd">        elements denoting the experimental method [str] (e.g.:</span>
<span class="sd">        ``&#39;X-ray&#39;``, ``&#39;NMR&#39;``, ...) and the resolution [float] (if</span>
<span class="sd">        applicable).</span>

<span class="sd">        :arg igraph.Graph graph:</span>
<span class="sd">            Optional, ``None`` by default. The network object for which</span>
<span class="sd">            the information is to be loaded. If none is passed, takes</span>
<span class="sd">            the undirected network of the current instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">u_pdb</span><span class="p">,</span> <span class="n">pdb_u</span> <span class="o">=</span> <span class="n">pdb_input</span><span class="o">.</span><span class="n">pdb_uniprot</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">u_pdb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Failed to download UniProt-PDB dictionary&#39;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;pdb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>
                <span class="n">v</span><span class="p">[</span><span class="s1">&#39;pdb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

                <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">u_pdb</span><span class="p">:</span>

                    <span class="k">for</span> <span class="n">pdb</span> <span class="ow">in</span> <span class="n">u_pdb</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]:</span>
                        <span class="n">v</span><span class="p">[</span><span class="s1">&#39;pdb&#39;</span><span class="p">][</span><span class="n">pdb</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="n">pdb</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pdb</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;PDB IDs for proteins has been retrieved.&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.load_pfam"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_pfam">[docs]</a>    <span class="k">def</span> <span class="nf">load_pfam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads the protein family information from UniProt into the</span>
<span class="sd">        network. Creates the node attribute ``&#39;pfam&#39;`` containing a</span>
<span class="sd">        [list] of protein family identifier(s) [str].</span>

<span class="sd">        :arg igraph.Graph graph:</span>
<span class="sd">            Optional, ``None`` by default. The network object for which</span>
<span class="sd">            the information is to be loaded. If none is passed, takes</span>
<span class="sd">            the undirected network of the current instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">u_pfam</span><span class="p">,</span> <span class="n">pfam_u</span> <span class="o">=</span> <span class="n">pfam_input</span><span class="o">.</span><span class="n">pfam_uniprot</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">u_pfam</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Failed to download Pfam data from UniProt&#39;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
        <span class="c1"># FIXME: should assign `[None]` if the attribute is empty not otherwise</span>
            <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;pfam&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>
                <span class="n">v</span><span class="p">[</span><span class="s1">&#39;pfam&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">u_pfam</span><span class="p">:</span>
                    <span class="n">v</span><span class="p">[</span><span class="s1">&#39;pfam&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">u_pfam</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Pfam domains has been retrieved.&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.load_pfam2"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_pfam2">[docs]</a>    <span class="k">def</span> <span class="nf">load_pfam2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads the protein family information from Pfam into the network.</span>
<span class="sd">        Creates the node attribute ``&#39;pfam&#39;`` containing a [list] of</span>
<span class="sd">        [dict] whose keys are protein family identifier(s) [str] and</span>
<span class="sd">        corresponding values are [list] of [dict] containing detailed</span>
<span class="sd">        information about the protein family(ies) for regions and</span>
<span class="sd">        isoforms of the protein.</span>

<span class="sd">        :arg igraph.Graph graph:</span>
<span class="sd">            Optional, ``None`` by default. The network object for which</span>
<span class="sd">            the information is to be loaded. If none is passed, takes</span>
<span class="sd">            the undirected network of the current instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pfam_regions</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">u_pfam</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Failed to download data from Pfam&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;pfam&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">u_pfam</span><span class="p">:</span>
                    <span class="n">v</span><span class="p">[</span><span class="s1">&#39;pfam&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">u_pfam</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Pfam domains has been retrieved.&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.load_pfam3"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_pfam3">[docs]</a>    <span class="k">def</span> <span class="nf">load_pfam3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads the protein domain information from Pfam into the network.</span>
<span class="sd">        Creates the node attribute ``&#39;doms&#39;`` containing a [list] of</span>
<span class="sd">        :py:class:`pypath.intera.Domain` instances with information</span>
<span class="sd">        about each domain of the protein (see the corresponding class</span>
<span class="sd">        documentation for more information).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pfam_regions</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">u_pfam</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Failed to download data from Pfam&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;doms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">u_pfam</span><span class="p">:</span>

                    <span class="k">for</span> <span class="n">pfam</span><span class="p">,</span> <span class="n">regions</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">u_pfam</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]):</span>

                        <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
                            <span class="n">v</span><span class="p">[</span><span class="s1">&#39;doms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                <span class="n">intera</span><span class="o">.</span><span class="n">Domain</span><span class="p">(</span>
                                    <span class="n">protein</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                                    <span class="n">domain</span><span class="o">=</span><span class="n">pfam</span><span class="p">,</span>
                                    <span class="n">start</span><span class="o">=</span><span class="n">region</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">],</span>
                                    <span class="n">end</span><span class="o">=</span><span class="n">region</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">],</span>
                                    <span class="n">isoform</span><span class="o">=</span><span class="n">region</span><span class="p">[</span><span class="s1">&#39;isoform&#39;</span><span class="p">]))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Pfam domains has been retrieved.&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.load_corum"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_corum">[docs]</a>    <span class="k">def</span> <span class="nf">load_corum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads complexes from CORUM database. Loads data into vertex attribute</span>
<span class="sd">        `graph.vs[&#39;complexes&#39;][&#39;corum&#39;]`.</span>
<span class="sd">        This resource is human only.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">complexes</span><span class="p">,</span> <span class="n">members</span> <span class="o">=</span> <span class="n">corum</span><span class="o">.</span><span class="n">corum_complexes</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">complexes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Failed to download data from CORUM&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">init_complex_attr</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;corum&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">cs</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">members</span><span class="p">):</span>
                <span class="n">sw</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span> <span class="mi">9606</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sw</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]:</span>

                        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cs</span><span class="p">:</span>
                            <span class="n">others</span> <span class="o">=</span> <span class="p">[]</span>

                            <span class="k">for</span> <span class="n">memb</span> <span class="ow">in</span> <span class="n">complexes</span><span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">]:</span>
                                <span class="n">others</span> <span class="o">+=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">memb</span><span class="p">,</span>
                                                               <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                                                               <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                                                               <span class="mi">9606</span><span class="p">)</span>

                            <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
                                <span class="n">name</span><span class="o">=</span><span class="n">s</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;complexes&#39;</span><span class="p">][</span><span class="s1">&#39;corum&#39;</span><span class="p">][</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
                                    <span class="s1">&#39;full_name&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                    <span class="s1">&#39;all_members&#39;</span><span class="p">:</span> <span class="n">others</span><span class="p">,</span>
                                    <span class="s1">&#39;all_members_original&#39;</span><span class="p">:</span> <span class="n">complexes</span><span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">],</span>
                                    <span class="s1">&#39;references&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                    <span class="s1">&#39;functions&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
                                    <span class="s1">&#39;diseases&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
                                <span class="p">}</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Complexes from CORUM have been retrieved.&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.init_complex_attr"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.init_complex_attr">[docs]</a>    <span class="k">def</span> <span class="nf">init_complex_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="s1">&#39;complexes&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">v</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">]:</span>
                <span class="n">v</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span></div>

<div class="viewcode-block" id="PyPath.load_havugimana"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_havugimana">[docs]</a>    <span class="k">def</span> <span class="nf">load_havugimana</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads complexes from Havugimana 2012. Loads data into vertex attribute</span>
<span class="sd">        `graph.vs[&#39;complexes&#39;][&#39;havugimana&#39;]`.</span>
<span class="sd">        This resource is human only.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">complexes</span> <span class="o">=</span> <span class="n">havugimana</span><span class="o">.</span><span class="n">havugimana_complexes</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">complexes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Failed to read data from Havugimana&#39;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">init_complex_attr</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;havugimana&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">complexes</span><span class="p">:</span>
                <span class="n">membs</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">for</span> <span class="n">memb</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
                    <span class="n">membs</span> <span class="o">+=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">memb</span><span class="p">,</span>
                                                  <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                                                  <span class="mi">9606</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">membs</span><span class="p">:</span>
                    <span class="n">names</span> <span class="o">+=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">u</span><span class="p">,</span>
                                                  <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;genesymbol&#39;</span><span class="p">,</span>
                                                  <span class="mi">9606</span><span class="p">)</span>

                <span class="n">names</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">names</span><span class="p">))</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">membs</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]:</span>
                        <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
                            <span class="n">name</span><span class="o">=</span><span class="n">u</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;complexes&#39;</span><span class="p">][</span><span class="s1">&#39;havugimana&#39;</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                                <span class="s1">&#39;full_name&#39;</span><span class="p">:</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; complex&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;all_members&#39;</span><span class="p">:</span> <span class="n">membs</span><span class="p">,</span>
                                <span class="s1">&#39;all_members_original&#39;</span><span class="p">:</span> <span class="n">c</span>
                            <span class="p">}</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Complexes from Havugimana have been retrieved.&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.load_compleat"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_compleat">[docs]</a>    <span class="k">def</span> <span class="nf">load_compleat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads complexes from Compleat. Loads data into vertex attribute</span>
<span class="sd">        `graph.vs[&#39;complexes&#39;][&#39;compleat&#39;]`.</span>
<span class="sd">        This resource is human only.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">complexes</span> <span class="o">=</span> <span class="n">compleat</span><span class="o">.</span><span class="n">compleat_complexes</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">complexes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Failed to load data from COMPLEAT&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">init_complex_attr</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;compleat&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">complexes</span><span class="p">:</span>
                <span class="n">c</span><span class="p">[</span><span class="s1">&#39;uniprots&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">c</span><span class="p">[</span><span class="s1">&#39;gsymbols&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;entrez&#39;</span><span class="p">]:</span>
                    <span class="n">c</span><span class="p">[</span><span class="s1">&#39;uniprots&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">e</span><span class="p">,</span>
                                                          <span class="s1">&#39;entrez&#39;</span><span class="p">,</span>
                                                          <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                                                          <span class="mi">9606</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;uniprots&#39;</span><span class="p">]:</span>
                    <span class="n">c</span><span class="p">[</span><span class="s1">&#39;gsymbols&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">u</span><span class="p">,</span>
                                                          <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                                                          <span class="s1">&#39;genesymbol&#39;</span><span class="p">,</span>
                                                          <span class="mi">9606</span><span class="p">)</span>

                <span class="n">c</span><span class="p">[</span><span class="s1">&#39;gsymbols&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                    <span class="nb">set</span><span class="p">([</span><span class="n">gs</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">gs</span> <span class="ow">in</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;gsymbols&#39;</span><span class="p">]]))</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;uniprots&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

                    <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;uniprots&#39;</span><span class="p">]:</span>

                        <span class="k">if</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]:</span>
                            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;gsymbols&#39;</span><span class="p">])</span>
                            <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
                                <span class="n">name</span><span class="o">=</span><span class="n">u</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;complexes&#39;</span><span class="p">][</span><span class="s1">&#39;compleat&#39;</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                                    <span class="s1">&#39;full_name&#39;</span><span class="p">:</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; complex&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;all_members&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;uniprots&#39;</span><span class="p">],</span>
                                    <span class="s1">&#39;all_members_original&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;entrez&#39;</span><span class="p">],</span>
                                    <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">],</span>
                                    <span class="s1">&#39;references&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;pubmeds&#39;</span><span class="p">]</span>
                                <span class="p">}</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Complexes from COMPLEAT have been retrieved.&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.load_complexportal"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_complexportal">[docs]</a>    <span class="k">def</span> <span class="nf">load_complexportal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads complexes from ComplexPortal. Loads data into vertex attribute</span>
<span class="sd">        `graph.vs[&#39;complexes&#39;][&#39;complexportal&#39;]`.</span>
<span class="sd">        This resource is human only.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="c1"># TODO: handling species</span>
        <span class="n">complexes</span> <span class="o">=</span> <span class="n">complexportal</span><span class="o">.</span><span class="n">complexportal_complexes</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">complexes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Failed to read data from ComplexPortal&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">if</span> <span class="s1">&#39;complexes&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">v</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

                <span class="k">if</span> <span class="s1">&#39;complexportal&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">]:</span>
                    <span class="n">v</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">][</span><span class="s1">&#39;complexportal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">complexes</span><span class="p">:</span>
                <span class="n">swprots</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">if</span> <span class="s1">&#39;complex recommended name&#39;</span> <span class="ow">in</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">]:</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">][</span><span class="s1">&#39;complex recommended name&#39;</span><span class="p">]</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;fullname&#39;</span><span class="p">]</span>

                <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;uniprots&#39;</span><span class="p">]:</span>
                    <span class="n">swprots</span> <span class="o">+=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">u</span><span class="p">,</span>
                                                    <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                                                    <span class="mi">9606</span><span class="p">)</span>

                <span class="n">swprots</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">swprots</span><span class="p">))</span>

                <span class="k">for</span> <span class="n">sw</span> <span class="ow">in</span> <span class="n">swprots</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">sw</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]:</span>
                        <span class="n">v</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">sw</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">v</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">][</span><span class="s1">&#39;complexportal&#39;</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="s1">&#39;full_name&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;fullname&#39;</span><span class="p">],</span>
                            <span class="s1">&#39;all_members&#39;</span><span class="p">:</span> <span class="n">swprots</span><span class="p">,</span>
                            <span class="s1">&#39;all_members_original&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;uniprots&#39;</span><span class="p">],</span>
                            <span class="s1">&#39;pdbs&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;pdbs&#39;</span><span class="p">],</span>
                            <span class="s1">&#39;references&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;pubmeds&#39;</span><span class="p">],</span>
                            <span class="s1">&#39;synonyms&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">],</span>
                            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
                        <span class="p">}</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Complexes from Complex Portal have been retrieved.&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.load_3dcomplexes"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_3dcomplexes">[docs]</a>    <span class="k">def</span> <span class="nf">load_3dcomplexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">c3d</span> <span class="o">=</span> <span class="n">threedcomplex</span><span class="o">.</span><span class="n">threedcomplex_ddi</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">c3d</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Failed to download data from 3DComplex and PDB&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">if</span> <span class="s1">&#39;complexes&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">v</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

                <span class="k">if</span> <span class="s1">&#39;3dcomplexes&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">]:</span>
                    <span class="n">v</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">][</span><span class="s1">&#39;3dcomplexes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">if</span> <span class="s1">&#39;3dstructure&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;3dstructure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;3dstructure&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">e</span><span class="p">[</span><span class="s1">&#39;3dstructure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

                <span class="k">if</span> <span class="s1">&#39;3dcomplexes&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;3dstructure&#39;</span><span class="p">]:</span>
                    <span class="n">e</span><span class="p">[</span><span class="s1">&#39;3dstructure&#39;</span><span class="p">][</span><span class="s1">&#39;3dcomplexes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="n">compl_names</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">compl_membs</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">compl_links</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c3d</span><span class="p">),</span> <span class="s1">&#39;Processing complexes&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">cname</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">c3d</span><span class="p">):</span>
                <span class="n">swprots</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">uprots</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">for</span> <span class="n">ups</span><span class="p">,</span> <span class="n">contact</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
                    <span class="n">uprots</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ups</span><span class="p">)</span>
                    <span class="n">up1s</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">ups</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">up1</span> <span class="ow">in</span> <span class="n">up1s</span><span class="p">:</span>
                        <span class="n">inRefLists</span> <span class="o">=</span> <span class="kc">False</span>

                        <span class="k">for</span> <span class="n">tax</span><span class="p">,</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reflists</span><span class="p">):</span>

                            <span class="k">if</span> <span class="n">up1</span> <span class="ow">in</span> <span class="n">lst</span><span class="o">.</span><span class="n">lst</span><span class="p">:</span>
                                <span class="n">up2s</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">ups</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                                                            <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>

                                <span class="k">for</span> <span class="n">up2</span> <span class="ow">in</span> <span class="n">up2s</span><span class="p">:</span>

                                    <span class="k">for</span> <span class="n">tax</span><span class="p">,</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reflists</span><span class="p">):</span>

                                        <span class="k">if</span> <span class="n">up2</span> <span class="ow">in</span> <span class="n">lst</span><span class="o">.</span><span class="n">lst</span><span class="p">:</span>
                                            <span class="n">inRefLists</span> <span class="o">=</span> <span class="kc">True</span>
                                            <span class="n">thisPair</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">up1</span><span class="p">,</span> <span class="n">up2</span><span class="p">])</span>
                                            <span class="n">swprots</span> <span class="o">+=</span> <span class="n">thisPair</span>
                                            <span class="n">compl_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                                <span class="p">(</span><span class="n">thisPair</span><span class="p">,</span> <span class="n">contact</span><span class="p">,</span> <span class="n">cname</span><span class="p">))</span>
                                            <span class="k">break</span>

                <span class="n">swprots</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">swprots</span><span class="p">))</span>
                <span class="n">uprots</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">uprots</span><span class="p">))</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">swprots</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="p">[]</span>

                    <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">swprots</span><span class="p">:</span>
                        <span class="n">name</span> <span class="o">+=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span>
                                                     <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                                                     <span class="s1">&#39;genesymbol&#39;</span><span class="p">,</span>
                                                     <span class="mi">9606</span><span class="p">)</span>

                    <span class="n">compl_names</span><span class="p">[</span><span class="n">cname</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; complex&#39;</span>
                    <span class="n">compl_membs</span><span class="p">[</span><span class="n">cname</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">swprots</span><span class="p">,</span> <span class="n">uprots</span><span class="p">)</span>

                <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

            <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
            <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">compl_membs</span><span class="p">),</span> <span class="s1">&#39;Processing nodes&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">cname</span><span class="p">,</span> <span class="n">uniprots</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">compl_membs</span><span class="p">):</span>

                <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">uniprots</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>

                    <span class="k">if</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]:</span>
                        <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
                            <span class="n">name</span><span class="o">=</span><span class="n">sp</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;complexes&#39;</span><span class="p">][</span><span class="s1">&#39;3dcomplexes&#39;</span><span class="p">][</span><span class="n">cname</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                                <span class="s1">&#39;full_name&#39;</span><span class="p">:</span> <span class="n">compl_names</span><span class="p">[</span><span class="n">cname</span><span class="p">],</span>
                                <span class="s1">&#39;all_members&#39;</span><span class="p">:</span> <span class="n">uniprots</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                <span class="s1">&#39;all_members_original&#39;</span><span class="p">:</span> <span class="n">uniprots</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                            <span class="p">}</span>

                <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

            <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
            <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">compl_links</span><span class="p">),</span> <span class="s1">&#39;Processing edges&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">links</span> <span class="ow">in</span> <span class="n">compl_links</span><span class="p">:</span>
                <span class="n">one</span> <span class="o">=</span> <span class="n">links</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">two</span> <span class="o">=</span> <span class="n">links</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">one</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">two</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]:</span>
                    <span class="n">nodeOne</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">one</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
                    <span class="n">nodeTwo</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">two</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>

                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">edge</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">_between</span><span class="o">=</span><span class="p">((</span><span class="n">nodeOne</span><span class="p">,</span> <span class="p">),</span>
                                                         <span class="p">(</span><span class="n">nodeTwo</span><span class="p">,</span> <span class="p">)))[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">edge</span><span class="p">[</span><span class="s1">&#39;3dstructure&#39;</span><span class="p">][</span><span class="s1">&#39;3dcomplexes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                            <span class="s1">&#39;pdb&#39;</span><span class="p">:</span> <span class="n">links</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
                            <span class="s1">&#39;numof_residues&#39;</span><span class="p">:</span> <span class="n">links</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="p">})</span>

                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>

                <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
            <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.load_pisa"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_pisa">[docs]</a>    <span class="k">def</span> <span class="nf">load_pisa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">if</span> <span class="s1">&#39;complexes&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">()</span> \
                <span class="ow">or</span> <span class="s1">&#39;3dcomplexes&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;complexes&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_3dcomplexes</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;complexportal&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;complexes&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_complexportal</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span>

        <span class="n">pdblist</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">][</span><span class="s1">&#39;3dcomplexes&#39;</span><span class="p">]):</span>
                <span class="n">pdblist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">][</span><span class="s1">&#39;complexportal&#39;</span><span class="p">]):</span>
                <span class="n">pdblist</span> <span class="o">+=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;pdbs&#39;</span><span class="p">]</span>

        <span class="n">pdblist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">pdblist</span><span class="p">))</span>
        <span class="n">pisa</span><span class="p">,</span> <span class="n">unmapped</span> <span class="o">=</span> <span class="n">pisa</span><span class="o">.</span><span class="n">pisa_interfaces</span><span class="p">(</span><span class="n">pdblist</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;interfaces&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;interfaces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;interfaces&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;interfaces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">if</span> <span class="s1">&#39;pisa&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;interfaces&#39;</span><span class="p">]:</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;interfaces&#39;</span><span class="p">][</span><span class="s1">&#39;pisa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">pdb</span><span class="p">,</span> <span class="n">iflist</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">pisa</span><span class="p">):</span>

            <span class="k">for</span> <span class="n">uniprots</span><span class="p">,</span> <span class="n">intf</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">iflist</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">uniprots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">uniprots</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span>
                        <span class="s1">&#39;name&#39;</span><span class="p">]:</span>
                    <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_exists</span><span class="p">(</span><span class="n">uniprots</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">uniprots</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>

                        <span class="k">if</span> <span class="n">pdb</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;interfaces&#39;</span><span class="p">][</span><span class="s1">&#39;pisa&#39;</span><span class="p">]:</span>
                            <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;interfaces&#39;</span><span class="p">][</span><span class="s1">&#39;pisa&#39;</span><span class="p">][</span><span class="n">pdb</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                        <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;interfaces&#39;</span><span class="p">][</span><span class="s1">&#39;pisa&#39;</span><span class="p">][</span><span class="n">pdb</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">intf</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">unmapped</span></div>

<div class="viewcode-block" id="PyPath.find_complex"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.find_complex">[docs]</a>    <span class="k">def</span> <span class="nf">find_complex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Finds complexes by their non standard names.</span>
<span class="sd">        E.g. to find DNA polymerases you can use the search</span>
<span class="sd">        term `DNA pol` which will be tested against complex names</span>
<span class="sd">        in CORUM.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">comp</span><span class="p">,</span> <span class="n">memb</span> <span class="o">=</span> <span class="n">corum</span><span class="o">.</span><span class="n">corum_complexes</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">cname</span><span class="p">,</span> <span class="n">cdata</span> <span class="ow">in</span> <span class="n">comp</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

            <span class="k">if</span> <span class="n">search</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">cname</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cname</span><span class="p">,</span> <span class="n">cdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">result</span></div>


    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">vertex_name</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>

        <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">igraph</span><span class="o">.</span><span class="n">Vertex</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span>


    <span class="k">def</span> <span class="nf">get_entity_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entity</span><span class="p">):</span>

        <span class="n">entity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex_name</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">entity_mod</span><span class="o">.</span><span class="n">Entity</span><span class="o">.</span><span class="n">_get_entity_type</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">is_protein</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entity</span><span class="p">):</span>

        <span class="n">entity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex_name</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">entity_mod</span><span class="o">.</span><span class="n">Entity</span><span class="o">.</span><span class="n">_is_protein</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">is_complex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entity</span><span class="p">):</span>

        <span class="n">entity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex_name</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">entity_mod</span><span class="o">.</span><span class="n">Entity</span><span class="o">.</span><span class="n">_is_complex</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">is_mirna</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entity</span><span class="p">):</span>

        <span class="n">entity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertex_name</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">entity_mod</span><span class="o">.</span><span class="n">Entity</span><span class="o">.</span><span class="n">_is_mirna</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>


<div class="viewcode-block" id="PyPath.genesymbol"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.genesymbol">[docs]</a>    <span class="k">def</span> <span class="nf">genesymbol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genesymbol</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``igraph.Vertex()`` object if the GeneSymbol</span>
<span class="sd">        can be found in the default undirected network,</span>
<span class="sd">        otherwise ``None``.</span>

<span class="sd">        @genesymbol : str</span>
<span class="sd">            GeneSymbol.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_undirected</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">labDct</span><span class="p">[</span><span class="n">genesymbol</span><span class="p">]]</span> \
            <span class="k">if</span> <span class="n">genesymbol</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labDct</span> <span class="k">else</span> <span class="kc">None</span></div>

    <span class="n">gs</span> <span class="o">=</span> <span class="n">genesymbol</span>

<div class="viewcode-block" id="PyPath.dgenesymbol"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.dgenesymbol">[docs]</a>    <span class="k">def</span> <span class="nf">dgenesymbol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genesymbol</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``igraph.Vertex()`` object if the GeneSymbol</span>
<span class="sd">        can be found in the default directed network,</span>
<span class="sd">        otherwise ``None``.</span>

<span class="sd">        @genesymbol : str</span>
<span class="sd">            GeneSymbol.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dgraph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_directed</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">dgraph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlabDct</span><span class="p">[</span><span class="n">genesymbol</span><span class="p">]]</span> \
            <span class="k">if</span> <span class="n">genesymbol</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlabDct</span> <span class="k">else</span> <span class="kc">None</span></div>

    <span class="n">dgs</span> <span class="o">=</span> <span class="n">dgenesymbol</span>

<div class="viewcode-block" id="PyPath.genesymbols"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.genesymbols">[docs]</a>    <span class="k">def</span> <span class="nf">genesymbols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genesymbols</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">genesymbol</span><span class="p">,</span> <span class="n">genesymbols</span><span class="p">))</span></div>

    <span class="n">gss</span> <span class="o">=</span> <span class="n">genesymbols</span>

<div class="viewcode-block" id="PyPath.dgenesymbols"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.dgenesymbols">[docs]</a>    <span class="k">def</span> <span class="nf">dgenesymbols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genesymbols</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dgenesymbol</span><span class="p">,</span> <span class="n">genesymbols</span><span class="p">))</span></div>

    <span class="n">dgss</span> <span class="o">=</span> <span class="n">dgenesymbols</span>

<div class="viewcode-block" id="PyPath.uniprot"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.uniprot">[docs]</a>    <span class="k">def</span> <span class="nf">uniprot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uniprot</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``igraph.Vertex()`` object if the UniProt</span>
<span class="sd">        can be found in the default undirected network,</span>
<span class="sd">        otherwise ``None``.</span>

<span class="sd">        @uniprot : str</span>
<span class="sd">            UniProt ID.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_undirected</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">uniprot</span><span class="p">]]</span> \
            <span class="k">if</span> <span class="n">uniprot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span> <span class="k">else</span> <span class="kc">None</span></div>

    <span class="n">up</span> <span class="o">=</span> <span class="n">uniprot</span>

<div class="viewcode-block" id="PyPath.duniprot"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.duniprot">[docs]</a>    <span class="k">def</span> <span class="nf">duniprot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uniprot</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Same as ``PyPath.uniprot(), just for directed graph.</span>
<span class="sd">        Returns ``igraph.Vertex()`` object if the UniProt</span>
<span class="sd">        can be found in the default directed network,</span>
<span class="sd">        otherwise ``None``.</span>

<span class="sd">        @uniprot : str</span>
<span class="sd">            UniProt ID.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dgraph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_directed</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">dgraph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dnodDct</span><span class="p">[</span><span class="n">uniprot</span><span class="p">]]</span> \
            <span class="k">if</span> <span class="n">uniprot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodDct</span> <span class="k">else</span> <span class="kc">None</span></div>

    <span class="n">dup</span> <span class="o">=</span> <span class="n">duniprot</span>

<div class="viewcode-block" id="PyPath.uniprots"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.uniprots">[docs]</a>    <span class="k">def</span> <span class="nf">uniprots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uniprots</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns list of ``igraph.Vertex()`` object</span>
<span class="sd">        for a list of UniProt IDs omitting those</span>
<span class="sd">        could not be found in the default</span>
<span class="sd">        undirected graph.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uniprot</span><span class="p">,</span> <span class="n">uniprots</span><span class="p">))</span></div>

    <span class="n">ups</span> <span class="o">=</span> <span class="n">uniprots</span>

<div class="viewcode-block" id="PyPath.duniprots"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.duniprots">[docs]</a>    <span class="k">def</span> <span class="nf">duniprots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uniprots</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns list of ``igraph.Vertex()`` object</span>
<span class="sd">        for a list of UniProt IDs omitting those</span>
<span class="sd">        could not be found in the default</span>
<span class="sd">        directed graph.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">duniprot</span><span class="p">,</span> <span class="n">uniprots</span><span class="p">))</span></div>

    <span class="n">dups</span> <span class="o">=</span> <span class="n">duniprots</span>

<div class="viewcode-block" id="PyPath.get_node"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.get_node">[docs]</a>    <span class="k">def</span> <span class="nf">get_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``igraph.Vertex()`` object if the identifier</span>
<span class="sd">        is a valid vertex index in the default undirected graph,</span>
<span class="sd">        or a UniProt ID or GeneSymbol which can be found in the</span>
<span class="sd">        default undirected network, otherwise ``None``.</span>

<span class="sd">        @identifier : int, str</span>
<span class="sd">            Vertex index (int) or GeneSymbol (str) or UniProt ID (str) or</span>
<span class="sd">            ``igraph.Vertex`` object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_undirected</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">igraph</span><span class="o">.</span><span class="n">Vertex</span><span class="p">):</span>
            <span class="n">identifier</span> <span class="o">=</span> <span class="n">identifier</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> \
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">identifier</span> <span class="o">&lt;</span> <span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()</span> \
            <span class="k">else</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">identifier</span><span class="p">]]</span> \
            <span class="k">if</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span> <span class="k">else</span> \
            <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">labDct</span><span class="p">[</span><span class="n">identifier</span><span class="p">]]</span> \
            <span class="k">if</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labDct</span> <span class="k">else</span> <span class="kc">None</span></div>

    <span class="c1"># synonyms</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">get_node</span>
    <span class="n">protein</span> <span class="o">=</span> <span class="n">get_node</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">get_node</span>

<div class="viewcode-block" id="PyPath.get_node_d"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.get_node_d">[docs]</a>    <span class="k">def</span> <span class="nf">get_node_d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Same as ``PyPath.get_node``, just for the directed graph.</span>
<span class="sd">        Returns ``igraph.Vertex()`` object if the identifier</span>
<span class="sd">        is a valid vertex index in the default directed graph,</span>
<span class="sd">        or a UniProt ID or GeneSymbol which can be found in the</span>
<span class="sd">        default directed network, otherwise ``None``.</span>

<span class="sd">        @identifier : int, str</span>
<span class="sd">            Vertex index (int) or GeneSymbol (str) or UniProt ID (str) or</span>
<span class="sd">            ``igraph.Vertex`` object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dgraph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_directed</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">igraph</span><span class="o">.</span><span class="n">Vertex</span><span class="p">):</span>
            <span class="n">identifier</span> <span class="o">=</span> <span class="n">identifier</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">dgraph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> \
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">identifier</span> <span class="o">&lt;</span> <span class="n">dgraph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()</span> \
            <span class="k">else</span> <span class="n">dgraph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dnodDct</span><span class="p">[</span><span class="n">identifier</span><span class="p">]]</span> \
            <span class="k">if</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodDct</span> <span class="k">else</span> \
            <span class="n">dgraph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlabDct</span><span class="p">[</span><span class="n">identifier</span><span class="p">]]</span> \
            <span class="k">if</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlabDct</span> <span class="k">else</span> <span class="kc">None</span></div>

    <span class="c1"># synonyms</span>
    <span class="n">dv</span> <span class="o">=</span> <span class="n">get_node_d</span>
    <span class="n">dp</span> <span class="o">=</span> <span class="n">get_node_d</span>
    <span class="n">protein</span> <span class="o">=</span> <span class="n">get_node_d</span>

<div class="viewcode-block" id="PyPath.get_nodes"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.get_nodes">[docs]</a>    <span class="k">def</span> <span class="nf">get_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifiers</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_node</span><span class="p">,</span> <span class="n">identifiers</span><span class="p">))</span></div>

    <span class="n">vs</span> <span class="o">=</span> <span class="n">get_nodes</span>
    <span class="n">proteins</span> <span class="o">=</span> <span class="n">get_nodes</span>
    <span class="n">ps</span> <span class="o">=</span> <span class="n">get_nodes</span>

<div class="viewcode-block" id="PyPath.get_nodes_d"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.get_nodes_d">[docs]</a>    <span class="k">def</span> <span class="nf">get_nodes_d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifiers</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_node_d</span><span class="p">,</span> <span class="n">identifiers</span><span class="p">))</span></div>

    <span class="c1"># these are just synonyms</span>
    <span class="n">dvs</span> <span class="o">=</span> <span class="n">get_nodes_d</span>
    <span class="n">dps</span> <span class="o">=</span> <span class="n">get_nodes_d</span>
    <span class="n">dproteins</span> <span class="o">=</span> <span class="n">get_nodes_d</span>

<div class="viewcode-block" id="PyPath.up_edge"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.up_edge">[docs]</a>    <span class="k">def</span> <span class="nf">up_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``igraph.Edge`` object if an edge exist between</span>
<span class="sd">        the 2 proteins, otherwise ``None``.</span>

<span class="sd">        @source : str</span>
<span class="sd">            UniProt ID</span>
<span class="sd">        @target : str</span>
<span class="sd">            UniProt ID</span>
<span class="sd">        @directed : bool</span>
<span class="sd">            To be passed to igraph.Graph.get_eid()</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">v_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uniprot</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="n">v_target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uniprot</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">v_source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">v_target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">eid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span>
                <span class="n">v_source</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">v_target</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="n">directed</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">eid</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">]</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="PyPath.gs_edge"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.gs_edge">[docs]</a>    <span class="k">def</span> <span class="nf">gs_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``igraph.Edge`` object if an edge exist between</span>
<span class="sd">        the 2 proteins, otherwise ``None``.</span>

<span class="sd">        @source : str</span>
<span class="sd">            GeneSymbol</span>
<span class="sd">        @target : str</span>
<span class="sd">            GeneSymbol</span>
<span class="sd">        @directed : bool</span>
<span class="sd">            To be passed to igraph.Graph.get_eid()</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">v_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genesymbol</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="n">v_target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genesymbol</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">v_source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">v_target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">eid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span>
                <span class="n">v_source</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">v_target</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="n">directed</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">eid</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">]</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="PyPath.get_edge"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.get_edge">[docs]</a>    <span class="k">def</span> <span class="nf">get_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns ``igraph.Edge`` object if an edge exist between</span>
<span class="sd">        the 2 proteins, otherwise ``None``.</span>

<span class="sd">        :param int,str source:</span>
<span class="sd">            Vertex index or UniProt ID or GeneSymbol or ``igraph.Vertex``</span>
<span class="sd">            object.</span>
<span class="sd">        :param int,str target:</span>
<span class="sd">            Vertex index or UniProt ID or GeneSymbol or ``igraph.Vertex``</span>
<span class="sd">            object.</span>
<span class="sd">        :param bool directed:</span>
<span class="sd">            To be passed to igraph.Graph.get_eid()</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">v_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> \
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">is_directed</span><span class="p">()</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node_d</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="n">v_target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">target</span><span class="p">)</span> \
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">is_directed</span><span class="p">()</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node_d</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">v_source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">v_target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">eid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span>
                <span class="n">v_source</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">v_target</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">directed</span><span class="o">=</span><span class="n">directed</span><span class="p">,</span>
                <span class="n">error</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">eid</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">]</span>

        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="c1"># synonyms</span>
    <span class="n">protein_edge</span> <span class="o">=</span> <span class="n">get_edge</span>

<div class="viewcode-block" id="PyPath.get_edges"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.get_edges">[docs]</a>    <span class="k">def</span> <span class="nf">get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sources</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a generator with all edges between source and target vertices.</span>

<span class="sd">        :param iterable sources:</span>
<span class="sd">            Source vertex IDs, names, labels, or any iterable yielding</span>
<span class="sd">            ``igraph.Vertex`` objects.</span>
<span class="sd">        :param iterable targets:</span>
<span class="sd">            Target vertec IDs, names, labels, or any iterable yielding</span>
<span class="sd">            ``igraph.Vertex`` objects.</span>
<span class="sd">        :param bool directed:</span>
<span class="sd">            Passed to ``igraph.get_eid()``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_edge</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">directed</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sources</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">e</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_has_directed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_directed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">is_directed</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_directed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_directed</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_already_has_directed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_directed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">is_directed</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_directed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgraph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgraph</span><span class="o">.</span><span class="n">is_directed</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_directed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgraph</span>

    <span class="k">def</span> <span class="nf">_get_directed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the directed instance of the graph.</span>
<span class="sd">        If not available, creates one at ``PyPath.dgraph``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_has_directed</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_directed</span>

    <span class="c1"># conversion between directed and undirected vertices</span>

    <span class="k">def</span> <span class="nf">_get_undirected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_undirected</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">is_directed</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_undirected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">is_directed</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_undirected</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_undirected</span>

<div class="viewcode-block" id="PyPath.up_in_directed"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.up_in_directed">[docs]</a>    <span class="k">def</span> <span class="nf">up_in_directed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uniprot</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_has_directed</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodDct</span><span class="p">[</span><span class="n">uniprot</span><span class="p">]</span> <span class="k">if</span> <span class="n">uniprot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodDct</span> <span class="k">else</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="PyPath.up_in_undirected"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.up_in_undirected">[docs]</a>    <span class="k">def</span> <span class="nf">up_in_undirected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uniprot</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_has_undirected</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">uniprot</span><span class="p">]</span> <span class="k">if</span> <span class="n">uniprot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span> <span class="k">else</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="PyPath.gs_in_directed"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.gs_in_directed">[docs]</a>    <span class="k">def</span> <span class="nf">gs_in_directed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genesymbol</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_has_directed</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlabDct</span><span class="p">[</span><span class="n">genesymbol</span><span class="p">]</span> <span class="k">if</span> <span class="n">genesymbol</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlabDct</span> <span class="k">else</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="PyPath.gs_in_undirected"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.gs_in_undirected">[docs]</a>    <span class="k">def</span> <span class="nf">gs_in_undirected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genesymbol</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_has_undirected</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">labDct</span><span class="p">[</span><span class="n">genesymbol</span><span class="p">]</span> <span class="k">if</span> <span class="n">genesymbol</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labDct</span> <span class="k">else</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="PyPath.in_directed"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.in_directed">[docs]</a>    <span class="k">def</span> <span class="nf">in_directed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertex</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_in_directed</span><span class="p">(</span><span class="n">vertex</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="PyPath.in_undirected"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.in_undirected">[docs]</a>    <span class="k">def</span> <span class="nf">in_undirected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertex</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_in_undirected</span><span class="p">(</span><span class="n">vertex</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span></div>

    <span class="c1"># affects and affected_by</span>

    <span class="k">def</span> <span class="nf">_affected_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertex</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dgraph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_directed</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">dgraph</span> <span class="o">!=</span> <span class="n">vertex</span><span class="o">.</span><span class="n">graph</span><span class="p">:</span>
            <span class="n">vertex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_directed</span><span class="p">(</span><span class="n">vertex</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

        <span class="n">vs</span> <span class="o">=</span> <span class="n">vertex</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;IN&#39;</span><span class="p">)</span> \
            <span class="k">if</span> <span class="n">vertex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>

        <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">(</span><span class="n">vs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodLab</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_affects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertex</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dgraph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_directed</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">dgraph</span> <span class="o">!=</span> <span class="n">vertex</span><span class="o">.</span><span class="n">graph</span><span class="p">:</span>
            <span class="n">vertex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_directed</span><span class="p">(</span><span class="n">vertex</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

        <span class="n">vs</span> <span class="o">=</span> <span class="n">vertex</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;OUT&#39;</span><span class="p">)</span> \
            <span class="k">if</span> <span class="n">vertex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>

        <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">(</span><span class="n">vs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodLab</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">affected_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">):</span>
        <span class="n">vrtx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node_d</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vrtx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_affected_by</span><span class="p">(</span><span class="n">vrtx</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">([],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodLab</span><span class="p">)</span>

<div class="viewcode-block" id="PyPath.affects"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.affects">[docs]</a>    <span class="k">def</span> <span class="nf">affects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">vrtx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node_d</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">vrtx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_affects</span><span class="p">(</span><span class="n">vrtx</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">([],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodLab</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.up_affects"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.up_affects">[docs]</a>    <span class="k">def</span> <span class="nf">up_affects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uniprot</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">vrtx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">duniprot</span><span class="p">(</span><span class="n">uniprot</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">vrtx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_affects</span><span class="p">(</span><span class="n">vrtx</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">([],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodLab</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.up_affected_by"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.up_affected_by">[docs]</a>    <span class="k">def</span> <span class="nf">up_affected_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uniprot</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">vrtx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">duniprot</span><span class="p">(</span><span class="n">uniprot</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">vrtx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_affected_by</span><span class="p">(</span><span class="n">vrtx</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">([],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodLab</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.gs_affects"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.gs_affects">[docs]</a>    <span class="k">def</span> <span class="nf">gs_affects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genesymbol</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">vrtx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgenesymbol</span><span class="p">(</span><span class="n">genesymbol</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">vrtx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_affects</span><span class="p">(</span><span class="n">vrtx</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">([],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodLab</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.gs_affected_by"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.gs_affected_by">[docs]</a>    <span class="k">def</span> <span class="nf">gs_affected_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genesymbol</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">vrtx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgenesymbol</span><span class="p">(</span><span class="n">genesymbol</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">vrtx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_affected_by</span><span class="p">(</span><span class="n">vrtx</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">([],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodLab</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.up_stimulated_by"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.up_stimulated_by">[docs]</a>    <span class="k">def</span> <span class="nf">up_stimulated_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uniprot</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dgraph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_directed</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">uniprot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodDct</span><span class="p">:</span>
            <span class="n">vid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodDct</span><span class="p">[</span><span class="n">uniprot</span><span class="p">]</span>
            <span class="n">vs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_affected_by</span><span class="p">(</span><span class="n">uniprot</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">(</span>
                <span class="nb">filter</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">dgraph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">dgraph</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">vid</span><span class="p">)][</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">positive</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">uniprot</span><span class="p">],</span>
                    <span class="n">vs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodLab</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">([],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodLab</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.up_inhibited_by"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.up_inhibited_by">[docs]</a>    <span class="k">def</span> <span class="nf">up_inhibited_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uniprot</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dgraph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_directed</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">uniprot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodDct</span><span class="p">:</span>
            <span class="n">vid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodDct</span><span class="p">[</span><span class="n">uniprot</span><span class="p">]</span>
            <span class="n">vs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_affected_by</span><span class="p">(</span><span class="n">uniprot</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">(</span>
                <span class="nb">filter</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">dgraph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">dgraph</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">vid</span><span class="p">)][</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">negative</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">uniprot</span><span class="p">],</span>
                    <span class="n">vs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodLab</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">([],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodLab</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.up_stimulates"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.up_stimulates">[docs]</a>    <span class="k">def</span> <span class="nf">up_stimulates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uniprot</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dgraph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_directed</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">uniprot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodDct</span><span class="p">:</span>
            <span class="n">vid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodDct</span><span class="p">[</span><span class="n">uniprot</span><span class="p">]</span>
            <span class="n">vs</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_affects</span><span class="p">(</span><span class="n">uniprot</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">(</span>
                <span class="nb">filter</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">dgraph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">dgraph</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span><span class="n">vid</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">)][</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">positive</span><span class="p">[</span><span class="n">uniprot</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]],</span>
                    <span class="n">vs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodLab</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">([],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodLab</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.up_inhibits"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.up_inhibits">[docs]</a>    <span class="k">def</span> <span class="nf">up_inhibits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uniprot</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dgraph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_directed</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">uniprot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodDct</span><span class="p">:</span>
            <span class="n">vid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodDct</span><span class="p">[</span><span class="n">uniprot</span><span class="p">]</span>
            <span class="n">vs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_affects</span><span class="p">(</span><span class="n">uniprot</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">(</span>
                <span class="nb">filter</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">dgraph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">dgraph</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span><span class="n">vid</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">)][</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">negative</span><span class="p">[</span><span class="n">uniprot</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]],</span>
                    <span class="n">vs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodLab</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">([],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodLab</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.gs_stimulated_by"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.gs_stimulated_by">[docs]</a>    <span class="k">def</span> <span class="nf">gs_stimulated_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genesymbol</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dgraph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_directed</span><span class="p">()</span>
        <span class="n">uniprot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlabDct</span><span class="p">[</span><span class="n">genesymbol</span><span class="p">]]</span> \
            <span class="k">if</span> <span class="n">genesymbol</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlabDct</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_stimulated_by</span><span class="p">(</span><span class="n">uniprot</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.gs_stimulates"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.gs_stimulates">[docs]</a>    <span class="k">def</span> <span class="nf">gs_stimulates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genesymbol</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dgraph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_directed</span><span class="p">()</span>
        <span class="n">uniprot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlabDct</span><span class="p">[</span><span class="n">genesymbol</span><span class="p">]]</span> \
            <span class="k">if</span> <span class="n">genesymbol</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlabDct</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_stimulates</span><span class="p">(</span><span class="n">uniprot</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.gs_inhibited_by"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.gs_inhibited_by">[docs]</a>    <span class="k">def</span> <span class="nf">gs_inhibited_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genesymbol</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dgraph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_directed</span><span class="p">()</span>
        <span class="n">uniprot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlabDct</span><span class="p">[</span><span class="n">genesymbol</span><span class="p">]]</span> \
            <span class="k">if</span> <span class="n">genesymbol</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlabDct</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_inhibited_by</span><span class="p">(</span><span class="n">uniprot</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.gs_inhibits"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.gs_inhibits">[docs]</a>    <span class="k">def</span> <span class="nf">gs_inhibits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genesymbol</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dgraph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_directed</span><span class="p">()</span>
        <span class="n">uniprot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dlabDct</span><span class="p">[</span><span class="n">genesymbol</span><span class="p">]]</span> \
            <span class="k">if</span> <span class="n">genesymbol</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlabDct</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">up_inhibits</span><span class="p">(</span><span class="n">uniprot</span><span class="p">)</span></div>

    <span class="c1"># neighbors variations</span>

<div class="viewcode-block" id="PyPath.up_neighbors"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.up_neighbors">[docs]</a>    <span class="k">def</span> <span class="nf">up_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uniprot</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;ALL&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">vrtx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uniprot</span><span class="p">(</span><span class="n">uniprot</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">vrtx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">(</span>
                <span class="n">vrtx</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodLab</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">([],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodLab</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.gs_neighbors"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.gs_neighbors">[docs]</a>    <span class="k">def</span> <span class="nf">gs_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genesymbol</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;ALL&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">vrtx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genesymbol</span><span class="p">(</span><span class="n">genesymbol</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">vrtx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">(</span>
                <span class="n">vrtx</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodLab</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">([],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodLab</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.neighbors"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.neighbors">[docs]</a>    <span class="k">def</span> <span class="nf">neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;ALL&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">vrtx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">vrtx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">(</span>
                <span class="n">vrtx</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodLab</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">([],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodLab</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.dneighbors"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.dneighbors">[docs]</a>    <span class="k">def</span> <span class="nf">dneighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;ALL&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">vrtx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node_d</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">vrtx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">(</span>
                <span class="n">vrtx</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodLab</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">([],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnodLab</span><span class="p">)</span></div>

    <span class="c1"># neighborhood variations:</span>

    <span class="k">def</span> <span class="nf">_neighborhood</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vs</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;ALL&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">vi</span><span class="p">]</span> <span class="k">for</span> <span class="n">vi</span> <span class="ow">in</span>
                <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span>
                    <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">neighborhood</span><span class="p">(</span>
                        <span class="n">vs</span><span class="p">,</span> <span class="n">order</span> <span class="o">=</span> <span class="n">order</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodNam</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodLab</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="PyPath.up_neighborhood"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.up_neighborhood">[docs]</a>    <span class="k">def</span> <span class="nf">up_neighborhood</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uniprots</span><span class="p">,</span> <span class="n">order</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;ALL&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">uniprots</span><span class="p">)</span> <span class="ow">in</span> <span class="n">common</span><span class="o">.</span><span class="n">simple_types</span><span class="p">:</span>
            <span class="n">uniprots</span> <span class="o">=</span> <span class="p">[</span><span class="n">uniprots</span><span class="p">]</span>

        <span class="n">vs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uniprots</span><span class="p">(</span><span class="n">uniprots</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_neighborhood</span><span class="p">(</span><span class="n">vs</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.gs_neighborhood"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.gs_neighborhood">[docs]</a>    <span class="k">def</span> <span class="nf">gs_neighborhood</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genesymbols</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;ALL&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">genesymbols</span><span class="p">)</span> <span class="ow">in</span> <span class="n">common</span><span class="o">.</span><span class="n">simple_types</span><span class="p">:</span>
            <span class="n">genesymbols</span> <span class="o">=</span> <span class="p">[</span><span class="n">genesymbols</span><span class="p">]</span>

        <span class="n">vs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genesymbols</span><span class="p">(</span><span class="n">genesymbols</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_neighborhood</span><span class="p">(</span><span class="n">vs</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.neighborhood"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.neighborhood">[docs]</a>    <span class="k">def</span> <span class="nf">neighborhood</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifiers</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;ALL&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">identifiers</span><span class="p">)</span> <span class="ow">in</span> <span class="n">common</span><span class="o">.</span><span class="n">simple_types</span><span class="p">:</span>
            <span class="n">identifiers</span> <span class="o">=</span> <span class="p">[</span><span class="n">identifiers</span><span class="p">]</span>

        <span class="n">vs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nodes</span><span class="p">(</span><span class="n">identifiers</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_neighborhood</span><span class="p">(</span><span class="n">vs</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span></div>

    <span class="c1"># complexes</span>

<div class="viewcode-block" id="PyPath.complexes_in_network"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.complexes_in_network">[docs]</a>    <span class="k">def</span> <span class="nf">complexes_in_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csource</span><span class="o">=</span><span class="s1">&#39;corum&#39;</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">graph</span>
        <span class="n">cdict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">allv</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">cdata</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">][</span><span class="n">csource</span><span class="p">]):</span>

                <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cdict</span><span class="p">:</span>
                    <span class="n">cdict</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">cdata</span><span class="p">[</span><span class="s1">&#39;all_members&#39;</span><span class="p">])</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">memb</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">cdict</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">memb</span> <span class="o">-</span> <span class="n">allv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="PyPath.complex_comembership_network"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.complex_comembership_network">[docs]</a>    <span class="k">def</span> <span class="nf">complex_comembership_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resources</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">if</span> <span class="n">resources</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;complexes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

        <span class="n">cnet</span> <span class="o">=</span> <span class="n">igraph</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
        <span class="n">cdict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">resources</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">src</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cdict</span><span class="p">:</span>
                    <span class="n">cdict</span><span class="p">[</span><span class="n">src</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

                <span class="k">if</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">]:</span>

                    <span class="k">for</span> <span class="n">cname</span><span class="p">,</span> <span class="n">cannot</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">][</span><span class="n">src</span><span class="p">]):</span>

                        <span class="k">if</span> <span class="n">cname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cdict</span><span class="p">[</span><span class="n">src</span><span class="p">]:</span>
                            <span class="n">cdict</span><span class="p">[</span><span class="n">src</span><span class="p">][</span><span class="n">cname</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                        <span class="n">cdict</span><span class="p">[</span><span class="n">src</span><span class="p">][</span><span class="n">cname</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

        <span class="k">pass</span></div>

<div class="viewcode-block" id="PyPath.edges_in_complexes"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.edges_in_complexes">[docs]</a>    <span class="k">def</span> <span class="nf">edges_in_complexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csources</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;corum&#39;</span><span class="p">],</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates edge attributes ``complexes`` and ``in_complex``.</span>
<span class="sd">        These are both dicts where the keys are complex resources.</span>
<span class="sd">        The values in ``complexes`` are the list of complex names</span>
<span class="sd">        both the source and the target vertices belong to.</span>
<span class="sd">        The values ``in_complex`` are boolean values whether there</span>
<span class="sd">        is at least one complex in the given resources both the</span>
<span class="sd">        source and the target vertex of the edge belong to.</span>

<span class="sd">        @csources : list</span>
<span class="sd">            List of complex resources. Should be already loaded.</span>
<span class="sd">        @graph : igraph.Graph()</span>
<span class="sd">            The graph object to do the calculations on.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">if</span> <span class="s1">&#39;complexes&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="k">if</span> <span class="s1">&#39;in_complex&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;in_complex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">_common_complexes</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">cs</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;complexes&#39;</span><span class="p">][</span><span class="n">cs</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&amp;</span> \
                <span class="nb">set</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;complexes&#39;</span><span class="p">][</span><span class="n">cs</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="n">nul</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">cs</span><span class="p">:</span>
                  <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span>
                      <span class="n">e</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">]</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">_common_complexes</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">cs</span><span class="p">)),</span>
                      <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">),</span>
                  <span class="n">csources</span><span class="p">)</span>

        <span class="n">nul</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">cs</span><span class="p">:</span>
                  <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span>
                      <span class="n">e</span><span class="p">[</span><span class="s1">&#39;in_complex&#39;</span><span class="p">]</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span>
                          <span class="n">cs</span><span class="p">,</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;complexes&#39;</span><span class="p">][</span><span class="n">cs</span><span class="p">]))),</span>
                      <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">),</span>
                  <span class="n">csources</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.sum_in_complex"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.sum_in_complex">[docs]</a>    <span class="k">def</span> <span class="nf">sum_in_complex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csources</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;corum&#39;</span><span class="p">],</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the total number of edges in the network falling</span>
<span class="sd">        between two members of the same complex.</span>
<span class="sd">        Returns as a dict by complex resources.</span>
<span class="sd">        Calls :py:func:pypath.pypath.Pypath.edges_in_comlexes()</span>
<span class="sd">        to do the calculations.</span>

<span class="sd">        @csources : list</span>
<span class="sd">            List of complex resources. Should be already loaded.</span>
<span class="sd">        @graph : igraph.Graph()</span>
<span class="sd">            The graph object to do the calculations on.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges_in_comlexes</span><span class="p">(</span><span class="n">csources</span><span class="o">=</span><span class="n">csources</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">cs</span><span class="p">:</span>
                        <span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span>
                                     <span class="n">e</span><span class="p">[</span><span class="s1">&#39;in_complex&#39;</span><span class="p">][</span><span class="n">cs</span><span class="p">],</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">)</span>
                                 <span class="p">)),</span>
                        <span class="n">csources</span><span class="p">)</span>
                    <span class="p">)</span></div>

    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="PyPath.get_function"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.get_function">[docs]</a>    <span class="k">def</span> <span class="nf">get_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fun</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">fun</span>

        <span class="n">fun</span> <span class="o">=</span> <span class="n">fun</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="n">fun0</span> <span class="o">=</span> <span class="n">fun</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">toCall</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">fun0</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
            <span class="n">toCall</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()[</span><span class="n">fun0</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">fun0</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">():</span>
            <span class="n">toCall</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()[</span><span class="n">fun0</span><span class="p">]</span>

        <span class="c1">#elif fun0 == __name__.split(&#39;.&#39;)[0]:</span>
        <span class="c1">#    toCall = __main__</span>

        <span class="k">elif</span> <span class="n">fun0</span> <span class="o">==</span> <span class="s1">&#39;self&#39;</span> <span class="ow">or</span> <span class="n">fun0</span> <span class="o">==</span> <span class="vm">__name__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">toCall</span> <span class="o">=</span> <span class="bp">self</span>

        <span class="k">elif</span> <span class="n">fun0</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">toCall</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fun0</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">subm</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="nb">globals</span><span class="p">()[</span><span class="n">subm</span><span class="p">],</span> <span class="s1">&#39;__name__&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">globals</span><span class="p">(</span>
                <span class="p">)[</span><span class="n">subm</span><span class="p">]</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="vm">__name__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>

                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="nb">globals</span><span class="p">()[</span><span class="n">subm</span><span class="p">],</span> <span class="n">fun0</span><span class="p">):</span>
                        <span class="n">toCall</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="nb">globals</span><span class="p">()[</span><span class="n">subm</span><span class="p">],</span> <span class="n">fun0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">toCall</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">for</span> <span class="n">fun0</span> <span class="ow">in</span> <span class="n">fun</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">toCall</span><span class="p">,</span> <span class="n">fun0</span><span class="p">):</span>
                <span class="n">toCall</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">toCall</span><span class="p">,</span> <span class="n">fun0</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">toCall</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">toCall</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="PyPath.edges_3d"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.edges_3d">[docs]</a>    <span class="k">def</span> <span class="nf">edges_3d</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;inputs.instruct.get_instruct&#39;</span><span class="p">,</span>
            <span class="s1">&#39;inputs.i3d.get_i3d&#39;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">all_3d</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
            <span class="n">fun</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_function</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">fun</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">all_3d</span> <span class="o">+=</span> <span class="n">fun</span><span class="p">()</span>

        <span class="c1"># initializing edge attributes:</span>
        <span class="k">if</span> <span class="s1">&#39;ddi&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;ddi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;ddi&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;ddi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># assigning annotations:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">all_3d</span><span class="p">:</span>
            <span class="n">u1</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;uniprots&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">u2</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;uniprots&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">u1</span> <span class="o">!=</span> <span class="n">u2</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">u2</span><span class="p">):</span>
                <span class="n">edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_exists</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span> <span class="n">u2</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">edge</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>

                    <span class="k">for</span> <span class="n">seq1</span> <span class="ow">in</span> <span class="n">i</span><span class="p">[</span><span class="n">u1</span><span class="p">][</span><span class="s1">&#39;seq&#39;</span><span class="p">]:</span>

                        <span class="k">for</span> <span class="n">seq2</span> <span class="ow">in</span> <span class="n">i</span><span class="p">[</span><span class="n">u2</span><span class="p">][</span><span class="s1">&#39;seq&#39;</span><span class="p">]:</span>
                            <span class="n">dom1</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Domain</span><span class="p">(</span>
                                <span class="n">protein</span><span class="o">=</span><span class="n">u1</span><span class="p">,</span>
                                <span class="n">domain</span><span class="o">=</span><span class="n">i</span><span class="p">[</span><span class="n">u1</span><span class="p">][</span><span class="s1">&#39;pfam&#39;</span><span class="p">],</span>
                                <span class="n">start</span><span class="o">=</span><span class="n">seq1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                <span class="n">end</span><span class="o">=</span><span class="n">seq1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                <span class="n">chains</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;pdb&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span> <span class="n">i</span><span class="p">[</span><span class="n">u1</span><span class="p">][</span><span class="s1">&#39;chain&#39;</span><span class="p">]})</span>
                            <span class="n">dom2</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Domain</span><span class="p">(</span>
                                <span class="n">protein</span><span class="o">=</span><span class="n">u2</span><span class="p">,</span>
                                <span class="n">domain</span><span class="o">=</span><span class="n">i</span><span class="p">[</span><span class="n">u2</span><span class="p">][</span><span class="s1">&#39;pfam&#39;</span><span class="p">],</span>
                                <span class="n">start</span><span class="o">=</span><span class="n">seq2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                <span class="n">end</span><span class="o">=</span><span class="n">seq2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                <span class="n">chains</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;pdb&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span> <span class="n">i</span><span class="p">[</span><span class="n">u2</span><span class="p">][</span><span class="s1">&#39;chain&#39;</span><span class="p">]})</span>
                            <span class="n">domdom</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">DomainDomain</span><span class="p">(</span>
                                <span class="n">dom1</span><span class="p">,</span>
                                <span class="n">dom2</span><span class="p">,</span>
                                <span class="n">refs</span><span class="o">=</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;references&#39;</span><span class="p">],</span>
                                <span class="n">sources</span><span class="o">=</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">],</span>
                                <span class="n">pdbs</span><span class="o">=</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;pdb&#39;</span><span class="p">])</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="s1">&#39;ddi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">domdom</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.edges_ptms"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.edges_ptms">[docs]</a>    <span class="k">def</span> <span class="nf">edges_ptms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pfam_regions</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_pepcyber</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_psite_reg</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_ielm</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_phosphoelm</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_elm</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_3did_dmi</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.pfam_regions"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.pfam_regions">[docs]</a>    <span class="k">def</span> <span class="nf">pfam_regions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">u_pfam</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">u_pfam</span> <span class="o">=</span> <span class="n">pfam_input</span><span class="o">.</span><span class="n">pfam_regions</span><span class="p">(</span>
                <span class="n">uniprots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                <span class="n">keepfile</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.complexes"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.complexes">[docs]</a>    <span class="k">def</span> <span class="nf">complexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;3dcomplexes&#39;</span><span class="p">,</span> <span class="s1">&#39;havugimana&#39;</span><span class="p">,</span> <span class="s1">&#39;corum&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;complexportal&#39;</span><span class="p">,</span> <span class="s1">&#39;compleat&#39;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="s1">&#39;load_&#39;</span> <span class="o">+</span> <span class="n">m</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
                <span class="n">toCall</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">toCall</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">):</span>
                    <span class="n">toCall</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.load_domino_dmi"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_domino_dmi">[docs]</a>    <span class="k">def</span> <span class="nf">load_domino_dmi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">organism</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">organism</span> <span class="o">=</span> <span class="n">organism</span> <span class="k">if</span> <span class="n">organism</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span>
        <span class="n">domi</span> <span class="o">=</span> <span class="n">domino</span><span class="o">.</span><span class="n">domino_enzsub</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">domi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                <span class="s1">&#39;Failed to load domain-motif interaction data from DOMINO&#39;</span><span class="p">,</span>
                <span class="o">-</span><span class="mi">5</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">&#39;ptm&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">domi</span><span class="p">[</span><span class="s1">&#39;dmi&#39;</span><span class="p">]),</span> <span class="s1">&#39;Loading domain-motif interactions&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">dm</span> <span class="ow">in</span> <span class="n">domi</span><span class="p">[</span><span class="s1">&#39;dmi&#39;</span><span class="p">]:</span>
            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
            <span class="n">uniprot1</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">protein</span>
            <span class="n">uniprot2</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">protein</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">uniprot1</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">uniprot2</span><span class="p">):</span>
                <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_exists</span><span class="p">(</span><span class="n">uniprot1</span><span class="p">,</span> <span class="n">uniprot2</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>

                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>

                        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dm</span><span class="p">)</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.load_3did_dmi"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_3did_dmi">[docs]</a>    <span class="k">def</span> <span class="nf">load_3did_dmi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dmi</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">threedid</span><span class="o">.</span><span class="n">process_3did_dmi</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">dmi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                <span class="s1">&#39;Failed to load domain-motif interaction data from 3DID&#39;</span><span class="p">,</span>
                <span class="o">-</span><span class="mi">5</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">&#39;ptm&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dmi</span><span class="p">),</span> <span class="s1">&#39;Loading domain-motif interactions&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">uniprots</span><span class="p">,</span> <span class="n">dmi_list</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">dmi</span><span class="p">):</span>
            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">uniprots</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">uniprots</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_exists</span><span class="p">(</span><span class="n">uniprots</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">uniprots</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dmi_list</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.load_ddi"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_ddi">[docs]</a>    <span class="k">def</span> <span class="nf">load_ddi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ddi</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ddi is either a list of intera.DomainDomain objects,</span>
<span class="sd">        or a function resulting this list</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">ddi</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ddi</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">ddi</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">ddi</span><span class="o">.</span><span class="vm">__module__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;inputs&#39;</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Function </span><span class="si">%s</span><span class="s1">() failed&#39;</span> <span class="o">%</span> <span class="n">ddi</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>

            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="s1">&#39;ddi&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;ddi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="s1">&#39;Loading domain-domain interactions&#39;</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>
        <span class="n">in_network</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">dd</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
            <span class="n">uniprot1</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">domains</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">protein</span>
            <span class="n">uniprot2</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">domains</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">protein</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">uniprot1</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">uniprot2</span><span class="p">):</span>
                <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_exists</span><span class="p">(</span><span class="n">uniprot1</span><span class="p">,</span> <span class="n">uniprot2</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ddi&#39;</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ddi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                    <span class="n">in_network</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ddi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.load_dmi"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_dmi">[docs]</a>    <span class="k">def</span> <span class="nf">load_dmi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dmi</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        dmi is either a list of intera.DomainMotif objects,</span>
<span class="sd">        or a function resulting this list</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">dmi</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dmi</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">dmi</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">dmi</span><span class="o">.</span><span class="vm">__module__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;inputs&#39;</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Function </span><span class="si">%s</span><span class="s1">() failed&#39;</span> <span class="o">%</span> <span class="n">dmi</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>

            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="s1">&#39;ptm&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">]</span></div>

<div class="viewcode-block" id="PyPath.run_batch"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.run_batch">[docs]</a>    <span class="k">def</span> <span class="nf">run_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">methods</span><span class="p">,</span> <span class="n">toCall</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">toCall</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">toCall</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_function</span><span class="p">(</span><span class="n">toCall</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
            <span class="n">fun</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_function</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">fun</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">toCall</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">):</span>
                    <span class="n">toCall</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fun</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyPath.load_ddis"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_ddis">[docs]</a>    <span class="k">def</span> <span class="nf">load_ddis</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;inputs.threedcomplex.threedcomplex_ddi&#39;</span><span class="p">,</span>
            <span class="s1">&#39;inputs.domino.domino_ddi&#39;</span><span class="p">,</span>
            <span class="s1">&#39;self.load_3did_ddi2&#39;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">run_batch</span><span class="p">(</span><span class="n">methods</span><span class="p">,</span> <span class="n">toCall</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">load_ddi</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.load_dmis"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_dmis">[docs]</a>    <span class="k">def</span> <span class="nf">load_dmis</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;self.pfam_regions&#39;</span><span class="p">,</span>
            <span class="s1">&#39;self.load_depod_dmi&#39;</span><span class="p">,</span>
            <span class="s1">&#39;self.load_dbptm&#39;</span><span class="p">,</span>
            <span class="s1">&#39;self.load_mimp_dmi&#39;</span><span class="p">,</span>
            <span class="s1">&#39;self.load_pnetworks_dmi&#39;</span><span class="p">,</span>
            <span class="s1">&#39;self.load_domino_dmi&#39;</span><span class="p">,</span>
            <span class="s1">&#39;self.load_pepcyber&#39;</span><span class="p">,</span>
            <span class="s1">&#39;self.load_psite_reg&#39;</span><span class="p">,</span>
            <span class="s1">&#39;self.load_psite_phos&#39;</span><span class="p">,</span>
            <span class="s1">&#39;self.load_ielm&#39;</span><span class="p">,</span>
            <span class="s1">&#39;self.load_phosphoelm&#39;</span><span class="p">,</span>
            <span class="s1">&#39;self.load_elm&#39;</span><span class="p">,</span>
            <span class="s1">&#39;self.load_3did_dmi&#39;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">run_batch</span><span class="p">(</span><span class="n">methods</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uniq_ptms</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phosphorylation_directions</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyPath.load_interfaces"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_interfaces">[docs]</a>    <span class="k">def</span> <span class="nf">load_interfaces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">load_3did_ddi2</span><span class="p">(</span><span class="n">ddi</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">interfaces</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">unm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_pisa</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyPath.load_3did_ddi"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_3did_ddi">[docs]</a>    <span class="k">def</span> <span class="nf">load_3did_ddi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">ddi</span><span class="p">,</span> <span class="n">interfaces</span> <span class="o">=</span> <span class="n">threedid</span><span class="o">.</span><span class="n">threedid_ddi</span><span class="p">(</span><span class="n">residues</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ddi</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">interfaces</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                <span class="s1">&#39;Failed to load domain-domain interaction data from 3DID&#39;</span><span class="p">,</span>
                <span class="o">-</span><span class="mi">5</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="s1">&#39;ddi&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;ddi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;ddi&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;ddi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">if</span> <span class="s1">&#39;3did&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;ddi&#39;</span><span class="p">]:</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;ddi&#39;</span><span class="p">][</span><span class="s1">&#39;3did&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ddi</span><span class="p">),</span> <span class="s1">&#39;Loading domain-domain interactions&#39;</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">ddi</span><span class="p">):</span>
            <span class="n">uniprot1</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">uniprot2</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">swprots</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">swissprots</span><span class="p">([</span><span class="n">uniprot1</span><span class="p">,</span> <span class="n">uniprot2</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">swprot1</span> <span class="ow">in</span> <span class="n">swprots</span><span class="p">[</span><span class="n">uniprot1</span><span class="p">]:</span>

                <span class="k">for</span> <span class="n">swprot2</span> <span class="ow">in</span> <span class="n">swprots</span><span class="p">[</span><span class="n">uniprot2</span><span class="p">]:</span>

                    <span class="k">if</span> <span class="n">swprot1</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">swprot2</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]:</span>
                        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_exists</span><span class="p">(</span><span class="n">swprot1</span><span class="p">,</span> <span class="n">swprot2</span><span class="p">)</span>

                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>

                            <span class="k">for</span> <span class="n">domains</span><span class="p">,</span> <span class="n">structures</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>

                                <span class="k">for</span> <span class="n">pdb</span><span class="p">,</span> <span class="n">pdb_uniprot_pairs</span> <span class="ow">in</span> \
                                        <span class="n">iteritems</span><span class="p">(</span><span class="n">structures</span><span class="p">[</span><span class="s1">&#39;pdbs&#39;</span><span class="p">]):</span>

                                    <span class="k">for</span> <span class="n">pdbuniprots</span> <span class="ow">in</span> <span class="n">pdb_uniprot_pairs</span><span class="p">:</span>
                                        <span class="n">pdbswprots</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">swissprots</span><span class="p">(</span>
                                            <span class="n">pdbuniprots</span><span class="p">)</span>

                                        <span class="k">for</span> <span class="n">pdbswprot1</span> <span class="ow">in</span> <span class="n">pdbswprots</span><span class="p">[</span>
                                                <span class="n">pdbuniprots</span><span class="p">[</span><span class="mi">0</span><span class="p">]]:</span>

                                            <span class="k">for</span> <span class="n">pdbswprot2</span> <span class="ow">in</span> <span class="n">pdbswprots</span><span class="p">[</span>
                                                    <span class="n">pdbuniprots</span><span class="p">[</span><span class="mi">1</span><span class="p">]]:</span>
                                                <span class="n">this_ddi</span> <span class="o">=</span> <span class="p">{}</span>
                                                <span class="n">this_ddi</span><span class="p">[</span><span class="n">swprot1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                                                    <span class="s1">&#39;pfam&#39;</span><span class="p">:</span> <span class="n">domains</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                                                <span class="p">}</span>
                                                <span class="n">this_ddi</span><span class="p">[</span><span class="n">swprot2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                                                    <span class="s1">&#39;pfam&#39;</span><span class="p">:</span> <span class="n">domains</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                                                <span class="p">}</span>
                                                <span class="n">this_ddi</span><span class="p">[</span><span class="s1">&#39;uniprots&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                                                    <span class="n">swprot1</span><span class="p">,</span> <span class="n">swprot2</span>
                                                <span class="p">]</span>
                                                <span class="n">this_ddi</span><span class="p">[</span>
                                                    <span class="s1">&#39;uniprots_original&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>
                                                <span class="n">this_ddi</span><span class="p">[</span><span class="s1">&#39;pdb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                                                    <span class="n">swprot1</span><span class="p">:</span> <span class="n">pdbswprot1</span><span class="p">,</span>
                                                    <span class="n">swprot2</span><span class="p">:</span> <span class="n">pdbswprot2</span><span class="p">,</span>
                                                    <span class="s1">&#39;pdb&#39;</span><span class="p">:</span> <span class="n">pdb</span>
                                                <span class="p">}</span>
                                                <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ddi&#39;</span><span class="p">][</span><span class="s1">&#39;3did&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                                    <span class="n">this_ddi</span><span class="p">)</span>

            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.load_3did_interfaces"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_3did_interfaces">[docs]</a>    <span class="k">def</span> <span class="nf">load_3did_interfaces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">load_3did_ddi2</span><span class="p">(</span><span class="n">ddi</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">interfaces</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.load_3did_ddi2"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_3did_ddi2">[docs]</a>    <span class="k">def</span> <span class="nf">load_3did_ddi2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ddi</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interfaces</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="n">ddi</span><span class="p">,</span> <span class="n">intfs</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">threedid</span><span class="o">.</span><span class="n">get_3did</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">ddi</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">interfaces</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                <span class="s1">&#39;Failed to load domain-domain interaction data from 3DID&#39;</span><span class="p">,</span>
                <span class="o">-</span><span class="mi">5</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># ERROR</span>
        <span class="k">if</span> <span class="n">interfaces</span><span class="p">:</span>

            <span class="k">if</span> <span class="s1">&#39;interfaces&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;interfaces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">intf</span> <span class="ow">in</span> <span class="n">intfs</span><span class="p">:</span>
                <span class="n">uniprot1</span> <span class="o">=</span> <span class="n">intf</span><span class="o">.</span><span class="n">domains</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">protein</span>
                <span class="n">uniprot2</span> <span class="o">=</span> <span class="n">intf</span><span class="o">.</span><span class="n">domains</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">protein</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">uniprot1</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">uniprot2</span><span class="p">):</span>
                    <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_exists</span><span class="p">(</span><span class="n">uniprot1</span><span class="p">,</span> <span class="n">uniprot2</span><span class="p">)</span>

                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>

                        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;interfaces&#39;</span><span class="p">],</span>
                                          <span class="nb">list</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;interfaces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;interfaces&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">intf</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ddi</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ddi</span></div>

<div class="viewcode-block" id="PyPath.load_ielm"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_ielm">[docs]</a>    <span class="k">def</span> <span class="nf">load_ielm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">&#39;ptm&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="n">ppi</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>
            <span class="n">ppi</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>

        <span class="n">ielm</span> <span class="o">=</span> <span class="n">ielm_input</span><span class="o">.</span><span class="n">get_ielm</span><span class="p">(</span><span class="n">ppi</span><span class="p">)</span>
        <span class="n">elm</span> <span class="o">=</span> <span class="n">elm_input</span><span class="o">.</span><span class="n">elm_classes</span><span class="p">()</span>
        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ielm</span><span class="p">),</span> <span class="s1">&#39;Processing domain-motif interactions&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
        <span class="n">noelm</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">ielm</span><span class="p">:</span>

            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node_pair</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">nodes</span><span class="p">:</span>
                <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">e</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                    <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">elm</span><span class="p">:</span>
                        <span class="n">noelm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

                    <span class="n">motif</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span> <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">elm</span> <span class="k">else</span> <span class="n">elm</span><span class="p">[</span><span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
                    <span class="n">mot</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Motif</span><span class="p">(</span>
                        <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                        <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
                        <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
                        <span class="n">regex</span><span class="o">=</span><span class="n">motif</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">prob</span><span class="o">=</span><span class="kc">None</span> <span class="k">if</span> <span class="n">motif</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">motif</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
                        <span class="n">description</span><span class="o">=</span><span class="n">motif</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                        <span class="n">elm</span><span class="o">=</span><span class="n">motif</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">motif_name</span><span class="o">=</span><span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="n">dom</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Domain</span><span class="p">(</span>
                        <span class="n">protein</span><span class="o">=</span><span class="n">l</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span>
                        <span class="n">start</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">11</span><span class="p">]),</span>
                        <span class="n">end</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">12</span><span class="p">]),</span>
                        <span class="n">domain</span><span class="o">=</span><span class="n">l</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span>
                        <span class="n">domain_id_type</span><span class="o">=</span><span class="s1">&#39;ielm_hmm&#39;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">u_pfam</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">u_pfam</span><span class="p">:</span>

                        <span class="k">for</span> <span class="n">pfam</span><span class="p">,</span> <span class="n">regions</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">u_pfam</span><span class="p">[</span><span class="n">l</span><span class="p">[</span><span class="mi">9</span><span class="p">]]):</span>

                            <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>

                                <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span> <span class="o">==</span> <span class="n">region</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">]</span> <span class="ow">and</span> \
                                        <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">12</span><span class="p">])</span> <span class="o">==</span> <span class="n">region</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]:</span>
                                    <span class="n">dom</span><span class="o">.</span><span class="n">pfam</span> <span class="o">=</span> <span class="n">pfam</span>
                                    <span class="n">dom</span><span class="o">.</span><span class="n">isoform</span> <span class="o">=</span> <span class="n">region</span><span class="p">[</span><span class="s1">&#39;isoform&#39;</span><span class="p">]</span>

                    <span class="n">ptm</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Ptm</span><span class="p">(</span><span class="n">protein</span><span class="o">=</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                     <span class="n">motif</span><span class="o">=</span><span class="n">mot</span><span class="p">,</span>
                                     <span class="n">typ</span><span class="o">=</span><span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">domMot</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">DomainMotif</span><span class="p">(</span><span class="n">dom</span><span class="p">,</span> <span class="n">ptm</span><span class="p">,</span> <span class="s1">&#39;iELM&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">domMot</span><span class="p">)</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span></div>
        <span class="c1"># find deprecated elm classes:</span>
        <span class="c1"># list(set(noelm))</span>

<div class="viewcode-block" id="PyPath.load_elm"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_elm">[docs]</a>    <span class="k">def</span> <span class="nf">load_elm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">&#39;ptm&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="n">elm</span> <span class="o">=</span> <span class="n">elm_input</span><span class="o">.</span><span class="n">elm_interactions</span><span class="p">()</span>
        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">elm</span><span class="p">),</span> <span class="s1">&#39;Processing domain-motif interactions&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">elm</span><span class="p">:</span>
            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">:</span>
                <span class="n">uniprot_elm</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">uniprot_dom</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">uniprot_elm</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span>
                        <span class="n">uniprot_dom</span><span class="p">):</span>
                    <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node_pair</span><span class="p">(</span><span class="n">uniprot_dom</span><span class="p">,</span> <span class="n">uniprot_elm</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">nodes</span><span class="p">:</span>
                        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">e</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>

                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                            <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
                            <span class="n">end</span>   <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>

                            <span class="k">if</span> <span class="n">uniprot_elm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">:</span>
                                <span class="n">inst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">[</span><span class="n">uniprot_elm</span><span class="p">]</span><span class="o">.</span><span class="n">get_region</span><span class="p">(</span><span class="n">start</span> <span class="o">=</span> <span class="n">start</span><span class="p">,</span>
                                                                        <span class="n">end</span> <span class="o">=</span> <span class="n">end</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>

                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">inst</span> <span class="o">=</span> <span class="kc">None</span>

                            <span class="n">mot</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Motif</span><span class="p">(</span>
                                <span class="n">protein</span><span class="o">=</span><span class="n">uniprot_elm</span><span class="p">,</span>
                                <span class="n">motif_name</span><span class="o">=</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span>
                                <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">,</span>
                                <span class="n">instance</span> <span class="o">=</span> <span class="n">inst</span><span class="p">)</span>
                            <span class="n">ptm</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Ptm</span><span class="p">(</span><span class="n">protein</span><span class="o">=</span><span class="n">uniprot_elm</span><span class="p">,</span> <span class="n">motif</span><span class="o">=</span><span class="n">mot</span><span class="p">)</span>
                            <span class="n">dstart</span> <span class="o">=</span> <span class="n">start</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span>
                                <span class="mi">6</span><span class="p">])</span>
                            <span class="n">dend</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>

                            <span class="n">doms</span> <span class="o">=</span> <span class="p">[]</span>

                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">u_pfam</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">uniprot_dom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">u_pfam</span><span class="p">:</span>

                                <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">u_pfam</span><span class="p">[</span><span class="n">uniprot_dom</span><span class="p">]:</span>

                                    <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">u_pfam</span><span class="p">[</span><span class="n">uniprot_dom</span><span class="p">][</span><span class="n">l</span><span class="p">[</span>
                                            <span class="mi">1</span><span class="p">]]:</span>

                                        <span class="k">if</span> <span class="n">dstart</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">dend</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> \
                                            <span class="p">(</span><span class="n">dstart</span> <span class="o">==</span> <span class="n">region</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">]</span> <span class="ow">and</span>
                                             <span class="n">dend</span> <span class="o">==</span> <span class="n">region</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]):</span>
                                            <span class="n">doms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                                <span class="n">intera</span><span class="o">.</span><span class="n">Domain</span><span class="p">(</span>
                                                    <span class="n">protein</span><span class="o">=</span><span class="n">uniprot_dom</span><span class="p">,</span>
                                                    <span class="n">domain</span><span class="o">=</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                                    <span class="n">start</span><span class="o">=</span><span class="n">region</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">],</span>
                                                    <span class="n">end</span><span class="o">=</span><span class="n">region</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">],</span>
                                                    <span class="n">isoform</span><span class="o">=</span><span class="n">region</span><span class="p">[</span><span class="s1">&#39;isoform&#39;</span><span class="p">]))</span>

                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">doms</span> <span class="o">=</span> <span class="p">[</span>
                                    <span class="n">intera</span><span class="o">.</span><span class="n">Domain</span><span class="p">(</span>
                                        <span class="n">protein</span><span class="o">=</span><span class="n">uniprot_dom</span><span class="p">,</span>
                                        <span class="n">domain</span><span class="o">=</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                                    <span class="p">)</span>
                                <span class="p">]</span>

                            <span class="k">for</span> <span class="n">dom</span> <span class="ow">in</span> <span class="n">doms</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                    <span class="n">intera</span><span class="o">.</span><span class="n">DomainMotif</span><span class="p">(</span><span class="n">dom</span><span class="p">,</span> <span class="n">ptm</span><span class="p">,</span> <span class="s1">&#39;ELM&#39;</span><span class="p">))</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.load_lmpid"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_lmpid">[docs]</a>    <span class="k">def</span> <span class="nf">load_lmpid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span></div>

<div class="viewcode-block" id="PyPath.process_dmi"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.process_dmi">[docs]</a>    <span class="k">def</span> <span class="nf">process_dmi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is an universal function</span>
<span class="sd">        for loading domain-motif objects</span>
<span class="sd">        like load_phospho_dmi() for PTMs.</span>
<span class="sd">        TODO this will replace load_elm, load_ielm, etc</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">functions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;LMPID&#39;</span><span class="p">:</span> <span class="s1">&#39;lmpid_dmi&#39;</span><span class="p">}</span>
        <span class="n">motif_plus</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;LMPID&#39;</span><span class="p">:</span> <span class="p">[]}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="n">toCall</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_method</span><span class="p">(</span><span class="n">functions</span><span class="p">[</span><span class="n">source</span><span class="p">])</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">toCall</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="p">(</span><span class="n">isoforms</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;ptm&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="s1">&#39;Processing domain-motif interactions from </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">source</span><span class="p">,</span>
            <span class="mi">7</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
            <span class="n">domain_ups</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">motif_upd</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">if</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;LMPID&#39;</span><span class="p">:</span>
                <span class="n">domain_ups</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;domain_protein&#39;</span><span class="p">],</span>
                                                  <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>
                <span class="n">motif_ups</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;motif_protein&#39;</span><span class="p">],</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                                                 <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">du</span> <span class="ow">in</span> <span class="n">domain_ups</span><span class="p">:</span>
                <span class="n">dom</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Domain</span><span class="p">(</span>
                    <span class="n">du</span><span class="p">,</span>
                    <span class="n">domain</span><span class="o">=</span><span class="kc">None</span>
                    <span class="k">if</span> <span class="s1">&#39;domain_name&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d</span> <span class="k">else</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;domain_name&#39;</span><span class="p">],</span>
                    <span class="n">domain_id_type</span><span class="o">=</span><span class="kc">None</span>
                    <span class="k">if</span> <span class="s1">&#39;domain_name_type&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d</span> <span class="k">else</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;domain_name_type&#39;</span><span class="p">])</span>

                <span class="k">for</span> <span class="n">mu</span> <span class="ow">in</span> <span class="n">motif_ups</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">mu</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span> <span class="ow">and</span> <span class="n">mu</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodInd</span> <span class="ow">and</span> <span class="n">du</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodInd</span><span class="p">:</span>
                        <span class="n">edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_edge</span><span class="p">(</span>
                            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">du</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">mu</span><span class="p">]))</span>

                        <span class="k">if</span> <span class="n">edge</span><span class="p">:</span>
                            <span class="n">mse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">[</span><span class="n">mu</span><span class="p">]</span>
                            <span class="n">isos</span> <span class="o">=</span> <span class="p">[]</span>

                            <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;instance&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">inst</span> <span class="o">=</span> <span class="n">mse</span><span class="o">.</span><span class="n">get_region</span><span class="p">(</span>
                                    <span class="n">start</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;motif_start&#39;</span><span class="p">],</span>
                                    <span class="n">end</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;motif_end&#39;</span><span class="p">],</span>
                                    <span class="n">isoform</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                                <span class="n">isos</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inst</span><span class="p">))</span>

                            <span class="k">for</span> <span class="n">iso</span> <span class="ow">in</span> <span class="n">mse</span><span class="o">.</span><span class="n">isoforms</span><span class="p">():</span>
                                <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">inst</span> <span class="o">=</span> <span class="n">mse</span><span class="o">.</span><span class="n">get_region</span><span class="p">(</span>
                                    <span class="n">start</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;motif_start&#39;</span><span class="p">],</span>
                                    <span class="n">end</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;motif_end&#39;</span><span class="p">],</span>
                                    <span class="n">isoform</span><span class="o">=</span><span class="n">iso</span><span class="p">)</span>

                                <span class="k">if</span> <span class="n">inst</span> <span class="o">==</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;instance&#39;</span><span class="p">]:</span>
                                    <span class="n">isos</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">iso</span><span class="p">,</span> <span class="n">inst</span><span class="p">))</span>

                            <span class="k">for</span> <span class="n">iso</span> <span class="ow">in</span> <span class="n">isos</span><span class="p">:</span>
                                <span class="n">motargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                                                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">motif_plus</span><span class="p">[</span><span class="n">source</span><span class="p">]])</span>
                                <span class="n">mot</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Motif</span><span class="p">(</span>
                                    <span class="n">mu</span><span class="p">,</span>
                                    <span class="n">iso</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                    <span class="n">iso</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                    <span class="n">isoform</span><span class="o">=</span><span class="n">iso</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                    <span class="n">instance</span><span class="o">=</span><span class="n">iso</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                                    <span class="o">**</span><span class="n">motargs</span><span class="p">)</span>
                                <span class="n">ptm</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Ptm</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span>
                                                 <span class="n">motif</span><span class="o">=</span><span class="n">mot</span><span class="p">,</span>
                                                 <span class="n">isoform</span><span class="o">=</span><span class="n">iso</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                                 <span class="n">source</span><span class="o">=</span><span class="p">[</span><span class="n">source</span><span class="p">])</span>
                                <span class="n">dommot</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">DomainMotif</span><span class="p">(</span>
                                    <span class="n">domain</span><span class="o">=</span><span class="n">dom</span><span class="p">,</span>
                                    <span class="n">ptm</span><span class="o">=</span><span class="n">ptm</span><span class="p">,</span>
                                    <span class="n">sources</span><span class="o">=</span><span class="p">[</span><span class="n">source</span><span class="p">],</span>
                                    <span class="n">refs</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;refs&#39;</span><span class="p">])</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dommot</span><span class="p">)</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.load_pepcyber"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_pepcyber">[docs]</a>    <span class="k">def</span> <span class="nf">load_pepcyber</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">&#39;ptm&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="n">pepc</span> <span class="o">=</span> <span class="n">pepcyber</span><span class="o">.</span><span class="n">pepcyber_interactions</span><span class="p">()</span>
        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pepc</span><span class="p">),</span> <span class="s1">&#39;Processing domain-motif interactions&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">pepc</span><span class="p">:</span>
            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
            <span class="n">uniprot1</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="p">[</span><span class="mi">9</span><span class="p">]]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">[]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">uniprot1</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span>
                                                <span class="s1">&#39;refseq&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                                                <span class="mi">9606</span><span class="p">)</span>

            <span class="n">uniprot2</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="p">[</span><span class="mi">11</span><span class="p">]]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">[]</span>

            <span class="c1"># ptm on u2,</span>
            <span class="c1"># u1 interacts with u2 depending on ptm</span>
            <span class="k">for</span> <span class="n">u1</span> <span class="ow">in</span> <span class="n">uniprot1</span><span class="p">:</span>

                <span class="k">for</span> <span class="n">u2</span> <span class="ow">in</span> <span class="n">uniprot2</span><span class="p">:</span>
                    <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node_pair</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span> <span class="n">u2</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">nodes</span><span class="p">:</span>
                        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">e</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">res</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Residue</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="n">l</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">u2</span><span class="p">)</span>
                            <span class="n">ptm</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Ptm</span><span class="p">(</span><span class="n">protein</span><span class="o">=</span><span class="n">u2</span><span class="p">,</span>
                                             <span class="n">residue</span><span class="o">=</span><span class="n">res</span><span class="p">,</span>
                                             <span class="n">typ</span><span class="o">=</span><span class="s1">&#39;phosphorylation&#39;</span><span class="p">)</span>
                            <span class="n">reg</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Regulation</span><span class="p">(</span>
                                <span class="n">source</span><span class="o">=</span><span class="n">u2</span><span class="p">,</span>
                                <span class="n">target</span><span class="o">=</span><span class="n">u1</span><span class="p">,</span>
                                <span class="n">sources</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PepCyber&#39;</span><span class="p">],</span>
                                <span class="n">effect</span><span class="o">=</span><span class="s1">&#39;induces&#39;</span><span class="p">,</span>
                                <span class="n">ptm</span><span class="o">=</span><span class="n">ptm</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.load_psite_reg"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_psite_reg">[docs]</a>    <span class="k">def</span> <span class="nf">load_psite_reg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">modtyp</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="s1">&#39;phosphorylation&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ac&#39;</span><span class="p">:</span> <span class="s1">&#39;acetylation&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ub&#39;</span><span class="p">:</span> <span class="s1">&#39;ubiquitination&#39;</span><span class="p">,</span>
            <span class="s1">&#39;me&#39;</span><span class="p">:</span> <span class="s1">&#39;methylation&#39;</span><span class="p">,</span>
            <span class="s1">&#39;sm&#39;</span><span class="p">:</span> <span class="s1">&#39;sumoylation&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ga&#39;</span><span class="p">:</span> <span class="s1">&#39;o-galnac&#39;</span><span class="p">,</span>
            <span class="s1">&#39;gl&#39;</span><span class="p">:</span> <span class="s1">&#39;o-glcnac&#39;</span><span class="p">,</span>
            <span class="s1">&#39;sc&#39;</span><span class="p">:</span> <span class="s1">&#39;succinylation&#39;</span><span class="p">,</span>
            <span class="s1">&#39;m3&#39;</span><span class="p">:</span> <span class="s1">&#39;tri-methylation&#39;</span><span class="p">,</span>
            <span class="s1">&#39;m1&#39;</span><span class="p">:</span> <span class="s1">&#39;mono-methylation&#39;</span><span class="p">,</span>
            <span class="s1">&#39;m2&#39;</span><span class="p">:</span> <span class="s1">&#39;di-methylation&#39;</span><span class="p">,</span>
            <span class="s1">&#39;pa&#39;</span><span class="p">:</span> <span class="s1">&#39;palmitoylation&#39;</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">&#39;ptm&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="n">preg</span> <span class="o">=</span> <span class="n">phosphosite</span><span class="o">.</span><span class="n">phosphosite_regsites</span><span class="p">()</span>
        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">preg</span><span class="p">),</span> <span class="s1">&#39;Processing regulatory effects&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">src</span><span class="p">,</span> <span class="n">tgts</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">preg</span><span class="p">):</span>
            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

            <span class="c1"># ptm on src</span>
            <span class="c1"># tgt: interactor of src, depending on ptm</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>

                <span class="k">for</span> <span class="n">tgt</span> <span class="ow">in</span> <span class="n">tgts</span><span class="p">:</span>

                    <span class="k">for</span> <span class="n">effect</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;induces&#39;</span><span class="p">,</span> <span class="s1">&#39;disrupts&#39;</span><span class="p">]:</span>

                        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">tgt</span><span class="p">[</span><span class="n">effect</span><span class="p">]:</span>
                            <span class="n">uniprots</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="s1">&#39;genesymbol&#39;</span><span class="p">,</span>
                                                            <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>

                            <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">uniprots</span><span class="p">:</span>

                                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
                                    <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node_pair</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>

                                    <span class="k">if</span> <span class="n">nodes</span><span class="p">:</span>
                                        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span>
                                            <span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                                        <span class="k">if</span> <span class="n">e</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>

                                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                                                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                                            <span class="n">res</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Residue</span><span class="p">(</span>
                                                <span class="nb">int</span><span class="p">(</span><span class="n">tgt</span><span class="p">[</span><span class="s1">&#39;res&#39;</span><span class="p">]),</span> <span class="n">tgt</span><span class="p">[</span><span class="s1">&#39;aa&#39;</span><span class="p">],</span>
                                                <span class="n">src</span><span class="p">)</span>
                                            <span class="n">ptm</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Ptm</span><span class="p">(</span>
                                                <span class="n">protein</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                                                <span class="n">residue</span><span class="o">=</span><span class="n">res</span><span class="p">,</span>
                                                <span class="n">typ</span><span class="o">=</span><span class="n">modtyp</span><span class="p">[</span><span class="n">tgt</span><span class="p">[</span><span class="s1">&#39;modt&#39;</span><span class="p">]])</span>
                                            <span class="n">reg</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Regulation</span><span class="p">(</span>
                                                <span class="n">source</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
                                                <span class="n">target</span><span class="o">=</span><span class="n">u</span><span class="p">,</span>
                                                <span class="n">sources</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PhosphoSite&#39;</span><span class="p">],</span>
                                                <span class="n">refs</span><span class="o">=</span><span class="n">tgt</span><span class="p">[</span><span class="s1">&#39;pmids&#39;</span><span class="p">],</span>
                                                <span class="n">effect</span><span class="o">=</span><span class="n">effect</span><span class="p">,</span>
                                                <span class="n">ptm</span><span class="o">=</span><span class="n">ptm</span><span class="p">)</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.load_comppi"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_comppi">[docs]</a>    <span class="k">def</span> <span class="nf">load_comppi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">&#39;comppi&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;comppi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="k">if</span> <span class="s1">&#39;comppi&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;comppi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">]</span>

        <span class="n">comppi</span> <span class="o">=</span> <span class="n">comppi_input</span><span class="o">.</span><span class="n">comppi_interaction_locations</span><span class="p">()</span>
        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">comppi</span><span class="p">),</span> <span class="s1">&#39;Processing localizations&#39;</span><span class="p">,</span> <span class="mi">33</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">comppi</span><span class="p">:</span>
            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
            <span class="n">uniprots1</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;uniprot1&#39;</span><span class="p">],</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span> <span class="mi">9606</span><span class="p">)</span>
            <span class="n">uniprots2</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;uniprot2&#39;</span><span class="p">],</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span> <span class="mi">9606</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">u1</span> <span class="ow">in</span> <span class="n">uniprots1</span><span class="p">:</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">u1</span><span class="p">):</span>

                    <span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;loc1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)]:</span>
                        <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">u1</span><span class="p">]]</span>\
                            <span class="p">[</span><span class="s1">&#39;comppi&#39;</span><span class="p">][</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">u2</span> <span class="ow">in</span> <span class="n">uniprots1</span><span class="p">:</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">u2</span><span class="p">):</span>

                    <span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;loc2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)]:</span>
                        <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">u2</span><span class="p">]]</span>\
                            <span class="p">[</span><span class="s1">&#39;comppi&#39;</span><span class="p">][</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">u1</span> <span class="ow">in</span> <span class="n">uniprots1</span><span class="p">:</span>

                <span class="k">for</span> <span class="n">u2</span> <span class="ow">in</span> <span class="n">uniprots2</span><span class="p">:</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_exists</span><span class="p">(</span><span class="n">u2</span><span class="p">):</span>
                        <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node_pair</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span> <span class="n">u2</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">nodes</span><span class="p">:</span>
                            <span class="n">e</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                            <span class="k">if</span> <span class="n">e</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                                <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;comppi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;loc_score&#39;</span><span class="p">])</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.edge_loc"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.edge_loc">[docs]</a>    <span class="k">def</span> <span class="nf">edge_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">topn</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">if</span> <span class="s1">&#39;comppi&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_comppi</span><span class="p">()</span>

        <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>
            <span class="n">e</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="nb">set</span><span class="p">([</span>
                    <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">heapq</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                            <span class="n">iteritems</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span>
                                                <span class="s1">&#39;comppi&#39;</span><span class="p">]),</span>
                                            <span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                <span class="p">])</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">([</span>
                    <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">heapq</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                                            <span class="n">iteritems</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span>
                                                <span class="s1">&#39;comppi&#39;</span><span class="p">]),</span>
                                            <span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                <span class="p">]))</span></div>

<div class="viewcode-block" id="PyPath.sequences"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.sequences">[docs]</a>    <span class="k">def</span> <span class="nf">sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isoforms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">seq</span> <span class="o">=</span> <span class="n">se</span><span class="o">.</span><span class="n">swissprot_seq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span><span class="p">,</span> <span class="n">isoforms</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.load_ptms2"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_ptms2">[docs]</a>    <span class="k">def</span> <span class="nf">load_ptms2</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">input_methods</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">map_by_homology_from</span> <span class="o">=</span> <span class="p">[</span><span class="mi">9606</span><span class="p">],</span>
            <span class="n">homology_only_swissprot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">ptm_homology_strict</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">nonhuman_direct_lookup</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">inputargs</span> <span class="o">=</span> <span class="p">{},</span>
            <span class="n">database</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">force_load</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is a new method which will replace `load_ptms`.</span>
<span class="sd">        It uses `pypath.enz_sub.EnzymeSubstrateAggregator`, a newly</span>
<span class="sd">        introduced module for combining enzyme-substrate data from multiple</span>
<span class="sd">        resources using homology translation on users demand.</span>

<span class="sd">        :param list input_methods: Resources to collect enzyme-substrate</span>
<span class="sd">            interactions from. E.g. `[&#39;Signor&#39;, &#39;phosphoELM&#39;]`. By default</span>
<span class="sd">            it contains Signor, PhosphoSitePlus, HPRD, phosphoELM, dbPTM,</span>
<span class="sd">            PhosphoNetworks, Li2012 and MIMP.</span>
<span class="sd">        :param list map_by_homology_from: List of NCBI Taxonomy IDs of</span>
<span class="sd">            source taxons used for homology translation of enzyme-substrate</span>
<span class="sd">            interactions. If you have a human network and you add here</span>
<span class="sd">            `[10090, 10116]` then mouse and rat interactions from the source</span>
<span class="sd">            databases will be translated to human.</span>
<span class="sd">        :param bool homology_only_swissprot: `True` by default which means</span>
<span class="sd">            only SwissProt IDs are accepted at homology translateion, Trembl</span>
<span class="sd">            IDs will be dropped.</span>
<span class="sd">        :param bool ptm_homology_strict: For homology translation use</span>
<span class="sd">            PhosphoSite&#39;s PTM homology table. This guarantees that only</span>
<span class="sd">            truely homologous sites will be included. Otherwise we only</span>
<span class="sd">            check if at the same numeric offset in the homologous sequence</span>
<span class="sd">            the appropriate residue can be find.</span>
<span class="sd">        :param bool nonhuman_direct_lookup: Fetch also directly nonhuman</span>
<span class="sd">            data from the resources whereever it&#39;s available. PhosphoSite</span>
<span class="sd">            contains mouse enzyme-substrate interactions and it is possible</span>
<span class="sd">            to extract these directly beside translating the human ones</span>
<span class="sd">            to mouse.</span>
<span class="sd">        :param dict inputargs: Additional arguments passed to `PtmProcessor`.</span>
<span class="sd">            A `dict` can be supplied for each resource, e.g.</span>
<span class="sd">            `{&#39;Signor&#39;: {...}, &#39;PhosphoSite&#39;: {...}, ...}`.</span>
<span class="sd">            Those not used by `PtmProcessor` are forwarded to the</span>
<span class="sd">            `pypath.inputs` methods.</span>
<span class="sd">        :param database:</span>
<span class="sd">            A ``PtmAggregator`` object. If provided no new database will be</span>
<span class="sd">            created.</span>
<span class="sd">        :param bool force_load:</span>
<span class="sd">            If ``True`` the database will be loaded with the parameters</span>
<span class="sd">            provided here; otherwise if the ``ptm`` module already has a</span>
<span class="sd">            database no new database will be created. This means the</span>
<span class="sd">            parameters specified in other arguments might have no effect.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">database</span><span class="p">:</span>

            <span class="n">ptma</span> <span class="o">=</span> <span class="n">database</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;init_db&#39;</span> <span class="k">if</span> <span class="n">force_load</span> <span class="k">else</span> <span class="s1">&#39;get_db&#39;</span>

            <span class="n">_</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">pypath</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">enz_sub</span><span class="p">,</span> <span class="s1">&#39;method&#39;</span><span class="p">)(</span>
                <span class="n">input_methods</span> <span class="o">=</span> <span class="n">input_methods</span><span class="p">,</span>
                <span class="n">ncbi_tax_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span><span class="p">,</span>
                <span class="n">map_by_homology_from</span> <span class="o">=</span> <span class="n">map_by_homology_from</span><span class="p">,</span>
                <span class="n">homology_only_swissprot</span> <span class="o">=</span> <span class="n">homology_only_swissprot</span><span class="p">,</span>
                <span class="n">ptm_homology_strict</span> <span class="o">=</span> <span class="n">ptm_homology_strict</span><span class="p">,</span>
                <span class="n">nonhuman_direct_lookup</span> <span class="o">=</span> <span class="n">nonhuman_direct_lookup</span><span class="p">,</span>
                <span class="n">inputargs</span> <span class="o">=</span> <span class="n">inputargs</span>
            <span class="p">)</span>

            <span class="n">ptma</span> <span class="o">=</span> <span class="n">pypath</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">enz_sub</span><span class="o">.</span><span class="n">get_db</span><span class="p">()</span>

        <span class="n">ptma</span><span class="o">.</span><span class="n">assign_to_network</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span> <span class="o">==</span> <span class="mi">9606</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="n">input_methods</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span>
                <span class="s1">&#39;DEPOD&#39;</span> <span class="ow">in</span> <span class="n">input_methods</span>
            <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_depod_dmi</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">uniq_ptms</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phosphorylation_directions</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.load_ptms"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_ptms">[docs]</a>    <span class="k">def</span> <span class="nf">load_ptms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">load_depod_dmi</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_signor_ptms</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_li2012_ptms</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_hprd_ptms</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_mimp_dmi</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_pnetworks_dmi</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_phosphoelm</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_dbptm</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_psite_phos</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uniq_ptms</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phosphorylation_directions</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.load_mimp_dmi"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_mimp_dmi">[docs]</a>    <span class="k">def</span> <span class="nf">load_mimp_dmi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">non_matching</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_phospho_dmi</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s1">&#39;MIMP&#39;</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="n">trace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">trace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">trace</span></div>

<div class="viewcode-block" id="PyPath.load_pnetworks_dmi"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_pnetworks_dmi">[docs]</a>    <span class="k">def</span> <span class="nf">load_pnetworks_dmi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_phospho_dmi</span><span class="p">(</span>
            <span class="n">source</span><span class="o">=</span><span class="s1">&#39;PhosphoNetworks&#39;</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="n">trace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">trace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">trace</span></div>

<div class="viewcode-block" id="PyPath.load_phosphoelm"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_phosphoelm">[docs]</a>    <span class="k">def</span> <span class="nf">load_phosphoelm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_phospho_dmi</span><span class="p">(</span>
            <span class="n">source</span><span class="o">=</span><span class="s1">&#39;phosphoELM&#39;</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="n">trace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">trace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">trace</span></div>

<div class="viewcode-block" id="PyPath.load_dbptm"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_dbptm">[docs]</a>    <span class="k">def</span> <span class="nf">load_dbptm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">non_matching</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_phospho_dmi</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s1">&#39;dbPTM&#39;</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="n">trace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">trace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">trace</span></div>

<div class="viewcode-block" id="PyPath.load_hprd_ptms"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_hprd_ptms">[docs]</a>    <span class="k">def</span> <span class="nf">load_hprd_ptms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">non_matching</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_phospho_dmi</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s1">&#39;HPRD&#39;</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="n">trace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">trace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">trace</span></div>

<div class="viewcode-block" id="PyPath.load_li2012_ptms"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_li2012_ptms">[docs]</a>    <span class="k">def</span> <span class="nf">load_li2012_ptms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">non_matching</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_phospho_dmi</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s1">&#39;Li2012&#39;</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="n">trace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">trace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">trace</span></div>

<div class="viewcode-block" id="PyPath.load_signor_ptms"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_signor_ptms">[docs]</a>    <span class="k">def</span> <span class="nf">load_signor_ptms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">non_matching</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_phospho_dmi</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s1">&#39;Signor&#39;</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="n">trace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">trace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">trace</span></div>

<div class="viewcode-block" id="PyPath.load_psite_phos"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_psite_phos">[docs]</a>    <span class="k">def</span> <span class="nf">load_psite_phos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_phospho_dmi</span><span class="p">(</span>
            <span class="n">source</span><span class="o">=</span><span class="s1">&#39;PhosphoSite&#39;</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="n">trace</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">trace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">trace</span></div>

<div class="viewcode-block" id="PyPath.load_phospho_dmi"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_phospho_dmi">[docs]</a>    <span class="k">def</span> <span class="nf">load_phospho_dmi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_raw</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">functions</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;Signor&#39;</span><span class="p">:</span> <span class="s1">&#39;load_signor_ptms&#39;</span><span class="p">,</span>
            <span class="s1">&#39;MIMP&#39;</span><span class="p">:</span> <span class="s1">&#39;get_mimp&#39;</span><span class="p">,</span>
            <span class="s1">&#39;PhosphoNetworks&#39;</span><span class="p">:</span> <span class="s1">&#39;get_phosphonetworks&#39;</span><span class="p">,</span>
            <span class="s1">&#39;phosphoELM&#39;</span><span class="p">:</span> <span class="s1">&#39;get_phosphoelm&#39;</span><span class="p">,</span>
            <span class="s1">&#39;dbPTM&#39;</span><span class="p">:</span> <span class="s1">&#39;get_dbptm&#39;</span><span class="p">,</span>
            <span class="s1">&#39;PhosphoSite&#39;</span><span class="p">:</span> <span class="s1">&#39;get_psite_phos&#39;</span><span class="p">,</span>
            <span class="s1">&#39;HPRD&#39;</span><span class="p">:</span> <span class="s1">&#39;get_hprd_ptms&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Li2012&#39;</span><span class="p">:</span> <span class="s1">&#39;li2012_phospho&#39;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;PhosphoSite&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span> <span class="ow">in</span> <span class="n">taxonomy</span><span class="o">.</span><span class="n">taxids</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;organism&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">taxonomy</span><span class="o">.</span><span class="n">taxids</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span><span class="p">]</span>

            <span class="k">if</span> <span class="s1">&#39;strict&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;strict&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;Signor&#39;</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;organism&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span>

        <span class="k">if</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;phosphoELM&#39;</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;organism&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span> <span class="o">!=</span> <span class="mi">9606</span> <span class="ow">and</span> <span class="s1">&#39;ltp_only&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ltp_only&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;dbPTM&#39;</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;organism&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span> <span class="o">!=</span> <span class="mi">9606</span> <span class="ow">and</span> <span class="n">source</span> <span class="ow">not</span> <span class="ow">in</span> \
            <span class="p">[</span><span class="s1">&#39;Signor&#39;</span><span class="p">,</span> <span class="s1">&#39;PhosphoSite&#39;</span><span class="p">,</span> <span class="s1">&#39;phosphoELM&#39;</span><span class="p">,</span> <span class="s1">&#39;dbPTM&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="n">toCall</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_method</span><span class="p">(</span><span class="n">functions</span><span class="p">[</span><span class="n">source</span><span class="p">])</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">toCall</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="p">(</span><span class="n">isoforms</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;ptm&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="n">nomatch</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">kin_ambig</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">sub_ambig</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="s1">&#39;Processing PTMs from </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">source</span><span class="p">,</span> <span class="mi">23</span><span class="p">)</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="n">p</span><span class="p">[</span><span class="s1">&#39;kinase&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
                <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;kinase&#39;</span><span class="p">],</span> <span class="n">intera</span><span class="o">.</span><span class="n">Complex</span><span class="p">)</span> <span class="ow">and</span>
                <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;substrate&#39;</span><span class="p">],</span> <span class="n">intera</span><span class="o">.</span><span class="n">Complex</span><span class="p">)</span> <span class="ow">and</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;kinase&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span>
            <span class="p">):</span>

                <span class="c1"># database specific id conversions</span>
                <span class="k">if</span> <span class="n">source</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PhosphoSite&#39;</span><span class="p">,</span> <span class="s1">&#39;phosphoELM&#39;</span><span class="p">,</span> <span class="s1">&#39;Signor&#39;</span><span class="p">]:</span>
                    <span class="n">kinase_ups</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;kinase&#39;</span><span class="p">],</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                                                      <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;kinase&#39;</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;kinase&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;kinase&#39;</span><span class="p">]]</span>
                    <span class="n">kinase_ups</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">i</span>
                        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="p">[</span>
                            <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s1">&#39;genesymbol&#39;</span><span class="p">,</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;kinase&#39;</span><span class="p">]</span>
                        <span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ii</span>
                    <span class="p">]</span>

                    <span class="n">kinase_ups</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">kinase_ups</span><span class="p">))</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;kinase&#39;</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">p</span><span class="p">[</span><span class="s1">&#39;kinase&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;kinase&#39;</span><span class="p">]]</span>

                <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;substrate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;HLA&#39;</span><span class="p">):</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="n">source</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;MIMP&#39;</span><span class="p">,</span> <span class="s1">&#39;PhosphoNetworks&#39;</span><span class="p">,</span> <span class="s1">&#39;Li2012&#39;</span><span class="p">]:</span>
                    <span class="n">substrate_ups_all</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span>
                        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;substrate&#39;</span><span class="p">],</span> <span class="s1">&#39;genesymbol&#39;</span><span class="p">,</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;MIMP&#39;</span><span class="p">:</span>
                    <span class="n">substrate_ups_all</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                        <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span>
                            <span class="n">p</span><span class="p">[</span><span class="s1">&#39;substrate_refseq&#39;</span><span class="p">],</span>
                            <span class="s1">&#39;refseq&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">substrate_ups_all</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">substrate_ups_all</span><span class="p">))</span>

                <span class="k">if</span> <span class="n">source</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;phosphoELM&#39;</span><span class="p">,</span> <span class="s1">&#39;dbPTM&#39;</span><span class="p">,</span> <span class="s1">&#39;PhosphoSite&#39;</span><span class="p">,</span> <span class="s1">&#39;Signor&#39;</span><span class="p">]:</span>
                    <span class="n">substrate_ups_all</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span>
                        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;substrate&#39;</span><span class="p">],</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;HPRD&#39;</span><span class="p">:</span>
                    <span class="n">substrate_ups_all</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span>
                        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;substrate_refseqp&#39;</span><span class="p">],</span> <span class="s1">&#39;refseqp&#39;</span><span class="p">,</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>
                    <span class="n">substrate_ups_all</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">uniq_list</span><span class="p">(</span><span class="n">substrate_ups_all</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;kinase&#39;</span><span class="p">]:</span>

                    <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kin_ambig</span><span class="p">:</span>
                        <span class="n">kin_ambig</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kinase_ups</span>

                <span class="c1"># looking up sequences in all isoforms:</span>
                <span class="n">substrate_ups</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">substrate_ups_all</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">:</span>

                        <span class="k">for</span> <span class="n">isof</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">isoforms</span><span class="p">():</span>

                            <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;instance&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
                                        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;instance&#39;</span><span class="p">],</span>
                                        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">],</span>
                                        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">],</span>
                                        <span class="n">isoform</span><span class="o">=</span><span class="n">isof</span><span class="p">):</span>
                                    <span class="n">substrate_ups</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="n">isof</span><span class="p">))</span>

                            <span class="k">else</span><span class="p">:</span>

                                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
                                        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;resaa&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;resnum&#39;</span><span class="p">],</span> <span class="n">isoform</span><span class="o">=</span><span class="n">isof</span><span class="p">):</span>
                                    <span class="n">substrate_ups</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="n">isof</span><span class="p">))</span>

                <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;substrate&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sub_ambig</span><span class="p">:</span>
                    <span class="n">sub_ambig</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;substrate&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">substrate_ups</span>

                <span class="c1"># generating report on non matching substrates</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">substrate_ups</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

                    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">substrate_ups_all</span><span class="p">:</span>

                        <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">:</span>
                            <span class="n">nomatch</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;substrate_refseq&#39;</span><span class="p">],</span>
                                            <span class="n">s</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;instance&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                                                <span class="n">p</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">])))</span>

                <span class="c1"># adding kinase-substrate interactions</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kinase_ups</span><span class="p">:</span>

                    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">substrate_ups</span><span class="p">:</span>
                        <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node_pair</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                            <span class="n">directed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">is_directed</span><span class="p">())</span>

                        <span class="k">if</span> <span class="n">nodes</span> <span class="ow">or</span> <span class="n">return_raw</span><span class="p">:</span>
                            <span class="n">e</span> <span class="o">=</span> <span class="kc">None</span>

                            <span class="k">if</span> <span class="n">nodes</span><span class="p">:</span>
                                <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span>
                                    <span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                            <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">e</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="n">return_raw</span><span class="p">:</span>
                                <span class="n">res</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Residue</span><span class="p">(</span>
                                    <span class="n">p</span><span class="p">[</span><span class="s1">&#39;resnum&#39;</span><span class="p">],</span>
                                    <span class="n">p</span><span class="p">[</span><span class="s1">&#39;resaa&#39;</span><span class="p">],</span>
                                    <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                    <span class="n">isoform</span><span class="o">=</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

                                <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;instance&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                                    <span class="n">reg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">get_region</span><span class="p">(</span>
                                        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;resnum&#39;</span><span class="p">],</span>
                                        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">],</span>
                                        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">],</span>
                                        <span class="n">isoform</span><span class="o">=</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

                                    <span class="k">if</span> <span class="n">reg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                                        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;instance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reg</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                                        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                                        <span class="n">p</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

                                <span class="k">if</span> <span class="s1">&#39;typ&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
                                    <span class="n">p</span><span class="p">[</span><span class="s1">&#39;typ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;phosphorylation&#39;</span>

                                <span class="n">mot</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Motif</span><span class="p">(</span>
                                    <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                    <span class="n">p</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">],</span>
                                    <span class="n">p</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">],</span>
                                    <span class="n">instance</span><span class="o">=</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;instance&#39;</span><span class="p">],</span>
                                    <span class="n">isoform</span><span class="o">=</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                                <span class="n">ptm</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Ptm</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                 <span class="n">motif</span><span class="o">=</span><span class="n">mot</span><span class="p">,</span>
                                                 <span class="n">residue</span><span class="o">=</span><span class="n">res</span><span class="p">,</span>
                                                 <span class="n">typ</span><span class="o">=</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;typ&#39;</span><span class="p">],</span>
                                                 <span class="n">source</span><span class="o">=</span><span class="p">[</span><span class="n">source</span><span class="p">],</span>
                                                 <span class="n">isoform</span><span class="o">=</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                                <span class="n">dom</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Domain</span><span class="p">(</span><span class="n">protein</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>

                                <span class="k">if</span> <span class="s1">&#39;references&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
                                    <span class="n">p</span><span class="p">[</span><span class="s1">&#39;references&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                                <span class="n">dommot</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">DomainMotif</span><span class="p">(</span>
                                    <span class="n">domain</span><span class="o">=</span><span class="n">dom</span><span class="p">,</span>
                                    <span class="n">ptm</span><span class="o">=</span><span class="n">ptm</span><span class="p">,</span>
                                    <span class="n">sources</span><span class="o">=</span><span class="p">[</span><span class="n">source</span><span class="p">],</span>
                                    <span class="n">refs</span><span class="o">=</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;references&#39;</span><span class="p">])</span>

                                <span class="k">if</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;MIMP&#39;</span><span class="p">:</span>
                                    <span class="n">dommot</span><span class="o">.</span><span class="n">mimp_sources</span> <span class="o">=</span> <span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">p</span><span class="p">[</span>
                                        <span class="s1">&#39;databases&#39;</span><span class="p">])</span>
                                    <span class="n">dommot</span><span class="o">.</span><span class="n">npmid</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;npmid&#39;</span><span class="p">]</span>

                                <span class="k">elif</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;PhosphoNetworks&#39;</span><span class="p">:</span>
                                    <span class="n">dommot</span><span class="o">.</span><span class="n">pnetw_score</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span>

                                <span class="k">elif</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;dbPTM&#39;</span><span class="p">:</span>
                                    <span class="n">dommot</span><span class="o">.</span><span class="n">dbptm_sources</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]]</span>

                                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">e</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

                                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                                    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dommot</span><span class="p">)</span>

                                <span class="k">if</span> <span class="n">return_raw</span><span class="p">:</span>
                                    <span class="n">raw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dommot</span><span class="p">)</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">trace</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;non_matching&#39;</span><span class="p">:</span> <span class="n">nomatch</span><span class="p">,</span>
                <span class="s1">&#39;kinase_ambiguousity&#39;</span><span class="p">:</span> <span class="n">kin_ambig</span><span class="p">,</span>
                <span class="s1">&#39;substrate_ambiguousity&#39;</span><span class="p">:</span> <span class="n">sub_ambig</span>
            <span class="p">}</span>

        <span class="k">if</span> <span class="n">return_raw</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">raw</span></div>

<div class="viewcode-block" id="PyPath.load_depod_dmi"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_depod_dmi">[docs]</a>    <span class="k">def</span> <span class="nf">load_depod_dmi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">reres</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;([A-Z][a-z]+)-([0-9]+)&#39;</span><span class="p">)</span>
        <span class="n">non_digit</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^\d.-]+&#39;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">depod_input</span><span class="o">.</span><span class="n">depod_enzyme_substrate</span><span class="p">()</span>
        <span class="n">aadict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">([</span><span class="n">a</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">common</span><span class="o">.</span><span class="n">aaletters</span><span class="o">.</span><span class="n">keys</span><span class="p">()],</span>
                <span class="n">common</span><span class="o">.</span><span class="n">aaletters</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">&#39;ptm&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="s1">&#39;Loading dephosphorylation data from DEPOD&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
        <span class="n">mapp</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
            <span class="n">reslist</span> <span class="o">=</span> <span class="p">[(</span><span class="n">aadict</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="nb">int</span><span class="p">(</span><span class="n">non_digit</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
                       <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">reres</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">aadict</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">enzymes</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>
                <span class="n">substrates</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>
                <span class="n">substrates</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">substrates</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">]</span>
                <span class="n">mapp</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">enzymes</span><span class="p">,</span> <span class="n">substrates</span><span class="p">,</span> <span class="n">reslist</span><span class="p">])</span>

                <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">reslist</span><span class="p">:</span>
                    <span class="n">substrates</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">substrates</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="p">]</span>

                <span class="n">mapp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">substrates</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">enzymes</span><span class="p">:</span>

                    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">substrates</span><span class="p">:</span>
                        <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node_pair</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">nodes</span><span class="p">:</span>
                            <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span>
                                <span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">e</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

                                <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">reslist</span><span class="p">:</span>
                                    <span class="n">res</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Residue</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s</span><span class="p">)</span>
                                    <span class="n">ptm</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Ptm</span><span class="p">(</span><span class="n">s</span><span class="p">,</span>
                                                     <span class="n">residue</span><span class="o">=</span><span class="n">res</span><span class="p">,</span>
                                                     <span class="n">typ</span><span class="o">=</span><span class="s1">&#39;dephosphorylation&#39;</span><span class="p">,</span>
                                                     <span class="n">source</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DEPOD&#39;</span><span class="p">])</span>
                                    <span class="n">dom</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">Domain</span><span class="p">(</span><span class="n">protein</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
                                    <span class="n">dommot</span> <span class="o">=</span> <span class="n">intera</span><span class="o">.</span><span class="n">DomainMotif</span><span class="p">(</span>
                                        <span class="n">domain</span><span class="o">=</span><span class="n">dom</span><span class="p">,</span>
                                        <span class="n">ptm</span><span class="o">=</span><span class="n">ptm</span><span class="p">,</span>
                                        <span class="n">sources</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DEPOD&#39;</span><span class="p">],</span>
                                        <span class="n">refs</span><span class="o">=</span><span class="p">[</span>
                                            <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                                        <span class="p">])</span>

                                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                                    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dommot</span><span class="p">)</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span></div>
        <span class="c1"># return mapp</span>

<div class="viewcode-block" id="PyPath.uniq_ptms"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.uniq_ptms">[docs]</a>    <span class="k">def</span> <span class="nf">uniq_ptms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="s1">&#39;ptm&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">uniq_ptm</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span>
            <span class="p">]</span></div>

<div class="viewcode-block" id="PyPath.uniq_ptm"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.uniq_ptm">[docs]</a>    <span class="k">def</span> <span class="nf">uniq_ptm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ptms</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ptms_uniq</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">ptm</span> <span class="ow">in</span> <span class="n">ptms</span><span class="p">:</span>
            <span class="n">merged</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ptmu</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ptms_uniq</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">ptm</span> <span class="o">==</span> <span class="n">ptmu</span><span class="p">:</span>
                    <span class="n">ptms_uniq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ptm</span><span class="p">)</span>
                    <span class="n">merged</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">merged</span><span class="p">:</span>
                <span class="n">ptms_uniq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ptm</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ptms_uniq</span></div>

<div class="viewcode-block" id="PyPath.phosphorylation_directions"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.phosphorylation_directions">[docs]</a>    <span class="k">def</span> <span class="nf">phosphorylation_directions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">uniq_ptms</span><span class="p">()</span>
        <span class="n">isdir</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">is_directed</span><span class="p">():</span>
                <span class="n">isdir</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">ptm</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]:</span>

                <span class="k">if</span> <span class="n">ptm</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;DomainMotif&#39;</span> <span class="ow">and</span> \
                        <span class="n">ptm</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">typ</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;phosphorylation&#39;</span><span class="p">,</span> <span class="s1">&#39;dephosphorylation&#39;</span><span class="p">]:</span>
                    <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_dir</span><span class="p">((</span><span class="n">ptm</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">protein</span><span class="p">,</span> <span class="n">ptm</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">protein</span><span class="p">),</span>
                                      <span class="n">ptm</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">sources</span><span class="p">)</span>

        <span class="n">isdir2</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">is_directed</span><span class="p">():</span>
                <span class="n">isdir2</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;Directionality set for </span><span class="si">%u</span><span class="s1"> interactions &#39;</span>
            <span class="s1">&#39;based on known (de)phosphorylation events.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">isdir2</span> <span class="o">-</span> <span class="n">isdir</span><span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.phosphorylation_signs"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.phosphorylation_signs">[docs]</a>    <span class="k">def</span> <span class="nf">phosphorylation_signs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="n">new_signs</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">dephos</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># looking up effects of dephosphorylations:</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">ptm</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]:</span>
                <span class="n">sign</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="k">if</span> <span class="n">ptm</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">typ</span> <span class="o">==</span> <span class="s1">&#39;dephosphorylation&#39;</span><span class="p">:</span>
                    <span class="n">direction</span> <span class="o">=</span> <span class="p">(</span><span class="n">ptm</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">protein</span><span class="p">,</span> <span class="n">ptm</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">protein</span><span class="p">)</span>
                    <span class="n">signs</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_sign</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">signs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">signs</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">sign</span> <span class="o">=</span> <span class="s1">&#39;positive&#39;</span>

                    <span class="k">elif</span> <span class="n">signs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">signs</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="n">sign</span> <span class="o">=</span> <span class="s1">&#39;negative&#39;</span>

                    <span class="k">if</span> <span class="n">sign</span><span class="p">:</span>

                        <span class="k">if</span> <span class="n">ptm</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">protein</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dephos</span><span class="p">:</span>
                            <span class="n">dephos</span><span class="p">[</span><span class="n">ptm</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">protein</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                        <span class="n">dephos</span><span class="p">[</span><span class="n">ptm</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">protein</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                            <span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="n">ptm</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">protein</span><span class="p">,</span>
                            <span class="s1">&#39;resaa&#39;</span><span class="p">:</span> <span class="n">ptm</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                            <span class="s1">&#39;resnum&#39;</span><span class="p">:</span> <span class="n">ptm</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">number</span><span class="p">,</span>
                            <span class="s1">&#39;sign&#39;</span><span class="p">:</span> <span class="n">sign</span>
                        <span class="p">})</span>

        <span class="c1"># set the opposite sign for posphorylations as it is</span>
        <span class="c1"># at corresponding dephosphorylations:</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">ptm</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]:</span>

                <span class="k">if</span> <span class="n">ptm</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">typ</span> <span class="o">==</span> <span class="s1">&#39;phosphorylation&#39;</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">ptm</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">protein</span> <span class="ow">in</span> <span class="n">dephos</span><span class="p">:</span>

                        <span class="k">for</span> <span class="n">de</span> <span class="ow">in</span> <span class="n">dephos</span><span class="p">[</span><span class="n">protein</span><span class="p">]:</span>

                            <span class="k">if</span> <span class="n">ptm</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">number</span> <span class="o">==</span> <span class="n">de</span><span class="p">[</span><span class="s1">&#39;resnum&#39;</span><span class="p">]</span> <span class="ow">and</span> \
                                    <span class="n">ptm</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">de</span><span class="p">[</span><span class="s1">&#39;resaa&#39;</span><span class="p">]:</span>

                                <span class="n">direction</span> <span class="o">=</span> <span class="p">(</span><span class="n">ptm</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">protein</span><span class="p">,</span>
                                             <span class="n">ptm</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">protein</span><span class="p">)</span>
                                <span class="n">signs</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_sign</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span>
                                <span class="n">sign</span> <span class="o">=</span> <span class="s1">&#39;positive&#39;</span> <span class="k">if</span> <span class="n">de</span><span class="p">[</span><span class="s1">&#39;sign&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;negative&#39;</span> \
                                    <span class="k">else</span> <span class="s1">&#39;negative&#39;</span>

                                <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">signs</span><span class="p">)):</span>
                                    <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_sign</span><span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="n">sign</span><span class="p">,</span>
                                                       <span class="n">ptm</span><span class="o">.</span><span class="n">sources</span><span class="p">)</span>
                                    <span class="n">new_signs</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;Signes set based on phosphorylation-&#39;</span>
            <span class="s1">&#39;dephosphorylation pairs: </span><span class="si">%u</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">new_signs</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.kinase_stats"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.kinase_stats">[docs]</a>    <span class="k">def</span> <span class="nf">kinase_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">counts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">pcounts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">ks_pairs</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">psite_num</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="n">ks_srcs</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]:</span>

                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">p</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;DomainMotif&#39;</span> <span class="ow">and</span>
                    <span class="n">p</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">typ</span> <span class="o">==</span> <span class="s1">&#39;phosphorylation&#39;</span>
                <span class="p">):</span>

                    <span class="n">ks_srcs</span> <span class="o">+=</span> <span class="n">p</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">sources</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">sources</span>
                    <span class="n">p_srcs</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">sources</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">sources</span>
                    <span class="n">p_srcs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">p_srcs</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">([</span><span class="s1">&#39;Swiss-Prot&#39;</span><span class="p">]))</span>
                    <span class="n">p_srcs</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">p_srcs</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">p_srcs</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pcounts</span><span class="p">:</span>
                        <span class="n">pcounts</span><span class="p">[</span><span class="n">p_srcs</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

                    <span class="n">pcounts</span><span class="p">[</span><span class="n">p_srcs</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">psite_num</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ks_srcs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ks_srcs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ks_srcs</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">([</span><span class="s1">&#39;Swiss-Prot&#39;</span><span class="p">]))</span>
                <span class="n">ks_srcs</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ks_srcs</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">ks_srcs</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">counts</span><span class="p">:</span>
                    <span class="n">counts</span><span class="p">[</span><span class="n">ks_srcs</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="n">counts</span><span class="p">[</span><span class="n">ks_srcs</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">ks_pairs</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;phosphorylations&#39;</span><span class="p">:</span> <span class="n">pcounts</span><span class="p">,</span> <span class="s1">&#39;kinase_substrate&#39;</span><span class="p">:</span> <span class="n">counts</span><span class="p">}</span></div>

<div class="viewcode-block" id="PyPath.update_db_dict"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.update_db_dict">[docs]</a>    <span class="k">def</span> <span class="nf">update_db_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">db_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;nodes&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;edges&#39;</span><span class="p">:</span> <span class="p">{}}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_vertex_sources</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_sources</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]:</span>

                <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">db_dict</span><span class="p">[</span><span class="s1">&#39;edges&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">db_dict</span><span class="p">[</span><span class="s1">&#39;edges&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">db_dict</span><span class="p">[</span><span class="s1">&#39;edges&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]:</span>

                <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">db_dict</span><span class="p">[</span><span class="s1">&#39;nodes&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">db_dict</span><span class="p">[</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">db_dict</span><span class="p">[</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.sources_overlap"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.sources_overlap">[docs]</a>    <span class="k">def</span> <span class="nf">sources_overlap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">diagonal</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_db_dict</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;single&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;nodes&#39;</span><span class="p">:</span> <span class="p">{},</span>
                <span class="s1">&#39;edges&#39;</span><span class="p">:</span> <span class="p">{}</span>
            <span class="p">},</span>
            <span class="s1">&#39;overlap&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;nodes&#39;</span><span class="p">:</span> <span class="p">{},</span>
                <span class="s1">&#39;edges&#39;</span><span class="p">:</span> <span class="p">{}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="s1">&#39;single&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_dict</span><span class="p">[</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">])</span>
            <span class="n">result</span><span class="p">[</span><span class="s1">&#39;single&#39;</span><span class="p">][</span><span class="s1">&#39;edges&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_dict</span><span class="p">[</span><span class="s1">&#39;edges&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">s1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">s2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">diagonal</span> <span class="ow">or</span> <span class="n">s1</span> <span class="o">!=</span> <span class="n">s2</span><span class="p">:</span>
                    <span class="n">result</span><span class="p">[</span><span class="s1">&#39;overlap&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">][(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)]</span> <span class="o">=</span> \
                        <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_dict</span><span class="p">[</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="n">s1</span><span class="p">]</span> <span class="o">&amp;</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">db_dict</span><span class="p">[</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="n">s2</span><span class="p">])</span>
                    <span class="n">result</span><span class="p">[</span><span class="s1">&#39;overlap&#39;</span><span class="p">][</span><span class="s1">&#39;edges&#39;</span><span class="p">][(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)]</span> <span class="o">=</span> \
                        <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_dict</span><span class="p">[</span><span class="s1">&#39;edges&#39;</span><span class="p">][</span><span class="n">s1</span><span class="p">]</span> <span class="o">&amp;</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">db_dict</span><span class="p">[</span><span class="s1">&#39;edges&#39;</span><span class="p">][</span><span class="n">s2</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="PyPath.source_stats"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.source_stats">[docs]</a>    <span class="k">def</span> <span class="nf">source_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources_overlap</span><span class="p">()</span>
        <span class="n">degrees</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
        <span class="n">bwness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">betweenness</span><span class="p">()</span>
        <span class="n">ebwness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">edge_betweenness</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;single&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">pass</span></div>

<div class="viewcode-block" id="PyPath.source_diagram"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.source_diagram">[docs]</a>    <span class="k">def</span> <span class="nf">source_diagram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">outf</span> <span class="o">=</span> <span class="n">outf</span> <span class="k">if</span> <span class="n">outf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span>
                                                          <span class="s1">&#39;databases.pdf&#39;</span><span class="p">)</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources_overlap</span><span class="p">(</span><span class="n">diagonal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">sources</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">overlaps</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;single&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">]):</span>
            <span class="n">sources</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;single&#39;</span><span class="p">][</span><span class="s1">&#39;edges&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">],</span> <span class="kc">None</span><span class="p">)))</span>

        <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;overlap&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">]):</span>
            <span class="n">overlaps</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;overlap&#39;</span><span class="p">][</span><span class="s1">&#39;edges&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">])}</span>

        <span class="n">diagram</span> <span class="o">=</span> <span class="n">bdrawing</span><span class="o">.</span><span class="n">InterSet</span><span class="p">(</span><span class="n">sources</span><span class="p">,</span> <span class="n">overlaps</span><span class="p">,</span> <span class="n">outf</span><span class="o">=</span><span class="n">outf</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">diagram</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.get_dirs_signs"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.get_dirs_signs">[docs]</a>    <span class="k">def</span> <span class="nf">get_dirs_signs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">dbs</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="n">network_resources</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
                <span class="n">network_resources</span><span class="o">.</span><span class="n">interaction_htp</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
                <span class="n">network_resources</span><span class="o">.</span><span class="n">pathway</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
                <span class="n">network_resources</span><span class="o">.</span><span class="n">transcription</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">]:</span>

            <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="n">dbs</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">db</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">bool</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">is_directed</span><span class="p">),</span> <span class="nb">bool</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">sign</span><span class="p">)]</span>

        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="PyPath.basic_stats"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.basic_stats">[docs]</a>    <span class="k">def</span> <span class="nf">basic_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">latex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">latex_hdr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                    <span class="n">font</span><span class="o">=</span><span class="s1">&#39;HelveticaNeueLTStd-LtCn&#39;</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">header_format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">row_order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">by_category</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">use_cats</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">],</span> <span class="n">urls</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">annots</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns basic numbers about the network resources, e.g. edge and</span>
<span class="sd">        node counts.</span>

<span class="sd">        latex</span>
<span class="sd">            Return table in a LaTeX document. This can be compiled by</span>
<span class="sd">            PDFLaTeX:</span>
<span class="sd">            latex stats.tex</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">url_strip</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;SPIKE&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="s1">&#39;PDZbase&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="s1">&#39;DEPOD&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="s1">&#39;LMPID&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s1">&#39;DIP&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="s1">&#39;MPPI&#39;</span><span class="p">:</span> <span class="mi">5</span>
        <span class="p">}</span>
        <span class="n">outf</span> <span class="o">=</span> <span class="n">fname</span> <span class="k">if</span> <span class="n">fname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="s1">&#39;results&#39;</span><span class="p">,</span>
            <span class="s1">&#39;databases-</span><span class="si">%s</span><span class="s1">.tex&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span> <span class="k">if</span> <span class="n">latex</span> <span class="k">else</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="s1">&#39;results&#39;</span><span class="p">,</span> <span class="s1">&#39;databases-</span><span class="si">%s</span><span class="s1">.tsv&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources_overlap</span><span class="p">()</span>
        <span class="n">dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dirs_signs</span><span class="p">()</span>
        <span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Database&#39;</span><span class="p">,</span> <span class="s1">&#39;Nodes&#39;</span><span class="p">,</span> <span class="s1">&#39;Edges&#39;</span><span class="p">,</span> <span class="s1">&#39;Directions&#39;</span><span class="p">,</span> <span class="s1">&#39;Signs&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">urls</span><span class="p">:</span>
            <span class="n">header</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;URL&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">annots</span><span class="p">:</span>
            <span class="n">header</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Annotations&#39;</span><span class="p">)</span>

        <span class="n">header</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Notes&#39;</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">header</span><span class="p">]</span>

        <span class="n">desc</span> <span class="o">=</span> <span class="n">descriptions</span><span class="o">.</span><span class="n">descriptions</span>

        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;single&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">desc</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">desc</span> <span class="k">else</span> <span class="n">desc</span><span class="p">[</span>
                <span class="s1">&#39;HPRD&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s1">&#39;HPRD-phos&#39;</span> <span class="k">else</span> <span class="n">desc</span><span class="p">[</span>
                <span class="s1">&#39;PhosphoSite&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s1">&#39;PhosphoSite_noref&#39;</span> <span class="k">else</span> <span class="p">{}</span>
            <span class="n">annot</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;annot&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;annot&#39;</span> <span class="ow">in</span> <span class="n">d</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
            <span class="n">recom</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;recommend&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;recommend&#39;</span> <span class="ow">in</span> <span class="n">d</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;urls&#39;</span><span class="p">][</span><span class="s1">&#39;webpages&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> \
                <span class="k">if</span> <span class="s1">&#39;urls&#39;</span> <span class="ow">in</span> <span class="n">d</span> \
                <span class="ow">and</span> <span class="s1">&#39;webpages&#39;</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;urls&#39;</span><span class="p">]</span> \
                <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;urls&#39;</span><span class="p">][</span><span class="s1">&#39;webpages&#39;</span><span class="p">])</span> \
                <span class="k">else</span> <span class="s1">&#39;&#39;</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
                <span class="n">_url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[:(</span><span class="mi">3</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">url_strip</span> <span class="k">else</span> <span class="n">url_strip</span><span class="p">[</span>
                    <span class="n">s</span><span class="p">])]</span>
                <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_url</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_url</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">url</span> <span class="o">+=</span> <span class="sa">r</span><span class="s1">&#39;/\-&#39;</span>
                    <span class="n">url</span> <span class="o">+=</span> <span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_url</span><span class="p">[</span><span class="mi">3</span><span class="p">:])</span>

            <span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\textasciitilde &#39;</span><span class="p">)</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">s</span><span class="p">,</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;single&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">],</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;single&#39;</span><span class="p">][</span><span class="s1">&#39;edges&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">],</span>
                <span class="nb">int</span><span class="p">(</span><span class="n">dirs</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">dirs</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">dirs</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">dirs</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
            <span class="p">]</span>

            <span class="k">if</span> <span class="n">urls</span><span class="p">:</span>
                <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">annots</span><span class="p">:</span>
                <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">annot</span><span class="p">)</span>

            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recom</span><span class="p">)</span>
            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">latex</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">out</span><span class="p">])</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">outf</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">:: Output written to file `</span><span class="si">%s</span><span class="s1">`</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">outf</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">cats</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">:</span> <span class="n">e1</span> <span class="o">|</span> <span class="n">e2</span><span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span>
                    <span class="p">[])))</span> <span class="k">if</span> <span class="n">by_category</span> <span class="k">else</span> <span class="p">[]</span>
            <span class="n">cats</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">cats</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">use_cats</span><span class="p">)</span>
            <span class="n">use_cats</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cats</span><span class="p">,</span> <span class="n">use_cats</span><span class="p">))</span>
            <span class="n">out</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span> <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">by_category</span><span class="p">:</span>
                <span class="n">row_order</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">row_order</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">use_cats</span><span class="p">:</span>
                    <span class="n">row_order</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">db_categories</span><span class="o">.</span><span class="n">catnames</span><span class="p">[</span><span class="n">cat</span><span class="p">],</span> <span class="s1">&#39;subtitle&#39;</span><span class="p">))</span>
                    <span class="n">row_order</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                        <span class="nb">sorted</span><span class="p">(</span>
                            <span class="nb">filter</span><span class="p">(</span>
                                <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span>
                                    <span class="nb">list</span><span class="p">(</span>
                                        <span class="n">db_categories</span><span class="o">.</span><span class="n">get_categories</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                                    <span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">cat</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">sources</span>
                            <span class="p">),</span>
                            <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                        <span class="p">)</span>
                    <span class="p">)</span>

            <span class="n">texnewline</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">_latex_tab</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span><span class="si">%s</span>
<span class="s2">                    \begin</span><span class="si">{tabularx}</span><span class="s2">{0.95\textwidth}{</span><span class="si">%s</span><span class="s2">}</span>
<span class="s2">                    \toprule</span>
<span class="s2">                        </span><span class="si">%s</span>
<span class="s2">                    \midrule</span>
<span class="s2">                        </span><span class="si">%s</span>
<span class="s2">                    \bottomrule</span>
<span class="s2">                    \end</span><span class="si">{tabularx}%s</span><span class="s2">&quot;&quot;&quot;</span>
            <span class="n">_latex_hdr</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;\documentclass[a4paper,</span><span class="si">%u</span><span class="s2">pt]</span><span class="si">{extarticle}</span>
<span class="s2">                    \usepackage</span><span class="si">{fontspec}</span>
<span class="s2">                    \usepackage</span><span class="si">{xunicode}</span>
<span class="s2">                    \usepackage</span><span class="si">{polyglossia}</span>
<span class="s2">                    \setdefaultlanguage</span><span class="si">{english}</span>
<span class="s2">                    \usepackage</span><span class="si">{xltxtra}</span>
<span class="s2">                    \usepackage</span><span class="si">{microtype}</span>
<span class="s2">                    \usepackage[margin=5pt,portrait,paperwidth=23cm,paperheight=30cm]</span><span class="si">{geometry}</span>
<span class="s2">                    \usepackage</span><span class="si">{amsmath}</span>
<span class="s2">                    \usepackage</span><span class="si">{amssymb}</span>
<span class="s2">                    \usepackage</span><span class="si">{textcomp}</span>
<span class="s2">                    \usepackage[usenames,dvipsnames,svgnames,table]</span><span class="si">{xcolor}</span>
<span class="s2">                    \usepackage</span><span class="si">{color}</span>
<span class="s2">                    \usepackage</span><span class="si">{booktabs}</span>
<span class="s2">                    \usepackage</span><span class="si">{tabularx}</span>
<span class="s2">                    \setmainfont{</span><span class="si">%s</span><span class="s2">}</span>
<span class="s2">                    \definecolor</span><span class="si">{grey875}{gray}{0.125}</span>
<span class="s2">                    \begin</span><span class="si">{document}</span>
<span class="s2">                    \color</span><span class="si">{grey875}</span>
<span class="s2">                    \thispagestyle</span><span class="si">{empty}</span>
<span class="s2">                    \vfill</span>
<span class="s2">                &quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span> <span class="k">if</span> <span class="n">latex_hdr</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
            <span class="n">_latex_end</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    \end</span><span class="si">{document}</span>
<span class="s2">                &quot;&quot;&quot;</span> <span class="k">if</span> <span class="n">latex_hdr</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>

            <span class="n">_hdr_row</span> <span class="o">=</span> <span class="s1">&#39; &amp; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="p">[</span><span class="n">header_format</span> <span class="o">%</span> <span class="n">h</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\%&#39;</span><span class="p">)</span>
                 <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">header</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\\\</span><span class="s1">&#39;</span>
            <span class="n">formatter</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">locale</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">grouping</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> \
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> \
                <span class="k">else</span> <span class="n">locale</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">grouping</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> \
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> \
                <span class="k">else</span> <span class="n">x</span>
            <span class="n">intfloat</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">_rows</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row_order</span><span class="p">):</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;subtitle&#39;</span><span class="p">:</span>
                    <span class="n">row</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
                        <span class="sa">r</span><span class="s1">&#39;\midrule&#39;</span>
                        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\multicolumn{</span><span class="si">%u</span><span class="s1">}</span><span class="si">{l}</span><span class="s1">{</span><span class="si">%s</span><span class="s1">}</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="o">%</span>
                        <span class="p">(</span><span class="mi">6</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">annots</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">urls</span><span class="p">),</span> <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="sa">r</span><span class="s1">&#39;\midrule&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span>
                    <span class="p">])</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">out</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\bigstar$&#39;</span> <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
                    <span class="n">out</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\bigstar$&#39;</span> <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
                    <span class="n">k0</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="sa">r</span><span class="s1">&#39;PhosphoSite\textsubscript</span><span class="si">{noref}</span><span class="s1">&#39;</span>
                        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;PhosphoSite_noref&#39;</span>
                        <span class="k">else</span> <span class="n">k</span>
                    <span class="p">)</span>
                    <span class="n">row</span> <span class="o">=</span> <span class="s1">&#39; &amp; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">k0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span>
                        <span class="n">xx</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\_&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span>
                        <span class="s1">&#39;</span><span class="si">{:,}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span> <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">out</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\\\\n</span><span class="s1">&#39;</span>

                <span class="n">_rows</span> <span class="o">+=</span> <span class="n">row</span>

            <span class="n">_latex_tab</span> <span class="o">=</span> <span class="n">_latex_tab</span> <span class="o">%</span> \
                <span class="p">(</span>
                    <span class="n">_latex_hdr</span><span class="p">,</span>
                    <span class="s1">&#39;r&#39;</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                    <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;p</span><span class="si">{3.0cm}</span><span class="s1">&lt;{\raggedright}&#39;</span> <span class="k">if</span> <span class="n">urls</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span>
                    <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;p</span><span class="si">{2.7cm}</span><span class="s1">&lt;{\raggedright}&#39;</span> <span class="k">if</span> <span class="n">annots</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span>
                    <span class="sa">r</span><span class="s1">&#39;X&lt;{\raggedright}&#39;</span><span class="p">,</span>
                    <span class="n">_hdr_row</span><span class="p">,</span>
                    <span class="n">_rows</span><span class="p">,</span>
                    <span class="n">_latex_end</span>
                <span class="p">)</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">outf</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">_latex_tab</span><span class="p">)</span>

            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">:: Output written to file `</span><span class="si">%s</span><span class="s1">`</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">outf</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></div>

    <span class="c1"># XXX: is this used? `PlotParam` is not defined in the whole package.</span>
    <span class="c1">#      Does not work.</span>
<div class="viewcode-block" id="PyPath.source_network"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.source_network">[docs]</a>    <span class="k">def</span> <span class="nf">source_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s1">&#39;HelveticaNeueLTStd&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        For EMBL branding, use Helvetica Neue Linotype Standard light</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources_overlap</span><span class="p">()</span>
        <span class="n">tupleListNodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tupleListEdges</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">dbs</span><span class="p">,</span> <span class="n">overlap</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;overlap&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">]):</span>

            <span class="k">if</span> <span class="n">overlap</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">tupleListNodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dbs</span><span class="p">))</span> <span class="o">+</span> <span class="p">[</span><span class="n">overlap</span><span class="p">]))</span>

        <span class="k">for</span> <span class="n">dbs</span><span class="p">,</span> <span class="n">overlap</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;overlap&#39;</span><span class="p">][</span><span class="s1">&#39;edges&#39;</span><span class="p">]):</span>

            <span class="k">if</span> <span class="n">overlap</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">tupleListEdges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dbs</span><span class="p">))</span> <span class="o">+</span> <span class="p">[</span><span class="n">overlap</span><span class="p">]))</span>

        <span class="n">tupleListNodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">tupleListNodes</span><span class="p">))</span>
        <span class="n">tupleListEdges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">tupleListEdges</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sourceNetNodes</span> <span class="o">=</span> <span class="n">igraph</span><span class="o">.</span><span class="n">Graph</span><span class="o">.</span><span class="n">TupleList</span><span class="p">(</span>
            <span class="n">tupleListNodes</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sourceNetEdges</span> <span class="o">=</span> <span class="n">igraph</span><span class="o">.</span><span class="n">Graph</span><span class="o">.</span><span class="n">TupleList</span><span class="p">(</span>
            <span class="n">tupleListEdges</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># edge widths proportional to overlaps in unique nodes/edges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sourceNetNodes</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;edge_width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;overlap&#39;</span><span class="p">][</span><span class="s1">&#39;nodes&#39;</span><span class="p">][(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sourceNetNodes</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sourceNetNodes</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])],</span> <span class="mi">10</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sourceNetNodes</span><span class="o">.</span><span class="n">es</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sourceNetEdges</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;edge_width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;overlap&#39;</span><span class="p">][</span><span class="s1">&#39;edges&#39;</span><span class="p">][(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sourceNetEdges</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sourceNetEdges</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])],</span> <span class="mi">10</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sourceNetEdges</span><span class="o">.</span><span class="n">es</span>
        <span class="p">]</span>
        <span class="c1"># node sizes proportional to number of nodes/edges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sourceNetNodes</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;vertex_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_dict</span><span class="p">[</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]),</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sourceNetNodes</span><span class="o">.</span><span class="n">vs</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sourceNetEdges</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;vertex_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_dict</span><span class="p">[</span><span class="s1">&#39;edges&#39;</span><span class="p">][</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]),</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sourceNetEdges</span><span class="o">.</span><span class="n">vs</span>
        <span class="p">]</span>
        <span class="c1"># numbers in vertex labels:</span>
        <span class="n">v</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (</span><span class="si">%u</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_dict</span><span class="p">[</span><span class="s1">&#39;nodes&#39;</span><span class="p">][</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]])</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sourceNetNodes</span><span class="o">.</span><span class="n">vs</span>
        <span class="p">]</span>
        <span class="n">v</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (</span><span class="si">%u</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db_dict</span><span class="p">[</span><span class="s1">&#39;edges&#39;</span><span class="p">][</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]])</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sourceNetEdges</span><span class="o">.</span><span class="n">vs</span>
        <span class="p">]</span>
        <span class="n">plotParamNodes</span> <span class="o">=</span> <span class="n">PlotParam</span><span class="p">(</span> <span class="c1"># XXX: global name PlotParam is not defined anywhere</span>
            <span class="n">graph</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sourceNetNodes</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;db_net_nodes.pdf&#39;</span><span class="p">,</span>
            <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;circular&#39;</span><span class="p">,</span>
            <span class="n">vertex_label_color</span><span class="o">=</span><span class="s1">&#39;#4d4d4d&#39;</span><span class="p">,</span>
            <span class="n">vertex_color</span><span class="o">=</span><span class="s1">&#39;#73b360&#39;</span><span class="p">,</span>
            <span class="n">edge_color</span><span class="o">=</span><span class="s1">&#39;#006666&#39;</span><span class="p">,</span>
            <span class="n">vertex_fill_alpha</span><span class="o">=</span><span class="s1">&#39;ff&#39;</span><span class="p">,</span>
            <span class="n">vertex_label_font</span><span class="o">=</span><span class="n">font</span><span class="p">,</span>
            <span class="n">vertex_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sourceNetNodes</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;vertex_size&#39;</span><span class="p">],</span>
            <span class="n">bbox</span><span class="o">=</span><span class="n">igraph</span><span class="o">.</span><span class="n">drawing</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">BoundingBox</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">994</span><span class="p">,</span> <span class="mi">994</span><span class="p">),</span>
            <span class="n">dimensions</span><span class="o">=</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">1024</span><span class="p">))</span>
        <span class="n">plotParamEdges</span> <span class="o">=</span> <span class="n">PlotParam</span><span class="p">(</span>
            <span class="n">graph</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sourceNetEdges</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;db_net_nodes.pdf&#39;</span><span class="p">,</span>
            <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;circular&#39;</span><span class="p">,</span>
            <span class="n">vertex_label_color</span><span class="o">=</span><span class="s1">&#39;#4d4d4d&#39;</span><span class="p">,</span>
            <span class="n">vertex_color</span><span class="o">=</span><span class="s1">&#39;#73b360&#39;</span><span class="p">,</span>
            <span class="n">edge_color</span><span class="o">=</span><span class="s1">&#39;#006666&#39;</span><span class="p">,</span>
            <span class="n">vertex_fill_alpha</span><span class="o">=</span><span class="s1">&#39;ff&#39;</span><span class="p">,</span>
            <span class="n">vertex_label_font</span><span class="o">=</span><span class="n">font</span><span class="p">,</span>
            <span class="n">vertex_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sourceNetEdges</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;vertex_size&#39;</span><span class="p">],</span>
            <span class="n">bbox</span><span class="o">=</span><span class="n">igraph</span><span class="o">.</span><span class="n">drawing</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">BoundingBox</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">994</span><span class="p">,</span> <span class="mi">994</span><span class="p">),</span>
            <span class="n">dimensions</span><span class="o">=</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">1024</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">plotParamNodes</span><span class="p">,</span> <span class="n">plotParamEdges</span></div>

    <span class="c1">#</span>
    <span class="c1"># Load data from GDSC</span>
    <span class="c1">#</span>
    <span class="c1"># XXX: global name &#39;gdsc&#39; is not defined (nor here or the whole package)</span>
<div class="viewcode-block" id="PyPath.load_mutations"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_mutations">[docs]</a>    <span class="k">def</span> <span class="nf">load_mutations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gdsc_datadir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">mutation_file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mutations are listed in vertex attributes. Mutation() objects</span>
<span class="sd">        offers methods to identify residues and look up in Ptm(), Motif()</span>
<span class="sd">        and Domain() objects, to check if those residues are</span>
<span class="sd">        modified, or are in some short motif or domain.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mutation_samples</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">attributes</span> <span class="o">=</span> <span class="n">attributes</span> <span class="k">if</span> <span class="n">attributes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[</span>
            <span class="s1">&#39;Consequence&#39;</span><span class="p">,</span> <span class="s1">&#39;COSMIC_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;SAMPLE_NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;Tissue_TCGA&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ZYGOSITY&#39;</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">gdsc</span><span class="o">.</span><span class="n">GDSC</span><span class="p">(</span><span class="n">datadir</span><span class="o">=</span><span class="n">gdsc_datadir</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">read_mutations</span><span class="p">(</span><span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span><span class="p">,</span> <span class="n">infile</span><span class="o">=</span><span class="n">mutation_file</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;mut&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;mut&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">]</span>

        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="s1">&#39;Processing mutations&#39;</span><span class="p">,</span> <span class="mi">33</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">uniprot</span><span class="p">,</span> <span class="n">muts</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">uniprot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">:</span>

                <span class="k">for</span> <span class="n">mu</span> <span class="ow">in</span> <span class="n">muts</span><span class="p">:</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">uniprot</span><span class="p">]][</span><span class="s1">&#39;mut&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">uniprot</span><span class="p">]][</span><span class="s1">&#39;mut&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

                    <span class="k">if</span> <span class="n">mu</span><span class="o">.</span><span class="n">sample</span> <span class="ow">not</span> <span class="ow">in</span> \
                            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">uniprot</span><span class="p">]][</span><span class="s1">&#39;mut&#39;</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">uniprot</span><span class="p">]][</span><span class="s1">&#39;mut&#39;</span><span class="p">]</span>\
                            <span class="p">[</span><span class="n">mu</span><span class="o">.</span><span class="n">sample</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">uniprot</span><span class="p">]][</span><span class="s1">&#39;mut&#39;</span><span class="p">]</span>\
                        <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mu</span><span class="o">.</span><span class="n">sample</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">mu</span><span class="o">.</span><span class="n">sample</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutation_samples</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">mutation_samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">mu</span><span class="o">.</span><span class="n">sample</span><span class="p">))</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="PyPath.load_expression"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_expression">[docs]</a>    <span class="k">def</span> <span class="nf">load_expression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Expression data can be loaded into vertex attributes,</span>
<span class="sd">        or into a pandas DataFrame – the latter offers faster</span>
<span class="sd">        ways to process and use these huge matrices.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">gdsc</span><span class="o">.</span><span class="n">read_transcriptomics</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">&#39;exp&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">]</span>

        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="s1">&#39;Processing transcriptomics&#39;</span><span class="p">,</span> <span class="mi">33</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">array</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">gsymb</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

                <span class="k">for</span> <span class="n">up</span> <span class="ow">in</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">gsymb</span><span class="p">,</span> <span class="s1">&#39;genesymbol&#39;</span><span class="p">,</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">):</span>

                    <span class="k">if</span> <span class="n">up</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">:</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">up</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">gsymb</span><span class="p">]</span>

                <span class="k">del</span> <span class="n">data</span><span class="p">[</span><span class="n">gsymb</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">exp</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">gsymb</span><span class="p">,</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
                <span class="n">uniprots</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">gsymb</span><span class="p">,</span> <span class="s1">&#39;genesymbol&#39;</span><span class="p">,</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">up</span> <span class="ow">in</span> <span class="n">uniprots</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">up</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">up</span><span class="p">]][</span><span class="s1">&#39;exp&#39;</span><span class="p">]</span> <span class="o">=</span> \
                            <span class="nb">dict</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="o">+</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">up</span><span class="p">]][</span><span class="s1">&#39;exp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.edges_expression"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.edges_expression">[docs]</a>    <span class="k">def</span> <span class="nf">edges_expression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Executes function `func` for each pairs of connected proteins in the</span>
<span class="sd">        network, for every expression dataset. By default, `func` simply</span>
<span class="sd">        gives the product the (normalized) expression values.</span>

<span class="sd">        func : callable</span>
<span class="sd">            Function to handle 2 vectors (pandas.Series() objects), should</span>
<span class="sd">            return one vector of the same length.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vindex</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_prod</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exp</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[])</span>
        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">(),</span>
                       <span class="s1">&#39;Weigh edges based on protein expression&#39;</span><span class="p">,</span> <span class="mi">37</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>
            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge_names</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">exp_prod</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exp</span><span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                              <span class="bp">self</span><span class="o">.</span><span class="n">exp</span><span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">exp_prod</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span>
                                                       <span class="bp">self</span><span class="o">.</span><span class="n">exp_prod</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span></div>

    <span class="c1">#</span>
    <span class="c1"># Find and remove edges where mutations disrupt PTMs</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="PyPath.mutated_edges"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.mutated_edges">[docs]</a>    <span class="k">def</span> <span class="nf">mutated_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compares the mutated residues and the modified residues in PTMs.</span>
<span class="sd">        Interactions are marked as mutated if the target residue in the</span>
<span class="sd">        underlying PTM is mutated.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">toDel</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">disrupted</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">]:</span>

                <span class="k">for</span> <span class="n">smpl</span><span class="p">,</span> <span class="n">mut</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;mut&#39;</span><span class="p">]):</span>

                    <span class="k">if</span> <span class="n">smpl</span> <span class="o">==</span> <span class="n">sample</span><span class="p">:</span>

                        <span class="k">for</span> <span class="n">ptm</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]:</span>

                            <span class="k">if</span> <span class="n">mut</span><span class="o">.</span><span class="n">original</span> <span class="o">==</span> <span class="n">ptm</span><span class="o">.</span><span class="n">ptm</span><span class="o">.</span><span class="n">residue</span><span class="p">:</span>
                                <span class="n">toDel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                                <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">index</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">disrupted</span><span class="p">:</span>
                                    <span class="n">disrupted</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> \
                                        <span class="p">{</span><span class="s1">&#39;ptms&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;ptm&#39;</span><span class="p">]),</span> <span class="s1">&#39;disr&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

                                <span class="n">disrupted</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;disr&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">toDel</span><span class="p">,</span> <span class="n">disrupted</span></div>

<div class="viewcode-block" id="PyPath.edges_between"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.edges_between">[docs]</a>    <span class="k">def</span> <span class="nf">edges_between</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">,</span> <span class="n">directed</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects edges between two groups of vertex IDs.</span>
<span class="sd">        Returns set of edge IDs.</span>

<span class="sd">        :param set group1,group2:</span>
<span class="sd">            List, set or tuple of vertex IDs.</span>
<span class="sd">        :param bool directed:</span>
<span class="sd">            Only edges with direction `group1 -&gt; group2` selected.</span>
<span class="sd">        :param bool strict:</span>
<span class="sd">            Edges with no direction information still selected even if</span>
<span class="sd">            ``directed`` is `False`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">edges</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">source</span> <span class="ow">in</span> <span class="n">group1</span> <span class="ow">and</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span> <span class="ow">in</span> <span class="n">group2</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">target</span> <span class="ow">in</span> <span class="n">group1</span> <span class="ow">and</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span> <span class="ow">in</span> <span class="n">group2</span><span class="p">)</span>
            <span class="p">):</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">directed</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">is_directed</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">strict</span><span class="p">):</span>

                    <span class="n">edges</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                    <span class="k">continue</span>

                <span class="n">up1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
                <span class="n">up2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>

                <span class="k">if</span> <span class="p">(</span>
                    <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">source</span> <span class="ow">in</span> <span class="n">group1</span> <span class="ow">and</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_dir</span><span class="p">((</span><span class="n">up1</span><span class="p">,</span> <span class="n">up2</span><span class="p">)))</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">target</span> <span class="ow">in</span> <span class="n">group1</span> <span class="ow">and</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_dir</span><span class="p">((</span><span class="n">up2</span><span class="p">,</span> <span class="n">up1</span><span class="p">)))</span>
                <span class="p">):</span>

                    <span class="n">edges</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">edges</span></div>

<div class="viewcode-block" id="PyPath.label"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.label">[docs]</a>    <span class="k">def</span> <span class="nf">label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">what</span> <span class="o">=</span> <span class="s1">&#39;vertices&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a boolean attribute ``label`` True for the</span>
<span class="sd">        vertex or edge IDs in the set ``idx``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">seq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span> <span class="k">if</span> <span class="n">what</span> <span class="o">==</span> <span class="s1">&#39;edges&#39;</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span>
        <span class="n">cnt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">()</span> <span class="k">if</span> <span class="n">what</span> <span class="o">==</span> <span class="s1">&#39;edges&#39;</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()</span>

        <span class="n">seq</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">cnt</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">:</span>

            <span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="PyPath.label_vertices"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.label_vertices">[docs]</a>    <span class="k">def</span> <span class="nf">label_vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">vertices</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a boolean vertex attribute ``label`` True for the</span>
<span class="sd">        vertex IDs in the set ``vertices``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">vertices</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.label_edges"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.label_edges">[docs]</a>    <span class="k">def</span> <span class="nf">label_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">edges</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a boolean edge attribute ``label`` True for the</span>
<span class="sd">        edge IDs in the set ``edges``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="s1">&#39;edges&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.select_by_go_all"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.select_by_go_all">[docs]</a>    <span class="k">def</span> <span class="nf">select_by_go_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">go_terms</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects the nodes annotated by all GO terms in ``go_terms``.</span>

<span class="sd">        Returns set of vertex IDs.</span>

<span class="sd">        :param list go_terms:</span>
<span class="sd">            List, set or tuple of GO terms.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">annot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_go</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">annot</span><span class="o">.</span><span class="n">select_by_all</span><span class="p">(</span>
            <span class="n">terms</span> <span class="o">=</span> <span class="n">go_terms</span><span class="p">,</span>
            <span class="n">uniprots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
        <span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_select_by_go</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">go_terms</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the vertex IDs of all vertices annotated with any of the</span>
<span class="sd">        Gene Ontology terms or their descendants.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">annot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_go</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">annot</span><span class="o">.</span><span class="n">select_by_term</span><span class="p">(</span>
            <span class="n">terms</span> <span class="o">=</span> <span class="n">go_terms</span><span class="p">,</span>
            <span class="n">uniprots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
        <span class="p">)</span>

<div class="viewcode-block" id="PyPath.select_by_go"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.select_by_go">[docs]</a>    <span class="k">def</span> <span class="nf">select_by_go</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">go_terms</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the vertex IDs of all vertices annotated with any</span>
<span class="sd">        Gene Ontology terms or their descendants, or evaluates string</span>
<span class="sd">        expression (see ``select_by_go_expr``).</span>

<span class="sd">        :param str,set go_terms:</span>
<span class="sd">            A single GO term, a set of GO terms or an expression with</span>
<span class="sd">            GO terms.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">annot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_go</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">annot</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
            <span class="n">terms</span> <span class="o">=</span> <span class="n">go_terms</span><span class="p">,</span>
            <span class="n">uniprots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.select_by_go_expr"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.select_by_go_expr">[docs]</a>    <span class="k">def</span> <span class="nf">select_by_go_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">go_expr</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects vertices based on an expression of Gene Ontology terms.</span>
<span class="sd">        Operator precedence not considered, please use parentheses.</span>

<span class="sd">        :param str go_expr:</span>
<span class="sd">            An expression of Gene Ontology terms. E.g.</span>
<span class="sd">            ``&#39;(GO:0005576 and not GO:0070062) or GO:0005887&#39;``. Parentheses</span>
<span class="sd">            and operators ``and``, ``or`` and ``not`` can be used.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">annot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_go</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">annot</span><span class="o">.</span><span class="n">select_by_expr</span><span class="p">(</span>
            <span class="n">expr</span> <span class="o">=</span> <span class="n">go_expr</span><span class="p">,</span>
            <span class="n">uniprots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.label_by_go"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.label_by_go">[docs]</a>    <span class="k">def</span> <span class="nf">label_by_go</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">go_terms</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;ANY&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assigns a boolean vertex attribute to nodes which tells whether</span>
<span class="sd">        the node is annotated by all or any of the GO terms.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">_method</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">select_by_go_all</span>
                <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;ALL&#39;</span>
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_by_go</span>
        <span class="p">)</span>

        <span class="n">vids</span> <span class="o">=</span> <span class="n">_method</span><span class="p">(</span><span class="n">go_terms</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_vertices</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">vids</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.network_by_go"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.network_by_go">[docs]</a>    <span class="k">def</span> <span class="nf">network_by_go</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">node_categories</span><span class="p">,</span>
            <span class="n">network_sources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">include</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">exclude</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">directed</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">keep_undirected</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">prefix</span>  <span class="o">=</span> <span class="s1">&#39;GO&#39;</span><span class="p">,</span>
            <span class="n">delete</span>  <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">copy</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">vertex_attrs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">edge_attrs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates or filters a network based on Gene Ontology annotations.</span>

<span class="sd">        :param dict node_categories:</span>
<span class="sd">            A dict with custom category labels as keys and expressions of</span>
<span class="sd">            GO terms as values. E.g.</span>
<span class="sd">            ``{&#39;extracell&#39;: &#39;GO:0005576 and not GO:0070062&#39;,</span>
<span class="sd">               &#39;plasmamem&#39;: &#39;GO:0005887&#39;}``.</span>
<span class="sd">        :param dict network_sources:</span>
<span class="sd">            A dict with anything as keys and network input format definintions</span>
<span class="sd">            (``input_formats.NetworkInput`` instances) as values.</span>
<span class="sd">        :param list include:</span>
<span class="sd">            A list of tuples of category label pairs. By default we keep all</span>
<span class="sd">            edges connecting proteins annotated with any of the defined</span>
<span class="sd">            categories. If ``include`` is defined then only edges between</span>
<span class="sd">            category pairs defined here will be kept and all others deleted.</span>
<span class="sd">        :param list exclude:</span>
<span class="sd">            Similarly to include, all edges will be kept but the ones listed</span>
<span class="sd">            in ``exclude`` will be deleted.</span>
<span class="sd">        :param bool directed:</span>
<span class="sd">            If True ``include`` and ``exclude`` relations will be processed</span>
<span class="sd">            with directed (source, target) else direction won&#39;t be considered.</span>
<span class="sd">        :param bool keep_undirected:</span>
<span class="sd">            If True the interactions without direction information will be</span>
<span class="sd">            kept even if ``directed`` is True. Passed to ``edges_between``</span>
<span class="sd">            as ``strict`` argument.</span>
<span class="sd">        :param str prefix:</span>
<span class="sd">            Prefix for all vertex and edge attributes created in this</span>
<span class="sd">            operation. E.g. if you have a category label &#39;bar&#39; and prefix</span>
<span class="sd">            is &#39;foo&#39; then you will have a new vertex attribute &#39;foo__bar&#39;.</span>
<span class="sd">        :param bool delete:</span>
<span class="sd">            Delete the vertices and edges which don&#39;t belong to any of the</span>
<span class="sd">            categories.</span>
<span class="sd">        :param bool copy:</span>
<span class="sd">            Return a copy of the entire ``PyPath`` object with the graph</span>
<span class="sd">            filtered by GO terms. By default the object is modified in place</span>
<span class="sd">            and ``None`` is returned.</span>
<span class="sd">        :param bool vertex_attrs:</span>
<span class="sd">            Create vertex attributes.</span>
<span class="sd">        :param bool edge_attrs:</span>
<span class="sd">            Create edge attributes.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">network_sources</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">init_network</span><span class="p">(</span><span class="n">network_sources</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">load_omnipath</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>

            <span class="n">graph_original</span> <span class="o">=</span> <span class="n">copy_mod</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>

        <span class="n">vselections</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">label</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">select_by_go</span><span class="p">(</span><span class="n">definition</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">definition</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">node_categories</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">categories</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">vselections</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="n">eselections</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">categories</span><span class="p">,</span> <span class="n">categories</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">include</span> <span class="ow">and</span> <span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">include</span><span class="p">:</span>

                <span class="k">continue</span>

            <span class="k">elif</span> <span class="n">exclude</span> <span class="ow">and</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">:</span>

                <span class="k">continue</span>

            <span class="n">eselections</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges_between</span><span class="p">(</span>
                    <span class="n">vselections</span><span class="p">[</span><span class="n">label</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                    <span class="n">vselections</span><span class="p">[</span><span class="n">label</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
                    <span class="n">directed</span> <span class="o">=</span> <span class="n">directed</span><span class="p">,</span>
                    <span class="n">strict</span> <span class="o">=</span> <span class="n">keep_undirected</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">vertex_attrs</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">vertices</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">vselections</span><span class="p">):</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">label_vertices</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">__</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">label</span><span class="p">),</span> <span class="n">vertices</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">edge_attrs</span><span class="p">:</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">label1</span><span class="p">,</span> <span class="n">label2</span><span class="p">),</span> <span class="n">edges</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">eselections</span><span class="p">):</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">label_edges</span><span class="p">(</span>
                    <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">__</span><span class="si">%s</span><span class="s1">__</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">label1</span><span class="p">,</span> <span class="n">label2</span><span class="p">),</span>
                    <span class="n">edges</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">delete</span><span class="p">:</span>

            <span class="n">edges_to_delete</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">set</span><span class="p">(</span><span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">()))</span> <span class="o">-</span>
                <span class="nb">set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="n">eselections</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">delete_edges</span><span class="p">(</span><span class="n">edges_to_delete</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">delete_vertices</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">degree</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>

            <span class="n">pypath_new</span> <span class="o">=</span> <span class="n">PyPath</span><span class="p">(</span><span class="n">copy</span> <span class="o">=</span> <span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">graph_original</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">pypath_new</span></div>

<div class="viewcode-block" id="PyPath.load_ligand_receptor_network"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_ligand_receptor_network">[docs]</a>    <span class="k">def</span> <span class="nf">load_ligand_receptor_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lig_rec_resources</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">inference_from_go</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">sources</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">keep_undirected</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">keep_rec_rec</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">keep_lig_lig</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes a ligand-receptor network.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">sources</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            
            <span class="n">sources</span> <span class="o">=</span> <span class="n">network_resources</span><span class="o">.</span><span class="n">pathway</span>

        <span class="n">CC_EXTRACELL</span>    <span class="o">=</span> <span class="s1">&#39;GO:0005576&#39;</span> <span class="c1"># select all extracellular</span>
        <span class="n">CC_EXOSOME</span>      <span class="o">=</span> <span class="s1">&#39;GO:0070062&#39;</span> <span class="c1"># remove exosome localized proteins</span>
        <span class="n">CC_PLASMAMEM</span>    <span class="o">=</span> <span class="s1">&#39;GO:0005887&#39;</span> <span class="c1"># select plasma membrane proteins</span>
        <span class="n">MF_RECBINDING</span>   <span class="o">=</span> <span class="s1">&#39;GO:0005102&#39;</span> <span class="c1"># select ligands</span>
        <span class="n">MF_RECACTIVITY</span>  <span class="o">=</span> <span class="s1">&#39;GO:0038023&#39;</span> <span class="c1"># select receptors</span>
        <span class="n">MF_ECM_STRUCT</span>   <span class="o">=</span> <span class="s1">&#39;GO:0005201&#39;</span> <span class="c1"># select matrix structure proteins</span>
                                       <span class="c1"># e.g. collagene</span>
        <span class="n">MF_CATALYTIC</span>    <span class="o">=</span> <span class="s1">&#39;GO:0003824&#39;</span> <span class="c1"># select enzymes, e.g. MMPs</span>

        <span class="n">BP_SURF_REC_SIG</span> <span class="o">=</span> <span class="s1">&#39;GO:0007166&#39;</span> <span class="c1"># cell surface receptor signaling pw.</span>
        <span class="n">CC_ECM_COMP</span>     <span class="o">=</span> <span class="s1">&#39;GO:0044420&#39;</span> <span class="c1"># ECM component</span>


        <span class="k">if</span> <span class="n">inference_from_go</span><span class="p">:</span>

            <span class="n">go_desc</span> <span class="o">=</span> <span class="n">go_input</span><span class="o">.</span><span class="n">go_descendants_quickgo</span><span class="p">(</span><span class="n">aspects</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">init_network</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;go&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">go_annotate</span><span class="p">()</span>

            <span class="n">vids_extracell</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_by_go</span><span class="p">(</span><span class="n">CC_EXTRACELL</span><span class="p">,</span>   <span class="n">go_desc</span><span class="p">)</span>
            <span class="n">vids_exosome</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_by_go</span><span class="p">(</span><span class="n">CC_EXOSOME</span><span class="p">,</span>     <span class="n">go_desc</span><span class="p">)</span>
            <span class="c1">#vids_extracell   = vids_extracell - vids_exosome</span>
            <span class="n">vids_plasmamem</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_by_go</span><span class="p">(</span><span class="n">CC_PLASMAMEM</span><span class="p">,</span>   <span class="n">go_desc</span><span class="p">)</span>
            <span class="n">vids_recbinding</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_by_go</span><span class="p">(</span><span class="n">MF_RECBINDING</span><span class="p">,</span>  <span class="n">go_desc</span><span class="p">)</span>
            <span class="n">vids_recactivity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_by_go</span><span class="p">(</span><span class="n">MF_RECACTIVITY</span><span class="p">,</span> <span class="n">go_desc</span><span class="p">)</span>

            <span class="n">receptors</span> <span class="o">=</span> <span class="n">vids_plasmamem</span> <span class="o">&amp;</span> <span class="n">vids_recactivity</span>
            <span class="n">ligands</span>   <span class="o">=</span> <span class="n">vids_extracell</span> <span class="o">&amp;</span> <span class="n">vids_recbinding</span>

            <span class="n">ureceptors</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodNam</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">receptors</span><span class="p">)</span>
            <span class="n">uligands</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodNam</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ligands</span><span class="p">)</span>

            <span class="n">lig_with_interactions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="n">rec_with_interactions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="n">lig_rec_edges</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="n">lig_lig_edges</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="n">rec_rec_edges</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

            <span class="c1"># vertex attributes to mark ligands and receptors</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;GO_ligand&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())</span>
            <span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;GO_receptor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())</span>
            <span class="p">]</span>

            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

                <span class="c1"># set boolean vertex attributes</span>
                <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">source</span> <span class="ow">in</span> <span class="n">ligands</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;GO_ligand&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span> <span class="ow">in</span> <span class="n">ligands</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;GO_ligand&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">source</span> <span class="ow">in</span> <span class="n">receptors</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;GO_receptors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span> <span class="ow">in</span> <span class="n">receptors</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;GO_receptors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="c1"># set edge attributes and collect edges to keep</span>
                <span class="n">di</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span>

                <span class="n">srcs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
                    <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">di</span><span class="o">.</span><span class="n">src</span><span class="p">(</span><span class="n">keep_undirected</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">tgts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
                    <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">di</span><span class="o">.</span><span class="n">tgt</span><span class="p">(</span><span class="n">keep_undirected</span><span class="p">)</span>
                <span class="p">)</span>

                <span class="c1"># ligand-receptor interaction</span>
                <span class="k">if</span> <span class="n">srcs</span> <span class="o">&amp;</span> <span class="n">ligands</span> <span class="ow">and</span> <span class="n">tgts</span> <span class="o">&amp;</span> <span class="n">receptors</span><span class="p">:</span>
                    <span class="n">lig_rec_edges</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                    <span class="n">lig_with_interactions</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">srcs</span><span class="p">)</span>
                    <span class="n">rec_with_interactions</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">tgts</span><span class="p">)</span>
                    <span class="n">e</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;GO_lig_rec&#39;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="p">(</span>
                        <span class="n">di</span><span class="o">.</span><span class="n">straight</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">uligands</span> <span class="ow">and</span>
                        <span class="n">di</span><span class="o">.</span><span class="n">straight</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">ureceptors</span>
                    <span class="p">):</span>

                        <span class="n">di</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="n">di</span><span class="o">.</span><span class="n">straight</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;GO_lig_rec&#39;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="p">(</span>
                        <span class="n">di</span><span class="o">.</span><span class="n">reverse</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">uligands</span> <span class="ow">and</span>
                        <span class="n">di</span><span class="o">.</span><span class="n">reverse</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">ureceptors</span>
                    <span class="p">):</span>

                        <span class="n">di</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="n">di</span><span class="o">.</span><span class="n">reverse</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;GO_lig_rec&#39;</span><span class="p">)</span>

                <span class="c1"># ligand-ligand interaction</span>
                <span class="k">elif</span> <span class="n">keep_lig_lig</span> <span class="ow">and</span> <span class="n">srcs</span> <span class="o">&amp;</span> <span class="n">ligands</span> <span class="ow">and</span> <span class="n">tgts</span> <span class="o">&amp;</span> <span class="n">ligands</span><span class="p">:</span>
                    <span class="n">lig_lig_edges</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                    <span class="n">e</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;GO_lig_lig&#39;</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">di</span><span class="o">.</span><span class="n">sources</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>

                        <span class="k">if</span> <span class="n">d</span><span class="p">:</span>

                            <span class="n">d</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;GO_lig_lig&#39;</span><span class="p">)</span>

                <span class="c1"># receptor-receptor interaction</span>
                <span class="k">elif</span> <span class="n">keep_rec_rec</span> <span class="ow">and</span> <span class="n">srcs</span> <span class="o">&amp;</span> <span class="n">receptors</span> <span class="ow">and</span> <span class="n">tgts</span> <span class="o">&amp;</span> <span class="n">receptors</span><span class="p">:</span>
                    <span class="n">rec_rec_edges</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                    <span class="n">e</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;GO_rec_rec&#39;</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">di</span><span class="o">.</span><span class="n">sources</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>

                        <span class="k">if</span> <span class="n">d</span><span class="p">:</span>

                            <span class="n">d</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;GO_rec_rec&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">set_boolean_vattr</span><span class="p">(</span><span class="s1">&#39;ligand_go&#39;</span><span class="p">,</span>   <span class="n">lig_with_interactions</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_boolean_vattr</span><span class="p">(</span><span class="s1">&#39;receptor_go&#39;</span><span class="p">,</span> <span class="n">rec_with_interactions</span><span class="p">)</span>
            <span class="n">edges_to_delete</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">set</span><span class="p">(</span><span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">()))</span> <span class="o">-</span>
                <span class="nb">set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span>
                    <span class="n">lig_rec_edges</span><span class="p">,</span>
                    <span class="n">rec_rec_edges</span><span class="p">,</span>
                    <span class="n">lig_lig_edges</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">delete_edges</span><span class="p">(</span><span class="n">edges_to_delete</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">delete_vertices</span><span class="p">(</span>
                <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">degree</span><span class="p">())</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">d</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_sources</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">lig_rec_resources</span><span class="p">:</span>
            
            <span class="n">datasets</span> <span class="o">=</span> <span class="n">copy_mod</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">network_resources</span><span class="o">.</span><span class="n">ligand_receptor</span><span class="p">)</span>
            <span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;cellphonedb&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">networkinput</span><span class="o">.</span><span class="n">input_args</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;ligand_ligand&#39;</span><span class="p">:</span>     <span class="n">keep_lig_lig</span><span class="p">,</span>
                <span class="s1">&#39;receptor_receptor&#39;</span><span class="p">:</span> <span class="n">keep_rec_rec</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_resources</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.set_boolean_vattr"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.set_boolean_vattr">[docs]</a>    <span class="k">def</span> <span class="nf">set_boolean_vattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">vids</span><span class="p">,</span> <span class="n">negate</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">vids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">vids</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">negate</span><span class="p">:</span>
            <span class="n">vids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()))</span> <span class="o">-</span> <span class="n">vids</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="ow">in</span> <span class="n">vids</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())]</span></div>


<div class="viewcode-block" id="PyPath.go_annotate_graph"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.go_annotate_graph">[docs]</a>    <span class="k">def</span> <span class="nf">go_annotate_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aspects</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">)):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Annotates protein nodes with GO terms. In the ``go`` vertex</span>
<span class="sd">        attribute each node is annotated by a dict of sets where keys are</span>
<span class="sd">        one letter codes of GO aspects and values are sets of GO accessions.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">go</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">aspects</span> <span class="o">=</span> <span class="n">aspects</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.load_go"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_go">[docs]</a>    <span class="k">def</span> <span class="nf">load_go</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">organism</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a ``pypath.go.GOAnnotation`` object for one organism in the</span>
<span class="sd">        dict under ``go`` attribute.</span>

<span class="sd">        :param int organism:</span>
<span class="sd">            NCBI Taxonomy ID of the organism.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">organism</span> <span class="o">=</span> <span class="n">organism</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;go&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">go</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">go</span><span class="p">[</span><span class="n">organism</span><span class="p">]</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">GOAnnotation</span><span class="p">(</span><span class="n">organism</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.get_go"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.get_go">[docs]</a>    <span class="k">def</span> <span class="nf">get_go</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">organism</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the ``GOAnnotation`` object for the organism requested</span>
<span class="sd">        (or the default one).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">organism</span> <span class="o">=</span> <span class="n">organism</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;go&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">organism</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">go</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">load_go</span><span class="p">(</span><span class="n">organism</span> <span class="o">=</span> <span class="n">organism</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">go</span><span class="p">[</span><span class="n">organism</span><span class="p">]</span></div>

<div class="viewcode-block" id="PyPath.go_enrichment"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.go_enrichment">[docs]</a>    <span class="k">def</span> <span class="nf">go_enrichment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proteins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                      <span class="n">correction_method</span><span class="o">=</span><span class="s1">&#39;hommel&#39;</span><span class="p">,</span> <span class="n">all_proteins</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Does not work at the moment because cfisher module should be</span>
<span class="sd">        replaced with scipy.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;go&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">go</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">go_dict</span><span class="p">()</span>

        <span class="n">all_proteins</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">set</span><span class="p">(</span><span class="n">all_proteins</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">all_proteins</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span>
            <span class="n">all_proteins</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">all_proteins</span><span class="p">,</span> <span class="nb">set</span><span class="p">)</span> <span class="k">else</span>
            <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
        <span class="p">)</span>

        <span class="n">annotation</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="p">(</span><span class="n">up</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">up</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span>
                <span class="nb">getattr</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">go</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span><span class="p">],</span>
                    <span class="n">aspect</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">up</span> <span class="ow">in</span> <span class="n">all_proteins</span>
        <span class="p">)</span>

        <span class="n">enr</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">GOEnrichmentSet</span><span class="p">(</span>
            <span class="n">aspect</span><span class="o">=</span><span class="n">aspect</span><span class="p">,</span>
            <span class="n">organism</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span><span class="p">,</span>
            <span class="n">basic_set</span><span class="o">=</span><span class="n">annotation</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">correction_method</span><span class="o">=</span><span class="n">correction_method</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">proteins</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">enr</span><span class="o">.</span><span class="n">new_set</span><span class="p">(</span><span class="n">set_names</span><span class="o">=</span><span class="n">proteins</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">enr</span></div>

<div class="viewcode-block" id="PyPath.init_gsea"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.init_gsea">[docs]</a>    <span class="k">def</span> <span class="nf">init_gsea</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes a ``pypath.gsea.GSEA`` object and shows the list of the</span>
<span class="sd">        collections in MSigDB.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gsea</span> <span class="o">=</span> <span class="n">gsea</span><span class="o">.</span><span class="n">GSEA</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> :: GSEA object initialized, use &#39;</span>
                         <span class="s1">&#39;load_genesets() to load some of the collections.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;      e.g. load_genesets([</span><span class="se">\&#39;</span><span class="s1">H</span><span class="se">\&#39;</span><span class="s1">])</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gsea</span><span class="o">.</span><span class="n">show_collections</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.add_genesets"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.add_genesets">[docs]</a>    <span class="k">def</span> <span class="nf">add_genesets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genesets</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">gsetid</span> <span class="ow">in</span> <span class="n">genesets</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">gsetid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gsea</span><span class="o">.</span><span class="n">collections</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gsea</span><span class="o">.</span><span class="n">load_collection</span><span class="p">(</span><span class="n">gsetid</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.geneset_enrichment"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.geneset_enrichment">[docs]</a>    <span class="k">def</span> <span class="nf">geneset_enrichment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proteins</span><span class="p">,</span> <span class="n">all_proteins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">geneset_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">correction_method</span><span class="o">=</span><span class="s1">&#39;hommel&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Does not work at the moment because cfisher module should be</span>
<span class="sd">        replaced with scipy.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">all_proteins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> \
            <span class="k">if</span> <span class="n">all_proteins</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">all_proteins</span>
        <span class="n">enr</span> <span class="o">=</span> <span class="n">gsea</span><span class="o">.</span><span class="n">GSEABinaryEnrichmentSet</span><span class="p">(</span>
            <span class="n">basic_set</span><span class="o">=</span><span class="n">all_proteins</span><span class="p">,</span>
            <span class="n">gsea</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gsea</span><span class="p">,</span>
            <span class="n">geneset_ids</span><span class="o">=</span><span class="n">geneset_ids</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">correction_method</span><span class="o">=</span><span class="n">correction_method</span><span class="p">)</span>
        <span class="n">enr</span><span class="o">.</span><span class="n">new_set</span><span class="p">(</span><span class="n">proteins</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">enr</span></div>

<div class="viewcode-block" id="PyPath.update_adjlist"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.update_adjlist">[docs]</a>    <span class="k">def</span> <span class="nf">update_adjlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;ALL&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates an adjacency list in a list of sets format.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjlist</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">set</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())</span>
        <span class="p">]</span></div>

<div class="viewcode-block" id="PyPath.find_all_paths"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.find_all_paths">[docs]</a>    <span class="k">def</span> <span class="nf">find_all_paths</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">start</span><span class="p">,</span>
            <span class="n">end</span><span class="p">,</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;OUT&#39;</span><span class="p">,</span>
            <span class="n">maxlen</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">graph</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">silent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">update_adjlist</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Finds all paths up to length `maxlen` between groups of</span>
<span class="sd">        vertices. This function is needed only becaues igraph`s</span>
<span class="sd">        get_all_shortest_paths() finds only the shortest, not any</span>
<span class="sd">        path up to a defined length.</span>

<span class="sd">        start : int or list</span>
<span class="sd">            Indices of the starting node(s) of the paths.</span>
<span class="sd">        end : int or list</span>
<span class="sd">            Indices of the target node(s) of the paths.</span>
<span class="sd">        attr : str</span>
<span class="sd">            Name of the vertex attribute to identify the vertices by.</span>
<span class="sd">            Necessary if ``start`` and ``end`` are not igraph vertex ids</span>
<span class="sd">            but for example vertex names or labels.</span>
<span class="sd">        mode : &#39;IN&#39;, &#39;OUT&#39;, &#39;ALL&#39;</span>
<span class="sd">            Passed to igraph.Graph.neighbors()</span>
<span class="sd">        maxlen : int</span>
<span class="sd">            Maximum length of paths in steps, i.e. if maxlen = 3, then</span>
<span class="sd">            the longest path may consist of 3 edges and 4 nodes.</span>
<span class="sd">        graph : igraph.Graph object</span>
<span class="sd">            The graph you want to find paths in. self.graph by default.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">find_all_paths_aux</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">maxlen</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="p">[</span><span class="n">start</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="n">end</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">path</span><span class="p">]</span>

            <span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">maxlen</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>

                <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjlist</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
                    <span class="n">paths</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                        <span class="n">find_all_paths_aux</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">maxlen</span><span class="p">))</span>

            <span class="k">return</span> <span class="n">paths</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">if</span> <span class="n">update_adjlist</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;adjlist&#39;</span><span class="p">):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">update_adjlist</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span><span class="p">)</span>

        <span class="n">all_paths</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">start</span> <span class="o">=</span> <span class="n">start</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="n">start</span><span class="p">]</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">end</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">end</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="n">end</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">attr</span><span class="p">:</span>

            <span class="n">attr_to_id</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">attr</span><span class="p">]))</span>
            <span class="n">start</span> <span class="o">=</span> <span class="p">[</span><span class="n">attr_to_id</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">start</span><span class="p">]</span>
            <span class="n">end</span> <span class="o">=</span> <span class="p">[</span><span class="n">attr_to_id</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">end</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">end</span><span class="p">),</span>
                <span class="s1">&#39;Looking up all paths up to length </span><span class="si">%u</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">maxlen</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">start</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">end</span><span class="p">:</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
                    <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

                <span class="n">all_paths</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">find_all_paths_aux</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="p">[],</span> <span class="n">maxlen</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
            <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">attr</span><span class="p">:</span>

            <span class="n">all_paths</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">[</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">attr</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">path</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">all_paths</span>
            <span class="p">]</span>

        <span class="k">return</span> <span class="n">all_paths</span></div>


<div class="viewcode-block" id="PyPath.find_all_paths2"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.find_all_paths2">[docs]</a>    <span class="k">def</span> <span class="nf">find_all_paths2</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">graph</span><span class="p">,</span>
            <span class="n">start</span><span class="p">,</span>
            <span class="n">end</span><span class="p">,</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;OUT&#39;</span><span class="p">,</span>
            <span class="n">maxlen</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">psize</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
            <span class="n">update_adjlist</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">one_step</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="n">adjlist</span><span class="p">):</span>
            <span class="c1"># extends all paths by one step using all neighbors in adjacency</span>
            <span class="c1"># list</span>
            <span class="k">return</span> <span class="p">[</span>
                <span class="n">i</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="p">[[</span><span class="n">s</span> <span class="o">+</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">adjlist</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">s</span><span class="p">]</span>
                             <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ii</span>
            <span class="p">]</span>

        <span class="k">def</span> <span class="nf">parts</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">adjlist</span><span class="p">,</span> <span class="n">maxlen</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">psize</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">complete_paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">paths</span> <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">maxlen</span><span class="p">:</span>

                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">),</span> <span class="n">psize</span><span class="p">):</span>
                    <span class="n">new_paths</span> <span class="o">=</span> <span class="n">one_step</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">psize</span><span class="p">],</span> <span class="n">adjlist</span><span class="p">)</span>
                    <span class="n">complete_paths</span> <span class="o">+=</span> <span class="n">parts</span><span class="p">(</span>
                        <span class="n">new_paths</span><span class="p">,</span>
                        <span class="n">targets</span><span class="p">,</span>
                        <span class="n">adjlist</span><span class="p">,</span>
                        <span class="n">maxlen</span><span class="p">,</span>
                        <span class="n">psize</span><span class="p">,</span>
                        <span class="n">depth</span><span class="o">=</span><span class="n">depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">90</span><span class="p">)</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r\t</span><span class="s1">Depth: </span><span class="si">%u</span><span class="s1"> :: Paths found: </span><span class="si">%u</span><span class="s1">&#39;</span> <span class="o">%</span>
                                     <span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">complete_paths</span><span class="p">)))</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">complete_paths</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">graph</span>
        <span class="n">all_paths</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">start</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="n">start</span><span class="p">]</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">end</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">end</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="n">end</span><span class="p">]</span>
        <span class="n">send</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">end</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">adjlist</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">set</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span>
                <span class="n">node</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
            <span class="p">))</span>
            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())</span>
        <span class="p">]</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="p">[[</span><span class="n">s</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">start</span><span class="p">]</span>
        <span class="n">all_paths</span> <span class="o">=</span> <span class="n">parts</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">adjlist</span><span class="p">,</span> <span class="n">maxlen</span><span class="p">,</span> <span class="n">psize</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">all_paths</span></div>


<div class="viewcode-block" id="PyPath.transcription_factors"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.transcription_factors">[docs]</a>    <span class="k">def</span> <span class="nf">transcription_factors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">common</span><span class="o">.</span><span class="n">uniq_list</span><span class="p">([</span>
            <span class="n">j</span>
            <span class="k">for</span> <span class="n">ssl</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="n">i</span> <span class="k">for</span> <span class="n">sl</span> <span class="ow">in</span> <span class="p">[[</span>
                    <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">src_by_source</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;sources_by_type&#39;</span><span class="p">][</span><span class="s1">&#39;TF&#39;</span><span class="p">]</span>
                <span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span> <span class="k">if</span> <span class="s1">&#39;TF&#39;</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sl</span>
            <span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">ssl</span>
        <span class="p">])</span></div>

<div class="viewcode-block" id="PyPath.neighbourhood_network"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.neighbourhood_network">[docs]</a>    <span class="k">def</span> <span class="nf">neighbourhood_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">center</span> <span class="o">=</span> <span class="n">center</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="n">center</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">center</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">second</span><span class="p">:</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">second_neighbours</span><span class="p">(</span>
                <span class="n">center</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_neighbours</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">center</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">induced_subgraph</span><span class="p">(</span>
            <span class="n">nodes</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;create_from_scratch&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.get_proteomicsdb"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.get_proteomicsdb">[docs]</a>    <span class="k">def</span> <span class="nf">get_proteomicsdb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">passwd</span><span class="p">,</span> <span class="n">tissues</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pickle</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">proteomicsdb</span> <span class="o">=</span> <span class="n">proteomicsdb</span><span class="o">.</span><span class="n">ProteomicsDB</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">passwd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proteomicsdb</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pfile</span><span class="o">=</span><span class="n">pickle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proteomicsdb</span><span class="o">.</span><span class="n">get_tissues</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proteomicsdb</span><span class="o">.</span><span class="n">tissues_x_proteins</span><span class="p">(</span><span class="n">tissues</span><span class="o">=</span><span class="n">tissues</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proteomicsdb</span><span class="o">.</span><span class="n">tissues_loaded</span></div>

<div class="viewcode-block" id="PyPath.prdb_tissue_expr"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.prdb_tissue_expr">[docs]</a>    <span class="k">def</span> <span class="nf">prdb_tissue_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tissue</span><span class="p">,</span> <span class="n">prdb</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">occurrence</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                         <span class="n">group_function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span>
                         <span class="n">na_value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">graph</span>
        <span class="n">prdb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proteomicsdb</span> <span class="k">if</span> <span class="n">prdb</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">prdb</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">prdb</span><span class="o">.</span><span class="n">samples</span><span class="p">[</span><span class="n">tissue</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">tissue</span> <span class="ow">in</span> <span class="n">prdb</span><span class="o">.</span><span class="n">samples</span>
            <span class="k">else</span> <span class="p">[</span><span class="n">tissue</span><span class="p">]</span> <span class="k">if</span> <span class="n">tissue</span> <span class="ow">in</span> <span class="n">prdb</span><span class="o">.</span><span class="n">expression</span>
            <span class="k">else</span> <span class="p">[]</span>
        <span class="p">)</span>

        <span class="n">nsamples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
        <span class="n">occurrence</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">nsamples</span><span class="p">,</span> <span class="n">occurrence</span><span class="p">)</span> \
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">occurrence</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> \
            <span class="k">else</span> <span class="n">nsamples</span> <span class="o">*</span> <span class="n">occurrence</span>

        <span class="n">proteins_present</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span>
            <span class="n">uniprot</span>
            <span class="k">for</span> <span class="n">uniprot</span><span class="p">,</span> <span class="n">cnt</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span>
                <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span>
                    <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="p">(</span>
                        <span class="n">prdb</span><span class="o">.</span><span class="n">expression</span><span class="p">[</span><span class="n">sample</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                        <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span>
                    <span class="p">))</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">cnt</span> <span class="o">&gt;=</span> <span class="n">occurrence</span>
        <span class="p">])</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

        <span class="n">expressions</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">uniprot</span><span class="p">,</span> <span class="n">group_function</span><span class="p">([</span>
            <span class="n">prdb</span><span class="o">.</span><span class="n">expression</span><span class="p">[</span><span class="n">sample</span><span class="p">][</span><span class="n">uniprot</span><span class="p">]</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span>
            <span class="k">if</span> <span class="n">uniprot</span> <span class="ow">in</span> <span class="n">prdb</span><span class="o">.</span><span class="n">expression</span><span class="p">[</span><span class="n">sample</span><span class="p">]</span>
        <span class="p">]))</span> <span class="k">for</span> <span class="n">uniprot</span> <span class="ow">in</span> <span class="n">proteins_present</span><span class="p">])</span>

        <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">tissue</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">na_value</span> <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">expressions</span> <span class="k">else</span> <span class="n">expressions</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span>
        <span class="p">]</span></div>

<div class="viewcode-block" id="PyPath.load_hpa"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_hpa">[docs]</a>    <span class="k">def</span> <span class="nf">load_hpa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pathology</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cancer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">summarize_pathology</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tissues</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">quality</span><span class="o">=</span><span class="nb">set</span><span class="p">([</span><span class="s1">&#39;Supported&#39;</span><span class="p">,</span> <span class="s1">&#39;Approved&#39;</span><span class="p">]),</span>
                 <span class="n">levels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;High&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Medium&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Low&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Not detected&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
                 <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">na_value</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads Human Protein Atlas data into vertex attributes.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">hpa</span> <span class="o">=</span> <span class="n">proteinatlas</span><span class="o">.</span><span class="n">get_proteinatlas</span><span class="p">(</span>
            <span class="n">normal</span> <span class="o">=</span> <span class="n">normal</span><span class="p">,</span> <span class="n">pathology</span> <span class="o">=</span> <span class="n">pathology</span> <span class="ow">or</span> <span class="n">cancer</span><span class="p">)</span>

        <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;hpa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())]</span>

        <span class="k">if</span> <span class="n">normal</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">tissue</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">hpa</span><span class="p">[</span><span class="s1">&#39;normal&#39;</span><span class="p">]):</span>

                <span class="k">if</span> <span class="n">tissues</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">tissue</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tissues</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>
                    <span class="n">v</span><span class="p">[</span><span class="s1">&#39;hpa&#39;</span><span class="p">][</span><span class="n">tissue</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">levels</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]][</span><span class="mi">0</span><span class="p">]]</span>
                        <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]][</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">quality</span>
                        <span class="k">else</span> <span class="n">na_value</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cancer</span> <span class="ow">or</span> <span class="n">pathology</span><span class="p">:</span>
            <span class="n">counts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="s1">&#39;Not detected&#39;</span><span class="p">,</span> <span class="s1">&#39;Low&#39;</span><span class="p">,</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;High&#39;</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">tissue</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">hpa</span><span class="p">[</span><span class="s1">&#39;pathology&#39;</span><span class="p">]):</span>

                <span class="k">if</span> <span class="n">tissues</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">tissue</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tissues</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">tissue</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{}</span> <span class="k">if</span> <span class="n">summarize_pathology</span> <span class="k">else</span> <span class="n">na_value</span>
                                    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())]</span>

                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>

                        <span class="k">if</span> <span class="n">summarize_pathology</span><span class="p">:</span>
                            <span class="n">patho_sum</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
                                <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                                <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">counts</span><span class="p">))</span>

                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">patho_sum</span><span class="p">):</span>
                                <span class="n">v</span><span class="p">[</span><span class="n">tissue</span><span class="p">]</span> <span class="o">=</span> <span class="n">levels</span><span class="p">[</span><span class="n">patho_sum</span><span class="o">.</span><span class="n">most_common</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>

                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">v</span><span class="p">[</span><span class="n">tissue</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span></div>

<div class="viewcode-block" id="PyPath.tissue_network"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.tissue_network">[docs]</a>    <span class="k">def</span> <span class="nf">tissue_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tissue</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a network which includes the proteins expressed in</span>
<span class="sd">        certain tissue according to ProteomicsDB.</span>

<span class="sd">        Args</span>
<span class="sd">        -----</span>
<span class="sd">        :param str tissue:</span>
<span class="sd">            Tissue name as used in ProteomicsDB.</span>
<span class="sd">        :param igraph.Graph graph:</span>
<span class="sd">            A graph object, by default the `graph` attribute of</span>
<span class="sd">            the current instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">graph</span>

        <span class="k">if</span> <span class="n">tissue</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prdb_tissue_expr</span><span class="p">(</span><span class="n">tissue</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">graph</span><span class="o">.</span><span class="n">induced_subgraph</span><span class="p">(</span>
            <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span> <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">tissue</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">])</span></div>

<div class="viewcode-block" id="PyPath.small_plot"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.small_plot">[docs]</a>    <span class="k">def</span> <span class="nf">small_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method is deprecated, do not use it.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arrow_size</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">arrow_width</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">edge_color</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">dgraph</span> <span class="o">=</span> <span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">is_directed</span><span class="p">()</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_directed</span><span class="p">(</span>
            <span class="n">graph</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">toDel</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">dgraph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">is_directed</span> <span class="ow">and</span> <span class="n">e</span><span class="o">.</span><span class="n">index</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">toDel</span><span class="p">:</span>
                <span class="n">opp</span> <span class="o">=</span> <span class="n">dgraph</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">soure</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">opp</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">dgraph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">opp</span><span class="p">][</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">is_directed</span><span class="p">():</span>
                    <span class="n">toDel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opp</span><span class="p">)</span>

        <span class="n">dgraph</span><span class="o">.</span><span class="n">delete_edges</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">toDel</span><span class="p">)))</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">dgraph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>
            <span class="n">src</span> <span class="o">=</span> <span class="n">dgraph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
            <span class="n">tgt</span> <span class="o">=</span> <span class="n">dgraph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">is_directed</span><span class="p">():</span>
                <span class="n">edge_color</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;#646567&#39;</span><span class="p">)</span>
                <span class="n">arrow_size</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">)</span>
                <span class="n">arrow_width</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">is_stimulation</span><span class="p">((</span><span class="n">src</span><span class="p">,</span> <span class="n">tgt</span><span class="p">)):</span>
                    <span class="n">edge_color</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;#6EA945&#39;</span><span class="p">)</span>
                    <span class="n">arrow_size</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
                    <span class="n">arrow_width</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>

                <span class="k">elif</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">is_inhibition</span><span class="p">((</span><span class="n">src</span><span class="p">,</span> <span class="n">tgt</span><span class="p">)):</span>
                    <span class="n">edge_color</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;#DA0025&#39;</span><span class="p">)</span>
                    <span class="n">arrow_size</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
                    <span class="n">arrow_width</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">edge_color</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;#007B7F&#39;</span><span class="p">)</span>
                    <span class="n">arrow_size</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
                    <span class="n">arrow_width</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">bdrawing</span><span class="o">.</span><span class="n">Plot</span><span class="p">(</span>
            <span class="n">graph</span><span class="o">=</span><span class="n">dgraph</span><span class="p">,</span>
            <span class="n">edge_color</span><span class="o">=</span><span class="n">edge_color</span><span class="p">,</span>
            <span class="n">edge_arrow_size</span><span class="o">=</span><span class="n">arrow_size</span><span class="p">,</span>
            <span class="n">edge_arrow_width</span><span class="o">=</span><span class="n">arrow_width</span><span class="p">,</span>
            <span class="n">vertex_label</span><span class="o">=</span><span class="n">dgraph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">],</span>
            <span class="n">vertex_color</span><span class="o">=</span><span class="s1">&#39;ltp&#39;</span><span class="p">,</span>
            <span class="n">vertex_alpha</span><span class="o">=</span><span class="s1">&#39;FF&#39;</span><span class="p">,</span>
            <span class="n">edge_alpha</span><span class="o">=</span><span class="s1">&#39;FF&#39;</span><span class="p">,</span>
            <span class="n">edge_label</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">dgraph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">]],</span>
            <span class="n">vertex_label_family</span><span class="o">=</span><span class="s1">&#39;HelveticaNeueLT Std Lt&#39;</span><span class="p">,</span>
            <span class="n">edge_label_family</span><span class="o">=</span><span class="s1">&#39;HelveticaNeueLT Std Lt&#39;</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.communities"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.communities">[docs]</a>    <span class="k">def</span> <span class="nf">communities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;spinglass&#39;</span><span class="p">:</span>
            <span class="n">giant</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_giant</span><span class="p">()</span>
            <span class="n">graph</span> <span class="o">=</span> <span class="n">giant</span>

            <span class="k">if</span> <span class="s1">&#39;spins&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;spins&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>

        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;fastgreedy&#39;</span><span class="p">:</span>
            <span class="n">undgr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_undirected</span><span class="p">(</span><span class="n">combine_edges</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
            <span class="n">graph</span> <span class="o">=</span> <span class="n">undgr</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_community&#39;</span> <span class="o">%</span> <span class="n">method</span><span class="p">):</span>
            <span class="n">to_call</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_community&#39;</span> <span class="o">%</span> <span class="n">method</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">to_call</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">):</span>
                <span class="n">comm</span> <span class="o">=</span> <span class="n">to_call</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">comm</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;VertexDendrogram&#39;</span><span class="p">:</span>
                <span class="n">comm</span> <span class="o">=</span> <span class="n">comm</span><span class="o">.</span><span class="n">as_clustering</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">comm</span></div>

<div class="viewcode-block" id="PyPath.set_receptors"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.set_receptors">[docs]</a>    <span class="k">def</span> <span class="nf">set_receptors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a vertex attribute `rec` with value *True* if</span>
<span class="sd">        the protein is a receptor, otherwise *False*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;rec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">]</span>

        <span class="k">if</span> <span class="s1">&#39;rec&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">receptors_list</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="s1">&#39;rec&#39;</span><span class="p">]:</span>

            <span class="k">if</span> <span class="n">rec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">rec</span><span class="p">]][</span><span class="s1">&#39;rec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="PyPath.set_plasma_membrane_proteins_cspa"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.set_plasma_membrane_proteins_cspa">[docs]</a>    <span class="k">def</span> <span class="nf">set_plasma_membrane_proteins_cspa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a vertex attribute `cspa` with value *True* if</span>
<span class="sd">        the protein is a plasma membrane protein according to CPSA,</span>
<span class="sd">        otherwise *False*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;cspa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">]</span>

        <span class="k">if</span> <span class="s1">&#39;cspa&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cspa_list</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="s1">&#39;cspa&#39;</span><span class="p">]:</span>

            <span class="k">if</span> <span class="n">sp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">sp</span><span class="p">]][</span><span class="s1">&#39;cspa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="PyPath.set_plasma_membrane_proteins_surfaceome"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.set_plasma_membrane_proteins_surfaceome">[docs]</a>    <span class="k">def</span> <span class="nf">set_plasma_membrane_proteins_surfaceome</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">score_threshold</span> <span class="o">=</span> <span class="mf">.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a vertex attribute `ishs` with value *True* if</span>
<span class="sd">        the protein is a plasma membrane protein according to the In Silico</span>
<span class="sd">        Human Surfaceome, otherwise *False*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;ishs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">]</span>

        <span class="c1"># always load this to apply score threshold</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surfaceome_list</span><span class="p">(</span><span class="n">score_threshold</span> <span class="o">=</span> <span class="n">score_threshold</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="s1">&#39;ishs&#39;</span><span class="p">]:</span>

            <span class="k">if</span> <span class="n">sp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">sp</span><span class="p">]][</span><span class="s1">&#39;ishs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="PyPath.set_plasma_membrane_proteins_cspa_surfaceome"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.set_plasma_membrane_proteins_cspa_surfaceome">[docs]</a>    <span class="k">def</span> <span class="nf">set_plasma_membrane_proteins_cspa_surfaceome</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">score_threshold</span> <span class="o">=</span> <span class="mf">.0</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a vertex attribute ``surf`` with value *True* if</span>
<span class="sd">        the protein is a plasma membrane protein according either to the</span>
<span class="sd">        Cell Surface Protein Atlas or the In Silico Human Surfaceome.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_plasma_membrane_proteins_cspa</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_plasma_membrane_proteins_surfaceome</span><span class="p">(</span>
            <span class="n">score_threshold</span> <span class="o">=</span> <span class="n">score_threshold</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;surf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">cspa</span> <span class="ow">or</span> <span class="n">ishs</span>
            <span class="k">for</span> <span class="n">cspa</span><span class="p">,</span> <span class="n">ishs</span> <span class="ow">in</span>
            <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;cspa&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;ishs&#39;</span><span class="p">])</span>
        <span class="p">]</span></div>

<div class="viewcode-block" id="PyPath.load_surfaceome_attrs"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_surfaceome_attrs">[docs]</a>    <span class="k">def</span> <span class="nf">load_surfaceome_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads vertex attributes from the In Silico Human Surfaceome.</span>
<span class="sd">        Attributes are ``surfaceome_score``, ``surfaceome_class`` and</span>
<span class="sd">        ``surfaceome_subclass``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">attrs</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s1">&#39;surfaceome_score&#39;</span><span class="p">,</span>
            <span class="s1">&#39;surfaceome_class&#39;</span><span class="p">,</span>
            <span class="s1">&#39;surfaceome_subclass&#39;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>

        <span class="n">sf</span> <span class="o">=</span> <span class="n">surfaceome_input</span><span class="o">.</span><span class="n">get_surfaceome</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">attrs</span><span class="p">):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">sf</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]][</span><span class="n">i</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span>
                <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">sf</span>
            <span class="p">]</span></div>

<div class="viewcode-block" id="PyPath.load_matrisome_attrs"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_matrisome_attrs">[docs]</a>    <span class="k">def</span> <span class="nf">load_matrisome_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">organism</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads vertex attributes from MatrisomeDB 2.0. Attributes are</span>
<span class="sd">        ``matrisome_class``, ``matrisome_subclass`` and ``matrisome_notes``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">attrs</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s1">&#39;matrisome_class&#39;</span><span class="p">,</span>
            <span class="s1">&#39;matrisome_subclass&#39;</span><span class="p">,</span>
            <span class="s1">&#39;matrisome_notes&#39;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">organism</span> <span class="o">=</span> <span class="n">organism</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span>

        <span class="n">matrisome</span> <span class="o">=</span> <span class="n">matrisome_input</span><span class="o">.</span><span class="n">get_matrisome</span><span class="p">(</span><span class="n">organism</span> <span class="o">=</span> <span class="n">organism</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">attrs</span><span class="p">):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">matrisome</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]][</span><span class="n">i</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span>
                <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">matrisome</span>
            <span class="p">]</span></div>

<div class="viewcode-block" id="PyPath.load_membranome_attrs"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_membranome_attrs">[docs]</a>    <span class="k">def</span> <span class="nf">load_membranome_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads attributes from Membranome, a database of single-helix</span>
<span class="sd">        transmembrane proteins.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;membranome_location&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())</span>
        <span class="p">]</span>

        <span class="n">m</span> <span class="o">=</span> <span class="n">membranome_input</span><span class="o">.</span><span class="n">get_membranome</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">uniprot</span><span class="p">,</span> <span class="n">mem</span><span class="p">,</span> <span class="n">side</span> <span class="ow">in</span> <span class="n">m</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">uniprot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">uniprot</span><span class="p">]</span>
                    <span class="p">][</span>
                        <span class="s1">&#39;membranome_location&#39;</span>
                    <span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">side</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.load_exocarta_attrs"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_exocarta_attrs">[docs]</a>    <span class="k">def</span> <span class="nf">load_exocarta_attrs</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">load_samples</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">load_refs</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates vertex attributes from ExoCarta data. Creates a boolean</span>
<span class="sd">        attribute ``exocarts_exosomal`` which tells whether a protein is</span>
<span class="sd">        in ExoCarta i.e. has been found in exosomes. Optionally creates</span>
<span class="sd">        attributes ``exocarta_samples`` and ``exocarta_refs`` listing the</span>
<span class="sd">        sample tissue and the PubMed references, respectively.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_load_exocarta_vesiclepedia_attrs</span><span class="p">(</span>
            <span class="n">database</span> <span class="o">=</span> <span class="s1">&#39;exocarta&#39;</span><span class="p">,</span>
            <span class="n">load_samples</span> <span class="o">=</span> <span class="n">load_samples</span><span class="p">,</span>
            <span class="n">load_refs</span> <span class="o">=</span> <span class="n">load_refs</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.load_vesiclepedia_attrs"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_vesiclepedia_attrs">[docs]</a>    <span class="k">def</span> <span class="nf">load_vesiclepedia_attrs</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">load_samples</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">load_refs</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">load_vesicle_type</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates vertex attributes from Vesiclepedia data. Creates a boolean</span>
<span class="sd">        attribute ``vesiclepedia_in_vesicle`` which tells whether a protein is</span>
<span class="sd">        in ExoCarta i.e. has been found in exosomes. Optionally creates</span>
<span class="sd">        attributes ``vesiclepedia_samples``, ``vesiclepedia_refs`` and</span>
<span class="sd">        ``vesiclepedia_vesicles`` listing the sample tissue, the PubMed</span>
<span class="sd">        references and the vesicle types, respectively.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_load_exocarta_vesiclepedia_attrs</span><span class="p">(</span>
            <span class="n">database</span> <span class="o">=</span> <span class="s1">&#39;vesiclepedia&#39;</span><span class="p">,</span>
            <span class="n">load_samples</span> <span class="o">=</span> <span class="n">load_samples</span><span class="p">,</span>
            <span class="n">load_refs</span> <span class="o">=</span> <span class="n">load_refs</span><span class="p">,</span>
            <span class="n">load_vesicle_type</span> <span class="o">=</span> <span class="n">load_vesicle_type</span><span class="p">,</span>
        <span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_load_exocarta_vesiclepedia_attrs</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">database</span> <span class="o">=</span> <span class="s1">&#39;exocarta&#39;</span><span class="p">,</span>
            <span class="n">load_samples</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">load_refs</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">load_vesicle_type</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">):</span>

        <span class="n">database</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="n">exo</span> <span class="o">=</span> <span class="n">exocarta_input</span><span class="o">.</span><span class="n">_get_exocarta_vesiclepedia</span><span class="p">(</span>
            <span class="n">database</span> <span class="o">=</span> <span class="n">database</span><span class="p">,</span>
            <span class="n">organism</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span>
        <span class="p">)</span>

        <span class="n">bool_attr</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s1">&#39;exocarta_exosomal&#39;</span>
                <span class="k">if</span> <span class="n">database</span> <span class="o">==</span> <span class="s1">&#39;exocarta&#39;</span> <span class="k">else</span>
            <span class="s1">&#39;vesiclepedia_in_vesicle&#39;</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">bool_attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="n">load_samples</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_samples&#39;</span> <span class="o">%</span> <span class="n">database</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="nb">set</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())</span>
            <span class="p">]</span>
        <span class="k">if</span> <span class="n">load_refs</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_refs&#39;</span> <span class="o">%</span> <span class="n">database</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="nb">set</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())</span>
            <span class="p">]</span>
        <span class="k">if</span> <span class="n">database</span> <span class="o">==</span> <span class="s1">&#39;vesiclepedia&#39;</span> <span class="ow">and</span> <span class="n">load_vesicle_type</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_vesicles&#39;</span> <span class="o">%</span> <span class="n">database</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="nb">set</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())</span>
            <span class="p">]</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">exo</span><span class="p">:</span>

            <span class="n">uniprots</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span>
                <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="s1">&#39;genesymbol&#39;</span><span class="p">,</span>
                <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                <span class="n">ncbi_tax_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">uniprots</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">u</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodInd</span><span class="p">:</span>

                    <span class="k">continue</span>

                <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">u</span><span class="p">]]</span>

                <span class="n">v</span><span class="p">[</span><span class="n">bool_attr</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="k">if</span> <span class="n">load_samples</span><span class="p">:</span>

                    <span class="n">v</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_samples&#39;</span> <span class="o">%</span> <span class="n">database</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">load_refs</span> <span class="ow">and</span> <span class="n">e</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                    <span class="n">v</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_refs&#39;</span> <span class="o">%</span> <span class="n">database</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">database</span> <span class="o">==</span> <span class="s1">&#39;vesiclepedia&#39;</span> <span class="ow">and</span> <span class="n">load_vesicle_type</span><span class="p">:</span>

                    <span class="n">v</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_vesicles&#39;</span> <span class="o">%</span> <span class="n">database</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">]))</span>

<div class="viewcode-block" id="PyPath.set_kinases"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.set_kinases">[docs]</a>    <span class="k">def</span> <span class="nf">set_kinases</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a vertex attribute `kin` with value *True* if</span>
<span class="sd">        the protein is a kinase, otherwise *False*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;kin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">]</span>

        <span class="k">if</span> <span class="s1">&#39;kin&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kinases_list</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">kin</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="s1">&#39;kin&#39;</span><span class="p">]:</span>

            <span class="k">if</span> <span class="n">kin</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">kin</span><span class="p">]][</span><span class="s1">&#39;kin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="PyPath.set_signaling_proteins"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.set_signaling_proteins">[docs]</a>    <span class="k">def</span> <span class="nf">set_signaling_proteins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a vertex attribute `kin` with value *True* if</span>
<span class="sd">        the protein is a kinase, otherwise *False*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;sig&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">]</span>

        <span class="k">if</span> <span class="s1">&#39;sig&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signaling_proteins_list</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">sig</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="s1">&#39;sig&#39;</span><span class="p">]:</span>

            <span class="k">if</span> <span class="n">sig</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">sig</span><span class="p">]][</span><span class="s1">&#39;sig&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="PyPath.set_druggability"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.set_druggability">[docs]</a>    <span class="k">def</span> <span class="nf">set_druggability</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a vertex attribute `dgb` with value *True* if</span>
<span class="sd">        the protein is druggable, otherwise *False*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;dgb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">]</span>

        <span class="k">if</span> <span class="s1">&#39;dgb&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">druggability_list</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">dgb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="s1">&#39;dgb&#39;</span><span class="p">]:</span>

            <span class="k">if</span> <span class="n">dgb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">dgb</span><span class="p">]][</span><span class="s1">&#39;dgb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="PyPath.set_drugtargets"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.set_drugtargets">[docs]</a>    <span class="k">def</span> <span class="nf">set_drugtargets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pchembl</span><span class="o">=</span><span class="mf">5.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a vertex attribute `dtg` with value *True* if</span>
<span class="sd">        the protein has at least one compound binding with</span>
<span class="sd">        affinity higher than `pchembl`, otherwise *False*.</span>

<span class="sd">        Args</span>
<span class="sd">        -----</span>
<span class="sd">        :param float pchembl:</span>
<span class="sd">            Pchembl threshold.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;dtg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">]</span>

        <span class="k">if</span> <span class="s1">&#39;compounds_data&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compounds_from_chembl</span><span class="p">(</span><span class="n">assay_types</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="n">pchembl</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;compounds_data&#39;</span><span class="p">]:</span>
                <span class="n">pc</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;pchembl&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pc</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

                    <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">pc</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">pchembl</span><span class="p">:</span>
                        <span class="n">v</span><span class="p">[</span><span class="s1">&#39;dtg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="PyPath.set_transcription_factors"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.set_transcription_factors">[docs]</a>    <span class="k">def</span> <span class="nf">set_transcription_factors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a vertex attribute `tf` with value *True* if</span>
<span class="sd">        the protein is a transcription factor, otherwise *False*.</span>

<span class="sd">        Args</span>
<span class="sd">        -----</span>
<span class="sd">        :param list classes:</span>
<span class="sd">            Classes to use from TF Census. Default is `[&#39;a&#39;, &#39;b&#39;, &#39;other&#39;]`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;tf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">]</span>

        <span class="k">if</span> <span class="s1">&#39;tf&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tfs_list</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">tf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="s1">&#39;tf&#39;</span><span class="p">]:</span>

            <span class="k">if</span> <span class="n">tf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">tf</span><span class="p">]][</span><span class="s1">&#39;tf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="PyPath.set_disease_genes"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.set_disease_genes">[docs]</a>    <span class="k">def</span> <span class="nf">set_disease_genes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="s1">&#39;curated&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a vertex attribute named `dis` with boolean values *True*</span>
<span class="sd">        if the protein encoded by a disease related gene according to</span>
<span class="sd">        DisGeNet.</span>

<span class="sd">        Args</span>
<span class="sd">        -----</span>
<span class="sd">        :param str dataset:</span>
<span class="sd">            Which dataset to use from DisGeNet. Default is `curated`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;dis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disease_genes_list</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">tf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lists</span><span class="p">[</span><span class="s1">&#39;dis&#39;</span><span class="p">]:</span>

            <span class="k">if</span> <span class="n">tf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">tf</span><span class="p">]][</span><span class="s1">&#39;dis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="PyPath.get_pathways"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.get_pathways">[docs]</a>    <span class="k">def</span> <span class="nf">get_pathways</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">attrname</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_pathways&#39;</span> <span class="o">%</span> <span class="n">source</span>
        <span class="n">proteins_pws</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">interactions_pws</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">attrname</span><span class="p">,</span> <span class="n">common</span><span class="o">.</span><span class="n">basestring</span><span class="p">)</span> <span class="ow">and</span>
            <span class="n">inputs</span><span class="o">.</span><span class="n">get_method</span><span class="p">(</span><span class="n">attrname</span><span class="p">)</span>
        <span class="p">):</span>

            <span class="n">fun</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get_method</span><span class="p">(</span><span class="n">attrname</span><span class="p">)</span>
            <span class="n">proteins_pws</span><span class="p">,</span> <span class="n">interactions_pws</span> <span class="o">=</span> <span class="n">fun</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">proteins_pws</span><span class="p">,</span> <span class="n">interactions_pws</span></div>


<div class="viewcode-block" id="PyPath.pathway_members"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.pathway_members">[docs]</a>    <span class="k">def</span> <span class="nf">pathway_members</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pathway</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an iterator with the members of a single pathway.</span>
<span class="sd">        Apart from the pathway name you need to supply its source</span>
<span class="sd">        database too.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">attr</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_pathways&#39;</span> <span class="o">%</span> <span class="n">source</span>
        <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attribute_names</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">(</span>
                <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">pathway</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="n">attr</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodLab</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_NamedVertexSeq</span><span class="p">([],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodNam</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodLab</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.pathway_names"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.pathway_names">[docs]</a>    <span class="k">def</span> <span class="nf">pathway_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">graph</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the names of all pathways having at least one member</span>
<span class="sd">        in the current graph.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="n">attr</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_pathways&#39;</span> <span class="o">%</span> <span class="n">source</span>

        <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vertex_attributes</span><span class="p">():</span>
            <span class="k">return</span> <span class="nb">set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">attr</span><span class="p">])</span></div>

<div class="viewcode-block" id="PyPath.load_all_pathways"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_all_pathways">[docs]</a>    <span class="k">def</span> <span class="nf">load_all_pathways</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">kegg_pathways</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signor_pathways</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pathway_attributes</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.load_pathways"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_pathways">[docs]</a>    <span class="k">def</span> <span class="nf">load_pathways</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generic method to load pathway annotations from a resource.</span>
<span class="sd">        We don&#39;t recommend calling this method but either specific</span>
<span class="sd">        methods for a single source e.g. `kegg_pathways()`</span>
<span class="sd">        or `sirnor_pathways()` or call `load_all_pathways()` to</span>
<span class="sd">        load all resources.</span>

<span class="sd">        Args</span>
<span class="sd">        -----</span>

<span class="sd">        :param str source:</span>
<span class="sd">            Name of the source, this need to match a method in the dict</span>
<span class="sd">            in `get_pathways()` method and the edge and vertex attributes</span>
<span class="sd">            with pathway annotations will be called &quot;&lt;source&gt;_pathways&quot;.</span>
<span class="sd">        :param igraph.Graph graph:</span>
<span class="sd">            A graph, by default the default the `graph` attribute of the</span>
<span class="sd">            current instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">attrname</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_pathways&#39;</span> <span class="o">%</span> <span class="n">source</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">graph</span>
        <span class="n">nodDct</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">xrange</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vcount</span><span class="p">())))</span>
        <span class="n">proteins_pws</span><span class="p">,</span> <span class="n">interactions_pws</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pathways</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">attrname</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">([])</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">]</span>
        <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">attrname</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">([])</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">proteins_pws</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>

            <span class="k">for</span> <span class="n">pw</span><span class="p">,</span> <span class="n">proteins</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">proteins_pws</span><span class="p">):</span>

                <span class="k">for</span> <span class="n">protein</span> <span class="ow">in</span> <span class="n">proteins</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">protein</span> <span class="ow">in</span> <span class="n">proteins</span><span class="p">:</span>
                        <span class="n">uniprots</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">protein</span><span class="p">,</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                                                        <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>

                        <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">uniprots</span><span class="p">:</span>

                            <span class="k">if</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">nodDct</span><span class="p">:</span>
                                <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">nodDct</span><span class="p">[</span><span class="n">u</span><span class="p">]][</span><span class="n">attrname</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pw</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interactions_pws</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>

            <span class="k">for</span> <span class="n">pw</span><span class="p">,</span> <span class="n">ia</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">interactions_pws</span><span class="p">):</span>

                <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">ia</span><span class="p">:</span>
                    <span class="n">usrcs</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>
                    <span class="n">utgts</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">usrc</span> <span class="ow">in</span> <span class="n">usrcs</span><span class="p">:</span>

                        <span class="k">for</span> <span class="n">utgt</span> <span class="ow">in</span> <span class="n">utgts</span><span class="p">:</span>

                            <span class="k">if</span> <span class="n">usrc</span> <span class="ow">in</span> <span class="n">nodDct</span> <span class="ow">and</span> <span class="n">utgt</span> <span class="ow">in</span> <span class="n">nodDct</span><span class="p">:</span>
                                <span class="n">eid</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span>
                                    <span class="n">nodDct</span><span class="p">[</span><span class="n">usrc</span><span class="p">],</span> <span class="n">nodDct</span><span class="p">[</span><span class="n">utgt</span><span class="p">],</span> <span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                                <span class="k">if</span> <span class="n">eid</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                                    <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">][</span><span class="n">attrname</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pw</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_pathway_types</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_pathways</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyPath.signor_pathways"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.signor_pathways">[docs]</a>    <span class="k">def</span> <span class="nf">signor_pathways</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">load_pathways</span><span class="p">(</span><span class="s1">&#39;signor&#39;</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.kegg_pathways"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.kegg_pathways">[docs]</a>    <span class="k">def</span> <span class="nf">kegg_pathways</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">load_pathways</span><span class="p">(</span><span class="s1">&#39;kegg&#39;</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.pathway_attributes"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.pathway_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">pathway_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">graph</span>

        <span class="k">if</span> <span class="s1">&#39;netpath_pathways&#39;</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;netpath_pathways&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">([])</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vcount</span><span class="p">())]</span>

            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>
                <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;netpath_pathways&#39;</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;netpath_pathways&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span>
                        <span class="n">e</span><span class="p">[</span><span class="s1">&#39;netpath_pathways&#39;</span><span class="p">])</span>

                <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;netpath_pathways&#39;</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;netpath_pathways&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span>
                        <span class="n">e</span><span class="p">[</span><span class="s1">&#39;netpath_pathways&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="s1">&#39;slk_pathways&#39;</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;signalink_pathways&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;slk_pathways&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;atg&#39;</span><span class="p">]:</span>
                    <span class="n">v</span><span class="p">[</span><span class="s1">&#39;signalink_pathways&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;autophagy&#39;</span><span class="p">)</span>

            <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;signalink_pathways&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;signalink_pathways&#39;</span><span class="p">]</span> <span class="o">|</span>
                <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;signalink_pathways&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">]</span></div>

<div class="viewcode-block" id="PyPath.pathways_table"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.pathways_table">[docs]</a>    <span class="k">def</span> <span class="nf">pathways_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;genes_pathways.list&#39;</span><span class="p">,</span>
                       <span class="n">pw_sources</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;signalink&#39;</span><span class="p">,</span> <span class="s1">&#39;signor&#39;</span><span class="p">,</span> <span class="s1">&#39;netpath&#39;</span><span class="p">,</span> <span class="s1">&#39;kegg&#39;</span><span class="p">],</span>
                       <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">hdr</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;UniProt&#39;</span><span class="p">,</span> <span class="s1">&#39;GeneSymbol&#39;</span><span class="p">,</span> <span class="s1">&#39;Database&#39;</span><span class="p">,</span> <span class="s1">&#39;Pathway&#39;</span><span class="p">]</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">graph</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">genesymbol_labels</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">pw_sources</span><span class="p">:</span>
                <span class="n">pw_attr</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_pathways&#39;</span> <span class="o">%</span> <span class="n">src</span>

                <span class="k">for</span> <span class="n">pw</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="n">pw_attr</span><span class="p">]:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">src</span><span class="p">,</span> <span class="n">pw</span><span class="p">])</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">hdr</span><span class="p">))</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="n">result</span><span class="p">)))</span></div>

<div class="viewcode-block" id="PyPath.guide2pharma"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.guide2pharma">[docs]</a>    <span class="k">def</span> <span class="nf">guide2pharma</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">g2p_input</span><span class="o">.</span><span class="n">guide2pharma_download</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">ulig</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">urec</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;receptor_uniprot&#39;</span><span class="p">],</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;ligand_uniprot&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ulig</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;ligand_uniprot&#39;</span><span class="p">],</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;ligand_genesymbol&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ulig</span> <span class="o">+=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;ligand_genesymbol&#39;</span><span class="p">],</span>
                                             <span class="s1">&#39;genesymbol&#39;</span><span class="p">,</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ulig</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">urec</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

                <span class="k">for</span> <span class="n">ur</span> <span class="ow">in</span> <span class="n">urec</span><span class="p">:</span>

                    <span class="k">for</span> <span class="n">ul</span> <span class="ow">in</span> <span class="n">ulig</span><span class="p">:</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ul</span><span class="p">,</span> <span class="n">ur</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;effect&#39;</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;pubmed&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="PyPath.set_tfs"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.set_tfs">[docs]</a>    <span class="k">def</span> <span class="nf">set_tfs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_transcription_factors</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.load_disgenet"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_disgenet">[docs]</a>    <span class="k">def</span> <span class="nf">load_disgenet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="s1">&#39;curated&#39;</span><span class="p">,</span> <span class="n">score</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">umls</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                      <span class="n">full_data</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assigns DisGeNet disease-gene associations to the proteins</span>
<span class="sd">        in the network. Disease annotations will be added to the `dis`</span>
<span class="sd">        vertex attribute.</span>

<span class="sd">        :param float score: Confidence score from DisGeNet. Only associations</span>
<span class="sd">            above the score provided will be considered.</span>
<span class="sd">        :param bool ulms: By default we assign a list of disease names to</span>
<span class="sd">            each protein. To use Unified Medical Language System IDs instead</span>
<span class="sd">            set this to `True`.</span>
<span class="sd">        :param bool full_data: By default we load only disease names. Set this</span>
<span class="sd">            to `True` if you wish to load additional annotations like number</span>
<span class="sd">            of PubMed IDs, number of SNPs and original sources.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">disgenet_input</span><span class="o">.</span><span class="n">disgenet_annotations</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;dis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">score</span><span class="p">:</span>
                <span class="n">uniprots</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;entrez&#39;</span><span class="p">],</span> <span class="s1">&#39;entrez&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">up</span> <span class="ow">in</span> <span class="n">uniprots</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">up</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodInd</span><span class="p">:</span>

                        <span class="k">if</span> <span class="n">full_data</span><span class="p">:</span>
                            <span class="n">_</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;entrez&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                            <span class="n">_</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;genesymbol&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">up</span><span class="p">]][</span><span class="s1">&#39;dis&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

                        <span class="k">elif</span> <span class="n">umls</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">up</span><span class="p">]][</span><span class="s1">&#39;dis&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">[</span>
                                <span class="s1">&#39;umls&#39;</span><span class="p">])</span>

                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">up</span><span class="p">]][</span><span class="s1">&#39;dis&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">[</span>
                                <span class="s1">&#39;disease&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="PyPath.curation_stats"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.curation_stats">[docs]</a>    <span class="k">def</span> <span class="nf">curation_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by_category</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">all_refs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span>
            <span class="nb">set</span><span class="p">(</span>
                <span class="n">common</span><span class="o">.</span><span class="n">flat_list</span><span class="p">([[</span><span class="n">r</span><span class="o">.</span><span class="n">pmid</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;references&#39;</span><span class="p">]]</span>
                                 <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">])))</span>

        <span class="n">cats</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
            <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">:</span> <span class="n">e1</span> <span class="o">|</span> <span class="n">e2</span><span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span>
                <span class="p">[])))</span> <span class="k">if</span> <span class="n">by_category</span> <span class="k">else</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)</span> <span class="o">+</span> <span class="n">cats</span><span class="p">:</span>
            <span class="n">sattr</span> <span class="o">=</span> <span class="s1">&#39;cat&#39;</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">db_categories</span><span class="o">.</span><span class="n">catnames</span> <span class="k">else</span> <span class="s1">&#39;sources&#39;</span>
            <span class="n">rattr</span> <span class="o">=</span> <span class="s1">&#39;refs_by_cat&#39;</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">db_categories</span><span class="o">.</span><span class="n">catnames</span> <span class="k">else</span> <span class="s1">&#39;refs_by_source&#39;</span>

            <span class="n">cat</span> <span class="o">=</span> <span class="n">db_categories</span><span class="o">.</span><span class="n">get_category</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

            <span class="n">catmembers</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">db_categories</span><span class="o">.</span><span class="n">catnames</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> \
                <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">db_categories</span><span class="o">.</span><span class="n">catnames</span> \
                <span class="k">else</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">db_categories</span><span class="p">,</span> <span class="n">cat</span><span class="p">)</span> \
                <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">db_categories</span><span class="p">,</span> <span class="n">cat</span><span class="p">)</span>

            <span class="n">src_nodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="n">sattr</span><span class="p">]])</span>
            <span class="n">cat_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()</span> <span class="k">if</span> <span class="n">cat</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span>
                <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">sattr</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">catmembers</span><span class="p">)])</span>

            <span class="n">src_nodes_pct</span> <span class="o">=</span> <span class="n">src_nodes</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">cat_nodes</span><span class="p">)</span> <span class="o">*</span> <span class="mf">100.0</span>
            <span class="n">only_src_nodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span>
                <span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span>
                <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="n">sattr</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">sattr</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">catmembers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="p">])</span>

            <span class="n">only_src_nodes_pct</span> <span class="o">=</span> <span class="n">only_src_nodes</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">cat_nodes</span><span class="p">)</span> <span class="o">*</span> <span class="mf">100.0</span>
            <span class="n">shared_nodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span>
                <span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span>
                <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="n">sattr</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">sattr</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">catmembers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
            <span class="p">])</span>

            <span class="n">src_edges</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="n">sattr</span><span class="p">]])</span>
            <span class="n">cat_edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">()</span> <span class="k">if</span> <span class="n">cat</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span>
                <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">sattr</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">catmembers</span><span class="p">)])</span>

            <span class="n">src_edges_pct</span> <span class="o">=</span> <span class="n">src_edges</span> <span class="o">/</span> \
                <span class="nb">float</span><span class="p">(</span><span class="n">cat_edges</span><span class="p">)</span> <span class="o">*</span> <span class="mf">100.0</span>

            <span class="n">only_src_edges</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span>
                <span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span>
                <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="n">sattr</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">sattr</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">catmembers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="p">])</span>

            <span class="n">only_src_edges_pct</span> <span class="o">=</span> <span class="n">only_src_edges</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">cat_edges</span><span class="p">)</span> <span class="o">*</span> <span class="mf">100.0</span>
            <span class="n">shared_edges</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span>
                <span class="n">e</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span>
                <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="n">sattr</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">sattr</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">catmembers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
            <span class="p">])</span>

            <span class="n">src_refs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
                <span class="n">common</span><span class="o">.</span><span class="n">uniq_list</span><span class="p">([</span>
                    <span class="n">r</span><span class="o">.</span><span class="n">pmid</span>
                    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">common</span><span class="o">.</span><span class="n">flat_list</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="n">rattr</span><span class="p">][</span><span class="n">s</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="n">rattr</span><span class="p">]])</span>
                <span class="p">]))</span>

            <span class="n">other_refs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
                <span class="n">common</span><span class="o">.</span><span class="n">flat_list</span><span class="p">([[</span>
                    <span class="n">r</span><span class="o">.</span><span class="n">pmid</span>
                    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">common</span><span class="o">.</span><span class="n">flat_list</span><span class="p">([</span>
                        <span class="n">rr</span> <span class="k">for</span> <span class="n">sr</span><span class="p">,</span> <span class="n">rr</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">rattr</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">sr</span> <span class="o">!=</span> <span class="n">s</span> <span class="ow">and</span> <span class="n">sr</span> <span class="ow">in</span> <span class="n">catmembers</span>
                    <span class="p">])</span>
                <span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">]))</span>

            <span class="n">only_src_refs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">src_refs</span> <span class="o">-</span> <span class="n">other_refs</span><span class="p">)</span>
            <span class="n">only_src_refs_pct</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">src_refs</span> <span class="o">-</span> <span class="n">other_refs</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span>
                <span class="n">all_refs</span><span class="p">)</span> <span class="o">*</span> <span class="mf">100.0</span>

            <span class="n">src_refs_pct</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">src_refs</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">all_refs</span><span class="p">)</span> <span class="o">*</span> <span class="mf">100.0</span>
            <span class="n">shared_refs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">src_refs</span> <span class="o">&amp;</span> <span class="n">other_refs</span><span class="p">)</span>

            <span class="n">shared_curation_effort</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="nb">set</span><span class="p">(</span>
                        <span class="n">common</span><span class="o">.</span><span class="n">flat_list</span><span class="p">([[(</span><span class="n">r</span><span class="o">.</span><span class="n">pmid</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rr</span><span class="p">]</span>
                                         <span class="k">for</span> <span class="n">sr</span><span class="p">,</span> <span class="n">rr</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">rattr</span><span class="p">])</span>
                                         <span class="k">if</span> <span class="n">sr</span> <span class="o">!=</span> <span class="n">s</span> <span class="ow">and</span> <span class="n">sr</span> <span class="ow">in</span> <span class="n">catmembers</span><span class="p">]))</span> <span class="o">&amp;</span>
                    <span class="nb">set</span><span class="p">([(</span><span class="n">rl</span><span class="o">.</span><span class="n">pmid</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="k">for</span> <span class="n">rl</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="n">rattr</span><span class="p">][</span><span class="n">s</span><span class="p">]])</span>
                    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="n">rattr</span><span class="p">]</span>
                <span class="p">]</span>
            <span class="p">])</span>

            <span class="n">src_only_curation_effort</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="nb">set</span><span class="p">([(</span><span class="n">rl</span><span class="o">.</span><span class="n">pmid</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="k">for</span> <span class="n">rl</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="n">rattr</span><span class="p">][</span><span class="n">s</span><span class="p">]])</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span>
                        <span class="n">common</span><span class="o">.</span><span class="n">flat_list</span><span class="p">([[(</span><span class="n">r</span><span class="o">.</span><span class="n">pmid</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rr</span><span class="p">]</span>
                                         <span class="k">for</span> <span class="n">sr</span><span class="p">,</span> <span class="n">rr</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">rattr</span><span class="p">])</span>
                                         <span class="k">if</span> <span class="n">sr</span> <span class="o">!=</span> <span class="n">s</span> <span class="k">if</span> <span class="n">sr</span> <span class="ow">in</span> <span class="n">catmembers</span><span class="p">]))</span>
                    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="n">rattr</span><span class="p">]</span>
                <span class="p">]</span>
            <span class="p">])</span>

            <span class="n">src_curation_effort</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="nb">set</span><span class="p">([(</span><span class="n">rl</span><span class="o">.</span><span class="n">pmid</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="k">for</span> <span class="n">rl</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="n">rattr</span><span class="p">][</span><span class="n">s</span><span class="p">]])</span>
                    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="n">rattr</span><span class="p">]</span>
                <span class="p">]</span>
            <span class="p">])</span>
            <span class="n">ratio</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">src_refs</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">src_edges</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">db_categories</span><span class="o">.</span><span class="n">catnames</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">db_categories</span><span class="o">.</span><span class="n">catnames</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>

            <span class="n">result</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;source_nodes&#39;</span><span class="p">:</span> <span class="n">src_nodes</span><span class="p">,</span>
                <span class="s1">&#39;source_nodes_percentage&#39;</span><span class="p">:</span> <span class="n">src_nodes_pct</span><span class="p">,</span>
                <span class="s1">&#39;specific_nodes&#39;</span><span class="p">:</span> <span class="n">only_src_nodes</span><span class="p">,</span>
                <span class="s1">&#39;specific_nodes_percentage&#39;</span><span class="p">:</span> <span class="n">only_src_nodes_pct</span><span class="p">,</span>
                <span class="s1">&#39;shared_nodes&#39;</span><span class="p">:</span> <span class="n">shared_nodes</span><span class="p">,</span>
                <span class="s1">&#39;source_edges&#39;</span><span class="p">:</span> <span class="n">src_edges</span><span class="p">,</span>
                <span class="s1">&#39;source_edges_percentage&#39;</span><span class="p">:</span> <span class="n">src_edges_pct</span><span class="p">,</span>
                <span class="s1">&#39;specific_edges&#39;</span><span class="p">:</span> <span class="n">only_src_edges</span><span class="p">,</span>
                <span class="s1">&#39;specific_edges_percentage&#39;</span><span class="p">:</span> <span class="n">only_src_edges_pct</span><span class="p">,</span>
                <span class="s1">&#39;shared_edges&#39;</span><span class="p">:</span> <span class="n">shared_edges</span><span class="p">,</span>
                <span class="s1">&#39;specific_refs&#39;</span><span class="p">:</span> <span class="n">only_src_refs</span><span class="p">,</span>
                <span class="s1">&#39;specific_refs_percentage&#39;</span><span class="p">:</span> <span class="n">only_src_refs_pct</span><span class="p">,</span>
                <span class="s1">&#39;source_refs&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">src_refs</span><span class="p">),</span>
                <span class="s1">&#39;source_refs_percentage&#39;</span><span class="p">:</span> <span class="n">src_refs_pct</span><span class="p">,</span>
                <span class="s1">&#39;shared_refs&#39;</span><span class="p">:</span> <span class="n">shared_refs</span><span class="p">,</span>
                <span class="s1">&#39;source_curation_effort&#39;</span><span class="p">:</span> <span class="n">src_curation_effort</span><span class="p">,</span>
                <span class="s1">&#39;source_specific_curation_effort&#39;</span><span class="p">:</span> <span class="n">src_only_curation_effort</span><span class="p">,</span>
                <span class="s1">&#39;shared_curation_effort&#39;</span><span class="p">:</span> <span class="n">shared_curation_effort</span><span class="p">,</span>
                <span class="s1">&#39;refs_edges_ratio&#39;</span><span class="p">:</span> <span class="n">ratio</span><span class="p">,</span>
                <span class="s1">&#39;corrected_curation_effort&#39;</span><span class="p">:</span> <span class="n">src_curation_effort</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">}</span>

        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="PyPath.table_latex"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.table_latex">[docs]</a>    <span class="k">def</span> <span class="nf">table_latex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">sum_row</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">row_order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">latex_hdr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s1">&#39;HelveticaNeueLTStd-LtCn&#39;</span><span class="p">,</span>
                    <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">sum_label</span><span class="o">=</span><span class="s1">&#39;Total&#39;</span><span class="p">,</span> <span class="n">sum_cols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">header_format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">by_category</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">non_digit</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^\d.-]+&#39;</span><span class="p">)</span>
        <span class="n">row_order</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span> \
            <span class="k">if</span> <span class="n">row_order</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">row_order</span>

        <span class="n">_latex_tab</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span><span class="si">%s</span>
<span class="s2">                \begin</span><span class="si">{tabularx}</span><span class="s2">{\textwidth}{</span><span class="si">%s</span><span class="s2">}</span>
<span class="s2">                \toprule</span>
<span class="s2">                    </span><span class="si">%s</span>
<span class="s2">                \midrule</span>
<span class="s2">                    </span><span class="si">%s</span>
<span class="s2">                </span><span class="si">%s</span><span class="s2">\bottomrule</span>
<span class="s2">                \end</span><span class="si">{tabularx}</span>
<span class="s2">                </span><span class="si">%s</span>
<span class="s2">            &quot;&quot;&quot;</span>

        <span class="n">_latex_hdr</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;\documentclass[a4wide,</span><span class="si">%u</span><span class="s2">pt]</span><span class="si">{extarticle}</span>
<span class="s2">                \usepackage</span><span class="si">{fontspec}</span>
<span class="s2">                \usepackage</span><span class="si">{xunicode}</span>
<span class="s2">                \usepackage</span><span class="si">{polyglossia}</span>
<span class="s2">                \setdefaultlanguage</span><span class="si">{english}</span>
<span class="s2">                \usepackage</span><span class="si">{xltxtra}</span>
<span class="s2">                \usepackage</span><span class="si">{microtype}</span>
<span class="s2">                \usepackage[margin=5pt,landscape]</span><span class="si">{geometry}</span>
<span class="s2">                \usepackage</span><span class="si">{amsmath}</span>
<span class="s2">                \usepackage</span><span class="si">{amssymb}</span>
<span class="s2">                \usepackage[usenames,dvipsnames,svgnames,table]</span><span class="si">{xcolor}</span>
<span class="s2">                \usepackage</span><span class="si">{color}</span>
<span class="s2">                \usepackage</span><span class="si">{booktabs}</span>
<span class="s2">                \usepackage</span><span class="si">{tabularx}</span>
<span class="s2">                \setmainfont{</span><span class="si">%s</span><span class="s2">}</span>
<span class="s2">                \definecolor</span><span class="si">{grey875}{gray}{0.125}</span>
<span class="s2">                \begin</span><span class="si">{document}</span>
<span class="s2">                \color</span><span class="si">{grey875}</span>
<span class="s2">                \thispagestyle</span><span class="si">{empty}</span>
<span class="s2">                \vfill</span>
<span class="s2">                \begin</span><span class="si">{table}</span><span class="s2">[h]</span>
<span class="s2">            &quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span> <span class="k">if</span> <span class="n">latex_hdr</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>

        <span class="n">_latex_end</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                \caption{</span><span class="si">%s</span><span class="s2">}</span>
<span class="s2">                \end</span><span class="si">{table}</span>
<span class="s2">                \end</span><span class="si">{document}</span>
<span class="s2">            &quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">caption</span> <span class="k">if</span> <span class="n">latex_hdr</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>

        <span class="n">_hdr_row</span> <span class="o">=</span> <span class="s1">&#39; &amp; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span>
            <span class="n">header_format</span> <span class="o">%</span> <span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\%&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">header</span>
        <span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\\\</span><span class="s1">&#39;</span>

        <span class="n">formatter</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">locale</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">grouping</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> \
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> \
            <span class="k">else</span> <span class="n">locale</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">grouping</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> \
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> \
            <span class="k">else</span> <span class="n">x</span>

        <span class="n">intfloat</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">_rows</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row_order</span><span class="p">):</span>

            <span class="n">row</span> <span class="o">=</span> <span class="s1">&#39; &amp; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span>
                <span class="n">formatter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">header</span>
            <span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\\\</span><span class="s1">&#39;</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;subtitle&#39;</span><span class="p">:</span>
                <span class="n">row</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;\midrule&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\midrule&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">])</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">row</span> <span class="o">=</span> <span class="n">row</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="n">_rows</span> <span class="o">+=</span> <span class="n">row</span>

        <span class="n">sum_cols</span> <span class="o">=</span> <span class="n">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">))</span> <span class="k">if</span> <span class="n">sum_cols</span> <span class="ow">is</span> <span class="kc">None</span> \
            <span class="k">else</span> <span class="n">sum_cols</span>
        <span class="n">_sum_row</span> <span class="o">=</span> <span class="s1">&#39; &amp; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">sum_label</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span>
            <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sum_cols</span> <span class="k">else</span> <span class="n">formatter</span><span class="p">(</span>
                <span class="nb">sum</span><span class="p">([</span>
                    <span class="n">intfloat</span><span class="p">(</span>
                        <span class="nb">list</span><span class="p">(</span>
                            <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span>
                                <span class="n">non_digit</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]])),</span> <span class="s1">&#39;0&#39;</span>
                            <span class="p">]))[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="p">]))</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
        <span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\\\\n</span><span class="s1">&#39;</span>
        <span class="n">_latex_tab</span> <span class="o">=</span> <span class="n">_latex_tab</span> <span class="o">%</span> <span class="p">(</span><span class="n">_latex_hdr</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span> <span class="o">+</span> <span class="s1">&#39;r&#39;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">),</span>
                                   <span class="n">_hdr_row</span><span class="p">,</span> <span class="n">_rows</span><span class="p">,</span>
                                   <span class="sa">r</span><span class="s1">&#39;\midrule&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">_sum_row</span>
                                   <span class="k">if</span> <span class="n">sum_row</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">_latex_end</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">_latex_tab</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.curation_tab"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.curation_tab">[docs]</a>    <span class="k">def</span> <span class="nf">curation_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="s1">&#39;curation_stats.tex&#39;</span><span class="p">,</span> <span class="n">by_category</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">use_cats</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">],</span> <span class="n">header_size</span><span class="o">=</span><span class="s1">&#39;normalsize&#39;</span><span class="p">,</span>
                     <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">by_category</span> <span class="ow">and</span> <span class="s1">&#39;cat&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_categories</span><span class="p">()</span>

        <span class="n">cats</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
            <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">:</span> <span class="n">e1</span> <span class="o">|</span> <span class="n">e2</span><span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span>
                <span class="p">[])))</span> <span class="k">if</span> <span class="n">by_category</span> <span class="k">else</span> <span class="p">[]</span>

        <span class="n">cats</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">cats</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">use_cats</span><span class="p">)</span>
        <span class="n">use_cats</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cats</span><span class="p">,</span> <span class="n">use_cats</span><span class="p">))</span>

        <span class="n">header</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;source_nodes&#39;</span><span class="p">,</span> <span class="s1">&#39;Proteins&#39;</span><span class="p">),</span>
                  <span class="p">(</span><span class="s1">&#39;source_nodes_percentage&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Proteins [%]&#39;</span><span class="p">),</span>
                  <span class="p">(</span><span class="s1">&#39;shared_nodes&#39;</span><span class="p">,</span> <span class="s1">&#39;Shared proteins&#39;</span><span class="p">),</span>
                  <span class="p">(</span><span class="s1">&#39;specific_nodes&#39;</span><span class="p">,</span> <span class="s1">&#39;Specific proteins&#39;</span><span class="p">),</span>
                  <span class="p">(</span><span class="s1">&#39;specific_nodes_percentage&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Specific proteins [%]&#39;</span><span class="p">),</span>
                  <span class="p">(</span><span class="s1">&#39;source_edges&#39;</span><span class="p">,</span> <span class="s1">&#39;Edges&#39;</span><span class="p">),</span>
                  <span class="p">(</span><span class="s1">&#39;source_edges_percentage&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Edges [%]&#39;</span><span class="p">),</span>
                  <span class="p">(</span><span class="s1">&#39;shared_edges&#39;</span><span class="p">,</span> <span class="s1">&#39;Shared edges&#39;</span><span class="p">),</span>
                  <span class="p">(</span><span class="s1">&#39;specific_edges&#39;</span><span class="p">,</span> <span class="s1">&#39;Specific edges&#39;</span><span class="p">),</span>
                  <span class="p">(</span><span class="s1">&#39;specific_edges_percentage&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Specific edges [%]&#39;</span><span class="p">),</span>
                  <span class="p">(</span><span class="s1">&#39;source_refs&#39;</span><span class="p">,</span> <span class="s1">&#39;References&#39;</span><span class="p">),</span>
                  <span class="p">(</span><span class="s1">&#39;source_refs_percentage&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;References [%]&#39;</span><span class="p">),</span>
                  <span class="p">(</span><span class="s1">&#39;shared_refs&#39;</span><span class="p">,</span> <span class="s1">&#39;Shared references&#39;</span><span class="p">),</span>
                  <span class="p">(</span><span class="s1">&#39;specific_refs&#39;</span><span class="p">,</span> <span class="s1">&#39;Specific references&#39;</span><span class="p">),</span>
                  <span class="p">(</span><span class="s1">&#39;specific_refs_percentage&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Specific references [%]&#39;</span><span class="p">),</span>
                  <span class="p">(</span><span class="s1">&#39;source_curation_effort&#39;</span><span class="p">,</span> <span class="s1">&#39;Curation effort&#39;</span><span class="p">),</span>
                  <span class="p">(</span><span class="s1">&#39;shared_curation_effort&#39;</span><span class="p">,</span> <span class="s1">&#39;Shared curation effort&#39;</span><span class="p">),</span> <span class="p">(</span>
                      <span class="s1">&#39;source_specific_curation_effort&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;Specific curation effort&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;refs_edges_ratio&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;References-edges ratio&#39;</span><span class="p">),</span>
                  <span class="p">(</span><span class="s1">&#39;corrected_curation_effort&#39;</span><span class="p">,</span> <span class="s1">&#39;Corrected curation effort&#39;</span><span class="p">)]</span>
        <span class="n">header_format</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\rotatebox</span><span class="si">{90}</span><span class="s1">{\</span><span class="si">%s</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="n">header_size</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">}&#39;</span>

        <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">curation_stats</span><span class="p">(</span><span class="n">by_category</span><span class="o">=</span><span class="n">by_category</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">cs</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;specific_refs&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;shared_refs&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;source_refs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;N/A&#39;</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;specific_refs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;N/A&#39;</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;shared_refs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;N/A&#39;</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;source_refs_percentage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;N/A&#39;</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;specific_refs_percentage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;N/A&#39;</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;source_curation_effort&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;N/A&#39;</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;shared_curation_effort&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;N/A&#39;</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;source_specific_curation_effort&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;N/A&#39;</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;refs_edges_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;N/A&#39;</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;corrected_curation_effort&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;N/A&#39;</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">use_cats</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">db_categories</span><span class="o">.</span><span class="n">catnames</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">db_categories</span><span class="o">.</span><span class="n">catnames</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">by_category</span><span class="p">:</span>
                    <span class="n">cs</span><span class="p">[(</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;subtitle&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="n">cs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

                <span class="k">else</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">cs</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">cs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

        <span class="n">row_order</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">by_category</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">use_cats</span><span class="p">:</span>
                <span class="n">row_order</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">db_categories</span><span class="o">.</span><span class="n">catnames</span><span class="p">[</span><span class="n">cat</span><span class="p">],</span> <span class="s1">&#39;subtitle&#39;</span><span class="p">))</span>
                <span class="n">row_order</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                    <span class="nb">sorted</span><span class="p">(</span>
                        <span class="nb">filter</span><span class="p">(</span>
                            <span class="k">lambda</span> <span class="n">name</span><span class="p">:</span>
                                <span class="n">cat</span> <span class="ow">in</span> <span class="n">db_categories</span><span class="o">.</span><span class="n">get_categories</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
                             <span class="n">cs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">table_latex</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">header_format</span><span class="o">=</span><span class="n">header_format</span><span class="p">,</span>
                         <span class="n">row_order</span><span class="o">=</span><span class="n">row_order</span> <span class="k">if</span> <span class="n">by_category</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="n">by_category</span><span class="o">=</span><span class="n">by_category</span><span class="p">,</span> <span class="n">sum_row</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.load_old_omnipath"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_old_omnipath">[docs]</a>    <span class="k">def</span> <span class="nf">load_old_omnipath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kinase_substrate_extra</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                          <span class="n">remove_htp</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">htp_threshold</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                          <span class="n">keep_directed</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">min_refs_undirected</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads the OmniPath network as it was before August 2016.</span>
<span class="sd">        Furthermore it gives some more options.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">load_omnipath</span><span class="p">(</span><span class="o">**</span><span class="nb">locals</span><span class="p">())</span></div>

<div class="viewcode-block" id="PyPath.load_omnipath"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.load_omnipath">[docs]</a>    <span class="k">def</span> <span class="nf">load_omnipath</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">omnipath</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">kinase_substrate_extra</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">ligand_receptor_extra</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">pathway_extra</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">remove_htp</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">htp_threshold</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">keep_directed</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">min_refs_undirected</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">old_omnipath_resources</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">exclude</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">pickle_file</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads the OmniPath network.</span>
<span class="sd">        Note, if ``pickle_file`` provided the network will be loaded directly</span>
<span class="sd">        from there regardless of its content.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># XXX: According to the alias above omnipath = data_formats.omnipath</span>
        <span class="c1"># already</span>
        <span class="c1"># YYY: Ok, but here the user has a chance to override it, is it bad?</span>

        <span class="k">if</span> <span class="n">pickle_file</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">pickle_file</span><span class="p">):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">init_network</span><span class="p">(</span><span class="n">pickle_file</span> <span class="o">=</span> <span class="n">pickle_file</span><span class="p">)</span>
            <span class="k">return</span>


        <span class="k">def</span> <span class="nf">reference_constraint</span><span class="p">(</span><span class="n">formats</span><span class="p">,</span> <span class="n">extra</span><span class="p">,</span> <span class="n">cat</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            If we anyways load extra interactions without references it does</span>
<span class="sd">            not make sense to throw away the records without references from</span>
<span class="sd">            the default OmniPath sources.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">extra</span><span class="p">:</span>

                <span class="k">return</span> <span class="n">formats</span>

            <span class="n">formats_noref</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">fmt</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">formats</span><span class="p">):</span>

                <span class="n">fmt_noref</span> <span class="o">=</span> <span class="n">copy_mod</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">fmt</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">db_categories</span><span class="p">,</span> <span class="n">cat</span><span class="p">):</span>

                    <span class="n">fmt_noref</span><span class="o">.</span><span class="n">networkinput</span><span class="o">.</span><span class="n">must_have_references</span> <span class="o">=</span> <span class="kc">False</span>

                <span class="n">formats_noref</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">fmt_noref</span>

            <span class="k">return</span> <span class="n">formats_noref</span>


        <span class="n">exclude</span> <span class="o">=</span> <span class="n">exclude</span> <span class="ow">or</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">omnipath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">old_omnipath_resources</span><span class="p">:</span>
                <span class="n">omnipath</span> <span class="o">=</span> <span class="n">copy_mod</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">network_resources</span><span class="o">.</span><span class="n">omnipath</span><span class="p">)</span>
                <span class="n">omnipath</span><span class="p">[</span><span class="s1">&#39;biogrid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">network_resources</span><span class="o">.</span><span class="n">interaction</span><span class="p">[</span><span class="s1">&#39;biogrid&#39;</span><span class="p">]</span>
                <span class="n">omnipath</span><span class="p">[</span><span class="s1">&#39;alz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">network_resources</span><span class="o">.</span><span class="n">interaction</span><span class="p">[</span><span class="s1">&#39;alz&#39;</span><span class="p">]</span>
                <span class="n">omnipath</span><span class="p">[</span><span class="s1">&#39;netpath&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">network_resources</span><span class="o">.</span><span class="n">interaction</span><span class="p">[</span><span class="s1">&#39;netpath&#39;</span><span class="p">]</span>
                <span class="n">exclude</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;intact&#39;</span><span class="p">,</span> <span class="s1">&#39;hprd&#39;</span><span class="p">])</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">omnipath</span> <span class="o">=</span> <span class="n">network_resources</span><span class="o">.</span><span class="n">omnipath</span>

        <span class="n">omnipath</span> <span class="o">=</span> <span class="n">reference_constraint</span><span class="p">(</span><span class="n">omnipath</span><span class="p">,</span> <span class="n">pathway_extra</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">)</span>
        <span class="n">omnipath</span> <span class="o">=</span> <span class="n">reference_constraint</span><span class="p">(</span><span class="n">omnipath</span><span class="p">,</span> <span class="n">kinase_substrate_extra</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
        <span class="n">omnipath</span> <span class="o">=</span> <span class="n">reference_constraint</span><span class="p">(</span><span class="n">omnipath</span><span class="p">,</span> <span class="n">ligand_receptor_extra</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">load_resources</span><span class="p">(</span><span class="n">omnipath</span><span class="p">,</span> <span class="n">exclude</span> <span class="o">=</span> <span class="n">exclude</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">kinase_substrate_extra</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_resources</span><span class="p">(</span><span class="n">network_resources</span><span class="o">.</span><span class="n">ptm_misc</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ligand_receptor_extra</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_resources</span><span class="p">(</span><span class="n">network_resources</span><span class="o">.</span><span class="n">ligand_receptor</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pathway_extra</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_resources</span><span class="p">(</span><span class="n">network_resources</span><span class="o">.</span><span class="n">pathway_noref</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">third_source_directions</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">remove_htp</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_htp</span><span class="p">(</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="n">htp_threshold</span><span class="p">,</span>
                <span class="n">keep_directed</span> <span class="o">=</span> <span class="n">keep_directed</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">keep_directed</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_undirected</span><span class="p">(</span><span class="n">min_refs</span> <span class="o">=</span> <span class="n">min_refs_undirected</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.remove_htp"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.remove_htp">[docs]</a>    <span class="k">def</span> <span class="nf">remove_htp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">keep_directed</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">htp_stats</span><span class="p">()</span>
        <span class="n">vcount_before</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()</span>
        <span class="n">ecount_before</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">()</span>
        <span class="n">htedgs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">e</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span>
                <span class="nb">set</span><span class="p">([</span><span class="n">r</span><span class="o">.</span><span class="n">pmid</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;references&#39;</span><span class="p">]])</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">htp</span><span class="p">[</span><span class="n">threshold</span><span class="p">][</span>
                    <span class="s1">&#39;htrefs&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">keep_directed</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span>
                                         <span class="o">.</span><span class="n">is_directed</span><span class="p">())</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">delete_edges</span><span class="p">(</span><span class="n">htedgs</span><span class="p">)</span>
        <span class="n">zerodeg</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">delete_vertices</span><span class="p">(</span><span class="n">zerodeg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;Interactions with only high-throughput references &#39;</span>
            <span class="s1">&#39;have been removed. </span><span class="si">%u</span><span class="s1"> interactions removed. &#39;</span>
            <span class="s1">&#39;Number of edges decreased from </span><span class="si">%u</span><span class="s1"> to </span><span class="si">%u</span><span class="s1">, &#39;</span>
            <span class="s1">&#39;number of vertices from </span><span class="si">%u</span><span class="s1"> to </span><span class="si">%u</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">htedgs</span><span class="p">),</span>
                <span class="n">ecount_before</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">(),</span>
                <span class="n">vcount_before</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.remove_undirected"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.remove_undirected">[docs]</a>    <span class="k">def</span> <span class="nf">remove_undirected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_refs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">vcount_before</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()</span>
        <span class="n">ecount_before</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">()</span>
        <span class="n">udedgs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">e</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">is_directed</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span><span class="n">min_refs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span>
                <span class="nb">set</span><span class="p">([</span><span class="n">r</span><span class="o">.</span><span class="n">pmid</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;references&#39;</span><span class="p">]]))</span> <span class="o">&lt;</span> <span class="n">min_refs</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">delete_edges</span><span class="p">(</span><span class="n">udedgs</span><span class="p">)</span>
        <span class="n">zerodeg</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">delete_vertices</span><span class="p">(</span><span class="n">zerodeg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;Undirected interactions </span><span class="si">%s</span><span class="s1"> have been removed. &#39;</span>
            <span class="s1">&#39;</span><span class="si">%u</span><span class="s1"> interactions removed. Number of edges &#39;</span>
            <span class="s1">&#39;decreased from </span><span class="si">%u</span><span class="s1"> to </span><span class="si">%u</span><span class="s1">, number of vertices &#39;</span>
            <span class="s1">&#39;from </span><span class="si">%u</span><span class="s1"> to </span><span class="si">%u</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="s1">&#39;&#39;</span>
                    <span class="k">if</span> <span class="n">min_refs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span>
                <span class="s1">&#39;with less than </span><span class="si">%u</span><span class="s1"> references&#39;</span> <span class="o">%</span> <span class="n">min_refs</span><span class="p">,</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">udedgs</span><span class="p">),</span>
                <span class="n">ecount_before</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">(),</span>
                <span class="n">vcount_before</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.numof_directed_edges"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.numof_directed_edges">[docs]</a>    <span class="k">def</span> <span class="nf">numof_directed_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">is_directed</span><span class="p">(),</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">)))</span></div>

<div class="viewcode-block" id="PyPath.numof_undirected_edges"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.numof_undirected_edges">[docs]</a>    <span class="k">def</span> <span class="nf">numof_undirected_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="ow">not</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">is_directed</span><span class="p">(),</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">)))</span></div>

<div class="viewcode-block" id="PyPath.htp_stats"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.htp_stats">[docs]</a>    <span class="k">def</span> <span class="nf">htp_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">htdata</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">refc</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span>
            <span class="n">common</span><span class="o">.</span><span class="n">flat_list</span><span class="p">((</span><span class="n">r</span><span class="o">.</span><span class="n">pmid</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;references&#39;</span><span class="p">])</span>
                            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">htlim</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">201</span><span class="p">)):</span>
            <span class="n">htrefs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">refc</span><span class="o">.</span><span class="n">most_common</span><span class="p">()</span> <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">htlim</span><span class="p">])</span>
            <span class="n">htedgs</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">e</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">r</span><span class="o">.</span><span class="n">pmid</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;references&#39;</span><span class="p">]])</span> <span class="o">-</span> <span class="n">htrefs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
            <span class="p">]</span>
            <span class="n">htsrcs</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">uniq_list</span><span class="p">(</span>
                <span class="n">common</span><span class="o">.</span><span class="n">flat_list</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;sources&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">htedgs</span><span class="p">]))</span>
            <span class="n">htdata</span><span class="p">[</span><span class="n">htlim</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rnum&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">htrefs</span><span class="p">),</span> <span class="s1">&#39;enum&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">htedgs</span><span class="p">),</span>
                             <span class="s1">&#39;snum&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">htsrcs</span><span class="p">),</span> <span class="s1">&#39;htrefs&#39;</span><span class="p">:</span> <span class="n">htrefs</span><span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">htp</span> <span class="o">=</span> <span class="n">htdata</span></div>

<div class="viewcode-block" id="PyPath.third_source_directions"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.third_source_directions">[docs]</a>    <span class="k">def</span> <span class="nf">third_source_directions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_string_effects</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">use_laudanna_data</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method calls a series of methods to get</span>
<span class="sd">        additional direction &amp; effect information</span>
<span class="sd">        from sources having no literature curated references,</span>
<span class="sd">        but giving sufficient evidence about the directionality</span>
<span class="sd">        for interactions already supported by literature</span>
<span class="sd">        evidences from other sources.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">use_string_effects</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">string_effects</span><span class="p">(</span><span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">kegg_directions</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">use_laudanna_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">laudanna_effects</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">laudanna_directions</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">wang_effects</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">acsn_effects</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phosphosite_directions</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phosphopoint_directions</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phosphonetworks_directions</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mimp_directions</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.kegg_directions"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.kegg_directions">[docs]</a>    <span class="k">def</span> <span class="nf">kegg_directions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">keggd</span> <span class="o">=</span> <span class="n">kegg_input</span><span class="o">.</span><span class="n">kegg_interactions</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_directions</span><span class="p">(</span><span class="n">keggd</span><span class="p">,</span> <span class="s1">&#39;KEGG&#39;</span><span class="p">,</span> <span class="n">stimulation</span><span class="o">=</span><span class="s1">&#39;activation&#39;</span><span class="p">,</span>
                                <span class="n">inhibition</span><span class="o">=</span><span class="s1">&#39;inhibition&#39;</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.phosphosite_directions"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.phosphosite_directions">[docs]</a>    <span class="k">def</span> <span class="nf">phosphosite_directions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">psite</span> <span class="o">=</span> <span class="n">phosphosite_input</span><span class="o">.</span><span class="n">phosphosite_directions</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_directions</span><span class="p">(</span><span class="n">psite</span><span class="p">,</span> <span class="s1">&#39;PhosphoSite_dir&#39;</span><span class="p">,</span> <span class="n">dirs_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">id_type</span><span class="o">=</span><span class="s1">&#39;uniprot&#39;</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.phosphopoint_directions"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.phosphopoint_directions">[docs]</a>    <span class="k">def</span> <span class="nf">phosphopoint_directions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ppoint</span> <span class="o">=</span> <span class="n">phosphopoint_input</span><span class="o">.</span><span class="n">phosphopoint_directions</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_directions</span><span class="p">(</span><span class="n">ppoint</span><span class="p">,</span> <span class="s1">&#39;PhosphoPoint&#39;</span><span class="p">,</span> <span class="n">dirs_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">id_type</span><span class="o">=</span><span class="s1">&#39;genesymbol&#39;</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.phosphonetworks_directions"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.phosphonetworks_directions">[docs]</a>    <span class="k">def</span> <span class="nf">phosphonetworks_directions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pnet</span> <span class="o">=</span> <span class="n">phosphonetworks_input</span><span class="o">.</span><span class="n">phosphonetworks_interactions</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_directions</span><span class="p">(</span><span class="n">pnet</span><span class="p">,</span> <span class="s1">&#39;PhosphoNetworks&#39;</span><span class="p">,</span> <span class="n">dirs_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">id_type</span><span class="o">=</span><span class="s1">&#39;genesymbol&#39;</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.mimp_directions"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.mimp_directions">[docs]</a>    <span class="k">def</span> <span class="nf">mimp_directions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">mimp</span> <span class="o">=</span> <span class="n">mimp_input</span><span class="o">.</span><span class="n">mimp_interactions</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_directions</span><span class="p">(</span><span class="n">mimp</span><span class="p">,</span> <span class="s1">&#39;MIMP&#39;</span><span class="p">,</span> <span class="n">dirs_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">id_type</span><span class="o">=</span><span class="s1">&#39;genesymbol&#39;</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.laudanna_directions"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.laudanna_directions">[docs]</a>    <span class="k">def</span> <span class="nf">laudanna_directions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">laud</span> <span class="o">=</span> <span class="n">laudanna_input</span><span class="o">.</span><span class="n">laudanna_directions</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_directions</span><span class="p">(</span><span class="n">laud</span><span class="p">,</span> <span class="s1">&#39;Laudanna_sigflow&#39;</span><span class="p">,</span> <span class="n">dirs_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">id_type</span><span class="o">=</span><span class="s1">&#39;genesymbol&#39;</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.laudanna_effects"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.laudanna_effects">[docs]</a>    <span class="k">def</span> <span class="nf">laudanna_effects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">laud</span> <span class="o">=</span> <span class="n">laudanna_input</span><span class="o">.</span><span class="n">laudanna_effects</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_directions</span><span class="p">(</span><span class="n">laud</span><span class="p">,</span> <span class="s1">&#39;Laudanna_effects&#39;</span><span class="p">,</span>
                                <span class="n">stimulation</span><span class="o">=</span><span class="s1">&#39;activation&#39;</span><span class="p">,</span>
                                <span class="n">inhibition</span><span class="o">=</span><span class="s1">&#39;inhibition&#39;</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="s1">&#39;docking&#39;</span><span class="p">,</span>
                                <span class="n">id_type</span><span class="o">=</span><span class="s1">&#39;genesymbol&#39;</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.string_effects"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.string_effects">[docs]</a>    <span class="k">def</span> <span class="nf">string_effects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">string</span> <span class="o">=</span> <span class="n">string_input</span><span class="o">.</span><span class="n">string_effects</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_directions</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="s1">&#39;STRING&#39;</span><span class="p">,</span> <span class="n">stimulation</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span>
                                <span class="n">inhibition</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">id_type</span><span class="o">=</span><span class="s1">&#39;ensp&#39;</span><span class="p">,</span>
                                <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.acsn_effects"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.acsn_effects">[docs]</a>    <span class="k">def</span> <span class="nf">acsn_effects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">acsnd</span> <span class="o">=</span> <span class="n">acsn_input</span><span class="o">.</span><span class="n">get_acsn_effects</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_directions</span><span class="p">(</span><span class="n">acsnd</span><span class="p">,</span> <span class="s1">&#39;ACSN&#39;</span><span class="p">,</span> <span class="n">stimulation</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">inhibition</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                                <span class="n">directed</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">id_type</span><span class="o">=</span><span class="s1">&#39;genesymbol&#39;</span><span class="p">,</span>
                                <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.wang_effects"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.wang_effects">[docs]</a>    <span class="k">def</span> <span class="nf">wang_effects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">wangd</span> <span class="o">=</span> <span class="n">wang_input</span><span class="o">.</span><span class="n">wang_interactions</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_directions</span><span class="p">(</span><span class="n">wangd</span><span class="p">,</span> <span class="s1">&#39;Wang&#39;</span><span class="p">,</span> <span class="n">stimulation</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">inhibition</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                                <span class="n">directed</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">id_type</span><span class="o">=</span><span class="s1">&#39;genesymbol&#39;</span><span class="p">,</span>
                                <span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyPath.process_directions"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.process_directions">[docs]</a>    <span class="k">def</span> <span class="nf">process_directions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stimulation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">inhibition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">id_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">dirs_only</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
        <span class="n">sourcedirs</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">newdirs</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">newsigns</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">dirs_only</span> <span class="ow">or</span> <span class="n">k</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">stimulation</span> <span class="ow">or</span> <span class="n">k</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">inhibition</span> <span class="ow">or</span> <span class="n">k</span><span class="p">[</span>
                    <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">directed</span><span class="p">:</span>
                <span class="n">src</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">if</span> <span class="n">id_type</span> <span class="ow">is</span> <span class="kc">None</span> \
                    <span class="k">else</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">id_type</span><span class="p">,</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>
                <span class="n">tgt</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">if</span> <span class="n">id_type</span> <span class="ow">is</span> <span class="kc">None</span> \
                    <span class="k">else</span> <span class="n">mapping</span><span class="o">.</span><span class="n">map_name</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">id_type</span><span class="p">,</span> <span class="s1">&#39;uniprot&#39;</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">src</span><span class="p">:</span>

                    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tgt</span><span class="p">:</span>

                        <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="ow">and</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
                            <span class="n">v1</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>
                            <span class="n">v2</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
                            <span class="n">e</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">get_eid</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                            <span class="k">if</span> <span class="n">e</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                                <span class="n">sourcedirs</span> <span class="o">+=</span> <span class="mi">1</span>

                                <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_dir</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)):</span>
                                    <span class="n">newdirs</span> <span class="o">+=</span> <span class="mi">1</span>

                                <span class="k">if</span> <span class="n">dirs_only</span> <span class="ow">or</span> <span class="n">k</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">directed</span><span class="p">:</span>
                                    <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_dir</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> <span class="n">name</span><span class="p">)</span>

                                <span class="k">elif</span> <span class="n">k</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">stimulation</span><span class="p">:</span>

                                    <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_sign</span><span class="p">(</span>
                                        <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> <span class="s1">&#39;positive&#39;</span><span class="p">):</span>
                                        <span class="n">newsigns</span> <span class="o">+=</span> <span class="mi">1</span>

                                    <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_sign</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span>
                                                             <span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

                                <span class="k">elif</span> <span class="n">k</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">inhibition</span><span class="p">:</span>

                                    <span class="k">if</span> <span class="ow">not</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_sign</span><span class="p">(</span>
                                        <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> <span class="s1">&#39;negative&#39;</span><span class="p">):</span>
                                        <span class="n">newsigns</span> <span class="o">+=</span> <span class="mi">1</span>

                                    <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_sign</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span>
                                                             <span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;Directions and signs set for </span><span class="si">%u</span><span class="s1"> edges based on </span><span class="si">%s</span><span class="s1">,&#39;</span>
            <span class="s1">&#39; </span><span class="si">%u</span><span class="s1"> new directions, </span><span class="si">%u</span><span class="s1"> new signs.&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">sourcedirs</span><span class="p">,</span>
                <span class="n">name</span><span class="p">,</span>
                <span class="n">newdirs</span><span class="p">,</span>
                <span class="n">newsigns</span>
            <span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.update_summaries"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.update_summaries">[docs]</a>    <span class="k">def</span> <span class="nf">update_summaries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a dict with many summarizing and comparative statistics</span>
<span class="sd">        about the resources in the current network.</span>
<span class="sd">        The result will be assigned to the attribute ``summaries``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">one_entity</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>

            <span class="n">key</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">method</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">label</span> <span class="ow">or</span> <span class="n">stats</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>

            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">ext</span><span class="p">,</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">(</span>
                <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;by_resource&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;unique&#39;</span><span class="p">,</span> <span class="s1">&#39;unique&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;shared&#39;</span><span class="p">,</span> <span class="s1">&#39;shared&#39;</span><span class="p">),</span>
                <span class="p">((</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="s1">&#39;[%]&#39;</span><span class="p">),</span> <span class="s1">&#39;percent&#39;</span><span class="p">),</span>
            <span class="p">):</span>

                <span class="n">key_sep</span><span class="p">,</span> <span class="n">lab_sep</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">ext</span> <span class="k">else</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">key_ext</span><span class="p">,</span> <span class="n">lab_ext</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">ext</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ext</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">ext</span><span class="p">,</span> <span class="n">ext</span><span class="p">)</span>
                <span class="p">)</span>

                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="s1">&#39;n_</span><span class="si">%s%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">key_sep</span><span class="p">,</span> <span class="n">key_ext</span><span class="p">),</span>
                        <span class="s1">&#39;</span><span class="si">%s%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">lab_sep</span><span class="p">,</span> <span class="n">lab_ext</span><span class="p">),</span>
                        <span class="nb">getattr</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">counts</span><span class="p">,</span> <span class="n">attr</span><span class="p">)[</span><span class="n">resource</span><span class="p">],</span>
                    <span class="p">)</span>
                <span class="p">)</span>

            <span class="k">return</span> <span class="n">result</span>


        <span class="n">summaries</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">summaries_labels</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">resources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span>
        <span class="n">references</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">references_stats</span><span class="p">()</span>
        <span class="n">entities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entities_stats</span><span class="p">()</span>
        <span class="n">interactions_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactions_all_stats</span><span class="p">()</span>
        <span class="n">interactions_undirected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactions_undirected_stats</span><span class="p">()</span>
        <span class="n">interactions_directed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactions_directed_stats</span><span class="p">()</span>
        <span class="n">interactions_signed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactions_signed_stats</span><span class="p">()</span>
        <span class="n">interactions_stimulatory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactions_stimulatory_stats</span><span class="p">()</span>
        <span class="n">interactions_inhibitory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactions_inhibitory_stats</span><span class="p">()</span>
        <span class="n">interactions_mutual</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactions_mutual_stats</span><span class="p">()</span>
        <span class="n">curation_effort</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">curation_effort_stats</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">resource</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="n">resources</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;Total&#39;</span><span class="p">,)):</span>

            <span class="n">summaries</span><span class="p">[</span><span class="n">resource</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;Resource&#39;</span><span class="p">,</span> <span class="n">resource</span><span class="p">),</span>
            <span class="p">]</span>

            <span class="k">for</span> <span class="n">stats</span> <span class="ow">in</span> <span class="p">(</span>
                <span class="n">entities</span><span class="p">,</span>
                <span class="n">interactions_all</span><span class="p">,</span>
                <span class="n">interactions_undirected</span><span class="p">,</span>
                <span class="n">interactions_directed</span><span class="p">,</span>
                <span class="n">interactions_signed</span><span class="p">,</span>
                <span class="n">interactions_stimulatory</span><span class="p">,</span>
                <span class="n">interactions_inhibitory</span><span class="p">,</span>
                <span class="n">interactions_mutual</span><span class="p">,</span>
                <span class="n">references</span><span class="p">,</span>
                <span class="n">curation_effort</span><span class="p">,</span>
            <span class="p">):</span>

                <span class="n">summaries</span><span class="p">[</span><span class="n">resource</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                    <span class="n">one_entity</span><span class="p">(</span>
                        <span class="n">stats</span> <span class="o">=</span> <span class="n">stats</span><span class="p">,</span>
                        <span class="n">resource</span> <span class="o">=</span> <span class="n">resource</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>

            <span class="n">summaries_labels</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">summaries_labels</span> <span class="ow">or</span>
                <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">summaries</span><span class="p">[</span><span class="n">resource</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="p">)</span>

            <span class="n">summaries</span><span class="p">[</span><span class="n">resource</span><span class="p">]</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">(</span>
                <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">summaries</span><span class="p">[</span><span class="n">resource</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">summaries</span> <span class="o">=</span> <span class="n">summaries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">summaries_labels</span> <span class="o">=</span> <span class="n">summaries_labels</span></div>


<div class="viewcode-block" id="PyPath.mean_reference_per_interaction"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.mean_reference_per_interaction">[docs]</a>    <span class="k">def</span> <span class="nf">mean_reference_per_interaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the mean number of references per interaction of the</span>
<span class="sd">        network.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*float*) -- Mean number of interactions per edge.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">numof_references</span><span class="p">(</span><span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">)</span> <span class="o">/</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">numof_edges</span><span class="p">(</span><span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.mean_reference_per_interaction_by_resource"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.mean_reference_per_interaction_by_resource">[docs]</a>    <span class="k">def</span> <span class="nf">mean_reference_per_interaction_by_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the mean number of references per interaction of the</span>
<span class="sd">        network.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*float*) -- Mean number of interactions per edge.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_resource</span><span class="p">(</span>
            <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_reference_per_interaction</span><span class="p">,</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.numof_edges"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.numof_edges">[docs]</a>    <span class="k">def</span> <span class="nf">numof_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of edges optionally limited to certain resources.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter_edges</span><span class="p">(</span><span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">)))</span></div>


<div class="viewcode-block" id="PyPath.iter_edges"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.iter_edges">[docs]</a>    <span class="k">def</span> <span class="nf">iter_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterates the edges in the graph optionally limited to certain</span>
<span class="sd">        resources. Yields ``igraph.Edge`` objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">resources</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">to_set</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">resources</span> <span class="ow">or</span> <span class="n">resources</span> <span class="o">&amp;</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]:</span>

                <span class="k">yield</span> <span class="n">e</span></div>


<div class="viewcode-block" id="PyPath.numof_reference_interaction_pairs"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.numof_reference_interaction_pairs">[docs]</a>    <span class="k">def</span> <span class="nf">numof_reference_interaction_pairs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># XXX: Not really sure about this one</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the total of unique references per interaction.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*int*) -- Total number of unique references per</span>
<span class="sd">            interaction.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">uniq_list</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">flat_list</span><span class="p">(</span>
            <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span>
                     <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span>
                              <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">r</span><span class="p">),</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;references&#39;</span><span class="p">])),</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">)))))</span></div>


<div class="viewcode-block" id="PyPath.curators_work"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.curators_work">[docs]</a>    <span class="k">def</span> <span class="nf">curators_work</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes and prints an estimation of how many years of curation</span>
<span class="sd">        took to achieve the amount of information on the network.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">curation_effort</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">numof_reference_interaction_pairs</span><span class="p">()</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">:: Curators worked </span><span class="si">%.01f</span><span class="s1">-</span><span class="si">%.01f</span><span class="s1"> years to accomplish &#39;</span>
            <span class="s1">&#39;what currently you have incorporated in this network!&#39;</span>
            <span class="s1">&#39;</span><span class="se">\n\n\t</span><span class="s1">Amazing, isn</span><span class="se">\&#39;</span><span class="s1">t it?</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>
            <span class="p">(</span><span class="n">curation_effort</span> <span class="o">*</span> <span class="mi">15</span> <span class="o">/</span> <span class="mf">60.0</span> <span class="o">/</span> <span class="mf">2087.0</span><span class="p">,</span>
             <span class="n">curation_effort</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">/</span> <span class="mf">60.0</span> <span class="o">/</span> <span class="mf">2087.0</span><span class="p">))</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyPath.reference_edge_ratio"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.reference_edge_ratio">[docs]</a>    <span class="k">def</span> <span class="nf">reference_edge_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the average number of references per edge (as in the</span>
<span class="sd">        undirected graph).</span>

<span class="sd">        :return:</span>
<span class="sd">            (*float*) -- Average number of references per edge.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">numof_references</span><span class="p">()</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">())</span></div>


    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_remove_cp</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">resources</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes the *CellPhoneDB* derived resources from a set in order</span>
<span class="sd">        to avoid them to be compared as they were primary resources.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_remove_by_label</span><span class="p">(</span><span class="n">resources</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;CP&#39;</span><span class="p">})</span>


    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_remove_by_label</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="n">elem</span>
            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">elements</span>
            <span class="k">if</span> <span class="nb">next</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)))</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">labels</span>
        <span class="p">}</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">resources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        All network resources. Returns *set* of strings.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_remove_cp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_collect_across_edges</span><span class="p">(</span><span class="s1">&#39;sources&#39;</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">_collect_across_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        For a *set* type edge attribute ``attr`` collects the elements</span>
<span class="sd">        across all edges.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">attr</span><span class="p">]))</span>


    <span class="k">def</span> <span class="nf">_by_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calls a method for each resource (by default for all resources).</span>
<span class="sd">        Returns dict with resources as keys and the output of the method</span>
<span class="sd">        as values.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">resources</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">to_set</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span>
        <span class="n">method</span> <span class="o">=</span> <span class="n">method</span> <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">method</span><span class="p">)</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">resource</span><span class="p">,</span>
                <span class="n">method</span><span class="p">(</span><span class="n">resources</span> <span class="o">=</span> <span class="n">resource</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">resource</span> <span class="ow">in</span> <span class="n">resources</span>
        <span class="p">)</span>


    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">resources_by_category</span><span class="p">():</span>

        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">label</span><span class="p">,</span>
                <span class="p">{</span>
                    <span class="n">resource</span>
                    <span class="k">for</span> <span class="n">resource</span><span class="p">,</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">db_categories</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">cat</span> <span class="o">==</span> <span class="n">letter</span>
                <span class="p">}</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">db_categories</span><span class="o">.</span><span class="n">catletters</span><span class="p">)</span>
        <span class="p">)</span>


    <span class="k">def</span> <span class="nf">_by_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="n">cat_res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources_by_category</span><span class="p">()</span>
        <span class="n">method</span> <span class="o">=</span> <span class="n">method</span> <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">method</span><span class="p">)</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">db_categories</span><span class="o">.</span><span class="n">catletters</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">cat_res</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="p">:</span>

                <span class="k">continue</span>

            <span class="n">entities</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">resources</span> <span class="o">=</span> <span class="n">cat_res</span><span class="p">[</span><span class="n">cat</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">entities</span><span class="p">:</span>

                <span class="n">result</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="n">entities</span>

        <span class="k">return</span> <span class="n">result</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">all_references</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collect_across_edges</span><span class="p">(</span><span class="s1">&#39;references&#39;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">numof_references</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Counts the number of reference on the network.</span>

<span class="sd">        Counts the total number of unique references in the edges of the</span>
<span class="sd">        network.</span>

<span class="sd">        resources : None,str,set</span>
<span class="sd">            Limits the query to one or more resources.</span>

<span class="sd">        :return:</span>
<span class="sd">            (*int*) -- Number of unique references in the network.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">references</span><span class="p">(</span><span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">))</span>


<div class="viewcode-block" id="PyPath.references"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.references">[docs]</a>    <span class="k">def</span> <span class="nf">references</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a set of references for all edges.</span>

<span class="sd">        resources : None,str,set</span>
<span class="sd">            Limits the query to one or more resources.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">resources</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">to_set</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="p">(</span>
            <span class="n">refs</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span>
            <span class="k">for</span> <span class="n">res</span><span class="p">,</span> <span class="n">refs</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;refs_by_source&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">resources</span> <span class="ow">or</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">resources</span>
        <span class="p">))</span></div>


    <span class="k">def</span> <span class="nf">numof_references</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">references</span><span class="p">(</span><span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">))</span>


<div class="viewcode-block" id="PyPath.references_by_resource"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.references_by_resource">[docs]</a>    <span class="k">def</span> <span class="nf">references_by_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a dict with resources as keys and sets of references</span>
<span class="sd">        as values.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">references</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">references_by_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_category</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">references</span><span class="p">)</span>


<div class="viewcode-block" id="PyPath.numof_references_by_resource"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.numof_references_by_resource">[docs]</a>    <span class="k">def</span> <span class="nf">numof_references_by_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Counts the references for each resource, optionally limited</span>
<span class="sd">        to certain resources.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numof_references</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">numof_references_by_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_category</span><span class="p">(</span><span class="n">selsf</span><span class="o">.</span><span class="n">numof_references</span><span class="p">)</span>


<div class="viewcode-block" id="PyPath.curation_effort"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.curation_effort">[docs]</a>    <span class="k">def</span> <span class="nf">curation_effort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a *set* of reference-interactions pairs.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">resources</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">to_set</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodNam</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodNam</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span>
            <span class="k">for</span> <span class="n">resource</span><span class="p">,</span> <span class="n">refs</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;refs_by_source&#39;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">refs</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">resources</span> <span class="ow">or</span> <span class="n">resource</span> <span class="ow">in</span> <span class="n">resources</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="PyPath.curation_effort_by_resource"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.curation_effort_by_resource">[docs]</a>    <span class="k">def</span> <span class="nf">curation_effort_by_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A *dict* with resources as keys and *set*s of curation items</span>
<span class="sd">        (interaction-reference pairs) as values.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_resource</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">curation_effort</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">curation_effort_by_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_category</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">curation_effort</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">iter_vertices</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">categories</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">entity_type</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">):</span>
            
            <span class="k">for</span> <span class="n">_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_entities</span><span class="p">(</span>
                <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
                <span class="n">categories</span> <span class="o">=</span> <span class="n">categories</span><span class="p">,</span>
                <span class="n">entity_type</span> <span class="o">=</span> <span class="n">entity_type</span><span class="p">,</span>
            <span class="p">):</span>
                
                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">_id</span><span class="p">])</span>


    <span class="k">def</span> <span class="nf">iter_entities</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">categories</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">entity_type</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterates nodes optionally only for certain resources. Yields</span>
<span class="sd">        ``igraph.Vertex`` objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">resources</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">to_set</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">to_set</span><span class="p">(</span><span class="n">categories</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">iattr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;attrs&#39;</span><span class="p">]:</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="p">(</span>
                    <span class="ow">not</span> <span class="n">resources</span> <span class="ow">or</span>
                    <span class="n">iattr</span><span class="o">.</span><span class="n">evidences</span> <span class="o">&amp;</span> <span class="n">resources</span>
                <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="ow">not</span> <span class="n">categories</span> <span class="ow">or</span>
                    <span class="n">iattr</span><span class="o">.</span><span class="n">data_models</span> <span class="o">%</span> <span class="n">categories</span>
                <span class="p">)</span>
            <span class="p">):</span>
                
                <span class="k">if</span> <span class="p">(</span>
                    <span class="ow">not</span> <span class="n">entity_type</span> <span class="ow">or</span>
                    <span class="n">iattr</span><span class="o">.</span><span class="n">entity_type_a</span> <span class="o">==</span> <span class="n">entity_type</span>
                <span class="p">):</span>
                    
                    <span class="k">yield</span> <span class="n">iattr_id_a</span>
                
                <span class="k">if</span> <span class="p">(</span>
                    <span class="ow">not</span> <span class="n">entity_type</span> <span class="ow">or</span>
                    <span class="n">iattr</span><span class="o">.</span><span class="n">entity_type_b</span> <span class="o">==</span> <span class="n">entity_type</span>
                <span class="p">):</span>
                    
                    <span class="k">yield</span> <span class="n">iattr_id_b</span>


    <span class="k">def</span> <span class="nf">iter_entities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_vertices</span><span class="p">(</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
            <span class="n">entity_type</span> <span class="o">=</span> <span class="n">entity_type</span><span class="p">,</span>
        <span class="p">):</span>

            <span class="k">yield</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>


    <span class="k">def</span> <span class="nf">entities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iter_entities</span><span class="p">(</span>
                <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
                <span class="n">entity_type</span> <span class="o">=</span> <span class="n">entity_type</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>


<div class="viewcode-block" id="PyPath.entities_by_resource"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.entities_by_resource">[docs]</a>    <span class="k">def</span> <span class="nf">entities_by_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">entity_type</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a *dict* of *set*s with resources as keys and sets of</span>
<span class="sd">        entities as values.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_resource</span><span class="p">(</span>
            <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entities</span><span class="p">,</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
            <span class="n">entity_type</span> <span class="o">=</span> <span class="n">entity_type</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">entities_by_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_category</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entities</span><span class="p">,</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="n">entity_type</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">protein_entities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">entities</span><span class="p">(</span><span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;protein&#39;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">protein_entities_by_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">entities_by_resource</span><span class="p">(</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
            <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;protein&#39;</span><span class="p">,</span>
        <span class="p">)</span>


    <span class="k">def</span> <span class="nf">protein_entities_by_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">entities_by_category</span><span class="p">(</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
            <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;protein&#39;</span><span class="p">,</span>
        <span class="p">)</span>


    <span class="k">def</span> <span class="nf">mirna_entities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">entities</span><span class="p">(</span><span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;mirna&#39;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">mirna_entities_by_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">entities_by_resource</span><span class="p">(</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
            <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;mirna&#39;</span><span class="p">,</span>
        <span class="p">)</span>


    <span class="k">def</span> <span class="nf">mirna_entities_by_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">entities_by_category</span><span class="p">(</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
            <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;mirna&#39;</span><span class="p">,</span>
        <span class="p">)</span>


    <span class="k">def</span> <span class="nf">complex_entities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">entities</span><span class="p">(</span><span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;complex&#39;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">complex_entities_by_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">entities_by_resource</span><span class="p">(</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
            <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;complex&#39;</span><span class="p">,</span>
        <span class="p">)</span>


    <span class="k">def</span> <span class="nf">complex_entities_by_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">entities_by_category</span><span class="p">(</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
            <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;complex&#39;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># interactions undirected</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="PyPath.interactions_undirected"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.interactions_undirected">[docs]</a>    <span class="k">def</span> <span class="nf">interactions_undirected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a *set* of tuples of node name pairs without being aware</span>
<span class="sd">        of the directions.</span>
<span class="sd">        Pairs of node names will be sorted alphabetically.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">resources</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">to_set</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nodNam</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nodNam</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="p">))</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="ow">not</span> <span class="n">resources</span> <span class="ow">and</span>
                <span class="ow">not</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">is_directed</span><span class="p">()</span>
            <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;undirected&#39;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">resources</span>
            <span class="p">)</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="PyPath.interactions_undirected_by_resource"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.interactions_undirected_by_resource">[docs]</a>    <span class="k">def</span> <span class="nf">interactions_undirected_by_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a *dict* of *set*s of tuples of node name pairs without</span>
<span class="sd">        being aware of the directions.</span>
<span class="sd">        Pairs of node names will be sorted alphabetically.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_resource</span><span class="p">(</span>
            <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactions_undirected</span><span class="p">,</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">interactions_undirected_by_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_category</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interactions_undirected</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># interactions directed</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="PyPath.interactions_directed"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.interactions_directed">[docs]</a>    <span class="k">def</span> <span class="nf">interactions_directed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a *set* of tuples of node name pairs with being aware</span>
<span class="sd">        of the directions.</span>
<span class="sd">        Undirected interactions will be discarded.</span>
<span class="sd">        Pairs of node names represent the directions: first is the source,</span>
<span class="sd">        second is the target.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interactions_directed</span><span class="p">(</span><span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.interactions_directed_by_resource"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.interactions_directed_by_resource">[docs]</a>    <span class="k">def</span> <span class="nf">interactions_directed_by_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">effect</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a *dict* of *set*s of tuples of node name pairs with being</span>
<span class="sd">        aware of the directions.</span>
<span class="sd">        Undirected interactions will be discarded.</span>
<span class="sd">        Pairs of node names represent the directions: first is the source,</span>
<span class="sd">        second is the target.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_resource</span><span class="p">(</span>
            <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interactions_directed</span><span class="p">,</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
            <span class="n">effect</span> <span class="o">=</span> <span class="n">effect</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">interactions_directed_by_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">effect</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_category</span><span class="p">(</span>
            <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interactions_directed</span><span class="p">,</span>
            <span class="n">effect</span> <span class="o">=</span> <span class="n">effect</span><span class="p">,</span>
        <span class="p">)</span>


    <span class="k">def</span> <span class="nf">_interactions_directed</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">effect</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">):</span>

        <span class="n">resources</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">to_set</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span>
        <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;which_directions&#39;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">effect</span> <span class="k">else</span> <span class="s1">&#39;which_signs&#39;</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">effect</span> <span class="k">else</span> <span class="p">{</span><span class="s1">&#39;effect&#39;</span><span class="p">:</span> <span class="n">effect</span><span class="p">}</span>

        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span>
            <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="p">(</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">],</span> <span class="n">method</span><span class="p">)(</span><span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span>
            <span class="p">)</span>
        <span class="p">))</span>


    <span class="c1">#</span>
    <span class="c1"># interactions signed</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="PyPath.interactions_signed"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.interactions_signed">[docs]</a>    <span class="k">def</span> <span class="nf">interactions_signed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a *set* of tuples of node name pairs only for signed</span>
<span class="sd">        interactions.</span>
<span class="sd">        Pairs of node names represent the directions: first is the source,</span>
<span class="sd">        second is the target.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interactions_directed</span><span class="p">(</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
            <span class="n">effect</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.interactions_signed_by_resource"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.interactions_signed_by_resource">[docs]</a>    <span class="k">def</span> <span class="nf">interactions_signed_by_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a *dict* of *set*s of tuples of node name pairs with being</span>
<span class="sd">        aware of the directions.</span>
<span class="sd">        Undirected interactions will be discarded.</span>
<span class="sd">        Pairs of node names represent the directions: first is the source,</span>
<span class="sd">        second is the target.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_resource</span><span class="p">(</span>
            <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interactions_directed</span><span class="p">,</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
            <span class="n">effect</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">interactions_signed_by_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactions_directed_by_category</span><span class="p">(</span><span class="n">effect</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>


    <span class="c1">#</span>
    <span class="c1"># interactions stimulatory</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="PyPath.interactions_stimulatory"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.interactions_stimulatory">[docs]</a>    <span class="k">def</span> <span class="nf">interactions_stimulatory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a *set* of tuples of node name pairs only for stimulatory</span>
<span class="sd">        interactions.</span>
<span class="sd">        Pairs of node names represent the directions: first is the source,</span>
<span class="sd">        second is the target.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interactions_directed</span><span class="p">(</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
            <span class="n">effect</span> <span class="o">=</span> <span class="s1">&#39;stimulation&#39;</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.interactions_stimulatory_by_resource"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.interactions_stimulatory_by_resource">[docs]</a>    <span class="k">def</span> <span class="nf">interactions_stimulatory_by_resource</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a *dict* of *set*s of tuples of node name pairs with being</span>
<span class="sd">        aware of the directions.</span>
<span class="sd">        Undirected interactions will be discarded.</span>
<span class="sd">        Pairs of node names represent the directions: first is the source,</span>
<span class="sd">        second is the target.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_resource</span><span class="p">(</span>
            <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interactions_directed</span><span class="p">,</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
            <span class="n">effect</span> <span class="o">=</span> <span class="s1">&#39;stimulation&#39;</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">interactions_stimulatory_by_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactions_directed_by_category</span><span class="p">(</span><span class="n">effect</span> <span class="o">=</span> <span class="s1">&#39;stimulation&#39;</span><span class="p">)</span>


    <span class="c1">#</span>
    <span class="c1"># interactions inhibitory</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="PyPath.interactions_inhibitory"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.interactions_inhibitory">[docs]</a>    <span class="k">def</span> <span class="nf">interactions_inhibitory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a *set* of tuples of node name pairs only for inhibitory</span>
<span class="sd">        interactions.</span>
<span class="sd">        Pairs of node names represent the directions: first is the source,</span>
<span class="sd">        second is the target.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interactions_directed</span><span class="p">(</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
            <span class="n">effect</span> <span class="o">=</span> <span class="s1">&#39;inhibition&#39;</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.interactions_inhibitory_by_resource"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.interactions_inhibitory_by_resource">[docs]</a>    <span class="k">def</span> <span class="nf">interactions_inhibitory_by_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a *dict* of *set*s of tuples of node name pairs with being</span>
<span class="sd">        aware of the directions.</span>
<span class="sd">        Undirected interactions will be discarded.</span>
<span class="sd">        Pairs of node names represent the directions: first is the source,</span>
<span class="sd">        second is the target.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_resource</span><span class="p">(</span>
            <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interactions_directed</span><span class="p">,</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
            <span class="n">effect</span> <span class="o">=</span> <span class="s1">&#39;inhibition&#39;</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">interactions_inhibitory_by_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactions_directed_by_category</span><span class="p">(</span><span class="n">effect</span> <span class="o">=</span> <span class="s1">&#39;inhibition&#39;</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># interactions mutual</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="PyPath.interactions_mutual"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.interactions_mutual">[docs]</a>    <span class="k">def</span> <span class="nf">interactions_mutual</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a *set* of tuples of node name pairs representing</span>
<span class="sd">        mutual interactions (i.e. A--&gt;B and B--&gt;A).</span>
<span class="sd">        Pairs of node names will be sorted alphabetically.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="nb">tuple</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span>
            <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">is_mutual</span><span class="p">(</span><span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">)</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="PyPath.interactions_mutual_by_resource"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.interactions_mutual_by_resource">[docs]</a>    <span class="k">def</span> <span class="nf">interactions_mutual_by_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a *dict* of *set*s of tuples of node name pairs representing</span>
<span class="sd">        mutual interactions (i.e. A--&gt;B and B--&gt;A).</span>
<span class="sd">        Pairs of node names will be sorted alphabetically.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_resource</span><span class="p">(</span>
            <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactions_mutual</span><span class="p">,</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">interactions_mutual_by_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_category</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interactions_mutual</span><span class="p">)</span>


<div class="viewcode-block" id="PyPath.interactions_all"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.interactions_all">[docs]</a>    <span class="k">def</span> <span class="nf">interactions_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a *set* of tuples of node name pairs representing</span>
<span class="sd">        interactions, both directed and undirected. Directed interactions</span>
<span class="sd">        will be present according to their direction, mutual directed</span>
<span class="sd">        interactions are represented by two tuples. The directed and</span>
<span class="sd">        undirected interactions are not distinguished here.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">interactions_undirected</span><span class="p">(</span><span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">|</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">interactions_directed</span><span class="p">(</span><span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">interactions_all_by_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_resource</span><span class="p">(</span>
            <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactions_all</span><span class="p">,</span>
            <span class="n">resources</span> <span class="o">=</span> <span class="n">resources</span><span class="p">,</span>
        <span class="p">)</span>


    <span class="k">def</span> <span class="nf">interactions_all_by_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_by_category</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactions_all</span><span class="p">)</span>


    <span class="c1">#</span>
    <span class="c1"># methods for collecting and counting entities</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="PyPath.collect"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.collect">[docs]</a>    <span class="k">def</span> <span class="nf">collect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Collects various entities over the network according to ``method``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">cat_shared_unique</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>

            <span class="k">return</span> <span class="p">(</span>
                <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span>
                        <span class="o">*</span><span class="p">(</span>
                            <span class="n">iteritems</span><span class="p">(</span>
                                <span class="nb">getattr</span><span class="p">(</span>
                                    <span class="n">common</span><span class="p">,</span>
                                    <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_foreach&#39;</span> <span class="o">%</span> <span class="n">method</span>
                                <span class="p">)(</span>
                                    <span class="nb">dict</span><span class="p">(</span>
                                        <span class="p">(</span>
                                            <span class="n">resource</span><span class="p">,</span>
                                            <span class="n">entities</span>
                                        <span class="p">)</span>
                                        <span class="k">for</span> <span class="n">resource</span><span class="p">,</span> <span class="n">entities</span>
                                        <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">by_resource</span><span class="p">)</span>
                                        <span class="k">if</span> <span class="n">resource</span> <span class="ow">in</span> <span class="n">resources</span>
                                    <span class="p">)</span>
                                <span class="p">)</span>
                            <span class="p">)</span>
                            <span class="k">for</span> <span class="n">cat</span><span class="p">,</span> <span class="n">resources</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">cat_resource</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">resources</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Collecting `</span><span class="si">%s</span><span class="s1">`.&#39;</span> <span class="o">%</span> <span class="n">method</span><span class="p">)</span>

        <span class="n">total</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">)(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">by_resource</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_by_resource&#39;</span> <span class="o">%</span> <span class="n">method</span><span class="p">)(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">by_category</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_by_category&#39;</span> <span class="o">%</span> <span class="n">method</span><span class="p">)(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">shared</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">shared_foreach</span><span class="p">(</span><span class="n">by_resource</span><span class="p">)</span>
        <span class="n">unique</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">unique_foreach</span><span class="p">(</span><span class="n">by_resource</span><span class="p">)</span>

        <span class="n">cat_resource</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">cat</span><span class="p">,</span>
                <span class="p">{</span>
                    <span class="n">resource</span>
                    <span class="k">for</span> <span class="n">resource</span> <span class="ow">in</span> <span class="n">by_resource</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">cat</span> <span class="ow">in</span> <span class="p">{</span>
                        <span class="n">db_categories</span><span class="o">.</span><span class="n">catnames</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
                        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">db_categories</span><span class="o">.</span><span class="n">get_categories</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">cat</span><span class="p">,</span> <span class="n">resources</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">by_category</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">resources</span>
        <span class="p">)</span>
        <span class="n">resource_cat</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">swap_dict</span><span class="p">(</span><span class="n">cat_resource</span><span class="p">)</span>

        <span class="n">shared_res_cat</span> <span class="o">=</span> <span class="n">cat_shared_unique</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;shared&#39;</span><span class="p">)</span>
        <span class="n">unique_res_cat</span> <span class="o">=</span> <span class="n">cat_shared_unique</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;unique&#39;</span><span class="p">)</span>

        <span class="n">shared_cat</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">shared_foreach</span><span class="p">(</span><span class="n">by_category</span><span class="p">)</span>
        <span class="n">unique_cat</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">shared_foreach</span><span class="p">(</span><span class="n">by_category</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">NetworkEntityCollection</span><span class="p">(</span>
            <span class="n">total</span> <span class="o">=</span> <span class="n">total</span><span class="p">,</span>
            <span class="n">by_resource</span> <span class="o">=</span> <span class="n">by_resource</span><span class="p">,</span>
            <span class="n">by_category</span>  <span class="o">=</span> <span class="n">by_category</span><span class="p">,</span>
            <span class="n">shared</span> <span class="o">=</span> <span class="n">shared</span><span class="p">,</span>
            <span class="n">unique</span> <span class="o">=</span> <span class="n">unique</span><span class="p">,</span>
            <span class="n">shared_res_cat</span> <span class="o">=</span> <span class="n">shared_res_cat</span><span class="p">,</span>
            <span class="n">unique_res_cat</span> <span class="o">=</span> <span class="n">unique_res_cat</span><span class="p">,</span>
            <span class="n">shared_cat</span> <span class="o">=</span> <span class="n">shared_cat</span><span class="p">,</span>
            <span class="n">unique_cat</span> <span class="o">=</span> <span class="n">unique_cat</span><span class="p">,</span>
            <span class="n">resource_cat</span> <span class="o">=</span> <span class="n">resource_cat</span><span class="p">,</span>
            <span class="n">cat_resource</span> <span class="o">=</span> <span class="n">cat_resource</span><span class="p">,</span>
            <span class="n">method</span> <span class="o">=</span> <span class="n">method</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.counts"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.counts">[docs]</a>    <span class="k">def</span> <span class="nf">counts</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">collection_method</span><span class="p">,</span>
            <span class="n">add_total</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">add_percent</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">add_cat_total</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Collects various entities over the network according to ``method``</span>
<span class="sd">        and counts them in total and by resources.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">coll</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">collection_method</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
                    <span class="n">collection_method</span><span class="p">,</span>
                    <span class="n">NetworkEntityCollection</span>
                <span class="p">)</span> <span class="k">else</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="n">collection_method</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Counting `</span><span class="si">%s</span><span class="s1">`.&#39;</span> <span class="o">%</span> <span class="n">coll</span><span class="o">.</span><span class="n">method</span><span class="p">)</span>

        <span class="n">n_total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">coll</span><span class="o">.</span><span class="n">total</span><span class="p">)</span>
        <span class="n">n_by_resource</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">dict_counts</span><span class="p">(</span><span class="n">coll</span><span class="o">.</span><span class="n">by_resource</span><span class="p">)</span>
        <span class="n">n_by_category</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">dict_counts</span><span class="p">(</span><span class="n">coll</span><span class="o">.</span><span class="n">by_category</span><span class="p">)</span>
        <span class="n">n_shared</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">dict_counts</span><span class="p">(</span><span class="n">coll</span><span class="o">.</span><span class="n">shared</span><span class="p">)</span>
        <span class="n">n_unique</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">dict_counts</span><span class="p">(</span><span class="n">coll</span><span class="o">.</span><span class="n">unique</span><span class="p">)</span>
        <span class="n">_percent</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">common</span><span class="o">.</span><span class="n">dict_percent</span><span class="p">(</span><span class="n">n_by_resource</span><span class="p">,</span> <span class="n">n_total</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">add_percent</span> <span class="k">else</span>
            <span class="kc">None</span>
        <span class="p">)</span>
        <span class="n">n_shared_res_cat</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">dict_counts</span><span class="p">(</span><span class="n">coll</span><span class="o">.</span><span class="n">shared_res_cat</span><span class="p">)</span>
        <span class="n">n_unique_res_cat</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">dict_counts</span><span class="p">(</span><span class="n">coll</span><span class="o">.</span><span class="n">unique_res_cat</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">resource</span> <span class="ow">in</span> <span class="n">coll</span><span class="o">.</span><span class="n">by_resource</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">db_categories</span><span class="o">.</span><span class="n">get_category</span><span class="p">(</span><span class="n">resource</span><span class="p">):</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Category not known for resource `</span><span class="si">%s</span><span class="s1">`.&#39;</span> <span class="o">%</span> <span class="n">resource</span><span class="p">)</span>

        <span class="n">percent_res_cat</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">resource</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">n_by_resource</span><span class="p">[</span><span class="n">resource</span><span class="p">]</span> <span class="o">/</span>
                    <span class="n">n_by_category</span><span class="p">[</span>
                        <span class="n">db_categories</span><span class="o">.</span><span class="n">catnames</span><span class="p">[</span>
                            <span class="n">db_categories</span><span class="o">.</span><span class="n">get_category</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
                        <span class="p">]</span>
                    <span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
                        <span class="k">if</span> <span class="n">n_by_resource</span><span class="p">[</span><span class="n">resource</span><span class="p">]</span> <span class="k">else</span>
                    <span class="mf">.0</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">resource</span> <span class="ow">in</span> <span class="n">coll</span><span class="o">.</span><span class="n">by_resource</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">n_shared_cat</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">dict_counts</span><span class="p">(</span><span class="n">coll</span><span class="o">.</span><span class="n">shared_cat</span><span class="p">)</span>
        <span class="n">n_unique_cat</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">dict_counts</span><span class="p">(</span><span class="n">coll</span><span class="o">.</span><span class="n">shared_cat</span><span class="p">)</span>
        <span class="n">percent_cat</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">common</span><span class="o">.</span><span class="n">dict_percent</span><span class="p">(</span><span class="n">n_by_category</span><span class="p">,</span> <span class="n">n_total</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">add_percent</span> <span class="k">else</span>
            <span class="kc">None</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">add_total</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">_percent</span><span class="p">:</span>

                <span class="n">_percent</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">100.</span>

            <span class="n">n_by_resource</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_total</span>
            <span class="n">n_shared</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">n_shared_total</span><span class="p">(</span><span class="n">coll</span><span class="o">.</span><span class="n">by_resource</span><span class="p">)</span>
            <span class="n">n_unique</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">n_unique_total</span><span class="p">(</span><span class="n">coll</span><span class="o">.</span><span class="n">by_resource</span><span class="p">)</span>
            <span class="n">n_shared_res_cat</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">common</span><span class="o">.</span><span class="n">n_shared_total</span><span class="p">(</span><span class="n">coll</span><span class="o">.</span><span class="n">by_category</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">n_unique_res_cat</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">common</span><span class="o">.</span><span class="n">n_unique_total</span><span class="p">(</span><span class="n">coll</span><span class="o">.</span><span class="n">by_category</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">percent_res_cat</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">100.</span>

        <span class="k">if</span> <span class="n">add_cat_total</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">n_by_category</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

                <span class="n">n_by_resource</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_by_category</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span>
                <span class="n">n_shared</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_shared_cat</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span>
                <span class="n">n_unique</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_unique_cat</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span>
                <span class="n">_percent</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="n">percent_cat</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span>

                <span class="n">this_cat_by_resource</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">it</span>
                    <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">coll</span><span class="o">.</span><span class="n">by_resource</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">it</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">coll</span><span class="o">.</span><span class="n">cat_resource</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span>
                <span class="p">)</span>

                <span class="n">n_shared_res_cat</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">n_shared_total</span><span class="p">(</span>
                    <span class="n">this_cat_by_resource</span>
                <span class="p">)</span>
                <span class="n">n_unique_res_cat</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">n_unique_total</span><span class="p">(</span>
                    <span class="n">this_cat_by_resource</span>
                <span class="p">)</span>

                <span class="n">coll</span><span class="o">.</span><span class="n">resource_cat</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="n">cat</span>
                <span class="n">coll</span><span class="o">.</span><span class="n">cat_resource</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">NetworkStatsRecord</span><span class="p">(</span>
            <span class="n">total</span> <span class="o">=</span> <span class="n">n_total</span><span class="p">,</span>
            <span class="n">by_resource</span> <span class="o">=</span> <span class="n">n_by_resource</span><span class="p">,</span>
            <span class="n">by_category</span> <span class="o">=</span> <span class="n">n_by_category</span><span class="p">,</span>
            <span class="n">shared</span> <span class="o">=</span> <span class="n">n_shared</span><span class="p">,</span>
            <span class="n">unique</span> <span class="o">=</span> <span class="n">n_unique</span><span class="p">,</span>
            <span class="n">percent</span> <span class="o">=</span> <span class="n">_percent</span><span class="p">,</span>
            <span class="n">shared_res_cat</span> <span class="o">=</span> <span class="n">n_shared_res_cat</span><span class="p">,</span>
            <span class="n">unique_res_cat</span> <span class="o">=</span> <span class="n">n_unique_res_cat</span><span class="p">,</span>
            <span class="n">percent_res_cat</span> <span class="o">=</span> <span class="n">percent_res_cat</span><span class="p">,</span>
            <span class="n">shared_cat</span> <span class="o">=</span> <span class="n">n_shared_cat</span><span class="p">,</span>
            <span class="n">unique_cat</span> <span class="o">=</span> <span class="n">n_unique_cat</span><span class="p">,</span>
            <span class="n">percent_cat</span> <span class="o">=</span> <span class="n">percent_cat</span><span class="p">,</span>
            <span class="n">resource_cat</span> <span class="o">=</span> <span class="n">coll</span><span class="o">.</span><span class="n">resource_cat</span><span class="p">,</span>
            <span class="n">cat_resource</span> <span class="o">=</span> <span class="n">coll</span><span class="o">.</span><span class="n">cat_resource</span><span class="p">,</span>
            <span class="n">method</span> <span class="o">=</span> <span class="n">coll</span><span class="o">.</span><span class="n">method</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PyPath.stats"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.stats">[docs]</a>    <span class="k">def</span> <span class="nf">stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">keep_collection</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a collection of entities over the network according to</span>
<span class="sd">        ``method`` and counts them. By default the collection won&#39;t be</span>
<span class="sd">        returned but only the counts.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">NetworkEntities</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span>
            <span class="s1">&#39;NetworkEntities&#39;</span><span class="p">,</span>
            <span class="p">[</span>
                <span class="s1">&#39;counts&#39;</span><span class="p">,</span>
                <span class="s1">&#39;entities&#39;</span><span class="p">,</span>
                <span class="s1">&#39;method&#39;</span><span class="p">,</span>
                <span class="s1">&#39;label&#39;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">)</span>
        <span class="n">NetworkEntities</span><span class="o">.</span><span class="fm">__new__</span><span class="o">.</span><span class="vm">__defaults__</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,)</span>

        <span class="n">collection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">(</span><span class="n">collection_method</span> <span class="o">=</span> <span class="n">collection</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">NetworkEntities</span><span class="p">(</span>
            <span class="n">counts</span> <span class="o">=</span> <span class="n">counts</span><span class="p">,</span>
            <span class="n">entities</span> <span class="o">=</span> <span class="n">collection</span> <span class="k">if</span> <span class="n">keep_collection</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">method</span> <span class="o">=</span> <span class="n">method</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">references_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="s1">&#39;references&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">interactions_undirected_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="s1">&#39;interactions_undirected&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">interactions_all_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="s1">&#39;interactions_all&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">interactions_directed_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="s1">&#39;interactions_directed&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">interactions_mutual_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="s1">&#39;interactions_mutual&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">interactions_signed_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="s1">&#39;interactions_signed&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">interactions_stimulatory_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="s1">&#39;interactions_stimulatory&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">interactions_inhibitory_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="s1">&#39;interactions_inhibitory&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">entities_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="s1">&#39;entities&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">curation_effort_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="s1">&#39;curation_effort&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


    <span class="c1">#</span>
    <span class="c1"># exporting resource vs. entity counts</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="PyPath.summaries_tab"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.summaries_tab">[docs]</a>    <span class="k">def</span> <span class="nf">summaries_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">return_table</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a table from resource vs. entity counts and optionally</span>
<span class="sd">        writes it to ``outfile`` and returns it.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">tab</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">summaries_labels</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="n">tab</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
            <span class="p">[</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">summaries</span><span class="p">[</span><span class="n">resource</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">resource</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">summaries</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
                <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s1">&#39;Total&#39;</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
            <span class="p">)</span>
        <span class="p">])</span>

        <span class="k">if</span> <span class="n">outfile</span><span class="p">:</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>

                <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tab</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">return_table</span><span class="p">:</span>

            <span class="k">return</span> <span class="n">tab</span></div>


<div class="viewcode-block" id="PyPath.export_dot"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.export_dot">[docs]</a>    <span class="k">def</span> <span class="nf">export_dot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">labels</span><span class="o">=</span><span class="s1">&#39;genesymbol&#39;</span><span class="p">,</span> <span class="n">edges_filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                   <span class="n">nodes_filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="n">edge_sources</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">dir_sources</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_object</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">save_dot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save_graphics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prog</span><span class="o">=</span><span class="s1">&#39;neato&#39;</span><span class="p">,</span>
                   <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">auto_edges</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">hide_nodes</span><span class="o">=</span><span class="p">[],</span> <span class="n">defaults</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Builds a pygraphviz.AGraph() object with filtering the edges</span>
<span class="sd">        and vertices along arbitrary criteria.</span>
<span class="sd">        Returns the Agraph object if requesred, or exports the dot</span>
<span class="sd">        file, or saves the graphics.</span>

<span class="sd">        @nodes : list</span>
<span class="sd">        List of vertex ids to be included.</span>
<span class="sd">        @edges : list</span>
<span class="sd">        List of edge ids to be included.</span>
<span class="sd">        @directed : bool</span>
<span class="sd">        Create a directed or undirected graph.</span>
<span class="sd">        @labels : str</span>
<span class="sd">        Name type to be used as id/label in the dot format.</span>
<span class="sd">        @edges_filter : function</span>
<span class="sd">        Function to filter edges, accepting igraph.Edge as argument.</span>
<span class="sd">        @nodes_filter : function</span>
<span class="sd">        Function to filter vertices, accepting igraph.Vertex as argument.</span>
<span class="sd">        @edge_sources : list</span>
<span class="sd">        Sources to be included.</span>
<span class="sd">        @dir_sources : list</span>
<span class="sd">        Direction and effect sources to be included.</span>
<span class="sd">        @graph : igraph.Graph</span>
<span class="sd">        The graph object to export.</span>
<span class="sd">        @return_object : bool</span>
<span class="sd">        Whether to return the pygraphviz.AGraph object.</span>
<span class="sd">        @save_dot : str</span>
<span class="sd">        Filename to export the dot file to.</span>
<span class="sd">        @save_graphics : str</span>
<span class="sd">        Filename to export the graphics, the extension defines the format.</span>
<span class="sd">        @prog : str</span>
<span class="sd">        The graphviz layout algorithm to use.</span>
<span class="sd">        @format : str</span>
<span class="sd">        The graphics format passed to pygraphviz.AGrapg().draw().</span>
<span class="sd">        @hide : bool</span>
<span class="sd">        Hide filtered edges instead of omit them.</span>
<span class="sd">        @hide nodes : list</span>
<span class="sd">        Nodes to hide. List of vertex ids.</span>
<span class="sd">        @auto_edges : str</span>
<span class="sd">        Automatic, built-in style for edges.</span>
<span class="sd">        &#39;DIRECTIONS&#39; or &#39;RESOURCE_CATEGORIES&#39; are supported.</span>
<span class="sd">        @font : str</span>
<span class="sd">        Font to use for labels.</span>
<span class="sd">        For using more than one fonts refer to graphviz attributes with constant values</span>
<span class="sd">        or define callbacks or mapping dictionaries.</span>
<span class="sd">        @defaults : dict</span>
<span class="sd">        Default values for graphviz attributes, labeled with the entity, e.g.</span>
<span class="sd">        `{&#39;edge_penwidth&#39;: 0.2}`.</span>
<span class="sd">        @**kwargs : constant, callable or dict</span>
<span class="sd">        Graphviz attributes, labeled by the target entity. E.g. `edge_penwidth`,</span>
<span class="sd">        &#39;vertex_shape` or `graph_label`.</span>
<span class="sd">        If the value is constant, this value will be used.</span>
<span class="sd">        If the value is dict, and has `_name` as key, for every instance of the</span>
<span class="sd">        given entity, the value of the attribute defined by `_name` will be looked</span>
<span class="sd">        up in the dict, and the corresponding value will be given to the graphviz</span>
<span class="sd">        attribute. If the key `_name` is missing from the dict, igraph vertex and</span>
<span class="sd">        edge indices will be looked up among the keys.</span>
<span class="sd">        If the value is callable, it will be called with the current instance of</span>
<span class="sd">        the entity and the returned value will be used for the graphviz attribute.</span>
<span class="sd">        E.g. `edge_arrowhead(edge)` or `vertex_fillcolor(vertex)`</span>
<span class="sd">        Example:</span>
<span class="sd">            import pypath</span>
<span class="sd">            from pypath import data_formats</span>
<span class="sd">            net = pypath.PyPath()</span>
<span class="sd">            net.init_network(pfile = &#39;cache/default.pickle&#39;)</span>
<span class="sd">            #net.init_network({&#39;arn&#39;: data_formats.omnipath[&#39;arn&#39;]})</span>
<span class="sd">            tgf = [v.index for v in net.graph.vs if &#39;TGF&#39; in v[&#39;slk_pathways&#39;]]</span>
<span class="sd">            dot = net.export_dot(nodes = tgf, save_graphics = &#39;tgf_slk.pdf&#39;, prog = &#39;dot&#39;,</span>
<span class="sd">                main_title = &#39;TGF-beta pathway&#39;, return_object = True,</span>
<span class="sd">                label_font = &#39;HelveticaNeueLTStd Med Cn&#39;,</span>
<span class="sd">                edge_sources = [&#39;SignaLink3&#39;],</span>
<span class="sd">                dir_sources = [&#39;SignaLink3&#39;], hide = True)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">_attrs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">_custom_attrs</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="n">graph_attrs</span><span class="p">,</span> <span class="n">vertex_attrs</span><span class="p">,</span> <span class="n">edge_attrs</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">graphviz_input</span><span class="o">.</span><span class="n">get_graphviz_attrs</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">_defaults</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;edge_color&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;undirected&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;unknown&#39;</span><span class="p">:</span> <span class="s1">&#39;#CCCCCC&#39;</span><span class="p">},</span>
                                    <span class="s1">&#39;directed&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;stimulation&#39;</span><span class="p">:</span> <span class="s1">&#39;#00AA00&#39;</span><span class="p">,</span>
                                                 <span class="s1">&#39;inhibition&#39;</span><span class="p">:</span> <span class="s1">&#39;#CC0000&#39;</span><span class="p">,</span>
                                                 <span class="s1">&#39;unknown&#39;</span><span class="p">:</span> <span class="s1">&#39;#0000CC&#39;</span><span class="p">},</span>
                                    <span class="s1">&#39;pathway&#39;</span><span class="p">:</span> <span class="s1">&#39;#7AA0A177&#39;</span><span class="p">,</span> <span class="s1">&#39;ptm&#39;</span><span class="p">:</span> <span class="s1">&#39;#C6909C77&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;reaction&#39;</span><span class="p">:</span> <span class="s1">&#39;#C5B26E77&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;interaction&#39;</span><span class="p">:</span> <span class="s1">&#39;#9D8BB777&#39;</span><span class="p">},</span>
                     <span class="s1">&#39;edge_arrowhead&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;undirected&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;unknown&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">},</span>
                                        <span class="s1">&#39;directed&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;stimulation&#39;</span><span class="p">:</span> <span class="s1">&#39;normal&#39;</span><span class="p">,</span>
                                                     <span class="s1">&#39;inhibition&#39;</span><span class="p">:</span> <span class="s1">&#39;tee&#39;</span><span class="p">,</span>
                                                     <span class="s1">&#39;unknown&#39;</span><span class="p">:</span> <span class="s1">&#39;diamond&#39;</span><span class="p">}},</span>
                     <span class="s1">&#39;vertex_fillcolor&#39;</span><span class="p">:</span> <span class="s1">&#39;#AAAAAA&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;vertex_fontcolor&#39;</span><span class="p">:</span> <span class="s1">&#39;#000000&#39;</span><span class="p">}</span>

        <span class="c1">#</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">defaults</span><span class="p">):</span>
            <span class="n">_defaults</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="c1">#</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">graph</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="s1">&#39;name&#39;</span> <span class="k">if</span> <span class="n">labels</span> <span class="o">==</span> <span class="s1">&#39;uniprot&#39;</span> <span class="k">else</span> <span class="s1">&#39;label&#39;</span>
        <span class="n">edge_sources</span> <span class="o">=</span> <span class="n">edge_sources</span> <span class="k">if</span> <span class="n">edge_sources</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">set</span><span class="p">(</span>
            <span class="n">edge_sources</span><span class="p">)</span>
        <span class="n">dir_sources</span> <span class="o">=</span> <span class="n">dir_sources</span> <span class="k">if</span> <span class="n">dir_sources</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">set</span><span class="p">(</span><span class="n">dir_sources</span><span class="p">)</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="s1">&#39;name&#39;</span> <span class="k">if</span> <span class="n">labels</span> <span class="o">==</span> <span class="s1">&#39;uniprot&#39;</span> <span class="k">else</span> <span class="n">labels</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="s1">&#39;label&#39;</span> <span class="k">if</span> <span class="n">labels</span> <span class="o">==</span> <span class="s1">&#39;genesymbol&#39;</span> <span class="k">else</span> <span class="n">labels</span>

        <span class="k">if</span> <span class="n">labels</span> <span class="o">==</span> <span class="s1">&#39;label&#39;</span> <span class="ow">and</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">genesymbol_labels</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">nodes</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">edges</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">n</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">edges</span>
            <span class="p">]</span>

        <span class="k">elif</span> <span class="n">nodes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">edges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">edges</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">e</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span>
                <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">source</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="ow">and</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span> <span class="ow">in</span> <span class="n">nodes</span>
            <span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">edges</span> <span class="o">=</span> <span class="n">xrange</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">ecount</span><span class="p">())</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="n">xrange</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vcount</span><span class="p">())</span>

        <span class="n">dNodes</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="n">labels</span><span class="p">])</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span>
                      <span class="k">if</span> <span class="n">nodes</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">)</span>
        <span class="n">hide_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">hide_nodes</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">font</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_custom_attrs</span><span class="p">[</span><span class="s1">&#39;graph_fontname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">font</span>
            <span class="n">_custom_attrs</span><span class="p">[</span><span class="s1">&#39;vertex_fontname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">font</span>
            <span class="n">_custom_attrs</span><span class="p">[</span><span class="s1">&#39;edge_fontname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">font</span>

        <span class="c1"># attribute callbacks</span>
        <span class="k">for</span> <span class="n">_entity</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;graph&#39;</span><span class="p">,</span> <span class="s1">&#39;vertex&#39;</span><span class="p">,</span> <span class="s1">&#39;edge&#39;</span><span class="p">]:</span>
            <span class="n">callbacks_dict</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_callbacks&#39;</span> <span class="o">%</span> <span class="n">_entity</span>
            <span class="n">_attrs</span><span class="p">[</span><span class="n">callbacks_dict</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">callbacks</span> <span class="o">=</span> <span class="n">_attrs</span><span class="p">[</span><span class="n">callbacks_dict</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">_entity</span> <span class="o">==</span> <span class="s1">&#39;edge&#39;</span><span class="p">:</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">auto_edges</span> <span class="o">==</span> <span class="s1">&#39;RESOURCE_CATEGORIES&#39;</span> <span class="ow">or</span>
                        <span class="n">auto_edges</span> <span class="o">==</span> <span class="s1">&#39;DIRECTIONS&#39;</span><span class="p">)</span> \
                        <span class="ow">and</span> <span class="s1">&#39;edge_color&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_custom_attrs</span> \
                        <span class="ow">and</span> <span class="s1">&#39;edge_arrowhead&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_custom_attrs</span><span class="p">:</span>
                    <span class="n">callbacks</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> \
                        <span class="n">_AttrHelper</span><span class="p">(</span><span class="n">auto_edges</span><span class="p">,</span> <span class="s1">&#39;edge_color&#39;</span><span class="p">,</span> <span class="n">_defaults</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">auto_edges</span> <span class="o">==</span> <span class="s1">&#39;DIRECTIONS&#39;</span><span class="p">:</span>
                        <span class="n">callbacks</span><span class="p">[</span><span class="s1">&#39;arrowhead&#39;</span><span class="p">]</span> <span class="o">=</span> \
                            <span class="n">_AttrHelper</span><span class="p">(</span><span class="n">auto_edges</span><span class="p">,</span> <span class="s1">&#39;edge_arrowhead&#39;</span><span class="p">,</span> <span class="n">_defaults</span><span class="p">)</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">callbacks</span><span class="p">[</span><span class="s1">&#39;arrowhead&#39;</span><span class="p">]</span> <span class="o">=</span> \
                            <span class="n">_AttrHelper</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;edge_arrowhead&#39;</span><span class="p">,</span> <span class="n">_defaults</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_attrs&#39;</span> <span class="o">%</span> <span class="n">_entity</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">callback_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">_entity</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">callback_name</span> <span class="ow">in</span> <span class="n">_custom_attrs</span><span class="p">:</span>
                    <span class="n">callback_value</span> <span class="o">=</span> <span class="n">_custom_attrs</span><span class="p">[</span><span class="n">callback_name</span><span class="p">]</span>

                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">callback_value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>

                        <span class="k">if</span> <span class="s1">&#39;_name&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">callback_value</span><span class="p">:</span>
                            <span class="n">callback_value</span><span class="p">[</span><span class="s1">&#39;_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span>
                    <span class="n">callbacks</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">_AttrHelper</span><span class="p">(</span>
                        <span class="n">value</span><span class="o">=</span><span class="n">callback_value</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span> <span class="n">defaults</span><span class="o">=</span><span class="n">_defaults</span><span class="p">)</span>

        <span class="c1"># graph</span>
        <span class="n">dot</span> <span class="o">=</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">AGraph</span><span class="p">(</span><span class="n">directed</span><span class="o">=</span><span class="n">directed</span><span class="p">)</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">gattr</span><span class="p">,</span> <span class="n">fun</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">_attrs</span><span class="p">[</span><span class="s1">&#39;graph_callbacks&#39;</span><span class="p">]):</span>
            <span class="n">attrs</span><span class="p">[</span><span class="n">gattr</span><span class="p">]</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

        <span class="n">attrs</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">clean_dict</span><span class="p">(</span><span class="n">attrs</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">gattr</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">attrs</span><span class="p">):</span>
            <span class="n">dot</span><span class="o">.</span><span class="n">graph_attr</span><span class="p">[</span><span class="n">gattr</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="c1"># vertices</span>
        <span class="k">for</span> <span class="n">vid</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">dNodes</span><span class="p">):</span>
            <span class="n">attrs</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">for</span> <span class="n">vattr</span><span class="p">,</span> <span class="n">fun</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">_attrs</span><span class="p">[</span><span class="s1">&#39;vertex_callbacks&#39;</span><span class="p">]):</span>
                <span class="n">attrs</span><span class="p">[</span><span class="n">vattr</span><span class="p">]</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">vid</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">vid</span> <span class="ow">in</span> <span class="n">hide_nodes</span><span class="p">:</span>
                <span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;style&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;invis&#39;</span>

            <span class="n">attrs</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">clean_dict</span><span class="p">(</span><span class="n">attrs</span><span class="p">)</span>
            <span class="n">dot</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span>

        <span class="c1"># edges</span>
        <span class="n">edge_callbacks</span> <span class="o">=</span> <span class="n">_attrs</span><span class="p">[</span><span class="s1">&#39;edge_callbacks&#39;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">eid</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">]</span><span class="o">.</span><span class="n">source</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">]</span><span class="o">.</span><span class="n">target</span>
            <span class="n">sn</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
            <span class="n">tn</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
            <span class="n">sl</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">labels</span><span class="p">]</span>
            <span class="n">tl</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">labels</span><span class="p">]</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">][</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span>
            <span class="c1"># this edge should be visible at all?</span>
            <span class="n">evis</span> <span class="o">=</span> <span class="n">edges_filter</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">])</span> <span class="ow">and</span> \
                <span class="n">nodes_filter</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">s</span><span class="p">])</span> <span class="ow">and</span> <span class="n">nodes_filter</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="ow">and</span> \
                <span class="p">(</span><span class="n">edge_sources</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">][</span><span class="s1">&#39;sources&#39;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">edge_sources</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> \
                <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">]</span><span class="o">.</span><span class="n">source</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hide_nodes</span> <span class="ow">and</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span>
                    <span class="n">eid</span><span class="p">]</span><span class="o">.</span><span class="n">target</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hide_nodes</span>

            <span class="k">if</span> <span class="n">evis</span> <span class="ow">or</span> <span class="n">hide</span><span class="p">:</span>
                <span class="n">drawn_directed</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">thisSign</span> <span class="o">=</span> <span class="s1">&#39;unknown&#39;</span>
                <span class="n">this_directed</span> <span class="o">=</span> <span class="s1">&#39;undirected&#39;</span>
                <span class="n">thisSources</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>

                <span class="k">if</span> <span class="n">directed</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">get_dir</span><span class="p">((</span><span class="n">sn</span><span class="p">,</span> <span class="n">tn</span><span class="p">)):</span>
                        <span class="n">sdir</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">get_dir</span><span class="p">((</span><span class="n">sn</span><span class="p">,</span> <span class="n">tn</span><span class="p">),</span> <span class="n">sources</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                        <span class="n">this_directed</span> <span class="o">=</span> <span class="p">(</span><span class="n">sn</span><span class="p">,</span> <span class="n">tn</span><span class="p">)</span>
                        <span class="n">vis</span> <span class="o">=</span> <span class="p">(</span><span class="n">dir_sources</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span>
                               <span class="nb">len</span><span class="p">(</span><span class="n">sdir</span> <span class="o">&amp;</span> <span class="n">dir_sources</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">evis</span>

                        <span class="k">if</span> <span class="n">vis</span> <span class="ow">or</span> <span class="n">hide</span><span class="p">:</span>
                            <span class="n">attrs</span> <span class="o">=</span> <span class="p">{}</span>
                            <span class="n">sign</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">get_sign</span><span class="p">((</span><span class="n">sn</span><span class="p">,</span> <span class="n">tn</span><span class="p">))</span>
                            <span class="n">ssign</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">get_sign</span><span class="p">((</span><span class="n">sn</span><span class="p">,</span> <span class="n">tn</span><span class="p">),</span> <span class="n">sources</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                            <span class="n">drawn_directed</span> <span class="o">=</span> <span class="kc">True</span>

                            <span class="k">if</span> <span class="n">vis</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sign</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">dir_sources</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span>
                                        <span class="n">dir_sources</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
                                        <span class="nb">len</span><span class="p">(</span><span class="n">ssign</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">dir_sources</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                                <span class="n">thisSign</span> <span class="o">=</span> <span class="s1">&#39;stimulation&#39;</span>
                                <span class="n">thisSources</span> <span class="o">=</span> <span class="n">ssign</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">dir_sources</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> \
                                    <span class="n">ssign</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">dir_sources</span>

                                <span class="k">for</span> <span class="n">eattr</span><span class="p">,</span> <span class="n">fun</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">edge_callbacks</span><span class="p">):</span>
                                    <span class="n">attrs</span><span class="p">[</span><span class="n">eattr</span><span class="p">]</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">],</span> <span class="n">this_directed</span><span class="p">,</span>
                                                       <span class="n">thisSign</span><span class="p">,</span> <span class="n">thisSources</span><span class="p">,</span>
                                                       <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">][</span><span class="s1">&#39;sources&#39;</span><span class="p">])</span>

                            <span class="k">elif</span> <span class="n">vis</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sign</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">dir_sources</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span>
                                          <span class="n">dir_sources</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
                                          <span class="nb">len</span><span class="p">(</span><span class="n">ssign</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">dir_sources</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                                <span class="n">thisSign</span> <span class="o">=</span> <span class="s1">&#39;inhibition&#39;</span>
                                <span class="n">thisSoures</span> <span class="o">=</span> <span class="n">ssign</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">dir_sources</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> \
                                    <span class="n">ssign</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">dir_sources</span>

                                <span class="k">for</span> <span class="n">eattr</span><span class="p">,</span> <span class="n">fun</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">edge_callbacks</span><span class="p">):</span>
                                    <span class="n">attrs</span><span class="p">[</span><span class="n">eattr</span><span class="p">]</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">],</span> <span class="n">this_directed</span><span class="p">,</span>
                                                       <span class="n">thisSign</span><span class="p">,</span> <span class="n">thisSources</span><span class="p">,</span>
                                                       <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">][</span><span class="s1">&#39;sources&#39;</span><span class="p">])</span>

                            <span class="k">elif</span> <span class="n">vis</span><span class="p">:</span>
                                <span class="n">thisSign</span> <span class="o">=</span> <span class="s1">&#39;unknown&#39;</span>
                                <span class="n">thisSources</span> <span class="o">=</span> <span class="n">sdir</span>

                                <span class="k">for</span> <span class="n">eattr</span><span class="p">,</span> <span class="n">fun</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">edge_callbacks</span><span class="p">):</span>
                                    <span class="n">attrs</span><span class="p">[</span><span class="n">eattr</span><span class="p">]</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">],</span> <span class="n">this_directed</span><span class="p">,</span>
                                                       <span class="n">thisSign</span><span class="p">,</span> <span class="n">thisSources</span><span class="p">,</span>
                                                       <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">][</span><span class="s1">&#39;sources&#39;</span><span class="p">])</span>

                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;style&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;invis&#39;</span>
                                <span class="n">drawn_directed</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="n">attrs</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">clean_dict</span><span class="p">(</span><span class="n">attrs</span><span class="p">)</span>
                            <span class="n">dot</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">sl</span><span class="p">,</span> <span class="n">tl</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">get_dir</span><span class="p">((</span><span class="n">tn</span><span class="p">,</span> <span class="n">sn</span><span class="p">)):</span>
                        <span class="n">sdir</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">get_dir</span><span class="p">((</span><span class="n">tn</span><span class="p">,</span> <span class="n">sn</span><span class="p">),</span> <span class="n">sources</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                        <span class="n">this_directed</span> <span class="o">=</span> <span class="p">(</span><span class="n">tn</span><span class="p">,</span> <span class="n">sn</span><span class="p">)</span>
                        <span class="n">vis</span> <span class="o">=</span> <span class="p">(</span><span class="n">dir_sources</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span>
                               <span class="nb">len</span><span class="p">(</span><span class="n">sdir</span> <span class="o">&amp;</span> <span class="n">dir_sources</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">evis</span>

                        <span class="k">if</span> <span class="n">vis</span> <span class="ow">or</span> <span class="n">hide</span><span class="p">:</span>
                            <span class="n">attrs</span> <span class="o">=</span> <span class="p">{}</span>
                            <span class="n">sign</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">get_sign</span><span class="p">((</span><span class="n">tn</span><span class="p">,</span> <span class="n">sn</span><span class="p">))</span>
                            <span class="n">ssign</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">get_sign</span><span class="p">((</span><span class="n">tn</span><span class="p">,</span> <span class="n">sn</span><span class="p">),</span> <span class="n">sources</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                            <span class="n">drawn_directed</span> <span class="o">=</span> <span class="kc">True</span>

                            <span class="k">if</span> <span class="n">vis</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sign</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">dir_sources</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span>
                                        <span class="n">dir_sources</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
                                        <span class="nb">len</span><span class="p">(</span><span class="n">ssign</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">dir_sources</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                                <span class="n">thisSign</span> <span class="o">=</span> <span class="s1">&#39;stimulation&#39;</span>
                                <span class="n">thisSources</span> <span class="o">=</span> <span class="n">ssign</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">dir_sources</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> \
                                    <span class="n">ssign</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">dir_sources</span>

                                <span class="k">for</span> <span class="n">eattr</span><span class="p">,</span> <span class="n">fun</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">edge_callbacks</span><span class="p">):</span>
                                    <span class="n">attrs</span><span class="p">[</span><span class="n">eattr</span><span class="p">]</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">],</span> <span class="n">this_directed</span><span class="p">,</span>
                                                       <span class="n">thisSign</span><span class="p">,</span> <span class="n">thisSources</span><span class="p">,</span>
                                                       <span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">][</span><span class="s1">&#39;sources&#39;</span><span class="p">]))</span>

                            <span class="k">elif</span> <span class="n">vis</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sign</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">dir_sources</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span>
                                          <span class="n">dir_sources</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
                                          <span class="nb">len</span><span class="p">(</span><span class="n">ssign</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">dir_sources</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                                <span class="n">thisSign</span> <span class="o">=</span> <span class="s1">&#39;inhibition&#39;</span>
                                <span class="n">thisSources</span> <span class="o">=</span> <span class="n">ssign</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">dir_sources</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> \
                                    <span class="n">ssign</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">dir_sources</span>

                                <span class="k">for</span> <span class="n">eattr</span><span class="p">,</span> <span class="n">fun</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">edge_callbacks</span><span class="p">):</span>
                                    <span class="n">attrs</span><span class="p">[</span><span class="n">eattr</span><span class="p">]</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">],</span> <span class="n">this_directed</span><span class="p">,</span>
                                                       <span class="n">thisSign</span><span class="p">,</span> <span class="n">thisSources</span><span class="p">,</span>
                                                       <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">][</span><span class="s1">&#39;sources&#39;</span><span class="p">])</span>

                            <span class="k">elif</span> <span class="n">vis</span><span class="p">:</span>
                                <span class="n">thisSign</span> <span class="o">=</span> <span class="s1">&#39;unknown&#39;</span>
                                <span class="n">thisSources</span> <span class="o">=</span> <span class="n">sdir</span>

                                <span class="k">for</span> <span class="n">eattr</span><span class="p">,</span> <span class="n">fun</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">edge_callbacks</span><span class="p">):</span>
                                    <span class="n">attrs</span><span class="p">[</span><span class="n">eattr</span><span class="p">]</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">],</span> <span class="n">this_directed</span><span class="p">,</span>
                                                       <span class="n">thisSign</span><span class="p">,</span> <span class="n">thisSources</span><span class="p">,</span>
                                                       <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">][</span><span class="s1">&#39;sources&#39;</span><span class="p">])</span>

                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;style&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;invis&#39;</span>
                                <span class="n">drawn_directed</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="n">attrs</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">clean_dict</span><span class="p">(</span><span class="n">attrs</span><span class="p">)</span>
                            <span class="n">dot</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">tl</span><span class="p">,</span> <span class="n">sl</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">directed</span> <span class="ow">or</span> <span class="n">d</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span><span class="s1">&#39;undirected&#39;</span><span class="p">):</span>
                    <span class="n">attrs</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">this_directed</span> <span class="o">=</span> <span class="s1">&#39;undirected&#39;</span>
                    <span class="n">thisSign</span> <span class="o">=</span> <span class="s1">&#39;unknown&#39;</span>
                    <span class="n">thisSources</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span><span class="s1">&#39;undirected&#39;</span><span class="p">,</span> <span class="n">sources</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">eattr</span><span class="p">,</span> <span class="n">fun</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">edge_callbacks</span><span class="p">):</span>
                        <span class="n">attrs</span><span class="p">[</span><span class="n">eattr</span><span class="p">]</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">],</span> <span class="n">this_directed</span><span class="p">,</span> <span class="n">thisSign</span><span class="p">,</span>
                                           <span class="n">thisSources</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="n">eid</span><span class="p">][</span><span class="s1">&#39;sources&#39;</span><span class="p">])</span>

                    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">evis</span> <span class="ow">and</span> <span class="n">hide</span><span class="p">)</span> <span class="ow">or</span> <span class="n">drawn_directed</span><span class="p">:</span>
                        <span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;style&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;invis&#39;</span>

                    <span class="k">if</span> <span class="n">dot</span><span class="o">.</span><span class="n">has_neighbor</span><span class="p">(</span><span class="n">sl</span><span class="p">,</span> <span class="n">tl</span><span class="p">):</span>

                        <span class="k">if</span> <span class="n">dot</span><span class="o">.</span><span class="n">get_edge</span><span class="p">(</span><span class="n">sl</span><span class="p">,</span> <span class="n">tl</span><span class="p">)</span><span class="o">.</span><span class="n">attr</span><span class="p">[</span><span class="s1">&#39;style&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                                <span class="s1">&#39;invis&#39;</span> <span class="ow">in</span> <span class="n">dot</span><span class="o">.</span><span class="n">get_edge</span><span class="p">(</span><span class="n">sl</span><span class="p">,</span> <span class="n">tl</span><span class="p">)</span><span class="o">.</span><span class="n">attr</span><span class="p">[</span><span class="s1">&#39;style&#39;</span><span class="p">]:</span>
                            <span class="n">dot</span><span class="o">.</span><span class="n">delete_edge</span><span class="p">(</span><span class="n">sl</span><span class="p">,</span> <span class="n">tl</span><span class="p">)</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="n">dot</span><span class="o">.</span><span class="n">has_neighbor</span><span class="p">(</span><span class="n">sl</span><span class="p">,</span> <span class="n">tl</span><span class="p">):</span>
                        <span class="n">attrs</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">clean_dict</span><span class="p">(</span><span class="n">attrs</span><span class="p">)</span>
                        <span class="n">dot</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="n">sl</span><span class="p">,</span> <span class="n">tl</span><span class="p">),</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">save_dot</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">([</span><span class="nb">str</span><span class="p">,</span> <span class="n">unicode</span><span class="p">]):</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">save_dot</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dot</span><span class="o">.</span><span class="n">to_string</span><span class="p">())</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">save_graphics</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">([</span><span class="nb">str</span><span class="p">,</span> <span class="n">unicode</span><span class="p">]):</span>
            <span class="n">dot</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">save_graphics</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span> <span class="n">prog</span><span class="o">=</span><span class="n">prog</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">return_object</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dot</span></div>

<div class="viewcode-block" id="PyPath.consistency"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.consistency">[docs]</a>    <span class="k">def</span> <span class="nf">consistency</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">con</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="p">((</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">),</span> <span class="nb">dict</span><span class="p">(</span>
                    <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">set</span><span class="p">([])</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;edges&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
                        <span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">,</span> <span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="s1">&#39;major&#39;</span><span class="p">])))</span>
                <span class="k">for</span> <span class="n">s1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span> <span class="k">for</span> <span class="n">s2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)),</span>
                <span class="p">[</span><span class="s1">&#39;directions&#39;</span><span class="p">,</span> <span class="s1">&#39;directions_edges&#39;</span><span class="p">,</span> <span class="s1">&#39;signs&#39;</span><span class="p">,</span> <span class="s1">&#39;signs_edges&#39;</span><span class="p">]))),</span>
            <span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">,</span> <span class="s1">&#39;inconsistency&#39;</span><span class="p">]))</span>

        <span class="c1"># inconsistency #</span>
        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Counting inconsistency&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">s1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">s2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">:</span>
                <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
                <span class="n">s12</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">])</span>

                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span>

                    <span class="k">if</span> <span class="n">s1</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">sources_straight</span><span class="p">()</span> <span class="ow">and</span> \
                            <span class="n">s1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">sources_reverse</span><span class="p">()</span> <span class="ow">and</span> \
                            <span class="n">s2</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">sources_reverse</span><span class="p">()</span> <span class="ow">and</span> \
                            <span class="n">s2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">sources_straight</span><span class="p">()</span> <span class="ow">or</span> \
                            <span class="n">s2</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">sources_straight</span><span class="p">()</span> <span class="ow">and</span> \
                            <span class="n">s2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">sources_reverse</span><span class="p">()</span> <span class="ow">and</span> \
                            <span class="n">s1</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">sources_reverse</span><span class="p">()</span> <span class="ow">and</span> \
                            <span class="n">s1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">sources_straight</span><span class="p">():</span>
                        <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions&#39;</span><span class="p">][(</span><span class="n">s1</span><span class="p">,</span>
                                                            <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;total&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions_edges&#39;</span><span class="p">][(</span>
                            <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">s1</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">sources_straight</span><span class="p">()</span> <span class="ow">and</span> <span class="n">s1</span> <span class="o">!=</span> <span class="n">s2</span><span class="p">:</span>

                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">sources_straight</span><span class="p">())</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span>
                                    <span class="n">d</span><span class="o">.</span><span class="n">sources_reverse</span><span class="p">()):</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions&#39;</span><span class="p">][(</span>
                                    <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions&#39;</span><span class="p">][(</span>
                                    <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions_edges&#39;</span><span class="p">][(</span>
                                    <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions_edges&#39;</span><span class="p">][(</span>
                                    <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">sources_straight</span><span class="p">())</span> <span class="o">&lt;</span> \
                                    <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">sources_reverse</span><span class="p">()):</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions&#39;</span><span class="p">][(</span>
                                    <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions&#39;</span><span class="p">][(</span>
                                    <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions_edges&#39;</span><span class="p">][(</span>
                                    <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions_edges&#39;</span><span class="p">][(</span>
                                    <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">sources_straight</span><span class="p">())</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> \
                                    <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">sources_reverse</span><span class="p">())</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions&#39;</span><span class="p">][(</span>
                                    <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions&#39;</span><span class="p">][(</span>
                                    <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions_edges&#39;</span><span class="p">][(</span>
                                    <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions_edges&#39;</span><span class="p">][(</span>
                                    <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">s1</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">positive_sources_straight</span><span class="p">()</span> <span class="ow">and</span> \
                            <span class="n">s2</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">negative_sources_straight</span><span class="p">()</span> <span class="ow">or</span> \
                            <span class="n">s1</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">negative_sources_straight</span><span class="p">()</span> <span class="ow">and</span> \
                            <span class="n">s2</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">positive_sources_straight</span><span class="p">():</span>
                        <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;total&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                            <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">s1</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">positive_sources_straight</span><span class="p">():</span>

                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">positive_sources_straight</span><span class="p">())</span> <span class="o">&gt;</span> \
                                    <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">negative_sources_straight</span><span class="p">()):</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span>
                                    <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span>
                                    <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                                    <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                                    <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">positive_sources_straight</span><span class="p">())</span> <span class="o">&lt;</span> \
                                    <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">negative_sources_straight</span><span class="p">()):</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span>
                                    <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span>
                                    <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                                    <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                                    <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">positive_sources_straight</span><span class="p">())</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> \
                                    <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">negative_sources_straight</span><span class="p">())</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span>
                                    <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span>
                                    <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                                    <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                                    <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">s1</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">positive_sources_reverse</span><span class="p">()</span> <span class="ow">and</span> \
                            <span class="n">s2</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">negative_sources_reverse</span><span class="p">()</span> <span class="ow">or</span> \
                            <span class="n">s1</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">negative_sources_reverse</span><span class="p">()</span> <span class="ow">and</span> \
                            <span class="n">s2</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">positive_sources_reverse</span><span class="p">():</span>
                        <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;total&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                            <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">s1</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">positive_sources_reverse</span><span class="p">():</span>

                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">positive_sources_reverse</span><span class="p">())</span> <span class="o">&gt;</span> \
                                    <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">negative_sources_reverse</span><span class="p">()):</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span>
                                    <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span>
                                    <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                                    <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                                    <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">positive_sources_reverse</span><span class="p">())</span> <span class="o">&lt;</span> \
                                    <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">negative_sources_reverse</span><span class="p">()):</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span>
                                    <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span>
                                    <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                                    <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                                    <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">positive_sources_reverse</span><span class="p">())</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> \
                                    <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">negative_sources_reverse</span><span class="p">())</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span>
                                    <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span>
                                    <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                                    <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                                <span class="n">con</span><span class="p">[</span><span class="s1">&#39;inconsistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                                    <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>

        <span class="c1"># consistency #</span>
        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Counting consistency&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">s1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">s2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">:</span>
                <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
                <span class="n">s12</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">])</span>

                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span>

                    <span class="k">if</span> <span class="n">s12</span> <span class="o">&lt;=</span> <span class="n">d</span><span class="o">.</span><span class="n">sources_straight</span><span class="p">():</span>
                        <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions&#39;</span><span class="p">][(</span><span class="n">s1</span><span class="p">,</span>
                                                          <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;total&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions_edges&#39;</span><span class="p">][(</span>
                            <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">sources_straight</span><span class="p">())</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">sources_reverse</span><span class="p">(</span>
                        <span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">s12</span> <span class="o">&amp;</span> <span class="n">d</span><span class="o">.</span><span class="n">sources_reverse</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions&#39;</span><span class="p">][(</span>
                                <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions_edges&#39;</span><span class="p">][(</span>
                                <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">sources_straight</span><span class="p">())</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">sources_reverse</span><span class="p">())</span> <span class="ow">and</span> \
                                <span class="nb">len</span><span class="p">(</span><span class="n">s12</span> <span class="o">&amp;</span> <span class="n">d</span><span class="o">.</span><span class="n">sources_reverse</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions&#39;</span><span class="p">][(</span>
                                <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions_edges&#39;</span><span class="p">][(</span>
                                <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">s12</span> <span class="o">&lt;=</span> <span class="n">d</span><span class="o">.</span><span class="n">sources_reverse</span><span class="p">():</span>
                        <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions&#39;</span><span class="p">][(</span><span class="n">s1</span><span class="p">,</span>
                                                          <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;total&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions_edges&#39;</span><span class="p">][(</span>
                            <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">sources_reverse</span><span class="p">())</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">sources_straight</span><span class="p">(</span>
                        <span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">s12</span> <span class="o">&amp;</span> <span class="n">d</span><span class="o">.</span><span class="n">sources_straight</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions&#39;</span><span class="p">][(</span>
                                <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions_edges&#39;</span><span class="p">][(</span>
                                <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">sources_reverse</span><span class="p">())</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">sources_straight</span><span class="p">())</span> <span class="ow">and</span> \
                                <span class="nb">len</span><span class="p">(</span><span class="n">s12</span> <span class="o">&amp;</span> <span class="n">d</span><span class="o">.</span><span class="n">sources_straight</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions&#39;</span><span class="p">][(</span>
                                <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;directions_edges&#39;</span><span class="p">][(</span>
                                <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">s12</span> <span class="o">&lt;=</span> <span class="n">d</span><span class="o">.</span><span class="n">positive_sources_straight</span><span class="p">():</span>
                        <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;total&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                            <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">positive_sources_straight</span><span class="p">())</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span>
                                <span class="n">d</span><span class="o">.</span><span class="n">positive_sources_reverse</span><span class="p">())</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span>
                                    <span class="n">s12</span> <span class="o">&amp;</span> <span class="n">d</span><span class="o">.</span><span class="n">positive_sources_reverse</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                                <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">positive_sources_straight</span><span class="p">())</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">positive_sources_reverse</span><span class="p">())</span> <span class="ow">and</span> \
                                <span class="nb">len</span><span class="p">(</span><span class="n">s12</span> <span class="o">&amp;</span> <span class="n">d</span><span class="o">.</span><span class="n">positive_sources_reverse</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                                <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">s12</span> <span class="o">&lt;=</span> <span class="n">d</span><span class="o">.</span><span class="n">negative_sources_straight</span><span class="p">():</span>
                        <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;total&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                            <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">negative_sources_straight</span><span class="p">())</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span>
                                <span class="n">d</span><span class="o">.</span><span class="n">negative_sources_reverse</span><span class="p">())</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span>
                                    <span class="n">s12</span> <span class="o">&amp;</span> <span class="n">d</span><span class="o">.</span><span class="n">negative_sources_reverse</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                                <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">negative_sources_straight</span><span class="p">())</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">negative_sources_reverse</span><span class="p">())</span> <span class="ow">and</span> \
                                <span class="nb">len</span><span class="p">(</span><span class="n">s12</span> <span class="o">&amp;</span> <span class="n">d</span><span class="o">.</span><span class="n">negative_sources_reverse</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                                <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">s12</span> <span class="o">&lt;=</span> <span class="n">d</span><span class="o">.</span><span class="n">positive_sources_reverse</span><span class="p">():</span>
                        <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;total&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                            <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">positive_sources_reverse</span><span class="p">())</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span>
                                <span class="n">d</span><span class="o">.</span><span class="n">positive_sources_straight</span><span class="p">())</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span>
                                    <span class="n">s12</span> <span class="o">&amp;</span> <span class="n">d</span><span class="o">.</span><span class="n">positive_sources_straight</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                                <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">positive_sources_reverse</span><span class="p">())</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">positive_sources_straight</span><span class="p">())</span> <span class="ow">and</span> \
                                <span class="nb">len</span><span class="p">(</span><span class="n">s12</span> <span class="o">&amp;</span> <span class="n">d</span><span class="o">.</span><span class="n">positive_sources_straight</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                                <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">s12</span> <span class="o">&lt;=</span> <span class="n">d</span><span class="o">.</span><span class="n">negative_sources_reverse</span><span class="p">():</span>
                        <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;total&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                            <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">negative_sources_reverse</span><span class="p">())</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span>
                                <span class="n">d</span><span class="o">.</span><span class="n">negative_sources_straight</span><span class="p">())</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span>
                                    <span class="n">s12</span> <span class="o">&amp;</span> <span class="n">d</span><span class="o">.</span><span class="n">negative_sources_straight</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                                <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;major&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">negative_sources_reverse</span><span class="p">())</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">negative_sources_straight</span><span class="p">())</span> <span class="ow">and</span> \
                                <span class="nb">len</span><span class="p">(</span><span class="n">s12</span> <span class="o">&amp;</span> <span class="n">d</span><span class="o">.</span><span class="n">negative_sources_straight</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs&#39;</span><span class="p">][(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="n">con</span><span class="p">[</span><span class="s1">&#39;consistency&#39;</span><span class="p">][</span><span class="s1">&#39;signs_edges&#39;</span><span class="p">][(</span>
                                <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)][</span><span class="s1">&#39;minor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">con</span></div>

<div class="viewcode-block" id="PyPath.export_edgelist"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.export_edgelist">[docs]</a>    <span class="k">def</span> <span class="nf">export_edgelist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                        <span class="n">edge_attributes</span><span class="o">=</span><span class="p">[],</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write edge list to text file with attributes</span>

<span class="sd">        :param fname:</span>
<span class="sd">            the name of the file or a stream to read from.</span>
<span class="sd">        :param graph:</span>
<span class="sd">            the igraph object containing the network</span>
<span class="sd">        :param names:</span>
<span class="sd">            list with the vertex attribute names to be printed</span>
<span class="sd">            for source and target vertices</span>
<span class="sd">        :param edge_attributes:</span>
<span class="sd">            list with the edge attribute names</span>
<span class="sd">            to be printed</span>
<span class="sd">        :param sep:</span>
<span class="sd">            string used to separate columns</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># from Luis Tobalina</span>
        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">graph</span>
        <span class="c1"># check that input &#39;names&#39; and &#39;edge_attributes&#39; exist</span>
        <span class="n">names</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">name</span><span class="p">:</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">attribute_names</span><span class="p">(),</span> <span class="n">names</span><span class="p">)</span>
        <span class="n">edge_attributes</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">attr</span><span class="p">:</span>
                        <span class="n">attr</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">attribute_names</span><span class="p">(),</span> <span class="n">edge_attributes</span><span class="p">)</span>

        <span class="c1"># write file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;wt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fid</span><span class="p">:</span>

            <span class="c1"># write header</span>
            <span class="k">for</span> <span class="n">iname</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
                <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
                    <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">iname</span><span class="p">)</span> <span class="k">for</span> <span class="n">st</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;source&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">)</span>
                <span class="p">]),</span> <span class="n">sep</span><span class="p">))</span>

            <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">eattr</span> <span class="k">for</span> <span class="n">eattr</span> <span class="ow">in</span> <span class="n">edge_attributes</span><span class="p">))</span>

            <span class="c1"># write data</span>
            <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

                <span class="k">for</span> <span class="n">iname</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
                    <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">iname</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span>
                                                  <span class="ow">in</span> <span class="n">edge</span><span class="o">.</span><span class="n">tuple</span><span class="p">]),</span> <span class="n">sep</span><span class="p">))</span>

                <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="n">eattr</span><span class="p">])</span> <span class="k">for</span> <span class="n">eattr</span>
                                             <span class="ow">in</span> <span class="n">edge_attributes</span><span class="p">]))</span></div>

<div class="viewcode-block" id="PyPath.in_complex"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.in_complex">[docs]</a>    <span class="k">def</span> <span class="nf">in_complex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csources</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;corum&#39;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deprecated, will be removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;in_complex&#39;</span><span class="p">]</span> <span class="o">=</span> \
            <span class="p">[</span><span class="nb">sum</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;complexes&#39;</span><span class="p">][</span><span class="n">cs</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&amp;</span>
                      <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;complexes&#39;</span><span class="p">][</span><span class="n">cs</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
                  <span class="k">for</span> <span class="n">cs</span> <span class="ow">in</span> <span class="n">csources</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">]</span></div>

    <span class="c1">#</span>
    <span class="c1"># Methods for translating network to other organism</span>
    <span class="c1">#</span>

    <span class="k">def</span> <span class="nf">_translate_refsdir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rd</span><span class="p">,</span> <span class="n">ids</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Homology translation of the `references by direction` dictionaries.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">new_refsdir</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">rd</span><span class="p">):</span>
            <span class="n">di</span> <span class="o">=</span> <span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">ids</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span> <span class="k">else</span> <span class="n">k</span>
            <span class="n">new_refsdir</span><span class="p">[</span><span class="n">di</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

            <span class="k">return</span> <span class="n">new_refsdir</span>


<div class="viewcode-block" id="PyPath.orthology_translation"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.orthology_translation">[docs]</a>    <span class="k">def</span> <span class="nf">orthology_translation</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">target</span><span class="p">,</span>
            <span class="n">source</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">only_swissprot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">graph</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Translates the current object to another organism by orthology.</span>
<span class="sd">        Proteins without known ortholog will be deleted.</span>

<span class="sd">        :param int target:</span>
<span class="sd">            NCBI Taxonomy ID of the target organism. E.g. 10090 for mouse.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">return_graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">graph</span>
        <span class="n">source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span> <span class="k">if</span> <span class="n">source</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">source</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;Translating network by orthology &#39;</span>
            <span class="s1">&#39;from taxon `</span><span class="si">%u</span><span class="s1">` to taxon `</span><span class="si">%u</span><span class="s1">`.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">name_old__name_new</span> <span class="o">=</span> <span class="n">homology</span><span class="o">.</span><span class="n">homologene_uniprot_dict</span><span class="p">(</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">source</span><span class="p">,</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">target</span><span class="p">,</span>
            <span class="n">only_swissprot</span> <span class="o">=</span> <span class="n">only_swissprot</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;UniProt to UniProt homology dictionary obtained from &#39;</span>
            <span class="s1">&#39;NCBI Homologene. Contains </span><span class="si">%u</span><span class="s1"> UniProt IDs for taxon `</span><span class="si">%u</span><span class="s1">`.&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">name_old__name_new</span><span class="p">),</span>
                <span class="n">source</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">vcount_before</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()</span>
        <span class="n">ecount_before</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;Starting translation. Original network consists of </span><span class="si">%u</span><span class="s1"> &#39;</span>
            <span class="s1">&#39;nodes and </span><span class="si">%u</span><span class="s1"> edges.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">vcount_before</span><span class="p">,</span> <span class="n">ecount_before</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># nodes could not be mapped are to be deleted</span>
        <span class="n">name_old__vid_old</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">vid</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">vid</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
        <span class="p">)</span>

        <span class="n">name_old__name_new</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="p">(</span><span class="n">name_old</span><span class="p">,</span> <span class="n">name_new</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">name_old</span><span class="p">,</span> <span class="n">name_new</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">name_old__name_new</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">name_old</span> <span class="ow">in</span> <span class="n">name_old__vid_old</span> <span class="ow">and</span> <span class="n">name_new</span>
        <span class="p">)</span>

        <span class="n">delete_vids</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">vid_old</span>
            <span class="k">for</span> <span class="n">name_old</span><span class="p">,</span> <span class="n">vid_old</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">name_old__vid_old</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="p">(</span>
                    <span class="n">name_old</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">name_old__name_new</span> <span class="ow">or</span>
                    <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_old__name_new</span><span class="p">[</span><span class="n">name_old</span><span class="p">])</span>
                <span class="p">)</span> <span class="ow">and</span>
                <span class="c1"># nodes of other species or compounds ignored</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">vid_old</span><span class="p">][</span><span class="s1">&#39;ncbi_tax_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">source</span>
            <span class="p">)</span>
        <span class="p">]</span>

        <span class="n">ndel</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">delete_vids</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;Found orthologues for </span><span class="si">%u</span><span class="s1"> node IDs, </span><span class="si">%u</span><span class="s1"> nodes will be &#39;</span>
            <span class="s1">&#39;deleted because no ortholog is known.&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">name_old__name_new</span><span class="p">),</span>
                <span class="n">ndel</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">graph</span><span class="o">.</span><span class="n">delete_vertices</span><span class="p">(</span><span class="n">delete_vids</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;Number of nodes reduced from </span><span class="si">%u</span><span class="s1"> to </span><span class="si">%u</span><span class="s1"> after &#39;</span>
            <span class="s1">&#39;deletion of nodes with no known orthologs.&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">vcount_before</span><span class="p">,</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">(),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;old_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy_mod</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

        <span class="k">del</span> <span class="n">delete_vids</span>
        <span class="k">del</span> <span class="n">name_old__vid_old</span>

        <span class="c1"># this for permanent identification of nodes:</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;id_old&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">xrange</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()))</span>
        <span class="c1"># a dict of these permanent ids and the orthologs:</span>
        <span class="n">vid_old__name_new</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">v</span><span class="p">[</span><span class="s1">&#39;id_old&#39;</span><span class="p">],</span>
                <span class="n">name_old__name_new</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span>
        <span class="p">)</span>

        <span class="c1"># renaming vertices using the first ortholog</span>
        <span class="n">new_names</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span>
                <span class="n">name_old__name_new</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;ncbi_tax_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">source</span> <span class="k">else</span>
                <span class="c1"># nodes of other species or compounds ignored</span>
                <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span>
        <span class="p">]</span>

        <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_names</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">%u</span><span class="s1"> nodes renamed to the name of the first ortholog. &#39;</span>
            <span class="s1">&#39;New nodes will be created for genes mapping to multiple &#39;</span>
            <span class="s1">&#39;orthologues.&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_names</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">del</span> <span class="n">new_names</span>

        <span class="c1"># the new nodes to be added because of ambiguous mapping</span>
        <span class="n">new_nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
            <span class="nb">set</span><span class="p">(</span>
                <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="p">(</span>
                    <span class="n">names_new</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                    <span class="k">for</span> <span class="n">names_new</span> <span class="ow">in</span> <span class="n">name_old__name_new</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="p">))</span>
            <span class="p">)</span> <span class="o">-</span>
            <span class="c1"># except those already exist:</span>
            <span class="nb">set</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
        <span class="p">)</span>

        <span class="n">graph</span> <span class="o">+=</span> <span class="n">new_nodes</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">%u</span><span class="s1"> new nodes have been added due to genes mapped to more &#39;</span>
            <span class="s1">&#39;than one orthologues. Total node count is </span><span class="si">%u</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">new_nodes</span><span class="p">),</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">(),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="k">del</span> <span class="n">new_nodes</span>

        <span class="c1"># this for permanent identification of nodes:</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;id_new&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">xrange</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()))</span>

        <span class="c1"># this is a dict of vertices to be multiplied:</span>
        <span class="n">vid_new_orig__vid_new_all</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="c1"># keys are id_new of the original node</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">id_old</span> <span class="o">=</span> <span class="n">vid_old</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;id_new&#39;</span><span class="p">],</span>
                <span class="c1"># id_new of all orthologs</span>
                <span class="p">[</span>
                    <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="n">name_new</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;id_new&#39;</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">name_new</span> <span class="ow">in</span> <span class="n">names_new</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">vid_old</span><span class="p">,</span> <span class="n">names_new</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">vid_old__name_new</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;Dictionary of nodes created: &#39;</span>
            <span class="s1">&#39;</span><span class="si">%u</span><span class="s1"> nodes are affected by ambiguous mapping.&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">([</span>
                    <span class="mi">1</span>
                    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vid_new_orig__vid_new_all</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
                <span class="p">]),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># compiling a dict of new edges to be added due to ambigous mapping</span>

        <span class="c1"># this is for unambiguously identify edges both at directed and</span>
        <span class="c1"># undirected graphs after reindexing at adding new edges:</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;id_orig&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">()))</span>
        <span class="c1"># pairs of new vertex IDs and names for the original edges</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;vids_new__e_orig&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;id_new&#39;</span><span class="p">],</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;id_new&#39;</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span>
        <span class="p">]</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;names_new__e_orig&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span>
        <span class="p">]</span>

        <span class="c1"># the parent edge original id as key</span>
        <span class="n">eid_orig__vids_new_not_orig</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">eid_orig</span><span class="p">,</span>
                <span class="p">[</span>
                    <span class="n">vids_new__e_new</span>
                    <span class="k">for</span> <span class="n">vids_new__e_new</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span>
                        <span class="n">vid_new_orig__vid_new_all</span><span class="p">[</span><span class="n">vids_new__e_orig</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                        <span class="n">vid_new_orig__vid_new_all</span><span class="p">[</span><span class="n">vids_new__e_orig</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                    <span class="p">)</span>
                    <span class="c1"># not the parent edge itself</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
                        <span class="n">vids_new__e_new</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">vids_new__e_orig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span>
                        <span class="n">vids_new__e_new</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">vids_new__e_orig</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">eid_orig</span><span class="p">,</span> <span class="n">vids_new__e_orig</span> <span class="ow">in</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;id_orig&#39;</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;vids_new__e_orig&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">%u</span><span class="s1"> edges have to be mapped to </span><span class="si">%u</span><span class="s1"> other edges due to &#39;</span>
            <span class="s1">&#39;ambiguous mapping of their endpoints. The network &#39;</span>
            <span class="s1">&#39;consists of </span><span class="si">%u</span><span class="s1"> edges in total.&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">([</span>
                    <span class="mi">1</span>
                    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">eid_orig__vids_new_not_orig</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="p">]),</span>
                <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">eid_orig__vids_new_not_orig</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">(),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># translating the dict values to new vertex indices</span>
        <span class="n">vids_missing</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
            <span class="nb">set</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">id_new</span> <span class="o">=</span> <span class="n">s_vid_new</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                    <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">id_new</span> <span class="o">=</span> <span class="n">t_vid_new</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">s_vid_new</span><span class="p">,</span> <span class="n">t_vid_new</span> <span class="ow">in</span> <span class="p">(</span>
                    <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">eid_orig__vids_new_not_orig</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
                <span class="p">)</span>
            <span class="p">)</span> <span class="o">-</span>
            <span class="c1"># but not any existing edge</span>
            <span class="nb">set</span><span class="p">((</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">)</span> <span class="o">-</span>
            <span class="p">(</span>
                <span class="nb">set</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">is_directed</span><span class="p">()</span> <span class="k">else</span>
                <span class="nb">set</span><span class="p">((</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># creating new edges</span>
        <span class="n">graph</span> <span class="o">+=</span> <span class="n">vids_missing</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">%u</span><span class="s1"> new edges have been added, number of edges &#39;</span>
            <span class="s1">&#39;increased to </span><span class="si">%u</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vids_missing</span><span class="p">),</span> <span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">())</span>
        <span class="p">)</span>

        <span class="c1"># id_new &gt; current index</span>
        <span class="n">vid_new__vid</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;id_new&#39;</span><span class="p">],</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">)</span>
        <span class="c1"># id_new &gt; name</span>
        <span class="n">vid_new__name</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;id_new&#39;</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">)</span>

        <span class="n">prg</span> <span class="o">=</span> <span class="n">Progress</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">(),</span> <span class="s1">&#39;Translating network by homology&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;Copying edge attributes from original edges &#39;</span>
            <span class="s1">&#39;to corresponding new edges between orthologues. &#39;</span>
            <span class="s1">&#39;Number of edges without attributes: </span><span class="si">%u</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">([</span><span class="mi">1</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span> <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">]),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># setting attributes on old and new edges:</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="n">prg</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

            <span class="n">d</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span>

            <span class="c1"># this lookup is appropriate as old node names are certainly</span>
            <span class="c1"># unique; for newly added edges `dirs` will be None</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
                <span class="n">d</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">name_old__name_new</span> <span class="ow">and</span>
                <span class="n">d</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">name_old__name_new</span>
            <span class="p">):</span>

                <span class="c1"># translation of direction object attached to original edges</span>

                <span class="n">ids</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">d</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">name_old__name_new</span><span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">d</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">name_old__name_new</span><span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">],</span>
                <span class="p">}</span>

                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span>

                <span class="n">e</span><span class="p">[</span><span class="s1">&#39;refs_by_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_translate_refsdir</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;refs_by_dir&#39;</span><span class="p">],</span> <span class="n">ids</span><span class="p">)</span>
                <span class="p">)</span>

                <span class="c1"># if no new edges have been introduced</span>
                <span class="c1"># based on this specific edge</span>
                <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;id_orig&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">eid_orig__vids_new_not_orig</span><span class="p">:</span>

                    <span class="k">continue</span>

                <span class="c1"># iterating new edges between orthologs</span>
                <span class="k">for</span> <span class="n">vid_new_s</span><span class="p">,</span> <span class="n">vid_new_t</span> <span class="ow">in</span> <span class="p">(</span>
                    <span class="n">eid_orig__vids_new_not_orig</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;id_orig&#39;</span><span class="p">]]</span>
                <span class="p">):</span>

                    <span class="c1"># the current vertex indices</span>
                    <span class="n">vid_s</span> <span class="o">=</span> <span class="n">vid_new__vid</span><span class="p">[</span><span class="n">vid_new_s</span><span class="p">]</span>
                    <span class="n">vid_t</span> <span class="o">=</span> <span class="n">vid_new__vid</span><span class="p">[</span><span class="n">vid_new_t</span><span class="p">]</span>
                    <span class="c1"># in case of directed graphs this will be correct:</span>
                    <span class="n">new_edges_0</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
                        <span class="n">_source</span> <span class="o">=</span> <span class="n">vid_s</span><span class="p">,</span>
                        <span class="n">_target</span> <span class="o">=</span> <span class="n">vid_t</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">new_edges_1</span> <span class="o">=</span> <span class="p">()</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="n">graph</span><span class="o">.</span><span class="n">is_directed</span><span class="p">():</span>
                        <span class="c1"># at undirected graphs</span>
                        <span class="c1"># source/target might be opposite:</span>
                        <span class="n">new_edges_1</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
                        <span class="n">_source</span> <span class="o">=</span> <span class="n">vid_t</span><span class="p">,</span>
                        <span class="n">_target</span> <span class="o">=</span> <span class="n">vid_s</span><span class="p">,</span>
                    <span class="p">)</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_edges_0</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_edges_1</span><span class="p">):</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                            <span class="s1">&#39;Orthology translation: could not find edge &#39;</span>
                            <span class="s1">&#39;between </span><span class="si">%s</span><span class="s1"> and </span><span class="si">%s</span><span class="s1">!&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">vid_s</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                                <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">vid_t</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                            <span class="p">),</span>
                            <span class="o">-</span><span class="mi">5</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="k">continue</span>

                    <span class="c1"># this is a new edge between orthologs</span>
                    <span class="k">for</span> <span class="n">new_edge</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="n">new_edges_0</span><span class="p">,</span> <span class="n">new_edges_1</span><span class="p">):</span>

                        <span class="c1"># this mapping supposed to be correct because</span>
                        <span class="c1"># the vid_s and vid_t pairs built at the same time</span>
                        <span class="c1"># as the `names_new__e_orig` edge attr</span>

                        <span class="n">ids</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="n">e</span><span class="p">[</span><span class="s1">&#39;names_new__e_orig&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                                <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">vid_s</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                            <span class="n">e</span><span class="p">[</span><span class="s1">&#39;names_new__e_orig&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                                <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">vid_t</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                        <span class="p">}</span>

                        <span class="n">new_edge</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span>

                        <span class="n">new_edge</span><span class="p">[</span><span class="s1">&#39;refs_by_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_translate_refsdir</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;refs_by_dir&#39;</span><span class="p">],</span> <span class="n">ids</span><span class="p">)</span>
                        <span class="p">)</span>
                        <span class="n">new_edge</span><span class="p">[</span><span class="s1">&#39;attrs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;attrs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span>

                        <span class="c1"># copying the remaining attributes</span>
                        <span class="k">for</span> <span class="n">eattr</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>

                            <span class="k">if</span> <span class="p">(</span>
                                <span class="n">eattr</span> <span class="ow">not</span> <span class="ow">in</span>
                                <span class="p">{</span><span class="s1">&#39;dirs&#39;</span><span class="p">,</span> <span class="s1">&#39;refs_by_dir&#39;</span><span class="p">,</span> <span class="s1">&#39;attrs&#39;</span><span class="p">}</span>
                            <span class="p">):</span>

                                <span class="n">new_edge</span><span class="p">[</span><span class="n">eattr</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy_mod</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">eattr</span><span class="p">])</span>

        <span class="n">prg</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;Copying edge attributes finished. &#39;</span>
            <span class="s1">&#39;Number of edges without attributes (should be zero): </span><span class="si">%u</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">([</span><span class="mi">1</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span> <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">]),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># id_new &gt; current index</span>
        <span class="n">vid_new__vid</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;id_new&#39;</span><span class="p">],</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;Copying node attributes from original nodes &#39;</span>
            <span class="s1">&#39;to their corresponding orthologues. &#39;</span>
            <span class="s1">&#39;Number of nodes without attributes: </span><span class="si">%u</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">([</span><span class="mi">1</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span> <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;ncbi_tax_id&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">])</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># setting attributes of vertices</span>
        <span class="k">for</span> <span class="n">vid_new_orig</span><span class="p">,</span> <span class="n">vids_new_all</span> <span class="ow">in</span> <span class="p">(</span>
            <span class="n">iteritems</span><span class="p">(</span><span class="n">vid_new_orig__vid_new_all</span><span class="p">)</span>
        <span class="p">):</span>

            <span class="c1"># the first ortholog:</span>
            <span class="n">v_orig</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">vid_new__vid</span><span class="p">[</span><span class="n">vid_new_orig</span><span class="p">]]</span>
            <span class="c1"># now setting its taxon to the target:</span>
            <span class="n">v_orig</span><span class="p">[</span><span class="s1">&#39;ncbi_tax_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">target</span>

            <span class="k">for</span> <span class="n">vid_new</span> <span class="ow">in</span> <span class="n">vids_new_all</span><span class="p">:</span>
                <span class="c1"># iterating further orthologs:</span>
                <span class="n">v_new</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">vid_new__vid</span><span class="p">[</span><span class="n">vid_new</span><span class="p">]]</span>

                <span class="k">if</span> <span class="n">v_new</span> <span class="o">==</span> <span class="n">v_orig</span><span class="p">:</span>

                    <span class="k">continue</span>

                <span class="c1"># copying attributes:</span>
                <span class="k">for</span> <span class="n">vattr</span> <span class="ow">in</span> <span class="n">v_orig</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>

                    <span class="k">if</span> <span class="n">vattr</span> <span class="o">!=</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span>

                        <span class="n">v_new</span><span class="p">[</span><span class="n">vattr</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy_mod</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">v_orig</span><span class="p">[</span><span class="n">vattr</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;Copying node attributes from original nodes finished.&#39;</span>
            <span class="s1">&#39;Number of nodes without attributes: </span><span class="si">%u</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">([</span><span class="mi">1</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span> <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;ncbi_tax_id&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">])</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># removing temporary edge attributes</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;id_orig&#39;</span><span class="p">]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;id_old&#39;</span><span class="p">]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;id_new&#39;</span><span class="p">]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;vids_new__e_orig&#39;</span><span class="p">]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">[</span><span class="s1">&#39;names_new__e_orig&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span><span class="s1">&#39;Collapsing any duplicate node or edge.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">collapse_by_name</span><span class="p">(</span><span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">genesymbol_labels</span><span class="p">(</span><span class="n">remap_all</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">return_graph</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
                <span class="s1">&#39;Setting the PyPath object`s default taxon to `</span><span class="si">%u</span><span class="s1">`.&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">target</span>
                <span class="p">)</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ncbi_tax_id</span> <span class="o">=</span> <span class="n">target</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">update_vname</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_vindex</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">clean_graph</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log</span><span class="p">(</span>
            <span class="s1">&#39;Network successfully translated from organism `</span><span class="si">%u</span><span class="s1">` to&#39;</span>
            <span class="s1">&#39; `</span><span class="si">%u</span><span class="s1">`. Nodes before: </span><span class="si">%u</span><span class="s1">, after: </span><span class="si">%u</span><span class="s1">. Edges before: </span><span class="si">%u</span><span class="s1">,&#39;</span>
            <span class="s1">&#39; after </span><span class="si">%u</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">source</span><span class="p">,</span>
                <span class="n">target</span><span class="p">,</span>
                <span class="n">vcount_before</span><span class="p">,</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">(),</span>
                <span class="n">ecount_before</span><span class="p">,</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">return_graph</span><span class="p">:</span>

            <span class="k">return</span> <span class="n">graph</span></div>


    <span class="n">homology_translation</span> <span class="o">=</span> <span class="n">orthology_translation</span>


<div class="viewcode-block" id="PyPath.random_walk_with_return"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.random_walk_with_return">[docs]</a>    <span class="k">def</span> <span class="nf">random_walk_with_return</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">niter</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Random walk with return (RWR) starting from one or more query nodes.</span>
<span class="sd">        Returns affinity (probability) vector of all nodes in the graph.</span>

<span class="sd">        Args</span>
<span class="sd">        -----</span>
<span class="sd">            :param int,list q:</span>
<span class="sd">                Vertex IDs of query nodes.</span>
<span class="sd">            :param igraph.Graph graph:</span>
<span class="sd">                An `igraph.Graph` object.</span>
<span class="sd">            :param float c:</span>
<span class="sd">                Probability of restart.</span>
<span class="sd">            :param int niter:</span>
<span class="sd">                Number of iterations.</span>

<span class="sd">        Example:</span>
<span class="sd">        --------</span>
<span class="sd">            &gt;&gt;&gt; import igraph</span>
<span class="sd">            &gt;&gt;&gt; import pypath</span>
<span class="sd">            &gt;&gt;&gt; pa = pypath.PyPath()</span>
<span class="sd">            &gt;&gt;&gt; pa.init_network({</span>
<span class="sd">                    &#39;signor&#39;: pypath.data_formats.pathway[&#39;signor&#39;]</span>
<span class="sd">                })</span>
<span class="sd">            &gt;&gt;&gt; q = [</span>
<span class="sd">                    pa.gs(&#39;EGFR&#39;).index,</span>
<span class="sd">                    pa.gs(&#39;ATG4B&#39;).index</span>
<span class="sd">                ]</span>
<span class="sd">            &gt;&gt;&gt; rwr = pa.random_walk_with_return(q = q)</span>
<span class="sd">            &gt;&gt;&gt; palette = igraph.RainbowPalette(n = 100)</span>
<span class="sd">            &gt;&gt;&gt; colors  = [palette.get(int(round(i))) for i in rwr / max(rwr) * 99]</span>
<span class="sd">            &gt;&gt;&gt; igraph.plot(pa.graph, vertex_color = colors)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_directed</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">graph</span><span class="o">.</span><span class="n">is_directed</span><span class="p">():</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">:: Warning: undirected graph provided</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># making q a set of vertex IDs</span>
        <span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="n">q</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">set</span> <span class="k">else</span> <span class="nb">set</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="k">else</span> <span class="p">{</span><span class="n">q</span><span class="p">}</span>
             <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">q</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">:: Warning: no starting node(s)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">]</span> <span class="o">*</span> <span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())</span>

        <span class="c1"># probability per start node</span>
        <span class="n">cp</span> <span class="o">=</span> <span class="n">c</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
        <span class="c1"># vector with restarting at starting nodes and 0 at all other nodes</span>
        <span class="n">_q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cp</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">q</span> <span class="k">else</span> <span class="mf">.0</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())])</span>

        <span class="c1"># vector of probabilities;</span>
        <span class="c1"># this will be subject of iteration</span>
        <span class="c1"># and its final state will be the result</span>
        <span class="n">_p</span> <span class="o">=</span> <span class="n">copy_mod</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_q</span><span class="p">)</span>

        <span class="c1"># transition matrix</span>
        <span class="n">__A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">get_adjacency</span><span class="p">()),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="n">__A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">__A</span> <span class="o">/</span> <span class="n">__A</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1">#return __A, _p, _q</span>

        <span class="c1"># iteration converges to affinity vector</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">niter</span><span class="p">):</span>
            <span class="n">_p</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">__A</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">_p</span><span class="p">)</span> <span class="o">+</span> <span class="n">_q</span>

        <span class="k">return</span> <span class="n">_p</span></div>

<div class="viewcode-block" id="PyPath.random_walk_with_return2"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.random_walk_with_return2">[docs]</a>    <span class="k">def</span> <span class="nf">random_walk_with_return2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">niter</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Literally does random walks.</span>
<span class="sd">        Only for testing of the other method, to be deleted later.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># making q a set of vertex IDs</span>
        <span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="n">q</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">set</span> <span class="k">else</span> <span class="nb">set</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="k">else</span> <span class="p">{</span><span class="n">q</span><span class="p">}</span>
             <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_directed</span><span class="p">()</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">qq</span> <span class="ow">in</span> <span class="n">q</span><span class="p">:</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">qq</span>

            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">niter</span><span class="p">):</span>
                <span class="n">p</span><span class="p">[</span><span class="n">current</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">c</span><span class="p">:</span>
                    <span class="n">current</span> <span class="o">=</span> <span class="n">qq</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">successors</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="n">successors</span><span class="p">:</span>
                        <span class="n">current</span> <span class="o">=</span> <span class="n">qq</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">current</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">successors</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">p</span></div>

    <span class="k">def</span> <span class="nf">nodes_by_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">):</span>

        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span>
            <span class="n">v</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span>
            <span class="k">if</span> <span class="n">resource</span> <span class="ow">in</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;sources&#39;</span><span class="p">]</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">nodes_by_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_by_resource</span><span class="p">(</span><span class="n">resource</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">resource</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span>
        <span class="p">)</span>


<div class="viewcode-block" id="PyPath.name_edgelist"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.name_edgelist">[docs]</a>    <span class="k">def</span> <span class="nf">name_edgelist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an edge list, i.e. a list with tuples of vertex names.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">graph</span> <span class="o">=</span> <span class="n">graph</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span>

        <span class="n">_sort</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span><span class="p">)</span> <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">is_directed</span><span class="p">()</span> <span class="k">else</span> <span class="nb">sorted</span>
        <span class="n">names</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">[</span>
            <span class="nb">tuple</span><span class="p">(</span><span class="n">_sort</span><span class="p">((</span><span class="n">names</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">],</span> <span class="n">names</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">])))</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">es</span>
        <span class="p">]</span></div>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_interactions</span><span class="p">()</span>

<div class="viewcode-block" id="PyPath.iter_interactions"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.iter_interactions">[docs]</a>    <span class="k">def</span> <span class="nf">iter_interactions</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">signs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">all_undirected</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">by_source</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">with_references</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterates over edges and yields interaction records.</span>

<span class="sd">        :param bool signs:</span>
<span class="sd">            Ignoring signs if ``False``. This way each directed interaction</span>
<span class="sd">            will yield a single record even if it&#39;s ambiguously labeled</span>
<span class="sd">            both positive and negative. The default behaviour is to yield</span>
<span class="sd">            two records in this case, one with positive and one with negative</span>
<span class="sd">            sign.</span>
<span class="sd">        :param bool all_undirected:</span>
<span class="sd">            Yield records for undirected interactions even if certain sources</span>
<span class="sd">            provide direction. If ``False`` only the directed records will</span>
<span class="sd">            be provided and the undirected sources and references will be</span>
<span class="sd">            added to the directed records.</span>
<span class="sd">        :param bool by_source:</span>
<span class="sd">            Yield separate records by resources. This way the node pairs</span>
<span class="sd">            will be redundant and you need to group later if you want</span>
<span class="sd">            unique interacting pairs. By default is ``False`` because for</span>
<span class="sd">            most applications unique interactions are preferred.</span>
<span class="sd">            If ``False`` the *refrences* field will still be present</span>
<span class="sd">            but with ``None`` values.</span>
<span class="sd">        :param bool with_references:</span>
<span class="sd">            Include the literature references. By default is ``False``</span>
<span class="sd">            because you rarely need these and they increase the data size</span>
<span class="sd">            significantly.</span>
<span class="sd">        &quot;&quot;&quot;</span>


        <span class="n">source_op</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">eq</span> <span class="k">if</span> <span class="n">by_source</span> <span class="k">else</span> <span class="n">operator</span><span class="o">.</span><span class="n">contains</span>


        <span class="k">def</span> <span class="nf">get_references</span><span class="p">(</span><span class="n">sources</span><span class="p">,</span> <span class="n">edge</span><span class="p">,</span> <span class="n">typ</span><span class="p">):</span>

            <span class="k">return</span> <span class="p">(</span>
                <span class="nb">set</span><span class="p">(</span>
                    <span class="n">ref</span><span class="o">.</span><span class="n">pmid</span>
                    <span class="k">for</span> <span class="n">this_refs</span> <span class="ow">in</span>
                    <span class="p">(</span>
                        <span class="n">refs</span>
                        <span class="k">for</span> <span class="n">src</span><span class="p">,</span> <span class="n">refs</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="s1">&#39;refs_by_source&#39;</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">source_op</span><span class="p">(</span><span class="n">sources</span><span class="p">,</span> <span class="n">src</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">this_refs</span> <span class="o">&amp;</span> <span class="n">edge</span><span class="p">[</span><span class="s1">&#39;refs_by_type&#39;</span><span class="p">][</span><span class="n">typ</span><span class="p">]</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">with_references</span> <span class="k">else</span>

                <span class="kc">None</span>
            <span class="p">)</span>


        <span class="k">def</span> <span class="nf">iter_sources</span><span class="p">(</span><span class="n">sources</span><span class="p">,</span> <span class="n">edge</span><span class="p">,</span> <span class="n">typ</span><span class="p">):</span>

            <span class="n">sources</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">sources</span>
                    <span class="k">if</span> <span class="n">by_source</span> <span class="k">else</span>
                <span class="p">(</span><span class="n">sources</span><span class="p">,)</span>
                    <span class="k">if</span> <span class="n">sources</span> <span class="k">else</span>
                <span class="p">()</span>
            <span class="p">)</span>

            <span class="k">for</span> <span class="n">_sources</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>

                <span class="k">yield</span> <span class="p">(</span>
                    <span class="n">_sources</span><span class="p">,</span>
                    <span class="n">get_references</span><span class="p">(</span><span class="n">_sources</span><span class="p">,</span> <span class="n">edge</span><span class="p">,</span> <span class="n">typ</span><span class="p">)</span>
                <span class="p">)</span>


        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span><span class="p">:</span>

            <span class="n">directions</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="s1">&#39;dirs&#39;</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">typ_sources</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="s1">&#39;sources_by_type&#39;</span><span class="p">]):</span>

                <span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">(</span><span class="n">directions</span><span class="o">.</span><span class="n">straight</span><span class="p">,</span> <span class="n">directions</span><span class="o">.</span><span class="n">reverse</span><span class="p">):</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="n">directions</span><span class="o">.</span><span class="n">dirs</span><span class="p">[</span><span class="n">direction</span><span class="p">]:</span>
                        <span class="c1"># this direction does not exist</span>
                        <span class="k">continue</span>

                    <span class="n">dir_sources</span> <span class="o">=</span> <span class="n">directions</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span>
                        <span class="n">direction</span><span class="p">,</span>
                        <span class="n">sources</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="p">)</span> <span class="o">&amp;</span> <span class="n">typ_sources</span>

                    <span class="n">id_a</span> <span class="o">=</span> <span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">id_b</span> <span class="o">=</span> <span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">type_a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uniprot</span><span class="p">(</span><span class="n">id_a</span><span class="p">)[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
                    <span class="n">type_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uniprot</span><span class="p">(</span><span class="n">id_b</span><span class="p">)[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>

                    <span class="k">for</span> <span class="n">effect</span><span class="p">,</span> <span class="n">sign_sources</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                        <span class="n">directions</span><span class="o">.</span><span class="n">get_sign</span><span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="n">sources</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
                    <span class="p">):</span>

                        <span class="k">for</span> <span class="n">sources</span><span class="p">,</span> <span class="n">references</span> <span class="ow">in</span> <span class="n">iter_sources</span><span class="p">(</span>
                            <span class="n">sign_sources</span> <span class="o">&amp;</span> <span class="n">typ_sources</span><span class="p">,</span>
                            <span class="n">edge</span><span class="p">,</span>
                            <span class="n">typ</span><span class="p">,</span>
                        <span class="p">):</span>

                            <span class="k">yield</span> <span class="n">network</span><span class="o">.</span><span class="n">Interaction</span><span class="p">(</span>
                                <span class="n">id_a</span> <span class="o">=</span> <span class="n">id_a</span><span class="p">,</span>
                                <span class="n">id_b</span> <span class="o">=</span> <span class="n">id_b</span><span class="p">,</span>
                                <span class="n">type_a</span> <span class="o">=</span> <span class="n">type_a</span><span class="p">,</span>
                                <span class="n">type_b</span> <span class="o">=</span> <span class="n">type_b</span><span class="p">,</span>
                                <span class="nb">type</span> <span class="o">=</span> <span class="n">typ</span><span class="p">,</span>
                                <span class="n">directed</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                <span class="n">effect</span> <span class="o">=</span> <span class="n">effect</span><span class="p">,</span>
                                <span class="n">sources</span> <span class="o">=</span> <span class="n">sources</span><span class="p">,</span>
                                <span class="n">references</span> <span class="o">=</span> <span class="n">references</span><span class="p">,</span>
                            <span class="p">)</span>

                    <span class="n">sources_with_sign</span> <span class="o">=</span> <span class="nb">set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span>
                        <span class="o">*</span><span class="n">directions</span><span class="o">.</span><span class="n">get_sign</span><span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="n">sources</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">sources_without_sign</span> <span class="o">=</span> <span class="n">dir_sources</span> <span class="o">-</span> <span class="n">sources_with_sign</span>

                    <span class="k">for</span> <span class="n">sources</span><span class="p">,</span> <span class="n">references</span> <span class="ow">in</span> <span class="n">iter_sources</span><span class="p">(</span>
                        <span class="n">sources_without_sign</span><span class="p">,</span>
                        <span class="n">edge</span><span class="p">,</span>
                        <span class="n">typ</span><span class="p">,</span>
                    <span class="p">):</span>

                        <span class="k">yield</span> <span class="n">network</span><span class="o">.</span><span class="n">Interaction</span><span class="p">(</span>
                            <span class="n">id_a</span> <span class="o">=</span> <span class="n">id_a</span><span class="p">,</span>
                            <span class="n">id_b</span> <span class="o">=</span> <span class="n">id_b</span><span class="p">,</span>
                            <span class="n">type_a</span> <span class="o">=</span> <span class="n">type_a</span><span class="p">,</span>
                            <span class="n">type_b</span> <span class="o">=</span> <span class="n">type_b</span><span class="p">,</span>
                            <span class="nb">type</span> <span class="o">=</span> <span class="n">typ</span><span class="p">,</span>
                            <span class="n">directed</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                            <span class="n">effect</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                            <span class="n">sources</span> <span class="o">=</span> <span class="n">sources</span><span class="p">,</span>
                            <span class="n">references</span> <span class="o">=</span> <span class="n">references</span><span class="p">,</span>
                        <span class="p">)</span>

                <span class="n">undirected_sources</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">directions</span><span class="o">.</span><span class="n">get_dir</span><span class="p">(</span><span class="s1">&#39;undirected&#39;</span><span class="p">,</span> <span class="n">sources</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
                <span class="p">)</span> <span class="o">&amp;</span> <span class="n">typ_sources</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">undirected_sources</span><span class="p">:</span>

                    <span class="k">continue</span>

                <span class="n">id_a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">edge</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="n">id_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">edge</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
                <span class="n">type_a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">edge</span><span class="o">.</span><span class="n">source</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
                <span class="n">type_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">edge</span><span class="o">.</span><span class="n">target</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>

                <span class="k">for</span> <span class="n">sources</span><span class="p">,</span> <span class="n">references</span> <span class="ow">in</span> <span class="n">iter_sources</span><span class="p">(</span>
                    <span class="n">undirected_sources</span><span class="p">,</span>
                    <span class="n">edge</span><span class="p">,</span>
                    <span class="n">typ</span><span class="p">,</span>
                <span class="p">):</span>

                    <span class="k">yield</span> <span class="n">network</span><span class="o">.</span><span class="n">Interaction</span><span class="p">(</span>
                        <span class="n">id_a</span> <span class="o">=</span> <span class="n">id_a</span><span class="p">,</span>
                        <span class="n">id_b</span> <span class="o">=</span> <span class="n">id_b</span><span class="p">,</span>
                        <span class="n">type_a</span> <span class="o">=</span> <span class="n">type_a</span><span class="p">,</span>
                        <span class="n">type_b</span> <span class="o">=</span> <span class="n">type_b</span><span class="p">,</span>
                        <span class="nb">type</span> <span class="o">=</span> <span class="n">typ</span><span class="p">,</span>
                        <span class="n">directed</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                        <span class="n">effect</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="n">sources</span> <span class="o">=</span> <span class="n">sources</span><span class="p">,</span>
                        <span class="n">references</span> <span class="o">=</span> <span class="n">references</span><span class="p">,</span>
                    <span class="p">)</span></div>

    <span class="c1"># shortcuts for the most often used igraph attributes:</span>


    <span class="k">def</span> <span class="nf">name_to_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodLab</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodDct</span><span class="p">[</span><span class="n">name</span><span class="p">]]</span>

        <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>

            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vcount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vcount</span><span class="p">()</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ecount</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">ecount</span><span class="p">()</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vs</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">es</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">es</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vertex_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">vertex_attributes</span><span class="p">()</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">edge_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">edge_attributes</span><span class="p">()</span>


<div class="viewcode-block" id="PyPath.reload"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.reload">[docs]</a>    <span class="k">def</span> <span class="nf">reload</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reloads the object from the module level.&quot;&quot;&quot;</span>

        <span class="n">modname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span>
        <span class="n">mod</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">modname</span><span class="p">,</span> <span class="n">fromlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">modname</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="n">imp</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>
        <span class="n">new</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;__class__&#39;</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span></div>


    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_disclaimer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints a disclaimer about respecting data licences.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pypath</span><span class="o">.</span><span class="n">_disclaimer</span><span class="p">()</span>


<div class="viewcode-block" id="PyPath.license"><a class="viewcode-back" href="../../../api/pypath.legacy.main.PyPath.html#pypath.legacy.main.PyPath.license">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">license</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints information about data licences.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pypath</span><span class="o">.</span><span class="n">license</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="init_db"><a class="viewcode-back" href="../../../api/pypath.legacy.main.init_db.html#pypath.legacy.main.init_db">[docs]</a><span class="k">def</span> <span class="nf">init_db</span><span class="p">(</span><span class="n">use_omnipath</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

    <span class="n">pa</span> <span class="o">=</span> <span class="n">PyPath</span><span class="p">()</span>
    <span class="nb">getattr</span><span class="p">(</span>
        <span class="n">pa</span><span class="p">,</span>
        <span class="s1">&#39;load_omnipath&#39;</span> <span class="k">if</span> <span class="n">use_omnipath</span> <span class="k">else</span> <span class="s1">&#39;init_network&#39;</span>
    <span class="p">)(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nb">globals</span><span class="p">()[</span><span class="s1">&#39;db&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pa</span></div>


<div class="viewcode-block" id="get_db"><a class="viewcode-back" href="../../../api/pypath.legacy.main.get_db.html#pypath.legacy.main.get_db">[docs]</a><span class="k">def</span> <span class="nf">get_db</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

    <span class="k">if</span> <span class="s1">&#39;db&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>

        <span class="n">init_db</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">globals</span><span class="p">()[</span><span class="s1">&#39;db&#39;</span><span class="p">]</span></div>
</pre></div>

                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="../../../index.html">Welcome to pypath!</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="../../../webservice.html">Webservice</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="../../../releasehistory.html">Release history</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="../../../reference.html">Reference</a></li>
<li class="toctree-l1 toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="../../../notebooks/manual.html">The pypath book</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2023, Denes Turei &lt;turei.denes@gmail.com&gt;, Nicolàs Palacio, Sebastian Lobentanzer, Olga Ivanova, Melih Darcan, Erva Ulusoy, Tennur Kilic, Omer Kaan Vural, Ahmet Rifaioglu, Charles Tapley Hoyt.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.0.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>